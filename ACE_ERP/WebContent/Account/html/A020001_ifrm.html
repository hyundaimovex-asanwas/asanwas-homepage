<!---------------------------------------------------------------------------
+ 시 스 템 명	:  미결전표관리 - 전표입력부부 (IFRAME 부분)	
+ 프로그램 ID	:  A020001_ifrm.html
+ 기 능 정 의	:  미결전표 입력 부분을 그리드가 멀티로를 지원하지 못하여 스크립트로 작성
+ 작   성  자 :  정 영 식
+ 작 성 일 자 :  2005.11.22
-----------------------------------------------------------------------------
+ 수 정 내 용 :	   
+ 수   정  자 :
+ 수 정 일 자 :
-----------------------------------------------------------------------------
+ 참 고 내 용 :	 중요 hidden flag
+                hid_flag        : 화면상의 row가 화면에 보이는지 숨겨졌는지 확인   (T-보임, F-숨김)
+                                  hid_flag"+i+"0   hid_flag"+i+"1   hid_flag"+i+"2  hid_flag"+i+"3  
    
								 hid_flag_sel    : 조회된 화면인지, 입력하기 위해 Add한 row인지 구분(S-조회, A-입력)
                                   hid_flag_sel"+i+"0

                 hid_fsseq       : 전표 detail의 가전표행번호로 조회시만 데이타가 있고 입력시에는 
								                   데이타가 존재하지 않음 ( 입력시 Max+1 로 채번하여 생성함)
	                                  hid_fsseq"+i+"    
								 
								 hid_flag_del    : 전표 등록 화면에서 계정의 수정과 삭제를 구분하기 위해 사용함.
								                   수정은 항상 'N' 값을 가지고 있고, 
                                   계정을 체크 후 삭제 버튼을 누르면 해당 flag에 'Y' 값을 넣어서 구분함.
																	 hid_flag_del"+i+"
                 
								 hid_atdebtyn    : 계정선택시 반제유무를 체크함.
								                   반제계정은 'Y' 값을 가지고 있음. 
                                   계정선택시만 가져옴.
																	 조회시는 blank가 됨.//입력시만 사용가능함.
																	 hid_atdebtyn"+i+"

								 hid_banjaeyn    : 반제연결테이블에 저장하고 전표 Dtl에 반제라고 표시하는 flag. 'Y' - 반제계정
								                   hid_banjaeyn"+i+"
                 
								 hid_type        : 관리항목의 코드값과 txt값 입력을 구분하는 필드 
								                   C - txt값 입력이 가능함. 
																	 B - 예산에서 세목
																	 이 경우 관리항목 name을 value에 복사해서 넣음 
                                   hid_type"+i+j+"1

                 hid_typeBf       : hid_type와 동일한 성격이지만 예산에서 세목을 찾을 때 사용(변경전 데이타의 세목)
								                   C - txt값 입력이 가능함. 
																	 B - 예산에서 세목
																	
                 hid_arbaldiv    : 관리항목 입력 구분값 N- 필수항목 

								 hid_bgtdiv      : 예산본부 코드 

								 hid_Bchaamt"+i+" : 예산관련해서 금액을 변경했을 경우 변경전 금액을 보관함.

								 hid_atdecr       : 계정코드에 따른 기준차대 값

		ls_html +="	    <input type=hidden  id=hid_type"+i+j+"1 value='"+gcds_data01.namevalue(i,"FSREFVAL0"+ino1)+"' >";
		ls_html +="			<input type=hidden  id=hid_arbaldiv"+i+j+"1 value='"+gcds_data01.namevalue(i,"FSREFVAL0"+ino1)+"' >";

    ls_html +="			<input type=hidden  id=hid_bgtcnt"+i+"     value=''>";  //세목 건수
		ls_html +="			<input type=hidden  id=hid_bgtcmtype"+i+"  value=''>";	//예산 가능건 null이면 불가능
+ 
-----------------------------------------------------------------------------
+ 서 블 릿 명	:
------------------------------------------------------------------------------>
<html>
<head>
<title></title>
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Content-Type" content="text/html; charset=euc-kr">
<!-----------------------------------------------------------------------------
		S T Y L E   S H E E T   L I N K   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<link rel="stylesheet" href="../../common/include/common.css">

<!-----------------------------------------------------------------------------
		C O M M O N   M O D U L E   S C R I P T S( MESSAGE & FUNCTION )
------------------------------------------------------------------------------>
<Script language="javascript" src="../../common/include/PubFun.js"></script>
<!-- <Script language="javascript" src="../../common/include/PubFun03.js"></script> -->
<!-----------------------------------------------------------------------------
		L O C A L   S T Y L E   S H E E T   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<style type="text/css">
<!--
//-->
</style>

<!-----------------------------------------------------------------------------
		L O C A L   S C R I P T   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javascript">
var ls_html2="";
var g_yn="";        //결재완료 대기 상태
var g_row=0;        //마지막 레코드 위치
var g_position=0;   //현재 row의 위치
var g_seq="0";      //전표행번호
var g_strbanjae="N"; //반제 구분

var g_remark="";     //전표입력시 하위 계정에 자동입력 변수 -적요
var g_deptcd="";     //전표입력시 하위 계정에 자동입력 변수 -거래처
var g_deptnm="";     //전표입력시 하위 계정에 자동입력 변수 -거래처명
var g_custcd="";     //전표입력시 하위 계정에 자동입력 변수 -부서
var g_custnm="";     //전표입력시 하위 계정에 자동입력 변수 -부서명
var g_documcd="";    //전표입력시 하위 계정에 자동입력 변수 -증빙코드
var g_docuval="";    //전표입력시 하위 계정에 자동입력 변수 -증빙값
var g_divcd="";
var g_taxval=0;      //세금계산서 금액 합계
var g_bgtdept="";     //예산부서
var g_bgtdeptnm="";   //예산부서명
var g_bgtdiv="";      //예산본부

var g_fsnum="";      //순번
var g_fsknd="0";     //기표종류  0 - 수동전표, 1- 세금계산서, 2 - 고정자산
                     //          3 - 자금      6- 반제      
get_cookdata();
lfn_init(); //로그인 체크 함수 호출
var gs_date = gcurdate.substring(0,4) + gcurdate.substring(5,7) + gcurdate.substring(8,10);
var gs_userid = gusrid;
var gs_usernm = gusrnm;
var gs_deptcd = gdeptcd;
var gs_deptnm = gdeptnm;
var gs_fdcode = gfdcode;
var gs_cocode = gcocode;


var g_arrParam	= new Array();
//var g_arrResult	= new Array();

//회계개발자 편의상 만듬---------------------
if (gs_userid=="ACCOUNT"){
		gs_userid="1990046";
		gs_fdcode = '02';
		gs_deptcd= 'C260';
		gs_deptnm='회계팀';
		gs_cocode='02';
}
//-------------------------------------------

/******************************************************************************
	Description : 페이지 로딩
******************************************************************************/
function ln_Start(){
	//ln_SetFormat(3)
	gcds_documcd.DataID = g_servlet+"/Account.comcode_s1?v_str1=0052"
	//prompt("",gcds_documcd.DataID);
	gcds_documcd.Reset();

	gcds_fswrkdiv.DataID = g_servlet+"/Account.comcode_s1?v_str1=2138"
	//prompt("",gcds_fswrkdiv.DataID);
	gcds_fswrkdiv.Reset();
}
/******************************************************************************
	Description : 조회
	parameter   : p0 - 구분         01 - 더블 클릭해서 데이타 가져옴.
	              p1 - fdcode 현장코드  
								p2 - fsdat  접수일자 
								p3 - fsnbr, 접수번호
								p4 - 결재완료 구분
								p5 - ssdat, 전표일자
								p6 - ssnbr  전표번호
******************************************************************************/
function ln_Query(p0,p1,p2,p3,p4,p5,p6){
  g_yn = p4;
	if (p0=="01"){ 
	  //div1.innerHTML="";
		__ws2_Clear__(div1);
	  //g_usests ="2";
		gcds_data01.DataID = g_servlet+"/Account.a020001_s7f?v_str1="+p1+"&v_str2="+p2+"&v_str3="+p3+"&v_str4="+p5+"&v_str5="+p6;
		prompt("",gcds_data01.DataID);																							
		gcds_data01.Reset(); 

		//조회시 회계일자 저장(수정전) 
    parent.hid_actdat02.value = parent.gcem_actdat02.text;
    //alert("hid_actdat02"+parent.hid_actdat02.value);
    ln_Clear();   //계정추가 관련 변수 클리어
	}
}

/******************************************************************************
	Description : 계정코드 및 관리항목 조회
	parameter   : p1 -  1 : 계정코드 2:계정코드명  3:관리항목명
							  p2 -  조회조건
******************************************************************************/
function ln_Atcode_Ref_Query(p1,p2){

		if(p1=="1"){
			g_servlet+"/Account.a020001_s20?v_str1="+p2+"&v_str2=";					
		  gcds_data01.Reset(); 
		}else if(p1=="2"){
			g_servlet+"/Account.a020001_s20?v_str1=&v_str2="+p2;					
		  gcds_data01.Reset(); 
		}else if(p1=="3"){
		  g_servlet+"/Account.a020001_s21?v_str1=&v_str2="+p2;					
		  gcds_data01.Reset(); 
		}

}
/******************************************************************************
	Description : 마감확인 조회
	parameter   :
							
******************************************************************************/
function ln_Slip_Close_Query(){
    var strdate = parent.gcem_actdat02.text;
		var stryyyy=strdate.substring(0,4);
		var strmm = strdate.substring(4,6);
		var strdd = strdate.substring(6,8);
    
		gcds_slip_close.DataID = g_servlet+"/Account.a020001_s19?v_str1="+parent.gclx_fdcode02.bindcolval
		                                                       +"&v_str2="+stryyyy
																													 +"&v_str3="+strmm
																													 +"&v_str4="+strdd;
	  //prompt("",gcds_slip_close.DataID);																							
		gcds_slip_close.Reset(); 
}

/******************************************************************************
	Description : 추가
******************************************************************************/
function ln_Add(){
	//ln_row_Cnt(1);
	//ln_line_Add(i,j,strbgcolor);
}


/******************************************************************************
	Description : 사업소코드 셋팅
******************************************************************************/
function ln_Cocode(strcocode){
	if(strcocode==""||strcocode==undefined){
		if(parent.gclx_fdcode02.bindcolval=="01"){
			strcocode="01";
		}else{
			strcocode="02";
		}
	}
	return strcocode;
}

/******************************************************************************
	Description : 전표 Master Data 와 전표 Detail 데이타를 동시에 저장함.
	              DataSet은 두개로 분리해서 저장함.
	parameter   : p2 - status     
								p3 - 현장코드(2자리)  
                p4 - 접수일자(9자리)
								p5 - 접수번호(6자리)
								p6 - 작성일자
								p7 - 작성부서
								p8 - 작성자
								p9 - 가전표금액
								p10- 부가세
								p11- 차변합계
								p12- 대변합계
								p13- 적요
								p14- 가전표상태
								p15- 작업일자
								p16- 회계일자
								p18 -본부코드
								p19 -사업장코드
								p20 -전표종류 ( )
******************************************************************************/
function ln_Save(p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p18,p19,p20){
   
		if(ln_Chk()){
				ln_SetDataHeader("MST");
				ln_SetDataHeader("SLIPNO");
				gcds_mst.addrow();
        if(g_fsknd!="") p20=g_fsknd;

				//사업소코드 넣기
				//alert(""+p19);
				var strcocode=ln_Cocode(p19);
				
				gcds_mst.namevalue(gcds_mst.rowposition,"FDCODE")=p3;
				gcds_mst.namevalue(gcds_mst.rowposition,"FSDAT")=p4;
				gcds_mst.namevalue(gcds_mst.rowposition,"FSNBR")=p5;
				gcds_mst.namevalue(gcds_mst.rowposition,"FSKND")=p20;
				gcds_mst.namevalue(gcds_mst.rowposition,"FSWRTDAT")=p6;

				//gcds_mst.namevalue(gcds_mst.rowposition,"COCODE")=p19;
				gcds_mst.namevalue(gcds_mst.rowposition,"COCODE")=strcocode;
				gcds_mst.namevalue(gcds_mst.rowposition,"DEPTCD")=p7;
				gcds_mst.namevalue(gcds_mst.rowposition,"EMPNO")=p8;
				gcds_mst.namevalue(gcds_mst.rowposition,"DIVCD")=p18;
				gcds_mst.namevalue(gcds_mst.rowposition,"FSAMT")=p9;

				gcds_mst.namevalue(gcds_mst.rowposition,"FSVAT")=p10;
				gcds_mst.namevalue(gcds_mst.rowposition,"DETOT")=p11;
				gcds_mst.namevalue(gcds_mst.rowposition,"CRTOT")=p12;
				gcds_mst.namevalue(gcds_mst.rowposition,"REMARK")=p13;
				gcds_mst.namevalue(gcds_mst.rowposition,"SGNDAT")="";  //결재일자

				gcds_mst.namevalue(gcds_mst.rowposition,"FSSTAT")=p14;
				gcds_mst.namevalue(gcds_mst.rowposition,"ACTDAT")=p16; //회계일자
				gcds_mst.namevalue(gcds_mst.rowposition,"WRDT")=p15;
				gcds_mst.namevalue(gcds_mst.rowposition,"WRID")=p8;
				gcds_mst.namevalue(gcds_mst.rowposition,"UPDT")=p15;
				gcds_mst.namevalue(gcds_mst.rowposition,"UPID")=p8;

				ln_Update_Del(p3,p4,p5);                 //Update 건 확인 - chk 된 건수
				ln_Bgt_Insert_Update_Del(p3,p4,p5,p19);  //예산MST 예산DTL UPDATE 예산총계정원장 INSERT
			
			if (gcds_mst.IsUpdated||gcds_data01.IsUpdated){
				if (confirm("저장하시겠습니까?")){	
					gctr_data01.Action = g_servlet+"/Account.a020001_t1f?";
          //prompt("gctr_data01",gctr_data01.Action);
					if(gcds_mst.countrow==0)      gcds_mst.ClearAll();
					if(gcds_data01.countrow==0)   gcds_data01.ClearAll();
          if(gcds_data02.countrow==0)   gcds_data02.ClearAll();
				  if(gcds_del01.countrow==0)    gcds_del01.ClearAll();
					if(gcds_banjae.countrow==0)   gcds_banjae.ClearAll();
					if(gcds_banjaemst.countrow==0)   gcds_banjaemst.ClearAll();
          if(gcds_tax.countrow==0)      gcds_tax.ClearAll();
					if(gcds_genrst.countrow==0)   gcds_genrst.ClearAll();
				  if(gcds_bgt_insert.countrow==0)   gcds_bgt_insert.ClearAll();
					if(gcds_bgt_update.countrow==0)   gcds_bgt_update.ClearAll();
					if(gcds_bgt_del.countrow==0)   gcds_bgt_del.ClearAll();
					if(gcds_fsnum.countrow==0)   gcds_fsnum.ClearAll();
         
				 /*
					prompt("gcds_mst",gcds_mst.text);
					prompt("gcds_data01",gcds_data01.text);
					prompt("gcds_data02",gcds_data02.text);
					prompt("gcds_del01",gcds_del01.text);
					
					prompt("gcds_banjae",gcds_banjae.text);
					prompt("gcds_banjaemst",gcds_banjaemst.text);
			
					prompt("gcds_tax",gcds_tax.text);
					prompt("gcds_genrst",gcds_genrst.text);
				  
					prompt("gcds_bgt_insert",gcds_bgt_insert.text);
					prompt("gcds_bgt_update",gcds_bgt_update.text);
				  prompt("gcds_bgt_del",gcds_bgt_del.text);
					
					prompt("gcds_fsnum",gcds_fsnum.text);
				  */
					gctr_data01.Parameters = "v_str1="+gs_fdcode;
					gctr_data01.post();
					parent.ln_Query('03');
				}else{
				  gcds_mst.ClearAll();
					gcds_data01.ClearAll();
					gcds_data02.ClearAll();
					gcds_del01.ClearAll();
					gcds_banjae.ClearAll();
					gcds_banjaemst.ClearAll();
					gcds_tax.ClearAll();
					gcds_bgt_insert.ClearAll();
					gcds_bgt_update.ClearAll();
					gcds_bgt_del.ClearAll();
					gcds_fsnum.ClearAll();
          
					//prompt("","fdcode::"+gcds_key.namevalue(1,"FDCODE"));
					//prompt("","FSDAT"+gcds_key.namevalue(1,"FSDAT"));
					//prompt("","FSNBR"+gcds_key.namevalue(1,"FSNBR"));

					//var ColumnName1 = gcds_del01.ColumnID(1);
					//alert("ColumnName1"+ColumnName1);
          
					//if (gcds_key.namevalue(1,"FDCODE")=='undefined'){
					  //alert("step111");				
					//}else{
						//ln_Query('01',gcds_key.namevalue(1,"FDCODE"),gcds_key.namevalue(1,"FSDAT"),gcds_key.namevalue(1,"FSNBR"),'N' );
						//alert("step");
						//parent.ln_key_change(gcds_key.namevalue(1,"FDCODE"),gcds_key.namevalue(1,"FSDAT"),gcds_key.namevalue(1,"FSNBR"));
					//}
				}
			}
		}
}

/******************************************************************************
	Description : Detail 과 관리항목 데이타를 입력/수정/삭제 구분함.
	              입력 - "hid_flag_sel"+i+"0"== A &&  eval("hid_flag_del"+i).value=="N"
								수정 - "hid_flag_sel"+i+"0"== S &&  "chkbox"+i= true && eval("hid_flag_del"+i).value=="N" 
                삭제 - "chkbox"+i = true && eval("hid_flag_del"+i).value=="Y"   
  parameter   : p1 - 지점
	              p2 - 접수일자
								p3 - 전표행번호
******************************************************************************/
function ln_Update_Del(p1,p2,p3){
  var cnt=0;
	var cnt2=0;
	var j=0;
	var seq="";
	var strBanjae="";

	for (i=1;i<=g_row;i++){
	  //alert("i::"+i+":txt_atcode"+eval("txt_atcode"+i).value+"::txt_atkornam::"+eval("txt_atkornam"+i).value);
		if(eval("txt_atcode"+i).value!=""&&eval("txt_atkornam"+i).value!=""){
			if(eval("hid_flag"+i+"0").value=="T"){ //순번만 update 함  T - 화면상 보이는 상태
				if(gcds_fsnum.countrow<=0) ln_SetDataHeader("FSNUM");		
				gcds_fsnum.Addrow();
				gcds_fsnum.namevalue(gcds_fsnum.rowposition,"FDCODE")=p1;
				gcds_fsnum.namevalue(gcds_fsnum.rowposition,"FSDAT")=p2;
				gcds_fsnum.namevalue(gcds_fsnum.rowposition,"FSNBR")=p3;
				gcds_fsnum.namevalue(gcds_fsnum.rowposition,"FSSEQ")=eval("hid_fsseq"+i).value;
				gcds_fsnum.namevalue(gcds_fsnum.rowposition,"FSNUM")=eval("txt_fsnum"+i).value;
			}

			//alert("chkbox" + eval("chkbox"+i).checked);
			//alert("hid_flag_del"+ eval("hid_flag_del"+i).value);

			if (eval("hid_flag_sel"+i+"0").value!="S"&&eval("hid_flag_del"+i).value=="N"){ //입력
					
					if(gcds_data01.countrow<=0) ln_SetDataHeader("DTL");		 
					if(eval("txt_atcode"+i).value!=""){
						gcds_data01.Addrow();
						gcds_data01.namevalue(gcds_data01.rowposition,"FDCODE")=p1;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSDAT")=p2;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSNBR")=p3;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSSEQ")=eval("hid_fsseq"+i).value;
						gcds_data01.namevalue(gcds_data01.rowposition,"ATCODE")=eval("txt_atcode"+i).value;

						gcds_data01.namevalue(gcds_data01.rowposition,"ATDECR")="2";  //프로시저에서 생성함
						gcds_data01.namevalue(gcds_data01.rowposition,"CHAAMT")=eval("gcem_chaamt"+i).text;
						gcds_data01.namevalue(gcds_data01.rowposition,"DAEAMT")=eval("gcem_daeamt"+i).text;
					//	alert("sel_documcd:::"+eval("sel_documcd"+i).value);
						gcds_data01.namevalue(gcds_data01.rowposition,"DOCUMCD")=eval("sel_documcd"+i).value;

						gcds_data01.namevalue(gcds_data01.rowposition,"FSWRKDIV")=eval("sel_fswrkdiv"+i).value;
						gcds_data01.namevalue(gcds_data01.rowposition,"REMARK")=eval("txt_remark"+i).value;
						//^^alert("hid_atdebtyn::"+eval("hid_atdebtyn"+i).value);
						//^^alert("hid_atdecr::"+eval("hid_atdecr"+i).value);
						strBanjae = ln_Banjae_yn(eval("hid_atdebtyn"+i).value,eval("hid_atdecr"+i).value,eval("gcem_chaamt"+i).text,eval("gcem_daeamt"+i).text);
						//^^alert("strBanjae::::"+strBanjae);
						gcds_data01.namevalue(gcds_data01.rowposition,"BANJAEYN")=strBanjae;
						gcds_data01.namevalue(gcds_data01.rowposition,"DOCUVAL")=eval("hid_docuval"+i).value;
						
						gcds_data01.namevalue(gcds_data01.rowposition,"FSNUM")=eval("txt_fsnum"+i).value;
						gcds_data01.namevalue(gcds_data01.rowposition,"DIVCD")=eval("hid_divcd"+i).value;
						gcds_data01.namevalue(gcds_data01.rowposition,"BGTDIV")=eval("hid_bgtdiv"+i).value;

						j=1;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFSEQ01")=eval("txt_fsrefseq"+i+j+"1").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFCD01")=eval("txt_fsrefcd"+i+j+"1").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFVAL01")=eval("txt_fsrefval"+i+j+"1").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFSEQ02")=eval("txt_fsrefseq"+i+j+"2").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFCD02")=eval("txt_fsrefcd"+i+j+"2").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFVAL02")=eval("txt_fsrefval"+i+j+"2").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFSEQ03")=eval("txt_fsrefseq"+i+j+"3").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFCD03")=eval("txt_fsrefcd"+i+j+"3").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFVAL03")=eval("txt_fsrefval"+i+j+"3").value;
						
						j=2;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFSEQ04")=eval("txt_fsrefseq"+i+j+"1").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFCD04")=eval("txt_fsrefcd"+i+j+"1").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFVAL04")=eval("txt_fsrefval"+i+j+"1").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFSEQ05")=eval("txt_fsrefseq"+i+j+"2").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFCD05")=eval("txt_fsrefcd"+i+j+"2").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFVAL05")=eval("txt_fsrefval"+i+j+"2").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFSEQ06")=eval("txt_fsrefseq"+i+j+"3").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFCD06")=eval("txt_fsrefcd"+i+j+"3").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFVAL06")=eval("txt_fsrefval"+i+j+"3").value;

						j=3;
						//alert("i"+i+"j"+j+"::"+eval("txt_fsrefseq"+i+j+"1").value);
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFSEQ07")=eval("txt_fsrefseq"+i+j+"1").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFCD07")=eval("txt_fsrefcd"+i+j+"1").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFVAL07")=eval("txt_fsrefval"+i+j+"1").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFSEQ08")=eval("txt_fsrefseq"+i+j+"2").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFCD08")=eval("txt_fsrefcd"+i+j+"2").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFVAL08")=eval("txt_fsrefval"+i+j+"2").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFSEQ09")=eval("txt_fsrefseq"+i+j+"3").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFCD09")=eval("txt_fsrefcd"+i+j+"3").value;
						gcds_data01.namevalue(gcds_data01.rowposition,"FSREFVAL09")=eval("txt_fsrefval"+i+j+"3").value;
				 
						gcds_data01.namevalue(gcds_data01.rowposition,"WRDT")=gs_date;
						gcds_data01.namevalue(gcds_data01.rowposition,"WRID")=gusrid;
						gcds_data01.namevalue(gcds_data01.rowposition,"UPDT")=gs_date;
						gcds_data01.namevalue(gcds_data01.rowposition,"UPID")=gusrid;

						if(eval("hid_flag"+i+"0").value=="F"){//
							gcds_data01.DeleteRow(i);
						}
					}

			}else if(eval("hid_flag_sel"+i+"0").value=="S"&&eval("chkbox"+i).checked==true&&eval("hid_flag_del"+i).value=="N"){ //수정
				  //^^alert("i:"+i+"::Update");
					if(gcds_data02.countrow<=0) ln_SetDataHeader("DTL_UPDATE");	

					gcds_data02.Addrow();
					//alert("fsseq"+ eval("hid_fsseq"+i).value);
					gcds_data02.namevalue(gcds_data02.rowposition,"FDCODE")=p1;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSDAT")=p2;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSNBR")=p3;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSSEQ")=eval("hid_fsseq"+i).value;
					gcds_data02.namevalue(gcds_data02.rowposition,"ATCODE")= eval("txt_atcode"+i).value;

					gcds_data02.namevalue(gcds_data02.rowposition,"ATDECR")="2"; //프로시저에서 생성함
					gcds_data02.namevalue(gcds_data02.rowposition,"CHAAMT")=eval("gcem_chaamt"+i).text;
					gcds_data02.namevalue(gcds_data02.rowposition,"DAEAMT")=eval("gcem_daeamt"+i).text;
					gcds_data02.namevalue(gcds_data02.rowposition,"DOCUMCD")=eval("sel_documcd"+i).value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSWRKDIV")=eval("sel_fswrkdiv"+i).value;
					gcds_data02.namevalue(gcds_data02.rowposition,"REMARK")=eval("txt_remark"+i).value;
					gcds_data02.namevalue(gcds_data02.rowposition,"DOCUVAL")=eval("hid_docuval"+i).value;
					
					gcds_data02.namevalue(gcds_data02.rowposition,"FSNUM")=eval("txt_fsnum"+i).value;
					gcds_data02.namevalue(gcds_data02.rowposition,"DIVCD")=eval("hid_divcd"+i).value;
					gcds_data02.namevalue(gcds_data02.rowposition,"BGTDIV")=eval("hid_bgtdiv"+i).value;

					j=1;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFSEQ01")=eval("txt_fsrefseq"+i+j+"1").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFCD01")=eval("txt_fsrefcd"+i+j+"1").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFVAL01")=eval("txt_fsrefval"+i+j+"1").value;
					
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFSEQ02")=eval("txt_fsrefseq"+i+j+"2").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFCD02")=eval("txt_fsrefcd"+i+j+"2").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFVAL02")=eval("txt_fsrefval"+i+j+"2").value;
					
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFSEQ03")=eval("txt_fsrefseq"+i+j+"3").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFCD03")=eval("txt_fsrefcd"+i+j+"3").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFVAL03")=eval("txt_fsrefval"+i+j+"3").value;
					
					j=2;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFSEQ04")=eval("txt_fsrefseq"+i+j+"1").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFCD04")=eval("txt_fsrefcd"+i+j+"1").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFVAL04")=eval("txt_fsrefval"+i+j+"1").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFSEQ05")=eval("txt_fsrefseq"+i+j+"2").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFCD05")=eval("txt_fsrefcd"+i+j+"2").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFVAL05")=eval("txt_fsrefval"+i+j+"2").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFSEQ06")=eval("txt_fsrefseq"+i+j+"3").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFCD06")=eval("txt_fsrefcd"+i+j+"3").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFVAL06")=eval("txt_fsrefval"+i+j+"3").value;

					j=3;
					//alert("i"+i+"j"+j+"::"+eval("txt_fsrefseq"+i+j+"1").value);
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFSEQ07")=eval("txt_fsrefseq"+i+j+"1").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFCD07")=eval("txt_fsrefcd"+i+j+"1").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFVAL07")=eval("txt_fsrefval"+i+j+"1").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFSEQ08")=eval("txt_fsrefseq"+i+j+"2").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFCD08")=eval("txt_fsrefcd"+i+j+"2").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFVAL08")=eval("txt_fsrefval"+i+j+"2").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFSEQ09")=eval("txt_fsrefseq"+i+j+"3").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFCD09")=eval("txt_fsrefcd"+i+j+"3").value;
					gcds_data02.namevalue(gcds_data02.rowposition,"FSREFVAL09")=eval("txt_fsrefval"+i+j+"3").value;

					gcds_data02.namevalue(gcds_data02.rowposition,"WRDT")=gs_date;
					gcds_data02.namevalue(gcds_data02.rowposition,"WRID")=gs_userid;
					gcds_data02.namevalue(gcds_data02.rowposition,"UPDT")=gs_date;
					gcds_data02.namevalue(gcds_data02.rowposition,"UPID")=gs_userid;

			}else if(eval("chkbox"+i).checked==true && eval("hid_flag_del"+i).value=="Y"){//삭제 
				//alert("i:"+i+"::Delete_1");
				if(eval("hid_fsseq"+i).value!=""){
					//alert("i:"+i+"::Delete_2");
					//alert("hid_fsseq:::" +eval("hid_fsseq"+i).value);
					if(gcds_del01.countrow<=0) ln_SetDataHeader("DTL_DEL");	
		
					gcds_del01.addrow();
					//alert("gcds_del01.rowposition::"+gcds_del01.rowposition);
					gcds_del01.namevalue(gcds_del01.rowposition,"FDCODE")=p1;
					gcds_del01.namevalue(gcds_del01.rowposition,"FSDAT")=p2;
					gcds_del01.namevalue(gcds_del01.rowposition,"FSNBR")=p3;
					gcds_del01.namevalue(gcds_del01.rowposition,"FSSEQ")=eval("hid_fsseq"+i).value; 

					//alert("gcds_del01.rowposition::"+gcds_del01.rowposition);
					//ln_Display(i);
					eval("chkbox"+i).checked=false;
				}
			}//if
		}//if 계정코드가 존재하는건만 
	}//for

	g_strbanjae="N";
}

/******************************************************************************
Description : 반제구분값
parameter   : p1 - 반제구분값   p3-차변금액
	            p2 - 기준차대     p4-대변금액
******************************************************************************/
function ln_Banjae_yn(p1,p2,p3,p4){

	//^^alert("ln_Banjae_yn :: p1"+p1+"p2"+p2+"p3"+p3+"p4"+p4);
	if(p1=="Y"){
		if(p2=="1"&&p3!=0&&p4==0){       //차변
			return "Y" ;
		}else if(p2=="2"&&p3==0&&p4!=0){ //대변
			return "Y" ;
		}else{
			return p1;
		}
	}else{
		return "N" ;
	}
}

/******************************************************************************
	Description : 예산관련 입력/수정/삭제 구분함.
	              입력 - "hid_flag_sel"+i+"0"== A &&  eval("hid_flag_del"+i).value=="N"
								수정 - "hid_flag_sel"+i+"0"== S &&  "chkbox"+i= false && eval("hid_flag_del"+i).value=="N" 
                삭제 - "chkbox"+i = true && eval("hid_flag_del"+i).value=="Y"   
  parameter   : p1 - 지점
	              p2 - 접수일자
								p3 - 전표행번호
								p19 - 사업장코드
******************************************************************************/
function ln_Bgt_Insert_Update_Del(p1,p2,p3,p19){
 // alert("g_row::"+g_row);
	for (i=1;i<=g_row;i++){
	 // alert("i::"+i);
   // alert("hid_flag_del::"+eval("hid_flag_del"+i).value);
   // alert("hid_fsseq::"+eval("hid_fsseq"+i).value);  
    if (eval("hid_flag_sel"+i+"0").value!="S"&&eval("hid_flag_del"+i).value=="N"){ //입력
			if(eval("txt_atcode"+i).value!=""){
				//예산부서가 존재하면 addrow();
				var no1 =ln_Bgt_position_find(i); //예산부서 위치찾기
				var no2 =ln_Bgt_Detail_find(i);   //세목위치 찾기
  
				if((no1!=""&&no1!=undefined)&&(no2!=""&&no2!=undefined)){
				   //MST는 생략 ==>DETAIL의 건으로 만듬
					if(gcds_bgt_insert.countrow<=0){
						ln_SetDataHeader("BGTDTL");
					}
					gcds_bgt_insert.Addrow();
					var stractdt = parent.gcem_actdat02.text;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"BGTYY")=stractdt.substring(0,4);           //예산년도
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"BGTMM")=stractdt.substring(4,6);           //예산월  
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"BGTDIV")=eval("hid_bgtdiv"+i).value;	      //예산본부         
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"BGTDPT")=eval("txt_fsrefval"+no1).value;	 //예산부서         
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"ATCODE")=eval("txt_atcode"+i).value;	     //계정과목         
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFCD")=eval("txt_fsrefcd"+no2).value;	 //관리항목코드     
					
					//예산부서가 예산관리항목인 경우 세목은 00로 설정
					if(eval("txt_fsrefcd"+no2).value=="0003"){
            gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"SATCODE")="00";	 //세목  
					}else{
						gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"SATCODE")=eval("txt_fsrefval"+no2).value;	 //세목  
					}
					
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"BGTMACT")=eval("sel_fswrkdiv"+i).value;	  //예산타입  
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"CHAAMT")=eval("gcem_chaamt"+i).text;       //금액          

					//예산총계정원장 (미승인 실적분)
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FDCODE")=p1;  
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"ACTDAT")=parent.gcem_actdat02.text;   
					//gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"ATCODE")=eval("txt_atcode"+i).value;
					//gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"COCODE")=parent.gclx_fdcode02.bindcolval;   
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"COCODE")=ln_Cocode(p19); 
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSDAT")=p2;   
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSNBR")=p3;   
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSSEQ")=eval("hid_fsseq"+i).value; 

					//예산관리항목원장 (미승인 실적분)
					j=1;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFCD01")=eval("txt_fsrefcd"+i+j+"1").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFVAL01")=eval("txt_fsrefval"+i+j+"1").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFCD02")=eval("txt_fsrefcd"+i+j+"2").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFVAL02")=eval("txt_fsrefval"+i+j+"2").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFCD03")=eval("txt_fsrefcd"+i+j+"3").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFVAL03")=eval("txt_fsrefval"+i+j+"3").value;

					j=2;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFCD04")=eval("txt_fsrefcd"+i+j+"1").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFVAL04")=eval("txt_fsrefval"+i+j+"1").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFCD05")=eval("txt_fsrefcd"+i+j+"2").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFVAL05")=eval("txt_fsrefval"+i+j+"2").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFCD06")=eval("txt_fsrefcd"+i+j+"3").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFVAL06")=eval("txt_fsrefval"+i+j+"3").value;

					j=3;
					//alert("i"+i+"j"+j+"::"+eval("txt_fsrefseq"+i+j+"1").value);
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFCD07")=eval("txt_fsrefcd"+i+j+"1").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFVAL07")=eval("txt_fsrefval"+i+j+"1").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFCD08")=eval("txt_fsrefcd"+i+j+"2").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFVAL08")=eval("txt_fsrefval"+i+j+"2").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFCD09")=eval("txt_fsrefcd"+i+j+"3").value;
					gcds_bgt_insert.namevalue(gcds_bgt_insert.rowposition,"FSREFVAL09")=eval("txt_fsrefval"+i+j+"3").value;
				}
			}
		}else if(((eval("hid_flag_sel"+i+"0").value=="S" && eval("chkbox"+i).checked==true &&  eval("hid_flag_del"+i).value=="N"))||(parent.gcem_actdat02.text!=parent.hid_actdat02.value)){ //수정건 또는 회계일자 변경시 예산반영함.
	    if(eval("txt_atcode"+i).value!=""){

				//예산부서가 존재하면 addrow();

				var no3 =ln_Bf_Bgt_position_find(i); //변경 전 예산부서 위치찾기
				var no4 =ln_Bf_Bgt_Detail_find(i);   //변경 세목위치 찾기
				var no1 =ln_Bgt_position_find(i);    //변경 후 예산부서 위치찾기
				var no2 =ln_Bgt_Detail_find(i);      //변경 후 세목위치 찾기
 
				if(((no1!=""&&no1!=undefined)&&(no2!=""&&no2!=undefined))||((no3!=""&&no3!=undefined)&&(no4!=""&&no4!=undefined))){
					//MST는 생략 ==>DETAIL의 건으로 만듬
					if(gcds_bgt_update.countrow<=0){
						ln_SetDataHeader("BGTDTL_UPDATE");
					}
					gcds_bgt_update.Addrow();
					var stractdt2 = parent.gcem_actdat02.text;
					
					//변경후
					if((no1!=""&&no1!=undefined)&&(no2!=""&&no2!=undefined)){
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BGTYY")=stractdt2.substring(0,4);          //예산년도
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BGTMM")=stractdt2.substring(4,6);          //예산월  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BGTDIV")=eval("hid_bgtdiv"+i).value;	      //예산본부         
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BGTDPT")=eval("txt_fsrefval"+no1).value;	  //예산부서         
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"ATCODE")=eval("txt_atcode"+i).value;	      //계정과목         
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD")=eval("txt_fsrefcd"+no2).value;	  //관리항목코드     
						
						//예산부서가 예산관리항목인 경우 세목은 00로 설정
						if(eval("txt_fsrefcd"+no2).value=="0003"){
							gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"SATCODE")="00";	 //세목  
						}else{
							gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"SATCODE")=eval("txt_fsrefval"+no2).value;	//세목   
						}
						
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BGTMACT")=eval("sel_fswrkdiv"+i).value;	  //예산타입 
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"CHAAMT")=eval("gcem_chaamt"+i).text; 			//금액   


						//예산총계정원장 (미승인 실적분)
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FDCODE")=p1;  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"ACTDAT")=parent.gcem_actdat02.text;   
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"COCODE")=ln_Cocode('');
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSDAT")=p2;   
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSNBR")=p3;   
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSSEQ")=eval("hid_fsseq"+i).value; 

						//변경 후 예산관리항목원장 (미승인 실적분)
						j=1;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD01")=eval("txt_fsrefcd"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL01")=eval("txt_fsrefval"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD02")=eval("txt_fsrefcd"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL02")=eval("txt_fsrefval"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD03")=eval("txt_fsrefcd"+i+j+"3").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL03")=eval("txt_fsrefval"+i+j+"3").value;

						j=2;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD04")=eval("txt_fsrefcd"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL04")=eval("txt_fsrefval"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD05")=eval("txt_fsrefcd"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL05")=eval("txt_fsrefval"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD06")=eval("txt_fsrefcd"+i+j+"3").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL06")=eval("txt_fsrefval"+i+j+"3").value;

						j=3;
						//alert("i"+i+"j"+j+"::"+eval("txt_fsrefseq"+i+j+"1").value);
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD07")=eval("txt_fsrefcd"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL07")=eval("txt_fsrefval"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD08")=eval("txt_fsrefcd"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL08")=eval("txt_fsrefval"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD09")=eval("txt_fsrefcd"+i+j+"3").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL09")=eval("txt_fsrefval"+i+j+"3").value;
					}else{
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BGTYY")="";    //예산년도
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BGTMM")="";    //예산월  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BGTDIV")="";	  //예산본부         
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BGTDPT")="";	  //예산부서         
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"ATCODE")="";	  //계정과목         
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD")="";	//관리항목코드     
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"SATCODE")="";	//세목   
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BGTMACT")="";	  //예산타입 
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"CHAAMT")=""; 			//금액   

						//변경 후 예산관리항목원장 (미승인 실적분)
						j=1;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD01")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL01")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD02")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL02")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD03")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL03")="";

						j=2;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD04")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL04")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD05")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL05")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD06")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL06")="";

						j=3;
						//alert("i"+i+"j"+j+"::"+eval("txt_fsrefseq"+i+j+"1").value);
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD07")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL07")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD08")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL08")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFCD09")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSREFVAL09")="";
					}
					
					//변경전
					var stractdt3 = parent.hid_actdat02.value;
					if((no3!=""&&no3!=undefined)&&(no4!=""&&no4!=undefined)){
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BBGTYY")=stractdt3.substring(0,4);          //변경전예산년도
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BBGTMM")=stractdt3.substring(4,6);          //변경전예산월  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BBGTDIV")=eval("hid_Bbgtdiv"+i).value;      //변경전예산본부  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BBGTDPT")=eval("hid_Bbgtdpt"+i).value;      //변경전예산부서  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BATCODE")=eval("hid_Batcode"+i).value;      //변경전계정과목  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD")=eval("hid_Bfsrefcd"+i).value;    //변경전관리항목코드  
						
						//예산부서가 예산관리항목인 경우 세목은 00로 설정
						if(eval("hid_Bfsrefcd"+i).value=="0003"){
							gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BSATCODE")="00";	 //세목  
						}else{
							gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BSATCODE")=eval("hid_Bsatcode"+i).value;    //변경전세목
						}
						
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BBGTMACT")=eval("hid_Bfswrkdiv"+i).value;	 //변경전예산타입 
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BCHAAMT")=eval("hid_Bchaamt"+i).value;      //변경전금액  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BACTDAT")=parent.hid_actdat02.value;        //변경전 회계일자  

						//예산총계정원장 (미승인 실적분)
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FDCODE")=p1;  
						//gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"ACTDAT")=parent.gcem_actdat02.text;   
						//gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"ATCODE")=eval("txt_atcode"+i).value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"COCODE")=ln_Cocode(parent.hid_cocode02.value);
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSDAT")=p2;   
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSNBR")=p3;   
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSSEQ")=eval("hid_fsseq"+i).value; 

						//alert("parent.hid_cocode02.value; "+parent.hid_cocode02.value);

						//변경 전 예산관리항목원장 (미승인 실적분)
						j=1;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD01")=eval("hid_fsrefcd"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL01")=eval("hid_fsrefval"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD02")=eval("hid_fsrefcd"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL02")=eval("hid_fsrefval"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD03")=eval("hid_fsrefcd"+i+j+"3").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL03")=eval("hid_fsrefval"+i+j+"3").value;

						j=2;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD04")=eval("hid_fsrefcd"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL04")=eval("hid_fsrefval"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD05")=eval("hid_fsrefcd"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL05")=eval("hid_fsrefval"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD06")=eval("hid_fsrefcd"+i+j+"3").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL06")=eval("hid_fsrefval"+i+j+"3").value;

						j=3;
						//alert("i"+i+"j"+j+"::"+eval("txt_fsrefseq"+i+j+"1").value);
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD07")=eval("hid_fsrefcd"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL07")=eval("hid_fsrefval"+i+j+"1").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD08")=eval("hid_fsrefcd"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL08")=eval("hid_fsrefval"+i+j+"2").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD09")=eval("hid_fsrefcd"+i+j+"3").value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL09")=eval("hid_fsrefval"+i+j+"3").value;
					}else{

						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BBGTYY")="";          //변경전예산년도
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BBGTMM")="";          //변경전예산월  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BBGTDIV")="";      //변경전예산본부  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BBGTDPT")="";      //변경전예산부서  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BATCODE")="";      //변경전계정과목  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD")="";     //변경전관리항목코드  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BSATCODE")="";     //변경전세목
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BBGTMACT")="";	    //변경전예산타입 
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BCHAAMT")="";      //변경전금액  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BACTDAT")="";        //변경전 회계일자  

						//예산총계정원장 (미승인 실적분)
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FDCODE")="";  
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"ACTDAT")="";   
						//gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"ATCODE")=eval("txt_atcode"+i).value;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"COCODE")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSDAT")="";   
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSNBR")="";   
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"FSSEQ")=""; 

						//alert("parent.hid_cocode02.value; "+parent.hid_cocode02.value);

						//변경 전 예산관리항목원장 (미승인 실적분)
						j=1;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD01")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL01")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD02")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL02")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD03")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL03")="";

						j=2;
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD04")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL04")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD05")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL05")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD06")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL06")="";

						j=3;
						//alert("i"+i+"j"+j+"::"+eval("txt_fsrefseq"+i+j+"1").value);
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD07")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL07")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD08")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL08")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFCD09")="";
						gcds_bgt_update.namevalue(gcds_bgt_update.rowposition,"BFSREFVAL09")="";
					}
        }
			}
		}else if(eval("hid_flag_del"+i).value=="Y"){//삭제 
      
      if(eval("hid_fsseq"+i).value!=""){
			 //예산부서가 존재하면 addrow();
				var no1 =ln_Bgt_position_find(i); //예산부서 위치찾기
				var no2 =ln_Bgt_Detail_find(i);   //세목위치 찾기
 
				if((no1!=""&&no1!=undefined)&&(no2!=""&&no2!=undefined)){
				   //MST는 생략 ==>DETAIL의 건으로 만듬
					 if(gcds_bgt_del.countrow<=0){
							ln_SetDataHeader("BGTDTL_DEL");
					 }
						gcds_bgt_del.Addrow();
						var stractdt3 = parent.hid_actdat02.value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"BGTYY")=stractdt3.substring(0,4);          //변경전예산년도
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"BGTMM")=stractdt3.substring(4,6);          //변경전예산월  
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"BGTDIV")=eval("hid_Bbgtdiv"+i).value;      //변경전예산본부  
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"BGTDPT")=eval("hid_Bbgtdpt"+i).value;      //변경전예산부서  
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"ATCODE")=eval("hid_Batcode"+i).value;      //변경전계정과목  
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFCD")=eval("hid_Bfsrefcd"+i).value;    //변경전관리항목코드  
						
						//예산부서가 예산관리항목인 경우 세목은 00로 설정
						if(eval("hid_Bfsrefcd"+i).value=="0003"){
							gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"SATCODE")="00";	 //세목  
						}else{
							gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"SATCODE")=eval("hid_Bsatcode"+i).value;    //변경전세목
						}
						
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"BGTMACT")=eval("hid_Bfswrkdiv"+i).value;	  //변경전예산타입 
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"CHAAMT")=eval("hid_Bchaamt"+i).value;      //변경전금액  
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"ACTDAT")=parent.hid_actdat02.value;        //변경전 회계일자  

						//예산총계정원장 (미승인 실적분)
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FDCODE")=p1;  
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"COCODE")=ln_Cocode(parent.hid_cocode02.value); 
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSDAT")=p2;   
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSNBR")=p3;   
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSSEQ")=eval("hid_fsseq"+i).value; 

						//변경 전 예산관리항목원장 (미승인 실적분)
						//예산관리항목원장
						j=1;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFCD01")=eval("hid_fsrefcd"+i+j+"1").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFVAL01")=eval("hid_fsrefval"+i+j+"1").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFCD02")=eval("hid_fsrefcd"+i+j+"2").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFVAL02")=eval("hid_fsrefval"+i+j+"2").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFCD03")=eval("hid_fsrefcd"+i+j+"3").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFVAL03")=eval("hid_fsrefval"+i+j+"3").value;

						j=2;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFCD04")=eval("hid_fsrefcd"+i+j+"1").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFVAL04")=eval("hid_fsrefval"+i+j+"1").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFCD05")=eval("hid_fsrefcd"+i+j+"2").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFVAL05")=eval("hid_fsrefval"+i+j+"2").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFCD06")=eval("hid_fsrefcd"+i+j+"3").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFVAL06")=eval("hid_fsrefval"+i+j+"3").value;

						j=3;
						//alert("i"+i+"j"+j+"::"+eval("txt_fsrefseq"+i+j+"1").value);
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFCD07")=eval("hid_fsrefcd"+i+j+"1").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFVAL07")=eval("hid_fsrefval"+i+j+"1").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFCD08")=eval("hid_fsrefcd"+i+j+"2").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFVAL08")=eval("hid_fsrefval"+i+j+"2").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFCD09")=eval("hid_fsrefcd"+i+j+"3").value;
						gcds_bgt_del.namevalue(gcds_bgt_del.rowposition,"FSREFVAL09")=eval("hid_fsrefval"+i+j+"3").value;
        }
			}
		}//if
	}//for
}

/******************************************************************************
	Description : 저장할 Data를 위한 DataSetHead 설정
  parameter   : 관련table - FSLIPMST, FSLIPDTL, FSLIPREF, 
	                          BANJAE, GENRST
******************************************************************************/
function ln_SetDataHeader(p1){
  //alert("header::"+p1);
	if(p1=="MST"){
		var s_fslipmst = "FDCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSKND:STRING,FSWRTDAT:STRING,"
									 + "COCODE:STRING,DEPTCD:STRING,EMPNO:STRING,DIVCD:STRING,FSAMT:DECIAML,"
									 + "FSVAT:DECIAML,DETOT:DECIAML,CRTOT:DECIAML,REMARK:STRING,"
									 + "SGNDAT:STRING,FSSTAT:STRING,ACTDAT:STRING,"
									 + "WRDT:STRING,WRID:STRING,UPDT:STRING,UPID:STRING";
		gcds_mst.SetDataHeader(s_fslipmst);
	}else if(p1=="DTL"){
		var s_fslipdtl = "FDCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSSEQ:STRING,ATCODE:STRING,"
                   + "ATKORNAM:STRING,ATDECR:STRING,REMARK:STRING,CHAAMT:DECIMAL,DAEAMT:DECIMAL,"
                   + "FSREFSEQ01:STRING,FSREFSEQ02:STRING,FSREFSEQ03:STRING,FSREFSEQ04:STRING,FSREFSEQ05:STRING,"
                   + "FSREFSEQ06:STRING,FSREFSEQ07:STRING,FSREFSEQ08:STRING,FSREFSEQ09,"
									 + "FSREFCD01:STRING,FSREFCD02:STRING,FSREFCD03:STRING,FSREFCD04:STRING,FSREFCD05:STRING,"
									 + "FSREFCD06:STRING,FSREFCD07:STRING,FSREFCD08:STRING,FSREFCD09:STRING,"
                   + "FSREFVAL01:STRING,FSREFVAL02:STRING,FSREFVAL03:STRING,FSREFVAL04:STRING,FSREFVAL05:STRING,"
									 + "FSREFVAL06:STRING,FSREFVAL07:STRING,FSREFVAL08:STRING,FSREFVAL09:STRING,"
									 + "FSREFNM01:STRING,FSREFNM02:STRING,FSREFNM03:STRING,FSREFNM04:STRING,FSREFNM05:STRING,"
									 + "FSREFNM06:STRING,FSREFNM07:STRING,FSREFNM08:STRING,FSREFNM09:STRING,"
									 + "FSRVALNM01:STRING,FSRVALNM02:STRING,FSRVALNM03:STRING,FSRVALNM04:STRING,FSRVALNM05:STRING,"
									 + "FSRVALNM06:STRING,FSRVALNM07:STRING,FSRVALNM08:STRING,FSRVALNM09:STRING,"
									 + "CNT:DECIMAL,DOCUMCD:STRING,DOCUMNM:STRING,FSWRKDIV:STRING,"
									 + "WRDT:STRING,WRID:STRING,UPDT:STRING,UPID:STRING,"
									 + "BANJAEYN:STRING,DOCUVAL:STRING,FSNUM:STRING,DIVCD:STRING,BGTDIV:STRING ";
		gcds_data01.SetDataHeader(s_fslipdtl);
                        
	}else if(p1=="DTL_UPDATE"){
		var s_fslipdtl2 = "FDCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSSEQ:STRING,ATCODE:STRING,"
                   + "ATKORNAM:STRING,ATDECR:STRING,REMARK:STRING,CHAAMT:DECIMAL,DAEAMT:DECIMAL,"
                   + "FSREFSEQ01:STRING,FSREFSEQ02:STRING,FSREFSEQ03:STRING,FSREFSEQ04:STRING,FSREFSEQ05:STRING,"
                   + "FSREFSEQ06:STRING,FSREFSEQ07:STRING,FSREFSEQ08:STRING,FSREFSEQ09,"
									 + "FSREFCD01:STRING,FSREFCD02:STRING,FSREFCD03:STRING,FSREFCD04:STRING,FSREFCD05:STRING,"
									 + "FSREFCD06:STRING,FSREFCD07:STRING,FSREFCD08:STRING,FSREFCD09:STRING,"
                   + "FSREFVAL01:STRING,FSREFVAL02:STRING,FSREFVAL03:STRING,FSREFVAL04:STRING,FSREFVAL05:STRING,"
									 + "FSREFVAL06:STRING,FSREFVAL07:STRING,FSREFVAL08:STRING,FSREFVAL09:STRING,"
									 + "FSREFNM01:STRING,FSREFNM02:STRING,FSREFNM03:STRING,FSREFNM04:STRING,FSREFNM05:STRING,"
									 + "FSREFNM06:STRING,FSREFNM07:STRING,FSREFNM08:STRING,FSREFNM09:STRING,"
									 + "FSRVALNM01:STRING,FSRVALNM02:STRING,FSRVALNM03:STRING,FSRVALNM04:STRING,FSRVALNM05:STRING,"
									 + "FSRVALNM06:STRING,FSRVALNM07:STRING,FSRVALNM08:STRING,FSRVALNM09:STRING,"
									 + "CNT:DECIMAL,DOCUMCD:STRING,DOCUMNM:STRING,FSWRKDIV:STRING,"
									 + "WRDT:STRING,WRID:STRING,UPDT:STRING,UPID:STRING,"
									 + "BANJAEYN:STRING,DOCUVAL:STRING,FSNUM:STRING,DIVCD:STRING,BGTDIV:STRING ";
								
		gcds_data02.SetDataHeader(s_fslipdtl2);
                        
	}else if(p1=="DTL_DEL"){
		var s_fslipdtl3 = "FDCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSSEQ:STRING";               
		gcds_del01.SetDataHeader(s_fslipdtl3);

  }else if(p1=="MST_DEL"){
		var s_fslipdtl4 = "FDCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSSEQ:STRING";
		gcds_del02.SetDataHeader(s_fslipdtl4);
	}else if(p1=="BANJAE"){
		var s_fslipdtl5 = "FTSTAT:STRING,FDCODE:STRING,TSDAT:STRING,TSNBR:STRING,TSSEQ:STRING,"
		                + "BTSDAT:STRING,BTSNBR:STRING,BTSSEQ:STRING,BANJAEYN:STRING,"	
                    + "SSDAT:STRING,SSNBR:STRING,FSNUM:STRING,BJDEAMT:DECIMAL,BJCRAMT:DECIMAL,"	 
										+ "BSDAT:STRING,BSNBR:STRING,BSNUM:STRING,"
										+ "WRDT:STRING,WRID:STRING,UPDT:STRING,UPID:STRING";

    gcds_banjae.SetDataHeader(s_fslipdtl5);
	}else if(p1=="TAX"){
		var s_fslipdtl6 = "TAXNBR:STRING,FDCODE:STRING,FSDAT:STRING,FSNBR:STRING,UPDT:STRING,UPID:STRING ";
    gcds_tax.SetDataHeader(s_fslipdtl6);
	}else if(p1=="GENRST"){
		var s_fslipdtl7 = "FDCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSSEQ:STRING,RSVNO:STRING, "
                    + "RSTDIV:STRING,RSTNO:STRING,VEND_CD:STRING,REMARK:STRING,AMOUNT:DECIMAL, "
		                + "RSVDATE:STRING,RSVMAN:STRING,CURDATE:STRING ";
    gcds_genrst.SetDataHeader(s_fslipdtl7);
	}else if(p1=="SLIPNO"){
		var s_fslipdtl8 = "FDCODE:STRING,FSDAT:STRING,FSNBR:STRING";
    gcds_slipno.SetDataHeader(s_fslipdtl8);
	}else if (p1=="BGTDTL"){
		var s_fslipdtl9 = "BGTYY:STRING,BGTMM:STRING,BGTDIV:STRING,BGTDPT:STRING,ATCODE:STRING,"
										+ "FSREFCD:STRING,SATCODE:STRING,BGTMACT:STRING,CHAAMT:DECIMAL, "
										+ "FDCODE:STRING,ACTDAT:STRING,COCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSSEQ:STRING, " 
										+ "FSREFCD01:STRING,FSREFCD02:STRING,FSREFCD03:STRING,FSREFCD04:STRING,FSREFCD05:STRING,"
										+ "FSREFCD06:STRING,FSREFCD07:STRING,FSREFCD08:STRING,FSREFCD09:STRING,"
										+ "FSREFVAL01:STRING,FSREFVAL02:STRING,FSREFVAL03:STRING,FSREFVAL04:STRING,FSREFVAL05:STRING,"
										+ "FSREFVAL06:STRING,FSREFVAL07:STRING,FSREFVAL08:STRING,FSREFVAL09:STRING";
    gcds_bgt_insert.SetDataHeader(s_fslipdtl9);
	}else if (p1=="BGTDTL_UPDATE"){
		var s_fslipdtl10 = "BGTYY:STRING,BGTMM:STRING,BGTDIV:STRING,BGTDPT:STRING,ATCODE:STRING,"
		                 + "FSREFCD:STRING,SATCODE:STRING,BGTMACT:STRING,CHAAMT:DECIMAL,"
										 + "BBGTYY:STRING,BBGTMM:STRING,BBGTDIV:STRING,BBGTDPT:STRING,BATCODE:STRING,"
		                 + "BFSREFCD:STRING,BSATCODE:STRING,BBGTMACT:STRING,BCHAAMT:DECIMAL,"
										 + "BACTDAT:STRING,"
										 + "FDCODE:STRING,ACTDAT:STRING,COCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSSEQ:STRING, " 
										 + "FSREFCD01:STRING,FSREFCD02:STRING,FSREFCD03:STRING,FSREFCD04:STRING,FSREFCD05:STRING,"
									   + "FSREFCD06:STRING,FSREFCD07:STRING,FSREFCD08:STRING,FSREFCD09:STRING,"
										 + "FSREFVAL01:STRING,FSREFVAL02:STRING,FSREFVAL03:STRING,FSREFVAL04:STRING,FSREFVAL05:STRING,"
										 + "FSREFVAL06:STRING,FSREFVAL07:STRING,FSREFVAL08:STRING,FSREFVAL09:STRING,"
										 + "BFSREFCD01:STRING,BFSREFCD02:STRING,BFSREFCD03:STRING,BFSREFCD04:STRING,BFSREFCD05:STRING,"
									   + "BFSREFCD06:STRING,BFSREFCD07:STRING,BFSREFCD08:STRING,BFSREFCD09:STRING,"
										 + "BFSREFVAL01:STRING,BFSREFVAL02:STRING,BFSREFVAL03:STRING,BFSREFVAL04:STRING,BFSREFVAL05:STRING,"
										 + "BFSREFVAL06:STRING,BFSREFVAL07:STRING,BFSREFVAL08:STRING,BFSREFVAL09:STRING";
    gcds_bgt_update.SetDataHeader(s_fslipdtl10);
	}else if (p1=="BGTDTL_DEL"){
		var s_fslipdtl11 = "BGTYY:STRING,BGTMM:STRING,BGTDIV:STRING,BGTDPT:STRING,ATCODE:STRING,"
		                 + "FSREFCD:STRING,SATCODE:STRING,BGTMACT:STRING,CHAAMT:DECIMAL,"
										 + "FDCODE:STRING,ACTDAT:STRING,COCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSSEQ:STRING," 
										 + "FSREFCD01:STRING,FSREFCD02:STRING,FSREFCD03:STRING,FSREFCD04:STRING,FSREFCD05:STRING,"
									   + "FSREFCD06:STRING,FSREFCD07:STRING,FSREFCD08:STRING,FSREFCD09:STRING,"
										 + "FSREFVAL01:STRING,FSREFVAL02:STRING,FSREFVAL03:STRING,FSREFVAL04:STRING,FSREFVAL05:STRING,"
										 + "FSREFVAL06:STRING,FSREFVAL07:STRING,FSREFVAL08:STRING,FSREFVAL09:STRING"; 
    gcds_bgt_del.SetDataHeader(s_fslipdtl11);
	}else if (p1=="BGTDTL_DEL_ALL"){
		var s_fslipdtl12 = "BGTYY:STRING,BGTMM:STRING,BGTDIV:STRING,BGTDPT:STRING,ATCODE:STRING,"
		                 + "FSREFCD:STRING,SATCODE:STRING,BGTMACT:STRING,CHAAMT:DECIMAL,"
										 + "FDCODE:STRING,ACTDAT:STRING,COCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSSEQ:STRING," 
										 + "FSREFCD01:STRING,FSREFCD02:STRING,FSREFCD03:STRING,FSREFCD04:STRING,FSREFCD05:STRING,"
									   + "FSREFCD06:STRING,FSREFCD07:STRING,FSREFCD08:STRING,FSREFCD09:STRING,"
										 + "FSREFVAL01:STRING,FSREFVAL02:STRING,FSREFVAL03:STRING,FSREFVAL04:STRING,FSREFVAL05:STRING,"
										 + "FSREFVAL06:STRING,FSREFVAL07:STRING,FSREFVAL08:STRING,FSREFVAL09:STRING"; 
    gcds_bgt_del_all.SetDataHeader(s_fslipdtl12);
	}else if (p1=="FSNUM"){
		var s_fslipdtl13 = "FDCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSSEQ:STRING,FSNUM:STRING";
    gcds_fsnum.SetDataHeader(s_fslipdtl13);
	}else if(p1=="BANJAEMST"){
		var s_fslipdtl14 = "FDCODE:STRING,TSDAT:STRING,TSNBR:STRING,TSSEQ:STRING,ATCODE:STRING,"
		                 + "DEPTCD:STRING,VENDCD:STRING,FSREFCD:STRING,FSREFVAL:STRING,DEAMT:DECIMAL,"	
                     + "CRAMT:DECIMAL,STATUS:STRING,SSDAT:STRING,SSNBR:STRING,FSNUM:STRING,"	 
										 + "REMARK:STRING,WRDT:STRING,WRID:STRING,UPDT:STRING,UPID:STRING,AMT:DECIMAL,SEQ:STRING";
    gcds_banjaemst.SetDataHeader(s_fslipdtl14);
	}
}

/******************************************************************************
	Description : 각 obj의 데이타 값을 DataSet에 넣는다.
	              현재까지 생성된 모든 row를 for문으로 돌면서 hid_flag="T"인 건만 실제 
								데이타로 간주하여 DataSet에 저장한다.
								hid_flag0 - 계정코드, 차변,대변,증빙명, 적요
								hid_flag1 - 관리항목(1~3)
                hid_flag2 - 관리항목(4~6)
                hid_flag3 - 관리항목(7~9)
  parameter   : p1 - 현장코드(2자리)      p2 - 접수일자(9자리)
******************************************************************************/
function ln_Data(p1,p2){
/*	alert("maxrow"+g_row);
	for (i=1;i<=g_row;i++){
		if(eval("hid_flag"+i+"0")=="T"){
			gcds_mst.AddRow() 

      gcds_mst.namevalue(gcds_mst.RowPosition,"FDCODE")=p1;
      gcds_mst.namevalue(gcds_mst.RowPosition,"FSDAT")=p2;
      gcds_mst.namevalue(gcds_mst.RowPosition,"FSNBR")="";   //저장시 서블릿에서 생성

      gcds_dtl.AddRow() 
			gcds_dtl.namevalue(gcds_dtl.RowPosition,"FDCODE")=p1;
      gcds_dtl.namevalue(gcds_dtl.RowPosition,"FSDAT")=p2;
      gcds_dtl.namevalue(gcds_dtl.RowPosition,"FSNBR")="";

			if(eval("gcem_chaamt"+i).value!=0){
				gcds_dtl.namevalue(gcds_mst.RowPosition,"FSAMT")=eval("gcem_chaamt"+i).value;
				gcds_dtl.namevalue(gcds_mst.RowPosition,"FSAMT")=eval("gcem_chaamt"+i).value;
			}else if {
				gcds_dtl.namevalue(gcds_mst.RowPosition,"FSAMT")=eval("gcem_daeamt"+i).value;
			}
			eval("txt_atcode"+i).value
			eval("gcem_chaamt"+i).value
			eval("gcem_daeamt"+i).value
			eval("sel_documcd"+i).value
			eval("txt_remark"+i).value 
		}

		if(eval("hid_flag"+i+"1")=="T"){
			
		}

    if(eval("hid_flag"+i+"2")=="T"){
			
		}

    if(eval("hid_flag"+i+"3")=="T"){

		}
	}

*/
}

/******************************************************************************
	Description : 삭제시 현재 Row가 몇번째 Line 인지 확인
	prameter    : 
******************************************************************************/
function ln_Dtl_Count(){


}

/******************************************************************************
	Description : 삭제
	prameter    : p1 - 지점
	              p2 - 접수일자
								p3 - 전표행번호
								p4 - 계정삭제와 DISPLAY만 삭제 구분 '
								p5 - 결재완료 구분
******************************************************************************/
function ln_Delete(p1,p2,p3,p4,p5){
	var chk="false"; //해당 line이 최상위 line인지 체크(false 최상위 line 아님)
	var cnt=0;
	var line_position_1=0; //첫번째 line
	var line_position_2=0; //두번째 line
	var line_cnt=0;

	g_yn=p5; 

  //var ColumnName = gcds_del01.ColumnID(1);
  //ln_SetDataHeader("DTL_DEL");
	for (ii=1;ii<=g_row;ii++){
		if((eval("chkbox"+ii).checked==true) && eval("hid_flag_del"+ii).value=="N" ){ //체크되었을 경우만 모든 항목 삭제가능함.

    /*  gcds_del01.addrow();
			gcds_del01.namevalue(gcds_del01.rowposition,"FDCODE")=p1;
			gcds_del01.namevalue(gcds_del01.rowposition,"FSDAT")=p2;
			gcds_del01.namevalue(gcds_del01.rowposition,"FSNBR")=p3;
			gcds_del01.namevalue(gcds_del01.rowposition,"FSSEQ")=eval("hid_fsseq"+ii).value;

			gctr_data03.Action = g_servlet+"/Account.a020001_t3f?";
				prompt("gcds_del01",gcds_del01.text);
				gctr_data03.post();
				ln_Display(ii);
      */
			//^^alert("ii:::"+ii);
      //^^alert("hid_flag_del;;"+eval("hid_flag_del"+ii).value);
			eval("hid_flag_del"+ii).value="Y";
			//^^alert("hid_flag_del;;"+eval("hid_flag_del"+ii).value);
			//gcds_del01.deleterow(gcds_del01.rowposition);
			ln_Display(ii);         //계정화면만 삭제 
			ln_Banjae_mst_Deleterow(ii); //반제원장과 반제연결전표에서 삭제함.
			ln_onblur('01','','');  //차변대변 금액합계

			//^^alert("bbbbbbhid_flag_del;;"+eval("hid_flag_del"+ii).value);
    }
	 // alert("Start+I::"+ii+"::g_row::"+g_row);
		/*
		if(eval("chkbox"+ii).checked==true) && eval("hid_flag_del"+ii).value=="N" ){ //체크되었을 경우만 모든 항목 삭제가능함.
		  //eval("hid_flag_del"+ii).value=="Y"
			gcds_del01.addrow();
			gcds_del01.namevalue(gcds_del01.rowposition,"FDCODE")=p1;
			gcds_del01.namevalue(gcds_del01.rowposition,"FSDAT")=p2;
			gcds_del01.namevalue(gcds_del01.rowposition,"FSNBR")=p3;
			gcds_del01.namevalue(gcds_del01.rowposition,"FSSEQ")=eval("hid_fsseq"+ii).value;

      alert("p4;;"+p4);
			alert("hid_fsseq;;"+eval("hid_fsseq"+ii).value);
			if(eval("hid_fsseq"+ii).value!="" && p4!="dis"){
				if (confirm("삭제하시겠습니까?")){	
					gctr_data03.Action = g_servlet+"/Account.a020001_t3f?";
					prompt("gcds_del01",gcds_del01.text);
					gctr_data03.post();
					ln_Display(ii);
				}else{
					gcds_del01.deleterow(gcds_del01.rowposition);
				}
				eval("chkbox"+ii).checked=false;
			}else{ //데이타가 없는 경우 화면에서만 삭제
				gcds_del01.deleterow(gcds_del01.rowposition);
				ln_Display(ii);        //계정화면만 삭제 
				ln_onblur('01','','') //차변대변 금액합계
			}
		}
    */
	//	alert("End+I::"+ii+"::g_row::"+g_row);
  }//for
	
	
}


/******************************************************************************
	Description : 행삭제시 . 반제 데이타셋에서 해당 계정삭제.
	prameter    : 
******************************************************************************/
function ln_Banjae_mst_Deleterow(ii){
  
	for(k=1;k<=gcds_banjaemst.countrow;k++){
		if(gcds_banjaemst.namevalue(k,"SEQ")==eval("hid_fsseq"+ii).value){
			gcds_banjaemst.Deleterow(k);
		}
	}

	for(k=1;k<=gcds_banjae.countrow;k++){
		if(gcds_banjae.namevalue(k,"BTSSEQ")==eval("hid_fsseq"+ii).value){
			gcds_banjae.Deleterow(k);
		}
	}
}

/******************************************************************************
	Description : 삭제시 화면상에서 row 숨김.
	prameter    : 
******************************************************************************/
function ln_Display(row){
	var chk="false"; //해당 line이 최상위 line인지 체크(false 최상위 line 아님)
	var cnt=0;
	var line_position_1=0; //첫번째 line
	var line_position_2=0; //두번째 line
	var line_cnt=0;
   
  //alert("g_row::"+g_row);
	//alert("row::"+row);
	//line 을 첫번째 란을 삭제 할 때 구분
	for(k=1;k<=g_row;k++){
	 // alert("hid_flag"+eval("hid_flag"+k+"0").value);
		if(eval("hid_flag"+k+"0").value=="T"){
			cnt+=1;
		}
	}

  for(k=1;k<=g_row;k++){

	  //alert("hid_flag+k"+k+"::::"+eval("hid_flag"+k+"0").value);
		if(eval("hid_flag"+k+"0").value=="T" && line_cnt==0 ){
		  line_cnt = 1;  
			line_position_1=k;
		}else if (eval("hid_flag"+k+"0").value=="T" && line_cnt==1){
			line_position_2=k;
			break;
		}
	}

   //alert("g_position"+g_position);
  //첫 칸 삭제시 Line 도 삭제함...
	if (g_position ==line_position_1){
	  if(line_position_2!=0){
			eval("document.all.l"+line_position_2+".style.display='none';");
		}
	}

  eval("cnt"+row).value=eval("hid_cnt_bf"+row).value;
  //alert("row::"+row+"::cnt::"+eval("cnt"+row).value);
  if((eval("cnt"+row).value==0)){ //20060828 추가
		eval("document.all.t"+row+"0.style.display='none';");
		eval("document.all.t"+row+"1.style.display='none';");
		eval("document.all.t"+row+"2.style.display='none';");
		eval("document.all.t"+row+"3.style.display='none';");
		eval("hid_flag"+row+"0").value ="F";
		eval("hid_flag"+row+"1").value ="F";
		eval("hid_flag"+row+"2").value ="F";
    eval("hid_flag"+row+"3").value ="F";
	}else if((eval("cnt"+row).value<=3)){
		eval("document.all.t"+row+"0.style.display='none';");
		eval("document.all.t"+row+"1.style.display='none';");
    eval("hid_flag"+row+"0").value ="F";
		eval("hid_flag"+row+"1").value ="F";
		//alert(eval("document.all.t"+row+"1.style.display"));
	}else if((eval("cnt"+row).value>=4)&&(eval("cnt"+row).value<=6)){
		eval("document.all.t"+row+"0.style.display='none';");
		eval("document.all.t"+row+"1.style.display='none';");
		eval("document.all.t"+row+"2.style.display='none';");
		eval("hid_flag"+row+"0").value ="F";
		eval("hid_flag"+row+"1").value ="F";
		eval("hid_flag"+row+"2").value ="F";
	}else if((eval("cnt"+row).value>=7)){
		eval("document.all.t"+row+"0.style.display='none';");
		eval("document.all.t"+row+"1.style.display='none';");
		eval("document.all.t"+row+"2.style.display='none';");
		eval("document.all.t"+row+"3.style.display='none';");
		eval("hid_flag"+row+"0").value ="F";
		eval("hid_flag"+row+"1").value ="F";
		eval("hid_flag"+row+"2").value ="F";
    eval("hid_flag"+row+"3").value ="F";
	}

  //alert("row"+row);
	if (row==1) eval("document.all.l"+2+".style.display='none';");	
	else if (chk=="true") eval("document.all.l"+row+".style.display='none';");	
	else eval("document.all.l"+row+".style.display='none';");	
	row=0;

}

/******************************************************************************
	Description : 전체 삭제
	prameter    : p1 - 지점
	              p2 - 접수일자
								p3 - 접수번호
******************************************************************************/
function ln_Delete_All(p1,p2,p3){
  
  if(parent.txt_fsknd02.value>="1"){
		alert("자동기표로 생성된 전표입니다. 삭제할 수 없습니다.");
		return;
	}

	//반제건인경우 삭제 못하게 함.
	if(ln_Banjae_Chk(p1,p2,p3)){
		alert("반제처리 전표는 삭제할 수 없습니다.");
		return;
	}

	ln_SetDataHeader("MST_DEL");
	gcds_del02.addrow();
	gcds_del02.namevalue(gcds_del02.rowposition,"FDCODE")=p1;
	gcds_del02.namevalue(gcds_del02.rowposition,"FSDAT")=p2;
	gcds_del02.namevalue(gcds_del02.rowposition,"FSNBR")=p3;
	
	ln_SetDataHeader("DTL_DEL");
	gcds_del01.addrow();
	gcds_del01.namevalue(gcds_del01.rowposition,"FDCODE")=p1;
	gcds_del01.namevalue(gcds_del01.rowposition,"FSDAT")=p2;
	gcds_del01.namevalue(gcds_del01.rowposition,"FSNBR")=p3;

	if (gcds_del01.IsUpdated && gcds_del02.IsUpdated){
	  ln_Del_All_Bgt_find(p1,p2,p3); //삭제건 중 예산이 존재하는 건 찾기
		if(ln_Tax_Chk(p1,p2,p3)){
			if(confirm("증빙문서가 존재합니다. 삭제하시겠습니까?")){	
				gctr_data02.Action = g_servlet+"/Account.a020001_t2f?";
			  //prompt("gcds_del02",gcds_del02.text);
				//gctr_data02.post();
				parent.ln_Add('02');
			}else{
				gcds_del01.Undo(gcds_del01.rowposition);
				gcds_del02.Undo(gcds_del01.rowposition);
				gcds_bgt_del_all.Undo(gcds_bgt_del_all.rowposition);
				return;
			}
	  }else{
			if (confirm("삭제하시겠습니까?")){	
				gctr_data02.Action = g_servlet+"/Account.a020001_t2f?";
		    //prompt("gcds_del02",gcds_del02.text);
				//prompt("gcds_bgt_del_all",gcds_bgt_del_all.text);
				gctr_data02.post();
				parent.ln_Add('02');
			}else{
				gcds_del01.Undo(gcds_del01.rowposition);
				gcds_del02.Undo(gcds_del01.rowposition);
				gcds_bgt_del_all.Undo(gcds_bgt_del_all.rowposition);
				return;
			}
		}
	}
}


/******************************************************************************
	Description : 반제전표체크 (삭제불가)
	prameter    : p1 - 지점, P2 -전표일자 , P3 -전표번호 
	             
******************************************************************************/
function ln_Banjae_Chk(p1,p2,p3){
		gcds_banjae2.DataID = g_servlet+"/Account.a020001_s13?v_str1="+p1+"&v_str2="+p2+"&v_str3="+p3;	//prompt("",gcds_banjae2.DataID);
	  gcds_banjae2.Reset();

		if (gcds_banjae2.CountRow>0){  
			return true;
		}else{
			return false; 
		}
}

/******************************************************************************
	Description : 세금계산서와 전표 연결체크
	prameter    : p1 - 지점, P2 -전표일자 , P3 -전표번호 
	             
******************************************************************************/
function ln_Tax_Chk(p1,p2,p3){
		gcds_taxcnt.DataID = g_servlet+"/Account.a020001_s14?v_str1="+p1+"&v_str2="+p2+"&v_str3="+p3;	
		gcds_taxcnt.Reset();

		if(gcds_taxcnt.namevalue(gcds_taxcnt.rowposition,"CNT")>0){  
			return true;
		}else{
			return false; 
		}
}
/******************************************************************************
	Description : 취소
******************************************************************************/
function ln_Cancel(){

}

/******************************************************************************
	Description : 출력 - 대체전표
	parameter   : 지점코드, 지점명, 부서명, 접수번호, 회계일자, 작성일자
	수정        : 지점코드, 접수번호
******************************************************************************/
function ln_Print(fdcd01,fsnb04){
	ln_PrtSetDataHeader();
	var sv_cost = "";
	var arrfsnb = new Array();
  arrfsnb = fsnb04.split("-");
	ln_PrintQuery(fdcd01,arrfsnb[0],arrfsnb[1]);	//대체전표 REPORT조회
}

/******************************************************************************
	Description : 조회 - 출력(head)
  Parameter   : p1-fdcode, p2-fsdat, p3-fsnbr 
******************************************************************************/
function ln_PrintQuery(p1,p2,p3){
	gcds_prttemp1.DataID = "/services/servlet/Account.a020001_s15?v_str1="+p1+"&v_str2="+p2+"&v_str3="+p3;
	//prompt("",gcds_prttemp1.DataID);
	gcds_prttemp1.Reset();
}

/******************************************************************************
	Description : 조회 - 출력(detail)
  Parameter   : p1-fdcode, p2-fsdat, p3-fsnbr 
******************************************************************************/
function ln_PrintSubQuery(){

	/*==========================================================================*/
	var fdcd01 = parent.gclx_fdcode02.bindcolval;														//지점코드
	var fsnb04 = parent.gcem_fs02.text+parent.gcem_fsdat02.text+"-"+parent.gcem_fsnbr02.text;	//접수번호
	var arrfsnb = new Array();
  arrfsnb = fsnb04.split("-");
	/*==========================================================================*/
	gcds_prttemp2.DataID = "/services/servlet/Account.a020001_s16?v_str1="+fdcd01+"&v_str2="+arrfsnb[0]+"&v_str3="+arrfsnb[1];
	//prompt("",gcds_prttemp2.DataID);
	gcds_prttemp2.Reset(); 

  /*
	if(gcds_prttemp2.countrow<1) {
		alert("출력할 정보가 없습니다.");
	}else{
    
		var cnt = gcds_prttemp2.countrow;
		for(i=1;i<=gcds_prttemp2.countrow;i++){

			gcds_print.ImportData(gcds_prttemp2.ExportData(i,1,false));
			gcds_print.namevalue(1,"DATA01") = "회 계 단 위 : "+fdcd01+" "+fdcd02+"지점";	//지점
			gcds_print.namevalue(1,"DATA02") = "집 행 부 서 : "+dept03;										//부서
			
			if (gcds_prttemp1.namevalue(1,"COST") != null && gcds_prttemp1.namevalue(1,"COST") != "" ) {
				sv_cost = gcds_prttemp1.namevalue(1,"COST");
			}else{
				sv_cost = gcds_prttemp1.namevalue(1,"DEPTNM3");
			}
			
			var s_ssnbr = gcds_print.namevalue(1,"SSNBR");
			gcds_print.namevalue(1,"DATA03") = "부서명/사업명 : "+sv_cost;	//부서/사업명
			gcds_print.namevalue(1,"DATA04") = s_ssnbr;		//전표번호
			gcds_print.namevalue(1,"DATA05") = "입 력 일 자 : "+fsnb04.substring(1,16);		//입력일자
			
			if(gcds_print.namevalue(1,"FSSTAT") == 'Y'){	//전표완료
				gcds_print.namevalue(1,"CURDT")	 = cudt05;	//회계일자
			}else{
				gcds_print.namevalue(1,"CURDT")	 = "        ";	//회계일자
			}
			gcds_print.namevalue(1,"CURDT2") = gs_date;		//작성일자
		}

		for(i=1;i<=gcds_print.countrow;i++){
			var s_leng1 = gcds_print.namevalue(i,"FOCHAAMT").length;
			var s_leng2 = gcds_print.namevalue(i,"FODAEAMT").length;
			if(s_leng1>0){
				gcds_print.namevalue(i,"FOCHAAMT")= gcds_prttemp2.namevalue(i,"FOCHAAMT").substring(0,1)
																					+ gf_setnum2(gcds_prttemp2.namevalue(i,"FOCHAAMT").substring(1,s_leng1));
			}else if(s_leng2>0){
				gcds_print.namevalue(i,"FODAEAMT")= gcds_prttemp2.namevalue(i,"FODAEAMT").substring(0,1)
																					+ gf_setnum2(gcds_prttemp2.namevalue(i,"FODAEAMT").substring(1,s_leng2));
			}
		}

		if(fdcd01!="03"){
			gcds_print.namevalue(1,"CHASUM") = "￦"+gf_setnum2(gcds_prttemp2.Sum(10,0,cnt));
			gcds_print.namevalue(1,"DAESUM") = "￦"+gf_setnum2(gcds_prttemp2.Sum(11,0,cnt));
		}else{
			gcds_print.namevalue(1,"CHASUM") = "＄"+gf_setnum2(gcds_prttemp2.Sum(10,0,cnt));
			gcds_print.namevalue(1,"DAESUM") = "＄"+gf_setnum2(gcds_prttemp2.Sum(11,0,cnt));
		}	
		gcrp_print.preview();
	}
	*/
}


function ln_PrintSubQuery2(){
  /*==========================================================================*/
	var fdcd01 = parent.gclx_fdcode02.bindcolval;														//지점코드
	var fdcd02 = parent.gclx_fdcode02.text;																	//지점명
	var dept03 = fn_trim(parent.txt_deptnm02.value);													//부서
	var fsnb04 = parent.gcem_fs02.text+parent.gcem_fsdat02.text+"-"+parent.gcem_fsnbr02.text;	//접수번호
	var arrfsnb = new Array();
  arrfsnb = fsnb04.split("-");

	if(parent.gcds_data01_2.namevalue(1,"ACTDAT")==undefined){
		var cudt05 = parent.gcds_data01_1.namevalue(1,"ACTDAT");									//회계일자
	}else{
		var cudt05 = parent.gcds_data01_2.namevalue(1,"ACTDAT");									//회계일자
	}

	if (parent.gcds_data01_2.namevalue(1,"ACTDAT")==undefined){
		var cudt06 = parent.gcds_data01_1.namevalue(1,"FSWRTDAT");								//작성일자
	}else{
		var cudt06 = parent.gcds_data01_2.namevalue(1,"FSWRTDAT");								//작성일자
	}
	  /*==========================================================================*/
  //alert("출력0");
	var cnt = gcds_prttemp2.countrow;
	for(i=1;i<=gcds_prttemp2.countrow;i++){

		gcds_print.ImportData(gcds_prttemp2.ExportData(i,1,false));
		gcds_print.namevalue(1,"DATA01") = "회 계 단 위 : "+fdcd01+" "+fdcd02+"지점";	//지점
		gcds_print.namevalue(1,"DATA02") = "집 행 부 서 : "+dept03;										//부서
		
		if (gcds_prttemp1.namevalue(1,"COST") != null && gcds_prttemp1.namevalue(1,"COST") != "" ) {
			sv_cost = gcds_prttemp1.namevalue(1,"COST");
		}else{
			sv_cost = gcds_prttemp1.namevalue(1,"DEPTNM3");
		}
		
		var s_ssnbr = gcds_print.namevalue(1,"SSNBR");
		gcds_print.namevalue(1,"DATA03") = "부서명/사업명 : "+sv_cost;	//부서/사업명
		gcds_print.namevalue(1,"DATA04") = s_ssnbr;		//전표번호
		gcds_print.namevalue(1,"DATA05") = "입 력 일 자 : "+fsnb04.substring(1,16);		//입력일자
		
		if(gcds_print.namevalue(1,"FSSTAT") == 'Y'){	//전표완료
			gcds_print.namevalue(1,"CURDT")	 = cudt05;	//회계일자
		}else{
			gcds_print.namevalue(1,"CURDT")	 = "        ";	//회계일자
		}
		gcds_print.namevalue(1,"CURDT2") = gs_date;		//작성일자
	}

  //alert("출력1");
	for(j=1;j<=gcds_print.countrow;j++){
		var s_leng1 = gcds_print.namevalue(j,"FOCHAAMT").length;
		var s_leng2 = gcds_print.namevalue(j,"FODAEAMT").length;
    
		//alert(":"+gcds_print.namevalue(j,"FODAEAMT")+":");
		//alert("s_leng1:;"+s_leng1);
		//alert("s_leng2:;"+s_leng2);

		if(s_leng1>0){
			gcds_print.namevalue(i,"FOCHAAMT")= gcds_prttemp2.namevalue(j,"FOCHAAMT").substring(0,1)
																				+ gf_setnum2(gcds_prttemp2.namevalue(j,"FOCHAAMT").substring(1,s_leng1));
		}else if(s_leng2>0){
			gcds_print.namevalue(i,"FODAEAMT")= gcds_prttemp2.namevalue(j,"FODAEAMT").substring(0,1)
																				+ gf_setnum2(gcds_prttemp2.namevalue(j,"FODAEAMT").substring(1,s_leng2));
		}
	}

  //alert("출력2");
	if(fdcd01!="03"){
		gcds_print.namevalue(1,"CHASUM") = "￦"+gf_setnum2(gcds_prttemp2.Sum(10,0,cnt));
		gcds_print.namevalue(1,"DAESUM") = "￦"+gf_setnum2(gcds_prttemp2.Sum(11,0,cnt));
	}else{
		gcds_print.namevalue(1,"CHASUM") = "＄"+gf_setnum2(gcds_prttemp2.Sum(10,0,cnt));
		gcds_print.namevalue(1,"DAESUM") = "＄"+gf_setnum2(gcds_prttemp2.Sum(11,0,cnt));
	}	

	//alert("출력");
	gcrp_print.preview();

}
/******************************************************************************
	Description : Report Head 설정
******************************************************************************/
function ln_PrtSetDataHeader(){
	var s_temp = "FDCODE:STRING,FSDAT:STRING,FSNBR:STRING,FSSEQ:STRING,ATCODE:STRING,"
						 + "ATKORNAM:STRING,ATDECR:STRING,REMARK:STRING,CURAMT:STRING,CHAAMT:DECIMAL,"
						 + "DAEAMT:DECIMAL,FOCHAAMT:STRING,FODAEAMT:STRING,FSRVALNM011:STRING,FSRVALNM012:STRING,"
						 + "FSRVALNM013:STRING,FSRVALNM014:STRING,DETITLE:STRING,CURRENCY:STRING,"
						 + "COST:STRING,FSSTAT:STRING,SSNBR:STRING,DOCUVAL:STRING,CURDT:STRING,CURDT2:STRING,PTITLE:STRING,"
						 + "DATA01:STRING,DATA02:STRING,DATA03:STRING,DATA04:STRING,DATA05:STRING,"
						 + "CHASUM:STRING,DAESUM:STRING";
	gcds_print.SetDataHeader(s_temp);
}

/******************************************************************************
	Description : 엑셀
******************************************************************************/
function ln_Excel(){

}

/******************************************************************************
	Description : FILE 
******************************************************************************/
function ln_File(){

}

/******************************************************************************
	Description : 체 크
  추      가  : 저장시   
******************************************************************************/
function ln_Chk(){
//  alert("g_taxval"+g_taxval+"parent.gcem_detot02.text"+parent.gcem_detot02.text);
  var tempnm ="";
	var tempchk="chk";
	var no1="";
	var no2="";
	var stryymmdd="";
  var stryyyy = "";
	var strmm = "";
	var	strbgtdept= "";
	var	strbgtdiv ="";
	var	stratcode ="";
	var dblamt=0;
	var strBanjaechk="";

	stryymmdd = parent.gcem_actdat02.text;

  //마감체크
	if(gf_Dept_Enable(gs_deptcd,gcds_dept2)){ // 회계부서 전표마감 체크
		 ln_Slip_Close_Query();
		 if(gcds_slip_close.namevalue(gcds_slip_close.rowposition,"SLPCLOSE")=="T"){
				alert("전표 입력이 마감되었습니다. 확인 바랍니다.")
				return;
		 }
	}else{                                    // 현업전표마감 체크
		 ln_Slip_Close_Query();
		 if(gcds_slip_close.namevalue(gcds_slip_close.rowposition,"WORKCLOSE")=="T"){
				alert("현업 전표 입력이 마감되었습니다. 확인 바랍니다.")
				return;
		 }
	}
	
	if(gcds_tax.countrow>0){
		if(g_taxval!=parent.gcem_detot02.text){
			alert("세금계산서금액과 전표금액이 일치하지 않습니다.");
		}
	}

  //순번 체크
	for (t=1;t<=g_row;t++){
		if(eval("hid_flag_del"+t).value!="Y"){ //삭제가 아닌경우
			for(s=t+1;s<=g_row;s++){
			 if(eval("hid_flag_del"+s).value!="Y"){ //삭제가 아닌경우
			   //alert("t:"+t+":"+eval("txt_fsnum"+t).value +":::::"+"s:"+s+":"+eval("txt_fsnum"+s).value+":g_row:"+g_row);
				 if(eval("txt_fsnum"+t).value == eval("txt_fsnum"+s).value){
					alert("순번이 동일합니다. 확인하십시요.");
					return false;
					break;
				 }
				}
			}// for s
		}
	}//for t

  //금액 및 계정, 관리항목 체크, 증빙체크 , 반제체크, 적요체크
	for(i=1;i<=g_row;i++){
	  //alert("i::"+i);
		//alert("gcem_chaamt::"+eval("gcem_chaamt"+i).text+"gcem_daeamt"+eval("gcem_daeamt"+i).text);
		if(eval("hid_flag"+i+"0").value=="T"){
      if(eval("txt_atcode"+i).value!=""&&eval("txt_atkornam"+i).value!=""){  //계정과목이 존재하는 경우
				if((eval("gcem_chaamt"+i).text==0)&&(eval("gcem_daeamt"+i).text==0)){
					alert("금액을 입력하십시요");
					eval("gcem_chaamt"+i).focus();
					return false
					break;
				}

				if((eval("gcem_chaamt"+i).text!=0)&&(eval("gcem_daeamt"+i).text!=0)){
					alert("차변금액과 대변금액을 확인 하십시요");
					eval("gcem_chaamt"+i).focus();
					return false
					break;
				}

				//증빙이 세금계산서/계산서/신용카드 공제일 경우 증빙번호가 존재하지 않는 경우 저장 안됨
				if(eval("sel_documcd"+i).value=="101"||eval("sel_documcd"+i).value=="102"||eval("sel_documcd"+i).value=="103"){
					if(eval("hid_docuval"+i).value==""){
						alert("증빙번호가 없습니다. 확인하십시요");
						return false
						break;
					}
				}

        //적요
				if((eval("txt_remark"+i).value=="")){
					alert("적요을 입력하십시요");
					eval("txt_remark"+i).focus();
					return false
					break;
				}


			}else{ 
				
				//계정과목만 없는 경우........
				if(eval("gcem_chaamt"+i).text==0&&eval("gcem_daeamt"+i).text==0){
				}else{
					//계정과목과 금액 및 부서 등이 없는 경우                         
					alert("계정과목을 선택하십시요");
					eval("txt_atkornam"+i).focus();
					return false
					break;
				}
			}

     //관리항목 체크
     for(j=1;j<=3;j++){
				for(k=1;k<=3;k++){
				  //^^alert("i::"+i+"::j::"+j+":k:"+k+"::hid_arbaldiv::"+eval("hid_arbaldiv"+i+j+k).value+":txt_fsrefval:"+eval("txt_fsrefval"+i+j+k).value+":txt_fsrvalnm:"+eval("txt_fsrvalnm"+i+j+k).value);
					if(eval("hid_arbaldiv"+i+j+k).value=="N"&&(eval("txt_fsrefval"+i+j+k).value==""||eval("txt_fsrvalnm"+i+j+k).value=="")){
						tempnm = eval("txt_fsrefnm"+i+j+k).value;
						alert("관리항목 "+tempnm+"는 필수항목입니다.");
						eval("txt_fsrvalnm"+i+j+k).focus(); 
						return false;
						break;
					}
				} //for k
			}//for j

			no1= ln_Bgt_position_find(i);  //예산부서찾기
			if((no1!=""&&no1!=undefined)){ //예산부서가 존재할 경우
				if(eval("sel_fswrkdiv"+i).value!="02"){
				  if(eval("txt_fsrefval"+no1).value==""){
						alert("예산부서가 존재합니다. 예산타입을 확인하십시요");
						return false;
						break;
					}
				}
			}else{
				if(eval("sel_fswrkdiv"+i).value=="02"){
					alert("예산부서가 존재하지 않습니다. 예산타입을 확인하십시요");
					return false;
					break;
				}
			}

      //조회 후 수정 및 삭제없이 저장 할 경우 msgbox 띄움 
			//alert("i"+i+"::hid_flag_sel"+eval("hid_flag_sel"+i+"0").value);
			//
			
			//alert("hid_flag_sel"+eval("hid_flag_sel"+i+"0").value);
			if(eval("hid_flag_sel"+i+"0").value=="S"){
				if(eval("chkbox"+i).checked==false){
				}else{
					 tempchk="";
				}
			}else{
       tempchk="";
			}

			//예산적용일 경우 예산 잔액과 현재 금액을 비교함.
			//alert("i::"+i+"sel_fswrkdiv:::::::"+eval("sel_fswrkdiv"+i).value);
			if(eval("sel_fswrkdiv"+i).value=="02"){
				//예산부서가 예산관리항목인 경우 세목은 00로 설정
				no2 = ln_Bgt_Detail_find(i);//세목찾기 
				if((no2!=""&&no2!=undefined)){ //예산부서가 존재할 경우
					if(eval("txt_fsrefcd"+no2).value=="0003"){
						strrefcd=fn_trim(eval("txt_fsrefcd"+no2).value);  
						strrefval="00";//세목	
					}else{
						strrefcd=fn_trim(eval("txt_fsrefcd"+no2).value);  
						strrefval=eval("txt_fsrefval"+no2).value;	 //세목  
					}
				}else{
          strrefcd="";
					strrefval="";
				}

				strmm = fn_trim(stryymmdd.substring(4,6));
				stryyyy = fn_trim(stryymmdd.substring(0,4));
				strbgtdept= fn_trim(eval("txt_fsrefval"+no1).value); //예산부서
				strbgtdiv = fn_trim(eval("hid_bgtdiv"+i).value);
				stratcode = fn_trim(eval("txt_atcode"+i).value);
        dblamt = Number(eval("gcem_chaamt"+i).text)+Number(eval("gcem_daeamt"+i).text); 
				ln_Bgt_Query(stryyyy,strbgtdiv,strbgtdept,stratcode,strrefcd,strrefval,strmm,'02',i);
				
				if(gcds_bgt.countrow>=1){  //
				  //alert("JANAMT::"+gcds_bgt.namevalue(gcds_bgt.rowposition,"JANAMT"));
					if(gcds_bgt.namevalue(gcds_bgt.rowposition,"JANAMT")< dblamt){
						alert("예산잔액이 더 작습니다. 확인 바랍니다.");
						return false;
					}
				}else{
					alert("순번 "+eval("txt_fsnum"+i).value+" 번 예산이 존재하지 않습니다. 확인 바랍니다.");	
					return false;
				}
			}


			//반제데이타 체크(반제계정이면서,
			if(eval("hid_atdebtyn"+i).value=="Y"){ //반제
				if(eval("hid_atdecr"+i).value=="1"){ //차변
					if(eval("gcem_daeamt"+i).text!=0&&eval("gcem_daeamt"+i).text!=""){
					  //반제 연결에 순번이 존재하지 않으면
						for(b=1;b<=gcds_banjae.countrow;b++){
							if(eval("hid_fsseq"+i).value==gcds_banjae.namevalue(b,"BTSSEQ")){
								strBanjaechk="T";
								break;
							}
						}

            if(strBanjaechk!="T"){
							alert("순번 "+eval("txt_fsnum"+i).value+" 번 은 반제계정입니다. 확인 바랍니다.");	
							return false;
						}else{
              strBanjaechk="";
						}
					}
				}else if(eval("hid_atdecr"+i).value=="2"){
					if(eval("gcem_chaamt"+i).text!=0&&eval("gcem_chaamt"+i).text!=""){
						//반제 연결에 순번이 존재하지 않으면
						for(b=1;b<=gcds_banjae.countrow;b++){
							if(eval("hid_fsseq"+i).value==gcds_banjae.namevalue(b,"BTSSEQ")){
								strBanjaechk="T";
								break;
							}
						}

            if(strBanjaechk!="T"){
							alert("순번 "+eval("txt_fsnum"+i).value+" 번 은 반제계정입니다. 확인 바랍니다.");	
							return false;
						}else{
              strBanjaechk="";
						}
					}
				}
			}

		}else //if eval("hid_flag"+i+"0").value=="F"
			//	alert("i"+i+"::hid_flag_sel"+eval("hid_flag_sel"+i+"0").value);
			//
			//alert("hid_flag_sel"+eval("hid_flag_sel"+i+"0").value);
			if(eval("hid_flag_sel"+i+"0").value=="S"){
				if(eval("chkbox"+i).checked==false){
				}else{
					 tempchk="";
				}
			}else{
       tempchk="";
			}

	}//for i

	if(tempchk=="chk"){
		alert("저장할 내용이 없습니다.")
		return false;
	}
	return true;
}

/******************************************************************************
	Description : 팝업시 체크
******************************************************************************/
function ln_Chk_Popup(p1,p2,p3,p4,p5){

	//받을어음 & 차변<>0 & 대변 = 0 (발생 ==> 입력)
	//어음번호, 어음 만기일, 어음 발생일은 입력해야함. 팝업없음. 
	//alert("p1:;"+p1);
	//alert(eval("txt_fsrefcd"+p3+p4).value);
  if(eval("hid_funddiv"+p5).value=="50"&& eval("gcem_chaamt"+p5).text!=0 && eval("gcem_daeamt"+p5).text==0){
	  if(eval("txt_fsrefcd"+p3+p4).value=="0967"||eval("txt_fsrefcd"+p3+p4).value=="0968"||eval("txt_fsrefcd"+p3+p4).value=="0969"){
      return false;
		}
	}else{
	}

	//관리항목코드가 없는 경우 return
  if(eval("txt_fsrefcd"+p3+p4).value=="") return false;
	if(eval(p1).value=="0967"&&eval("gcem_chaamt"+p5).text==0 && eval("gcem_daeamt"+p5).text==0){
		alert("금액을 먼저 입력하십시요.");
		return false;
	}
	
	return true;
}

/******************************************************************************
	Description : 반제 사용시 체크
	prameter : 
******************************************************************************/
function ln_Chk_Repay(){
	var cnt=0;
	var gubun="";
	//alert("g_row::"+g_row);
	//체크박스 멀티 체크 - 하나만 사용함.
	for (i=1;i<=g_row;i++){
	  //alert("i::"+i+"hid_flag"+eval("hid_flag"+i+"0").value);
		if(eval("chkbox"+i).checked==true && eval("hid_flag"+i+"0").value=="T") cnt+=1;
	}

  //alert("cnt::"+cnt);
	if(cnt>=2) {
		alert("반제는 하나의 계정만 선택 가능합니다.");
		return false;
  }else if(cnt==0){
		alert("반제 하실 계정을 선택하십시요.");
		return false;
	}

  //alert("chk");
	//반제계정 체크 - 반제 계정만 가능함. && 거래처 && 차변대변금액 0 체크
	for (i=1;i<=g_row;i++){
		if(eval("chkbox"+i).checked==true&&eval("hid_flag"+i+"0").value=="T"){
			//alert("hid_atdebtyn::"+eval("hid_atdebtyn"+i).value);
			if(eval("txt_atcode"+i).value==""||eval("txt_atkornam"+i).value==""){
				alert("계정이 존재하지 않습니다.");
				return false;
			}
			
			if(eval("hid_atdebtyn"+i).value!="Y"){
				//반제계정 재확인
				if(!ln_banjae_atcode_find(i)){
					alert("반제 가능한 계정이 아닙니다.");
					return false;
				}
			}
			
			/*****의미없음***************
			//차변대변 금액
      //alert(eval("gcem_chaamt"+i).text);
			//alert(eval("gcem_daeamt"+i).text);
			if(eval("gcem_chaamt"+i).text!=0 || eval("gcem_daeamt"+i).text!=0) { 
				alert("차변과 대변의 금액은 0이 되어야 합니다.");
				return false;
			}
			*****************************/
      if(eval("hid_atdecr"+i).value=="1"){  //차변
				if(eval("gcem_chaamt"+i).text!=0){
					alert("현재 계정은 반제시 차변금액 불가입니다.");
					return false;
				}
			}else if(eval("hid_atdecr"+i).value=="2"){  //대변
				if(eval("gcem_daeamt"+i).text!=0){
					alert("현재 계정은 반제시 대변금액 불가입니다.");
					return false;
				} 
			}else{
			  if(ln_banjae_atcode_find(i)){
					if(gcds_banjae_atcode.namevalue(gcds_banjae_atcode.rowposition,"ATDECR")=="1"){
						if(eval("gcem_chaamt"+i).text!=0){
							alert("현재 계정은 반제시 차변금액 불가입니다.");
							return false;
						}
					}else if(gcds_banjae_atcode.namevalue(gcds_banjae_atcode.rowposition,"ATDECR")=="2"){
						if(eval("gcem_daeamt"+i).text!=0){
							alert("현재 계정은 반제시 대변금액 불가입니다.");
							return false;
						} 
					}
				}
			}



			//거래처 확인
			_out:
			for (j=1;j<=3;j++){
				for(k=1;k<=3;k++) {
				  //alert("i::"+i+"::j::"+j+"::k::"+k);
				  //alert("txt_fsrefcd::"+eval("txt_fsrefcd"+i+j+k).value);
					//alert("txt_fsrefval:"+eval("txt_fsrefval"+i+j+k).value);
					if(eval("txt_fsrefcd"+i+j+k).value=="0020"){
						 if(eval("txt_fsrefval"+i+j+k).value==""){
								alert("거래처가 필요합니다.");
								return false;
								break _out;
						 }
             gubun="0020";
					}
				}//k
			}//j
		}//if
		if (gubun=="0020") break;
	}//i
	return true; 
}

/******************************************************************************
	Description : 반제계정확인
******************************************************************************/
function ln_banjae_atcode_find(i){
		gcds_banjae_atcode.DataID = g_servlet+"/Account.a020001_s21?v_str1="+eval("txt_atcode"+i).value;																						
		gcds_banjae_atcode.Reset();
		//alert(""+gcds_banjae_atcode.namevalue(gcds_banjae_atcode.rowposition,"ATDEBTYN"));
    if(gcds_banjae_atcode.namevalue(gcds_banjae_atcode.rowposition,"ATDEBTYN")=="Y"){
			return true;  //반제계정
		}else{
			return false;
		}
}

/******************************************************************************
	Description : 라인색깔
******************************************************************************/
function ln_bgcolor(row){
  var cnt =0;
	for (i=1; i<=row; i++){
	//	if(eval("hid_flag"+i).value=="T"){
	//		cnt = cnt+1;
	//	}
	}
	//alert("cnt"+cnt);
	cnt=cnt%2
	//alert("cnt2"+cnt);
  return cnt ; 
}

/******************************************************************************
	Description : 체크
******************************************************************************/
function Select_onclick(i){
 	//alert("II"+i);
 // var strtemp = 	eval("sel_documcd"+i).value;
 // alert("strtemp" + sel_documcd1.value);
 ln_position(i)

}

/******************************************************************************
	Description : 전표 Detail Record 갯수 
******************************************************************************/
function ln_row_Cnt(p,i){

	if (p=='01'){
		g_row = g_row +i;		
	
	}else{
		g_row=0;
	}
	// 	alert("g_row::"+g_row);
	return g_row;

}


/******************************************************************************
	Description : 
******************************************************************************/
function ln_Read(i,gubun){

	if(gubun=="false"){
	  //alert("txt_atcode"+i+"::"+ eval("txt_atcode"+i).readOnly);
		//alert("txt_atkornam"+i+"::"+ eval("txt_atkornam"+i).readOnly);
		//alert("gcem_daeamt"+i+"::"+ eval("gcem_daeamt"+i).readOnly);
		eval("txt_atcode"+i).readOnly = false;
		eval("txt_atkornam"+i).readOnly = false;
		eval("gcem_chaamt"+i).readOnly = false;
		eval("gcem_daeamt"+i).readOnly = false;

    //증빙인 존재할 경우 수정 못함. 20060306
    if(eval("sel_documcd"+i).value=="000"){
      eval("sel_documcd"+i).disabled = false; 
		}

		eval("txt_remark"+i).readOnly = false;
		eval("sel_fswrkdiv"+i).disabled = true;
		
		for (j=1;j<=3;j++){
			eval("txt_fsrefseq"+i+j+"1").readOnly = false;
			eval("txt_fsrefcd"+i+j+"1").readOnly= false;
			//eval("txt_fsrefnm"+i+j+"1").readOnly= false;
      eval("txt_fsrefval"+i+j+"1").readOnly= false;
			eval("txt_fsrvalnm"+i+j+"1").readOnly= false;

			eval("txt_fsrefseq"+i+j+"2").readOnly = false;
			eval("txt_fsrefcd"+i+j+"2").readOnly= false;
			//eval("txt_fsrefnm"+i+j+"2").readOnly= false;
			eval("txt_fsrefval"+i+j+"2").readOnly= false;
			eval("txt_fsrvalnm"+i+j+"2").readOnly= false;

			eval("txt_fsrefseq"+i+j+"3").readOnly = false;
			eval("txt_fsrefcd"+i+j+"3").readOnly= false;
			//eval("txt_fsrefnm"+i+j+"3").readOnly= false;
			eval("txt_fsrefval"+i+j+"3").readOnly= false;
			eval("txt_fsrvalnm"+i+j+"3").readOnly= false;
		}
		
	}else if(gubun=="true"){
		eval("txt_atcode"+i).readOnly = true;
		eval("txt_atkornam"+i).readOnly = true;
		eval("gcem_chaamt"+i).readOnly = true;
		eval("gcem_daeamt"+i).readOnly = true;
    eval("sel_documcd"+i).disabled = true; 
		eval("txt_remark"+i).readOnly = true;
		eval("sel_fswrkdiv"+i).disabled = true;
		
		for (j=1;j<=3;j++){
			eval("txt_fsrefseq"+i+j+"1").readOnly = true;
			eval("txt_fsrefcd"+i+j+"1").readOnly= true;
			//eval("txt_fsrefnm"+i+j+"1").readOnly= true;
      eval("txt_fsrefval"+i+j+"1").readOnly= true;
			eval("txt_fsrvalnm"+i+j+"1").readOnly= true;

			eval("txt_fsrefseq"+i+j+"2").readOnly = true;
			eval("txt_fsrefcd"+i+j+"2").readOnly= true;
			//eval("txt_fsrefnm"+i+j+"2").readOnly= true;
			eval("txt_fsrefval"+i+j+"2").readOnly= true;
			eval("txt_fsrvalnm"+i+j+"2").readOnly= true;

			eval("txt_fsrefseq"+i+j+"3").readOnly = true;
			eval("txt_fsrefcd"+i+j+"3").readOnly= true;
			//eval("txt_fsrefnm"+i+j+"3").readOnly= true;
			eval("txt_fsrefval"+i+j+"3").readOnly= true;
			eval("txt_fsrvalnm"+i+j+"3").readOnly= true;
		}
	}
}



/******************************************************************************
	Description : 자동기표의 경우 체크박스 막음.
	              
******************************************************************************/
function ln_Read2(){
  
//	alert("g_row::"+g_row);
	for (i=1;i<=g_row;i++){
//		alert("i::"+i);
		eval("chkbox"+i).disabled=true;
	}
}

/******************************************************************************
	Description : 관리항목 Clear
	parameter   : i - 위치, 
******************************************************************************/
function ln_Ref_DataClear(i){
	for (j=1;j<=3;j++){
			eval("txt_fsrefseq"+i+j+"1").value = "";
			eval("txt_fsrefcd"+i+j+"1").value = "";
			eval("txt_fsrefnm"+i+j+"1").value = "";
      eval("txt_fsrefval"+i+j+"1").value = "";
			eval("txt_fsrvalnm"+i+j+"1").value = "";

			eval("txt_fsrefseq"+i+j+"2").value = "";	
			eval("txt_fsrefcd"+i+j+"2").value = "";
			eval("txt_fsrefnm"+i+j+"2").value = "";
			eval("txt_fsrefval"+i+j+"2").value = "";
			eval("txt_fsrvalnm"+i+j+"2").value = "";

			eval("txt_fsrefseq"+i+j+"3").value = "";
			eval("txt_fsrefcd"+i+j+"3").value = "";
			eval("txt_fsrefnm"+i+j+"3").value = "";
			eval("txt_fsrefval"+i+j+"3").value = "";
			eval("txt_fsrvalnm"+i+j+"3").value = "";

      //type구분
			eval("hid_type"+i+j+"1").value="";
			eval("hid_type"+i+j+"2").value="";
			eval("hid_type"+i+j+"3").value="";
      
			//필수항목 구분
			eval("hid_arbaldiv"+i+j+"1").value="";
			eval("hid_arbaldiv"+i+j+"2").value="";
			eval("hid_arbaldiv"+i+j+"3").value="";
	}
	
}

/******************************************************************************
	Description : 레코드 위치 저장
	parameter   : i - 위치, 
	          gubun - 계정코드 선택(계정코드 선택 시 해당 row의 
						                      hid_flag를 Update로 변경하고 하고 모든 항목 활성화 시킴)
******************************************************************************/
function ln_position(i,gubun){
  
  //alert("position::"+i + "::g_yn::" +g_yn+ "::gubun::" +gubun );
	//alert("chkbox"+eval("chkbox"+i).checked );
	//alert(""+parent.txt_fsknd02.value);
	var strPopGubun="";//자금관련구분
	var strPo="";      //관리항목 위치.
  g_position = i
	if(gubun=="chk"){
		if(g_yn=="N"||g_yn=="B"){   //전표상태확인 - 대기 또는 반송
			if (eval("chkbox"+i).checked==true){ //체크되었을 경우만 모든 항목 수정가능함.
				//자동전표기표의 경우는 수정불가 
				if(parent.txt_fsknd02.value>="1"){
					alert(" 자동기표로 생성된 전표입니다. 수정할 수 없습니다.")
					eval("chkbox"+i).checked=false;
					return;
				}
				
				if(eval("hid_flag_sel"+i+"0").value=="S"&&(eval("sel_documcd"+i).value=="101"&&eval("sel_documcd"+i).value=="102"&&eval("sel_documcd"+i).value=="103")){
					alert("해당 계정은 수정할 수 없습니다.");
          eval("chkbox"+i).checked=false;
					return;
				}

				ln_Read(i,"false");
				
				if(eval("hid_bgtcnt"+i).value!=0){ 
					var strpo="", str1="", str2="", str3="";
					strpo=ln_Bgt_Detail_find(i);
					
				//	alert("strpo::"+strpo);

					//세목이 존재할 경우
					if(strpo!=""&&strpo!=undefined){
						str1 = strpo.substring(0,2);
						str2 = strpo.substring(2,3);
						str3 = strpo.substring(0,1);
						ln_Bgt_Amt_find('',str1,str2,str3);  //예산잔액 조회
					}else{
						ln_Bgt_Amt_Clear();
					}
				}else if(eval("hid_bgtcmtype"+i).value!=""&&eval("hid_bgtcnt"+i).value==0){
					ln_Bgt_Amt_Clear();
				}

				///////////////////////////////////////////////////////////////////////////
				//자금관련 수정 체크시 lock 작용함.
				strPopGubun = ln_PopGubun('2','',i);
				if(strPopGubun=="1"){
					strPo = ln_Ref_position_find(i,"0022");
					ln_Ref_lock(strPo,'1');
				}else if(strPopGubun=="2"){
					strPo = ln_Ref_position_find(i,"0020");
					ln_Ref_lock(strPo,'2');
					strPo = ln_Ref_position_find(i,"0022");
					ln_Ref_lock(strPo,'2');
					strPo = ln_Ref_position_find(i,"0968");
					ln_Ref_lock(strPo,'2');
					strPo = ln_Ref_position_find(i,"0969");
					ln_Ref_lock(strPo,'2');

					ln_Ref_lock(strPo,'3',i); //금액 lock
				}
				//////////////////////////////////////////////////////////////////////////
      }else{
        ln_Read(i,"true");
				ln_Bgt_Amt_Clear();
			}
		}else{
		  if (eval("chkbox"+i).checked==true){
				alert("전표상태가 수정가능건이 아닙니다.");
				eval("chkbox"+i).checked=false;
			}
		}
	}else if(gubun=="ATCODE"){ 

	}
}

/******************************************************************************
	Description : 증명내용코드 확인
	              gubun - FSWRKDIV : 예산타입
******************************************************************************/
function ln_Sel_change(i,gubun){
 
	//alert("ln_Sel_change::"+"i::"+i+"::gubun::"+gubun);
	if(gubun==""){
		eval("txt_documcd"+i).value=eval("sel_documcd"+i).value;
	}else if(gubun=="FSWRKDIV"){
	  alert("FSWRKDIV"+eval("sel_fswrkdiv"+i).value);
		if(eval("sel_fswrkdiv"+i).value=="02"){   //적용
			ln_Bgt_Amt_find('','','',i);
		}
	}
}

/******************************************************************************
	Description : line 추가 
	parameter  : gubun - 구분 0 - 라인긋기, 1 - 관리항목 1줄 추가 , 2- 관리항목 2줄 추가
******************************************************************************/
function ln_line_Add(gubun,i,j,strbgcolor){
  
	//alert("l"+i);
	var ls_html="";
	if (gubun==0){
	  //alert("l"+i);
	  ls_html +="<table id=l"+i+" width=857px cellpadding=0 cellspacing=0 border=0 style=position:relative;left:0px>";
		ls_html +="				<tr>"
		ls_html +="					<td width=857px  height=2px bgcolor=#D7959D align=center colspan=8 >";	
		ls_html +="				</tr>";
		ls_html +="</table>";
	}else{

	}
	
	//prompt("div1.innerHTML",div1.innerHTML);
	//prompt("ls_html",ls_html);
	__ws2__(div1,ls_html);
	///div1.innerHTML=div1.innerHTML + ls_html; 
	
}

function ln_Popup_Chk(i){

	if (eval("chkbox"+i).checked==false) {
	   if (eval("hid_flag_sel"+i+"0").value !="S"){
				return true;
		 }
		return false;
	}else{
    return true;
	}
	return false;
}

/******************************************************************************
	Description : 계정코드 선택시 필요항목 찾기
	parameter   : p1 - 구분    ( 01 -계정코드
	              obj - object ( 계정코드 또는 계정명)
                i - row 위치
******************************************************************************/
function ln_Popup_Find(p1,obj,i){
  var arrResult	= new Array();
	var Result="";

  if(event.keyCode!=113&&event.keyCode!=13) return;  //F2 또는 Enter 
	
	if(eval(obj+i).value!=""){
		gcds_code02.DataID = g_servlet+"/Account.actcode_s1f?v_str1="+eval(obj+i).value+"&v_str2='ATCODE'&v_str3="+parent.gclx_fdcode02.bindcolval;                                               
		//prompt("gcds_code02",gcds_code02.DataID);
		gcds_code02.Reset();

		if (gcds_code02.countrow>0){
				Result = gcds_code02.namevalue(gcds_code02.rowposition,"ATCODE") + ";"        
							+ gcds_code02.namevalue(gcds_code02.rowposition,"ATKORNAM")+ ";"       
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CNT")+ ";"            
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDCODE1")+ ";"        
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDNAM1")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDCODE2")+ ";"        
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDNAM2")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDCODE3")+ ";"        
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDNAM3")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDCODE4")+ ";"        
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDNAM4")+ ";"    //10 
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDCODE5")+ ";"        
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDNAM5")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDCODE6")+ ";"        
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDNAM6")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDCODE7")+ ";"        
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDNAM7")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDCODE8")+ ";"        
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDNAM8")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDCODE9")+ ";"        
							+ gcds_code02.namevalue(gcds_code02.rowposition,"CDNAM9")+ ";"   //20  
							
							+ gcds_code02.namevalue(gcds_code02.rowposition,"TYPE1")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"TYPE2")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"TYPE3")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"TYPE4")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"TYPE5")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"TYPE6")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"TYPE7")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"TYPE8")+ ";"         
							+ gcds_code02.namevalue(gcds_code02.rowposition,"TYPE9")+ ";"         
																																 
							+ gcds_code02.namevalue(gcds_code02.rowposition,"ARBALDIV1")+ ";"     
							+ gcds_code02.namevalue(gcds_code02.rowposition,"ARBALDIV2")+ ";"     
							+ gcds_code02.namevalue(gcds_code02.rowposition,"ARBALDIV3")+ ";"     
							+ gcds_code02.namevalue(gcds_code02.rowposition,"ARBALDIV4")+ ";"     
							+ gcds_code02.namevalue(gcds_code02.rowposition,"ARBALDIV5")+ ";"     
							+ gcds_code02.namevalue(gcds_code02.rowposition,"ARBALDIV6")+ ";"     
							+ gcds_code02.namevalue(gcds_code02.rowposition,"ARBALDIV7")+ ";"     
							+ gcds_code02.namevalue(gcds_code02.rowposition,"ARBALDIV8")+ ";"     
							+ gcds_code02.namevalue(gcds_code02.rowposition,"ARBALDIV9")+ ";"     
																																 
							+ gcds_code02.namevalue(gcds_code02.rowposition,"ATDEBTYN");         
							
							arrResult = Result.split(";");
							ln_Ref_Find(obj,i,arrResult)     //관리항목찾기
			}else {
			 // arrResult=undefined;
				alert("해당 계정과목이 존재하지 않습니다.");
				ln_Ref_Find(obj,i,arrResult)     //관리항목찾기
			}
		}
}

/******************************************************************************
	Description : 계정코드 찾기
	parameter   : p1 - 구분    ( 01 -계정코드
	              obj - object ( 계정코드 또는 계정명)
                i - row 위치
******************************************************************************/
function ln_Popup(p1,obj,i){
  
	//alert("popup i::"+i);
	var result="";
	var arrParam	= new Array();
	var arrResult	= new Array();
	var strURL;	
	var strPos;
	var cnt=0;
	var xcnt=0;
	var j=0;

	if(event.keyCode!=113&&event.keyCode!=13) return;  //F2 또는 Enter 
  if(!ln_Popup_Chk(i)) return; 
  arrParam[0]=eval(obj+i).value;
	/***
	if(gf_Dept_Enable(gs_deptcd,gcds_dept2)){
		arrParam[1]="A";                               // 회계부서
	}else{
		arrParam[1]=parent.gclx_fdcode02.bindcolval;   // 일반부서의 지점
	}
	***/
	arrParam[1]=parent.gclx_fdcode02.bindcolval;
  //alert("arrParam[0]" + arrParam[0]);
	if (p1=="01"){  //계정코드
		strURL = "./Actcode_popup_ifrm.html";
		strPos = "dialogWidth:400px;dialogHeight:379px;status:no;scroll:no;resizable:no";
		result = showModalDialog(strURL,arrParam,strPos);
    
		if(result != null){
			arrResult = result.split(";");
			ln_Find_Remark();
			ln_Bgt_Amt_Clear();
      ln_Ref_Find(obj,i,arrResult);     //관리항목찾기
			ln_Fswrkdiv_Setting(i);           //예산타입 자동 설정
		}
	}
}

/******************************************************************************
	Description : 관리항목설정
	parameter   : parameter   : p1 - 구분    ( 01 -계정코드
	              obj - object ( 계정코드 또는 계정명)
                i - row 위치
******************************************************************************/
function ln_Ref_Find(obj,i,arrResult){
   //alert("obj"+obj+"i"+i+"arrResult"+arrResult);
	 if(arrResult[0]!=undefined){
			eval("txt_atcode"+i).value = arrResult[0];
			eval("txt_atkornam"+i).value =arrResult[1];
			cnt = arrResult[2];   
			//alert("&&cnt::"+cnt);
			eval("hid_cnt_bf"+i).value = arrResult[2];   //현재 관리항목 갯수   
		
			//alert("hid_atdebtyn::"+arrResult[39]);
			eval("hid_atdebtyn"+i).value=arrResult[39];  //반제유무
      g_strbanjae = arrResult[39]; //반제유무
			eval("hid_atdecr"+i).value=arrResult[40];    //기준차대
      eval("hid_bgtcmtype"+i).value=arrResult[41]; //예산관리항목
			
			eval("hid_bgtcnt"+i).value=arrResult[42];    //예산세목건수			
			//alert("예산세목건수:hid_bgtcnt::"+eval("hid_bgtcnt"+i).value);
			eval("hid_funddiv"+i).value=arrResult[43];   //자금구분
			eval("hid_banjaeref"+i).value=arrResult[44];   //자금구분
			//alert("&&cntiii::"+eval("cnt"+i).value);
			if(eval("cnt"+i).value>=1&&eval("cnt"+i).value<=3){//변경전 관리항목 갯수 
					//alert("&&cnt::"+cnt);
					if((cnt>=4)&&(cnt<=6)){ //현재 관리항목 갯수와 다를 경우
						//alert("xcnt2::"+cnt);
						eval("document.all.t"+g_position+"2.style.display='block';"); //2번째 관리항목 라인보여줌
					}else if(cnt>=7){ 
						eval("document.all.t"+g_position+"2.style.display='block';"); //2번째 관리항목 라인보여줌
						eval("document.all.t"+g_position+"3.style.display='block';"); //3번째 관리항목 라인보여줌
					}
			}else if((eval("cnt"+i).value>=4)&&(eval("cnt"+i).value<=6)){ //변경전 관리항목 갯수 체크
					// alert("cnt2::"+cnt);
					if ((cnt>=0)&&(cnt<=3)){  //관리항목 갯수가 줄어들어서 안보이게함.
						eval("document.all.t"+g_position+"2.style.display='none';");
					}else if(cnt>=7){ 
						eval("document.all.t"+g_position+"3.style.display='block';"); //3번째 관리항목 라인추가
					}
			}else if (eval("cnt"+i).value>=7){ 
					//alert("paft3_cnt"+cnt); 
					if((cnt>=0)&&(cnt<=3)){
						eval("document.all.t"+g_position+"2.style.display='none';");
						eval("document.all.t"+g_position+"3.style.display='none';");
					}else if ((cnt>=4)&&(cnt<=6)){
						eval("document.all.t"+g_position+"3.style.display='none';");
					}
			}else{ //변경전 관리항목이 없는 경우		
					 //alert("cnt::::"+cnt);
           //alert("g_position::"+g_position);
					if((cnt>=0)&&(cnt<=3)){
					  //alert("step::1");
						eval("document.all.t"+g_position+"2.style.display='none';");
						eval("document.all.t"+g_position+"3.style.display='none';");
					}else if ((cnt>=4)&&(cnt<=6)){
					  //alert("step::2");
						eval("document.all.t"+g_position+"2.style.display='block';");
						eval("document.all.t"+g_position+"3.style.display='none';");
					}else if (cnt>=7){
					 // alert("step::3");
						eval("document.all.t"+g_position+"2.style.display='block';");
						eval("document.all.t"+g_position+"3.style.display='block';");
					}
			}
			
			//변경전 관리항목개수 저장
			//eval("cnt"+i).value= arrResult[2];
			//alert("cnti"+eval("cnt"+i).value);
			
			if (cnt==0||cnt==1|| cnt==2||cnt==3) xcnt=1;
			else if(cnt==4|| cnt==5||cnt==6)xcnt=2;
			else if(cnt==7|| cnt==8||cnt==9)xcnt=3;
			else xcnt =1;
		
			//관리항목 데이타 Clear
			ln_Ref_DataClear(i);

			//관리항목가져오기
			if (xcnt==1){
				j=1;
				eval("txt_fsrefcd"+i+j+"1").value=arrResult[3];
				eval("txt_fsrefnm"+i+j+"1").value=arrResult[4];
				eval("txt_fsrefcd"+i+j+"2").value=arrResult[5];
				eval("txt_fsrefnm"+i+j+"2").value=arrResult[6];
				eval("txt_fsrefcd"+i+j+"3").value=arrResult[7];
				eval("txt_fsrefnm"+i+j+"3").value=arrResult[8];

				eval("hid_type"+i+j+"1").value=arrResult[21];
				eval("hid_type"+i+j+"2").value=arrResult[22];
				eval("hid_type"+i+j+"3").value=arrResult[23];
				eval("hid_arbaldiv"+i+j+"1").value=arrResult[30];
				eval("hid_arbaldiv"+i+j+"2").value=arrResult[31];
				eval("hid_arbaldiv"+i+j+"3").value=arrResult[32];

				eval("txt_fsrefval"+i+j+"1").value="";
				eval("txt_fsrvalnm"+i+j+"1").value="";
				eval("txt_fsrefval"+i+j+"2").value="";
				eval("txt_fsrvalnm"+i+j+"2").value="";
				eval("txt_fsrefval"+i+j+"3").value="";
				eval("txt_fsrvalnm"+i+j+"3").value="";

			}else if (xcnt==2){
				j=1;
				eval("txt_fsrefcd"+i+j+"1").value=arrResult[3];
				eval("txt_fsrefnm"+i+j+"1").value=arrResult[4];
				eval("txt_fsrefcd"+i+j+"2").value=arrResult[5];
				eval("txt_fsrefnm"+i+j+"2").value=arrResult[6];
				eval("txt_fsrefcd"+i+j+"3").value=arrResult[7];
				eval("txt_fsrefnm"+i+j+"3").value=arrResult[8];

				eval("hid_type"+i+j+"1").value=arrResult[21];
				eval("hid_type"+i+j+"2").value=arrResult[22];
				eval("hid_type"+i+j+"3").value=arrResult[23];
				eval("hid_arbaldiv"+i+j+"1").value=arrResult[30];
				eval("hid_arbaldiv"+i+j+"2").value=arrResult[31];
				eval("hid_arbaldiv"+i+j+"3").value=arrResult[32];

				eval("txt_fsrefval"+i+j+"1").value="";
				eval("txt_fsrvalnm"+i+j+"1").value="";
				eval("txt_fsrefval"+i+j+"2").value="";
				eval("txt_fsrvalnm"+i+j+"2").value="";
				eval("txt_fsrefval"+i+j+"3").value="";
				eval("txt_fsrvalnm"+i+j+"3").value="";
				j=2
			
				eval("txt_fsrefcd"+i+j+"1").value=arrResult[9];
				eval("txt_fsrefnm"+i+j+"1").value=arrResult[10];
				eval("txt_fsrefcd"+i+j+"2").value=arrResult[11];
				eval("txt_fsrefnm"+i+j+"2").value=arrResult[12];
				eval("txt_fsrefcd"+i+j+"3").value=arrResult[13];
				eval("txt_fsrefnm"+i+j+"3").value=arrResult[14];

				eval("hid_type"+i+j+"1").value=arrResult[24];
				eval("hid_type"+i+j+"2").value=arrResult[25];
				eval("hid_type"+i+j+"3").value=arrResult[26];
				eval("hid_arbaldiv"+i+j+"1").value=arrResult[33];
				eval("hid_arbaldiv"+i+j+"2").value=arrResult[34];
				eval("hid_arbaldiv"+i+j+"3").value=arrResult[35];

				eval("txt_fsrefval"+i+j+"1").value="";
				eval("txt_fsrvalnm"+i+j+"1").value="";
				eval("txt_fsrefval"+i+j+"2").value="";
				eval("txt_fsrvalnm"+i+j+"2").value="";
				eval("txt_fsrefval"+i+j+"3").value="";
				eval("txt_fsrvalnm"+i+j+"3").value="";

        //eval("txt_fsrefnm"+i+j+"1").color="#0000FF";

			}else if (xcnt==3){
				j=1;
				eval("txt_fsrefcd"+i+j+"1").value=arrResult[3];
				eval("txt_fsrefnm"+i+j+"1").value=arrResult[4];
				eval("txt_fsrefcd"+i+j+"2").value=arrResult[5];
				eval("txt_fsrefnm"+i+j+"2").value=arrResult[6];
				eval("txt_fsrefcd"+i+j+"3").value=arrResult[7];
				eval("txt_fsrefnm"+i+j+"3").value=arrResult[8];

				eval("hid_type"+i+j+"1").value=arrResult[21];
				eval("hid_type"+i+j+"2").value=arrResult[22];
				eval("hid_type"+i+j+"3").value=arrResult[23];
				eval("hid_arbaldiv"+i+j+"1").value=arrResult[30];
				eval("hid_arbaldiv"+i+j+"2").value=arrResult[31];
				eval("hid_arbaldiv"+i+j+"3").value=arrResult[32];

				eval("txt_fsrefval"+i+j+"1").value="";
				eval("txt_fsrvalnm"+i+j+"1").value="";
				eval("txt_fsrefval"+i+j+"2").value="";
				eval("txt_fsrvalnm"+i+j+"2").value="";
				eval("txt_fsrefval"+i+j+"3").value="";
				eval("txt_fsrvalnm"+i+j+"3").value="";

				j=2;
				eval("txt_fsrefcd"+i+j+"1").value=arrResult[9];
				eval("txt_fsrefnm"+i+j+"1").value=arrResult[10];
				eval("txt_fsrefcd"+i+j+"2").value=arrResult[11];
				eval("txt_fsrefnm"+i+j+"2").value=arrResult[12];
				eval("txt_fsrefcd"+i+j+"3").value=arrResult[13];
				eval("txt_fsrefnm"+i+j+"3").value=arrResult[14];

				eval("hid_type"+i+j+"1").value=arrResult[24];
				eval("hid_type"+i+j+"2").value=arrResult[25];
				eval("hid_type"+i+j+"3").value=arrResult[26];
				eval("hid_arbaldiv"+i+j+"1").value=arrResult[33];
				eval("hid_arbaldiv"+i+j+"2").value=arrResult[34];
				eval("hid_arbaldiv"+i+j+"3").value=arrResult[35];

				eval("txt_fsrefval"+i+j+"1").value="";
				eval("txt_fsrvalnm"+i+j+"1").value="";
				eval("txt_fsrefval"+i+j+"2").value="";
				eval("txt_fsrvalnm"+i+j+"2").value="";
				eval("txt_fsrefval"+i+j+"3").value="";
				eval("txt_fsrvalnm"+i+j+"3").value="";

				j=3;
				eval("txt_fsrefcd"+i+j+"1").value=arrResult[15];
				eval("txt_fsrefnm"+i+j+"1").value=arrResult[16];
				eval("txt_fsrefcd"+i+j+"2").value=arrResult[17];
				eval("txt_fsrefnm"+i+j+"2").value=arrResult[18];
				eval("txt_fsrefcd"+i+j+"3").value=arrResult[19];
				eval("txt_fsrefnm"+i+j+"3").value=arrResult[20];

				eval("hid_type"+i+j+"1").value=arrResult[27];
				eval("hid_type"+i+j+"2").value=arrResult[28];
				eval("hid_type"+i+j+"3").value=arrResult[29];
				eval("hid_arbaldiv"+i+j+"1").value=arrResult[36];
				eval("hid_arbaldiv"+i+j+"2").value=arrResult[37];
				eval("hid_arbaldiv"+i+j+"3").value=arrResult[38];

				eval("txt_fsrefval"+i+j+"1").value="";
				eval("txt_fsrvalnm"+i+j+"1").value="";
				eval("txt_fsrefval"+i+j+"2").value="";
				eval("txt_fsrvalnm"+i+j+"2").value="";
				eval("txt_fsrefval"+i+j+"3").value="";
				eval("txt_fsrvalnm"+i+j+"3").value="";
			}
		} else { //NULL인경우
			eval("txt_atcode"+i).value = "";
			eval("txt_atkornam"+i).value ="";
			eval("hid_atdebtyn"+i).value="";
			j=1;
				//eval("txt_fsrefcd"+i+j+"1").value="";
				eval("txt_fsrefnm"+i+j+"1").value="";
				//eval("txt_fsrefcd"+i+j+"2").value="";
				eval("txt_fsrefnm"+i+j+"2").value="";
				//eval("txt_fsrefcd"+i+j+"3").value="";
				eval("txt_fsrefnm"+i+j+"3").value="";

				eval("txt_fsrefval"+i+j+"1").value="";
				eval("txt_fsrvalnm"+i+j+"1").value="";
				eval("txt_fsrefval"+i+j+"2").value="";
				eval("txt_fsrvalnm"+i+j+"2").value="";
				eval("txt_fsrefval"+i+j+"3").value="";
				eval("txt_fsrvalnm"+i+j+"3").value="";

				j=2;
				//eval("txt_fsrefcd"+i+j+"1").value="";
				eval("txt_fsrefnm"+i+j+"1").value="";
				//eval("txt_fsrefcd"+i+j+"2").value="";
				eval("txt_fsrefnm"+i+j+"2").value="";
				//eval("txt_fsrefcd"+i+j+"3").value="";
				eval("txt_fsrefnm"+i+j+"3").value="";

				eval("txt_fsrefval"+i+j+"1").value="";
				eval("txt_fsrvalnm"+i+j+"1").value="";
				eval("txt_fsrefval"+i+j+"2").value="";
				eval("txt_fsrvalnm"+i+j+"2").value="";
				eval("txt_fsrefval"+i+j+"3").value="";
				eval("txt_fsrvalnm"+i+j+"3").value="";

				j=3;
				//eval("txt_fsrefcd"+i+j+"1").value="";
				eval("txt_fsrefnm"+i+j+"1").value="";
				//eval("txt_fsrefcd"+i+j+"2").value="";
				eval("txt_fsrefnm"+i+j+"2").value="";
				//eval("txt_fsrefcd"+i+j+"3").value="";
				eval("txt_fsrefnm"+i+j+"3").value="";

				eval("txt_fsrefval"+i+j+"1").value="";
				eval("txt_fsrvalnm"+i+j+"1").value="";
				eval("txt_fsrefval"+i+j+"2").value="";
				eval("txt_fsrvalnm"+i+j+"2").value="";
				eval("txt_fsrefval"+i+j+"3").value="";
				eval("txt_fsrvalnm"+i+j+"3").value="";
	  }
		ln_Insert_Remark(i); //관리항목값 복사
		eval("gcem_chaamt"+i).Focus();

    //부서명이 존재할 경우
		if(eval("txt_fsrvalnm"+i+"11").value!=""){
			ln_Find_Bgtdiv(i,eval("txt_fsrvalnm"+i+"11").value);
		}
}


/******************************************************************************
	Description : 예산타입 설정
******************************************************************************/
function ln_Fswrkdiv_Setting(i){

	var stratcode = eval("txt_atcode"+i).value;
	stratcode = stratcode.substring(0,2);
 
	if (stratcode =="43"){ //매출원가 계정 - 예산타입 풀어놓음. 
    eval("sel_fswrkdiv"+i).disabled = false;
	}else{
    eval("sel_fswrkdiv"+i).disabled = true;
	}

	for(f=1;f<=3;f++){
		for (g=1;g<=3;g++){
			if (eval("txt_fsrefcd"+i+f+g).value=="0003"){	
				eval("sel_fswrkdiv"+i).value="02";
				return;
				break;
			} 
		}//for g
	}
  eval("sel_fswrkdiv"+i).value="01";
}

/******************************************************************************
	Description : 관리항목 찾기
	parameter   : p1 - 관리항목 구분 코드 (예, 거래처, 선급비용, 선수기간...)
	                   거래처(0020),부서(0002)는 따로 만듬
	              p2 - 해당 object 명
                p3 - object (i+j 값)
								p4 - object (열 구분값 1,2,3)
								참고 : p2+p3+p4 - 해당 관리항목 코드 또는 명칭
								p5 - i position
******************************************************************************/
function ln_Popup2(p1,p2,p3,p4,p5){

   //alert("p1:"+p1+":p2:"+p2+":p3:"+p3+":p4:"+p4+":p5:"+p5);
	//alert("ln_Popup2 keyCode::::::::"+event.keyCode);
	var result="";
	var arrParam	= new Array();
	var arrResult	= new Array();
	var strURL;	
	var strPos;
	var strposition="";
	var strpo2="";
	var strpo3="";
	var strPopGubun ="";
	var strPo="";// 관리항목위치
	var divcd="";

	if(event.keyCode==120){ //F9
		if(eval("hid_type"+p3+p4).value=="B"){ //세목이면
			//alert("hid_bgtcnt:::"+eval("hid_bgtcnt"+p5).value);
			if(eval("hid_bgtcnt"+p5).value!=0){      //예산계정 세목이 존재하는 경우
				//ln_Bgt_Amt_find(p2,p3,p4,p5);
			}else if(eval("hid_bgtcmtype"+p5).value!=""&&eval("hid_bgtcnt"+p5).value==0){//예산계정 세목이 존재하지 않을 경우
				ln_Bgt_Amt_find('','','',p5);
			}
		}
		///alert("keycode"+event.keyCode);
	  parent.ln_Add('99');
		return; //F9
	}else if(event.keyCode==9){ //Tab
    //alert("txt_fsrvalnm::"+eval("txt_fsrvalnm"+p3+p4).value);
		if(fn_trim(eval("txt_fsrvalnm"+p3+p4).value)!=""){
			//alert("txt_fsrefcd::"+eval("txt_fsrefcd"+p3+p4).value);
			//alert("txt_fsrefval"+eval("txt_fsrefval"+p3+p4).value);
			if(eval("txt_fsrefcd"+p3+p4).value=="0020"&&eval("txt_fsrefval"+p3+p4).value!=""){      //거래처
			   //alert("gcem_chaamt::"+eval("gcem_chaamt"+p5).ReadOnly);
				 if(eval("gcem_chaamt"+p5).ReadOnly==false&&eval("gcem_daeamt"+p5).ReadOnly==false){
					ln_Banjae_Amt_Chk(p5); //반제계정체크
				}
			}
		}
	}

	if(event.keyCode!=113&&event.keyCode!=13)return;
	
  if(!ln_Chk_Popup(p1,p2,p3,p4,p5))return;

  //입력항목일 경우 return ==>어음번호는 제외
  if(eval(p1).value!="0967"&&eval("hid_type"+p3+p4).value=="C") return;

  //입력항목이 예산이면서 세목이 없는 경우(관리항목이 예산부서가 아닌경우)
	//alert("p1"+eval(p1).value);
  if(eval(p1).value!="0003"){
		if(eval("hid_type"+p3+p4).value=="B"&&eval("hid_bgtcnt"+p5).value==0) return;
	}
	//alert("step5");
	
	strPopGubun = ln_PopGubun('1',p1,p5);
	arrParam[0]=eval(p1).value;
  arrParam[1]=eval(p2+p3+p4).value;

	//alert("arrParam[0]"+eval(p1).value);

	//alert("strPopGubun::"+strPopGubun);
	
	if(arrParam[0]=="0020"){
		strURL = "./Gczm_vender_popup.html";
		strPos = "dialogWidth:494px;dialogHeight:379px;status:no;scroll:no;resizable:no";
	}else if(arrParam[0]=="0002"){
    if(gf_Dept_Enable(gs_deptcd,gcds_name)){ //관리부서
      arrParam[2]="A";
			arrParam[3]="";
			arrParam[4]=parent.gclx_fdcode02.bindcolval;
		}else{ //일반부서
			divcd = parent.ln_Find_Divcd(); //본부찾기
			arrParam[2]="B";
			arrParam[3]=divcd;
			arrParam[4]=parent.gclx_fdcode02.bindcolval;
		}

    strURL = "/Account/html/Hcdept_popup.html";
	  strPos = "dialogWidth:496px;dialogHeight:379px;status:no;scroll:no;resizable:no";
	}else if(arrParam[0]=="1160"){ //상대계정
	  arrParam[0]=arrParam[1];
    strURL = "./Actcode_popup_ifrm.html";
		strPos = "dialogWidth:400px;dialogHeight:379px;status:no;scroll:no;resizable:no";
	}else if(strPopGubun=="1"&&arrParam[0]=="0967"){ //팝업구분 && 어음번호일경우 ===> 발생
	  arrParam[1]=eval("hid_funddiv"+p5).value;      //자금구분
		arrParam[2]= "";  //은행
		arrParam[3]= "0"; //처리구분(0-미발행)
    arrParam[4]=parent.gclx_fdcode02.bindcolval;   //지점
		arrParam[5]=eval("txt_atcode"+p5).value;       //계정
    strURL = "./Bill_popup_ifrm.html";
		strPos = "dialogWidth:400px;dialogHeight:379px;status:no;scroll:no;resizable:no";
  }else if(strPopGubun=="2"&&arrParam[0]=="0967"){ //팝업구분 && 어음번호일경우 ====>정산
		if(eval("txt_fsrefval"+p5+"12").value==""||eval("txt_fsrvalnm"+p5+"12").value==""){
			alert("거래처를 입력하시요.");
			return;
	  }
		arrParam[1]=eval("hid_funddiv"+p5).value;      //자금구분
		arrParam[3]= "0"; //처리구분(0-처리중)
		arrParam[4]=parent.gclx_fdcode02.bindcolval;   //지점
		arrParam[5]=eval("txt_atcode"+p5).value;       //계정
		arrParam[7]=eval("txt_atkornam"+p5).value;     //계정명
		if(eval("txt_fsrefcd"+p5+"12").value=="0020"){
		  arrParam[2]= eval("txt_fsrefval"+p5+"12").value;  //거래처코드
			arrParam[6]= eval("txt_fsrvalnm"+p5+"12").value;  //거래처
		}else{
		  arrParam[2]="";
      arrParam[6]="";
		}
    strURL = "./Bill_popup_ifrm2.html";
		strPos = "dialogWidth:400px;dialogHeight:379px;status:no;scroll:no;resizable:no"; 
	}else if(arrParam[0]=="0003"){ //예산부서
	  ///alert("step2::"+eval("hid_bgtdiv"+p5).value);
		arrParam[2]=eval("hid_bgtdiv"+p5).value;
		strURL = "./Commdtil_popup_ifrm.html";
		strPos = "dialogWidth:400px;dialogHeight:379px;status:no;scroll:no;resizable:no";
	}else if(arrParam[0]=="0030"){ //원가코드
	  //^^alert("step2::"+eval("hid_bgtdiv"+p5).value);
		if(parent.gclx_fdcode02.bindcolval=="01"){
			arrParam[2]="02";
		}else{
      arrParam[2]=parent.gclx_fdcode02.bindcolval;
		}
		strURL = "./Commdtil_popup_ifrm.html";
		strPos = "dialogWidth:400px;dialogHeight:379px;status:no;scroll:no;resizable:no";
	}else{
	  alert("arrParam[0]:"+arrParam[0]+":arrParam[1]:"+arrParam[1]);
		strURL = "./Commdtil_popup_ifrm.html";
		strPos = "dialogWidth:400px;dialogHeight:379px;status:no;scroll:no;resizable:no";
	}
	result = showModalDialog(strURL,arrParam,strPos);	

	if (result != null) {
		arrResult = result.split(";");
    if(strPopGubun=="1"){        //자금발생
		   //어음번호
			eval("txt_fsrefval"+p3+p4).value=arrResult[1];
			eval("txt_fsrvalnm"+p3+p4).value=eval("txt_fsrefval"+p3+p4).value;

			 //은행
			strPo="";
			strPo = ln_Ref_position_find(p5,"0022");
			eval("txt_fsrefval"+strPo).value =arrResult[2];   //은행코드
			eval("txt_fsrvalnm"+strPo).value =arrResult[3];   //은행명
			
			ln_Ref_lock(strPo,'1');

		}else if(strPopGubun=="2"){  //자금정산
		  
			//금액체크1 --받을어음의 경우  대변 금액이 발생금액(차변금액)과 동일해야함.
			//금액체크2 --지급어음의 경우  차변 금액이 발생금액(대변금액)과 동일해야함.
			if(eval("hid_funddiv"+p5).value=="50"){
				if(eval("gcem_daeamt"+p5).text!=arrResult[8]){
					alert("정산금액이 발생금액과 동일하지 않습니다.");
					ln_Ref_Fund_Clear("2",p3,p4,p5);
					return ;
				}
			}else if(eval("hid_funddiv"+p5).value=="60"){
				if(eval("gcem_chaamt"+p5).text!=arrResult[9]){
          alert("정산금액이 발생금액과 동일하지 않습니다.");
					ln_Ref_Fund_Clear("2",p3,p4,p5);
					return ;
				}
			}

			//어음번호
			eval("txt_fsrefval"+p3+p4).value=arrResult[1];
			eval("txt_fsrvalnm"+p3+p4).value=eval("txt_fsrefval"+p3+p4).value;

			//거래처
			//strPo = ln_Ref_position_find(p5,"0020");
			//eval("txt_fsrefval"+strPo).value =arrResult[2];  //거래처코드
			//eval("txt_fsrvalnm"+strPo).value =arrResult[3];  //거래처
			//ln_Ref_lock(strPo,'2');

			//은행
			strPo="";
			strPo = ln_Ref_position_find(p5,"0022");
			eval("txt_fsrefval"+strPo).value =arrResult[6];   //은행코드
			eval("txt_fsrvalnm"+strPo).value =arrResult[7];   //은행명
			ln_Ref_lock(strPo,'2');

			//어음발생일
			strPo="";
			strPo = ln_Ref_position_find(p5,"0968");
			eval("txt_fsrefval"+strPo).value =arrResult[4];   //
			eval("txt_fsrvalnm"+strPo).value =arrResult[4];   //
			ln_Ref_lock(strPo,'2');

			//어음만기일
			strPo="";
			strPo = ln_Ref_position_find(p5,"0969");
			eval("txt_fsrefval"+strPo).value =arrResult[5];   //
			eval("txt_fsrvalnm"+strPo).value =arrResult[5];   //
			ln_Ref_lock(strPo,'2');

			//금액 lock
			ln_Ref_lock(strPo,'3',i); //금액 lock
			
		}else{                //자금이외
			eval("txt_fsrefval"+p3+p4).value =arrResult[0];
			eval("txt_fsrvalnm"+p3+p4).value =arrResult[1];
		
			if(arrParam[0]=="0002"){                     //부서
				eval("hid_divcd"+p5).value = arrResult[3]; //본부
				//alert("step3::"+eval("hid_bgtdiv"+p5).value);
				//eval("hid_bgtdiv"+p5).value ="";
				
				//예산부서 위치찾기
				_out:
				for(f=1;f<=3;f++){
					for (g=1;g<=3;g++){
						//alert("p5:"+p5+":f:"+f+":g:"+g+":::"+eval("hid_type"+p5+f+g).value);
						if (eval("txt_fsrefcd"+p5+f+g).value=="0003"){
								eval("txt_fsrefval"+p5+f+g).value = arrResult[4]; //예산부서
								eval("txt_fsrvalnm"+p5+f+g).value = arrResult[5]; //예산부서명
								eval("hid_bgtdiv"+p5).value =arrResult[6];        //예산본부코드
								//^^alert("step4::"+eval("hid_bgtdiv"+p5).value);
								break _out; 
						} 
					}//for g
				}//for f
				
				//	alert("aahid_bgtcnt::"+eval("hid_bgtcnt"+p5).value);
				//예산부서 및 세목 존재확인(예산부서가 존재할 경우)
				var strpo="";
				var str1="";
				var str2="";
				var str3="";

				if(eval("hid_bgtcnt"+p5).value!=0){       //예산계정 세목이 존재하는 경우
					strpo=ln_Bgt_Detail_find(p5);
					//세목이 존재할 경우
					if(strpo!=""&&strpo!=undefined){
						str1 = strpo.substring(0,2);
						str2 = strpo.substring(2,3);
						str3 = strpo.substring(0,1);
						if( eval("txt_fsrefval"+strpo).value!=""){
							///////////ln_Bgt_Amt_find('',str1,str2,str3); ////부서찾을경우 예산조회안함.
						}
					}
				}else if(eval("hid_bgtcmtype"+p5).value!=""&&eval("hid_bgtcnt"+p5).value==0){ //예산계정 세목이 존재하지 않을 경우
					/////////////ln_Bgt_Amt_find('','','',p5);
				}
			}else if (arrParam[0]=="0003"){  ////예산부서
			  if(arrResult[2]=="1000"){

				}else{
					eval("hid_bgtdiv"+p5).value =arrResult[2]; //예산본부코드
				}

				if(eval("hid_bgtcnt"+p5).value!=0){        //예산계정 세목이 존재하는 경우
					//alert("step5::"+eval("hid_bgtdiv"+p5).value);
					//ln_Bgt_Amt_find(p2,p3,p4,p5);
				}else if(eval("hid_bgtcmtype"+p5).value!=""&&eval("hid_bgtcnt"+p5).value==0){//예산계정 세목이 존재하지 않을 경우
					ln_Bgt_Amt_find('','','',p5);
				}
			}else{
				 if(eval("hid_type"+p3+p4).value=="B"){ //예산부서의 세목이면 
						if(eval("hid_bgtcnt"+p5).value!=0){ //예산계정이 세목이 존재하는 경우
							ln_Bgt_Amt_find(p2,p3,p4,p5);       
						}else if(eval("hid_bgtcmtype"+p5).value!=""&&eval("hid_bgtcnt"+p5).value==0){ //예산계정 세목이 존재하지 않을 경우
							//ln_Bgt_Amt_find('','','',p5);
						}
				 }
			}
		}
	}else{//Data가 존재하지 않을 경우
    
		if(strPopGubun=="1"){        //자금발생
			ln_Ref_Fund_Clear("1",p3,p4,p5);
		}else if(strPopGubun=="2"){  //자금정산
		  ln_Ref_Fund_Clear("2",p3,p4,p5);
		}else{
			eval("txt_fsrefval"+p3+p4).value="";
			eval("txt_fsrvalnm"+p3+p4).value="";
			
			if(arrParam[0]=="0002"){
			  //부서가 존재하지 않으면
				eval("hid_divcd"+p5).value ="";
			}

			if(arrParam[0]=="0003"){
			  //부서가 존재하지 않으면 
				var spo=ln_Ref_position_find(p5,"0002");//부서
				if(eval("txt_fsrefval"+spo).value==""){
					eval("hid_bgtdiv"+p5).value ="";
				}
			}
		}
		return;
	}

	//마지막인란에서 행추가함.//////////////////////////////////
	//if(event.keyCode!=13) return;
	strposition=p3+p4;
	ln_Row_Add(strposition,p5);
	///////////////////////////////////////////////////////////
  
	///alert("222222222222222222222222222222222222222222::::::::"+event.keyCode);
}


/******************************************************************************
	Description : 마지막 라인에서 행추가 
	parameter   : strposition - 구분값
******************************************************************************/
function ln_Row_Add(strposition,p5){
  var strp2="";
	var strp3="";

	if(strposition.length==3){
    strpo2 = strposition.substring(1,2);
		strpo3 = strposition.substring(2,3);
	}else if(strposition.length==4){
		strpo2 = strposition.substring(2,3);
		strpo3 = strposition.substring(3,4);
	}else if(strposition.length==5){
		strpo2 = strposition.substring(3,4);
		strpo3 = strposition.substring(4,5);
	}

	if(eval("hid_cnt_bf"+p5).value==1){
		strp2="1";		strp3="1";
	}else if(eval("hid_cnt_bf"+p5).value==2){
	  strp2="1";		strp3="2";
	}else if(eval("hid_cnt_bf"+p5).value==3){
	  strp2="1";		strp3="3";
	}else if(eval("hid_cnt_bf"+p5).value==4){
	  strp2="2";		strp3="1";
	}else if(eval("hid_cnt_bf"+p5).value==5){
	  strp2="2";		strp3="2";
	}else if(eval("hid_cnt_bf"+p5).value==6){
	  strp2="2";		strp3="3";
	}else if(eval("hid_cnt_bf"+p5).value==7){
	  strp2="3";		strp3="1";
	}else if(eval("hid_cnt_bf"+p5).value==8){
	  strp2="3";		strp3="2";
	}else if(eval("hid_cnt_bf"+p5).value==9){
    strp2="3";		strp3="3";
	}

  var row = 0;
  for(k=1;k<=g_row;k++){
	  //alert(k+"::::"+eval("hid_flag_del"+p5).value);
		if(eval("hid_flag_del"+p5).value!='Y'){
			row+=1;
		}
	}


  if(row==p5){
		if(strp2==strpo2&&strp3==strpo3){
			parent.ln_Add('99');
		}
	}
}


/******************************************************************************
	Description : 관리항목 위치찾기
	parameter   : ii - 위치, strValue - 관리항목값
******************************************************************************/
function ln_Ref_position_find(ii,strValue){
  var strposition="";
	for(f=1;f<=3;f++){
		for (g=1;g<=3;g++){
			 if (eval("txt_fsrefcd"+ii+f+g).value==strValue){  
					strposition = ii+""+f+""+g;
					return strposition; 
			 }
		}//for g
	}//for f

}

/******************************************************************************
	Description : 변경전 예산부서 및 예산본부 위치찾기
	parameter   : p5 - 위치
******************************************************************************/
function ln_Bf_Bgt_position_find(p5){
  var strposition="";
	for(f=1;f<=3;f++){
		for (g=1;g<=3;g++){
			 if (eval("hid_fsrefcd"+p5+f+g).value=="0003"){
					strposition = p5+""+f+""+g;
					return strposition; 
			 }
		}//for g
	}//for f
}

/******************************************************************************
	Description : 변경전 세목 찾기
	parameter   : ii - 위치
******************************************************************************/
function ln_Bf_Bgt_Detail_find(ii){
  var strposition="";
	if(ln_Bgt_position_find(ii)!=""){
		for(f=1;f<=3;f++){
			for (g=1;g<=3;g++){
				 if (eval("hid_typeBf"+ii+f+g).value=="B"){  //예산세목임.
						strposition = ii+""+f+""+g;
						return strposition; 
				 }
			}//for g
		}//for f
	}
}

/******************************************************************************
	Description : 예산부서 및 예산본부 위치찾기
	parameter   : p5 - 위치
******************************************************************************/
function ln_Bgt_position_find(p5){
  //alert("p5::"+p5);
  var strposition="";
	for(f=1;f<=3;f++){
		for (g=1;g<=3;g++){
			 if (eval("txt_fsrefcd"+p5+f+g).value=="0003"){
					strposition = p5+""+f+""+g;
					return strposition; 
			 }
		}//for g
	}//for f
}

/******************************************************************************
	Description : 세목 찾기
	parameter   : ii - 위치
******************************************************************************/
function ln_Bgt_Detail_find(ii){
  var strposition="";
	if(ln_Bgt_position_find(ii)!=""){
		for(f=1;f<=3;f++){
			for (g=1;g<=3;g++){
				 if (eval("hid_type"+ii+f+g).value=="B"){  //예산세목임.
						strposition = ii+""+f+""+g;
						return strposition; 
				 }
			}//for g
		}//for f

		//alert("계정 관리항목이 예산세목으로 설정되지 않았습니다.");
	}
}

/******************************************************************************
	Description : 전표 전체 삭제시 예산 금액 찾기
	prameter    : p1 - 지점
	              p2 - 접수일자
								p3 - 접수번호
******************************************************************************/
function ln_Del_All_Bgt_find(p1,p2,p3){
	for (t=1;t<=g_row;t++){
		if(eval("hid_flag_del"+t).value!="Y"){ //삭제가 아닌경우
				var no1= ln_Bgt_position_find(t);   //예산부서찾기
				var no2= ln_Bgt_Detail_find(t);     //예산세목찾기

				if((no1!=""&&no1!=undefined)&&(no2!=""&&no2!=undefined)){
					ln_Del_All_Bgt_Data_Add(t,no1,no2,p1,p2,p3);  //삭제계정추가
				}
		}
	}//for t
}

/******************************************************************************
	Description : 삭제할 예산관련 계정 Data Set 설정
	parameter   : 
******************************************************************************/
function ln_Del_All_Bgt_Data_Add(i,no1,no2,p1,p2,p3){
	if(gcds_bgt_del_all.countrow<=0){
		ln_SetDataHeader("BGTDTL_DEL_ALL");
	}
	gcds_bgt_del_all.Addrow();

	var stractdt3 = parent.hid_actdat02.value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"BGTYY")=stractdt3.substring(0,4);          //변경전예산년도
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"BGTMM")=stractdt3.substring(4,6);          //변경전예산월  
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"BGTDIV")=eval("hid_Bbgtdiv"+i).value;      //변경전예산본부  
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"BGTDPT")=eval("hid_Bbgtdpt"+i).value;      //변경전예산부서  
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"ATCODE")=eval("hid_Batcode"+i).value;      //변경전계정과목  
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFCD")=eval("hid_Bfsrefcd"+i).value;    //변경전관리항목코드  
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"SATCODE")=eval("hid_Bsatcode"+i).value;    //변경전세목
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"BGTMACT")=eval("hid_Bfswrkdiv"+i).value;	  //변경전예산타입 
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"CHAAMT")=eval("hid_Bchaamt"+i).value;      //변경전금액  
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"ACTDAT")=parent.hid_actdat02.value;        //변경전 회계일자  

	//예산총계정원장 (미승인 실적분)
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FDCODE")=p1;  
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"COCODE")=ln_Cocode(parent.hid_cocode02.value);   
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSDAT")=p2;   
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSNBR")=p3;   
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSSEQ")=eval("hid_fsseq"+i).value; 


	//변경 전 예산관리항목원장 (미승인 실적분)
	//예산관리항목원장
	j=1;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFCD01")=eval("hid_fsrefcd"+i+j+"1").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFVAL01")=eval("hid_fsrefval"+i+j+"1").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFCD02")=eval("hid_fsrefcd"+i+j+"2").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFVAL02")=eval("hid_fsrefval"+i+j+"2").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFCD03")=eval("hid_fsrefcd"+i+j+"3").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFVAL03")=eval("hid_fsrefval"+i+j+"3").value;

	j=2;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFCD04")=eval("hid_fsrefcd"+i+j+"1").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFVAL04")=eval("hid_fsrefval"+i+j+"1").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFCD05")=eval("hid_fsrefcd"+i+j+"2").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFVAL05")=eval("hid_fsrefval"+i+j+"2").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFCD06")=eval("hid_fsrefcd"+i+j+"3").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFVAL06")=eval("hid_fsrefval"+i+j+"3").value;

	j=3;
	//alert("i"+i+"j"+j+"::"+eval("txt_fsrefseq"+i+j+"1").value);
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFCD07")=eval("hid_fsrefcd"+i+j+"1").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFVAL07")=eval("hid_fsrefval"+i+j+"1").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFCD08")=eval("hid_fsrefcd"+i+j+"2").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFVAL08")=eval("hid_fsrefval"+i+j+"2").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFCD09")=eval("hid_fsrefcd"+i+j+"3").value;
	gcds_bgt_del_all.namevalue(gcds_bgt_del_all.rowposition,"FSREFVAL09")=eval("hid_fsrefval"+i+j+"3").value;


}

/******************************************************************************
	Description : 세금계산서 및 계산서 등록
	parameter   : p0 - position
				        p1 - 지점코드
	              p2 - 접수일자
                p3 - 접수번호
								p4 - 전표행번호
					
				참 고	:	증빙구분 ( 001-세금계산서, 002-계산서)

	수정 : 2006.03.02 - 증빙명에 대한 프로세스 변경으로 추가됨
	       
******************************************************************************/
function ln_Popup_Tax(p0,p1,p2,p3,p4){
	var result="";
	var arrParam	= new Array();
	var arrResult	= new Array();
	var strURL;	
	var strPos;
	var strDocumcd="";
	var strDocGB="";

	strDocumcd=eval("sel_documcd"+p0).value;
	strDocGB=strDocumcd.substring(0,1);

	if(eval("sel_documcd"+p0).value==""||eval("sel_documcd"+p0).value=="000"){  
		alert("증빙명을 선택하십시요.");
		return;
  }

	if(eval("hid_docuval"+p0).value==""){
		arrParam[0]=p1;   //지점코드
		arrParam[1]=p2;   //접수일자
		arrParam[2]=p3;   //접수번호
		arrParam[3]=p4;   //전표행번호
		
		if(eval("txt_fsrefcd"+p0+"12").value=="0020"){
			arrParam[4]=eval("txt_fsrefval"+p0+"12").value;   //거래처코드
			arrParam[5]=eval("txt_fsrvalnm"+p0+"12").value;   //거래처명
		}else{
			arrParam[4]="";   //거래처코드
			arrParam[5]="";   //거래처명
		}
	}else{  //매입매출장 접수번호 존재
	  var strdocuval =eval("hid_docuval"+p0).value;
		arrParam[0]=strdocuval.substring(0,1);   //매입매출구분 (A-매입, B-매출)
		arrParam[1]=p1;                          //지점코드
		arrParam[2]=strdocuval.substring(1,11);  //접수번호
	}
  
	//증빙구분////////////////////////////// 	
	if(strDocGB=="1"){
		arrParam[6]= eval("sel_documcd"+p0).value;  
		arrParam[7]= eval("hid_docuval"+p0).value;
    if(eval("hid_docuval"+p0).value==""){
			strURL = "./Com_Tax_List1.html";
			strPos = "dialogWidth:830px;dialogHeight:500px;status:no;scroll:no;resizable:no";
		}else{
			strURL = "./STaxBill_popup.html";
			strPos = "dialogWidth:888px;dialogHeight:635px;status:no;scroll:no;resizable:no";
		}
  }else if(strDocGB=="2"){
		ln_Popup_Tax2(p0);
		return;
	}
	result = showModalDialog(strURL,arrParam,strPos);
	
	if (result != null) {
		arrResult = result.split(";");
		var stracnbr="";
  	var cnt = arrResult.length/12 //Dtl row 갯수
    
		var chasum=0;
		var daesum=0;
		var k=-1;
		var stracnbr =""//계산서 번호
		
		if(parent.gcem_remark02.text==""){
			parent.gcem_remark02.text=arrResult[k+7]; //적요
		}

		for(m=1;m<=cnt;m++){
		  //Detail 항목 추가
			if(m==1){
			  //alert("m02::"+m)
			}else{
			  //alert("m03::"+m);
				parent.ln_Add('99');
			}
		
			chasum+=parseInt(arrResult[k+8]);
			daesum+=parseInt(arrResult[k+9]);

		  //parameter   :  p1 - 계정코드,  p2- 계정명,    p3 -거래처코드,   p4-거래처명,  p5 - 부서코드, 
	    //               p6 - 부서명,    p7 - 적요,     p8 - 차변,        p9-대변,      p10 - 계산서번호, p11 - 증빙코드
			//               p12 - 본부코드
			ln_Refcode_find(arrResult[k+1],arrResult[k+2], arrResult[k+3],arrResult[k+4], arrResult[k+5],
		                  arrResult[k+6],arrResult[k+7], arrResult[k+8],arrResult[k+9], arrResult[k+10], 
											arrResult[k+11],arrResult[k+12],arrResult[k+13]);
			
			//동일계산서 번호는 한번만 넘김.
			if(stracnbr!=arrResult[k+10]){
				ln_Tax_Data_Save(arrResult[k+10],gs_date,gs_userid,p2);
			}
			stracnbr = arrResult[k+10];
			ln_lock(m,'1');
			k+=13; //parameter갯수
		}//for
      parent.gcem_detot02.text = Number(parent.gcem_detot02.text)+ Number(chasum);
		  parent.gcem_crtot02.text = Number(parent.gcem_crtot02.text)+ Number(daesum);
			parent.gcem_fsamt02.text = parent.gcem_detot02.text;
			parent.gcem_diff02.text = Number(parent.gcem_detot02.text)-Number(parent.gcem_crtot02.text); 
			
			g_taxval += Number(chasum);
			g_fsknd = "1";
			
	}else{
    //eval("txt_fsrefval"+p3+p4).value="";
		//eval("txt_fsrvalnm"+p3+p4).value="";
	}

}

/******************************************************************************
	Description : 일반증빙
	parameter   : p0 - position
	참고        : 일반증빙은 popup 저장을 하지않음.(2006.06.07. 장현정 대리 요청)
******************************************************************************/
function ln_Popup_Tax2(p0){

	var result="";
	var arrParam	= new Array();
	var arrResult	= new Array();
	var strURL;	
	var strPos;
 
  if(eval("txt_atcode"+p0).value==""){
		alert("계정코드를 선택하십시요");
		return;
	}
 
	if(eval("sel_documcd"+p0).value==""||eval("sel_documcd"+p0).value=="000"){  
		alert("증빙명을 선택하십시요.");
		return;
  }

	if (eval("gcem_chaamt"+p0).text==0 && eval("gcem_daeamt"+p0).text==0){
		alert("금액을 선택하십시요");
		return
	}

	if(eval("txt_fsrefval"+p0+"12").value==""||eval("txt_fsrvalnm"+p0+"12").value==""){
		alert("거래처를 선택하십시요");
		return;
	}

	arrParam[0]=parent.gclx_fdcode02.bindcolval;                  //지점코드
	arrParam[1]=parent.gcem_fs02.text+parent.gcem_fsdat02.text;   //접수일자
	arrParam[2]=parent.gcem_fsnbr02.text                          //접수번호
	arrParam[3]=eval("hid_fsseq"+p0).value;                       //전표행번호
	arrParam[4]=eval("sel_documcd"+p0).value; 
	
	//거래처가 존재할 경우 함께 넘김...
	if(eval("txt_fsrefcd"+p0+"12").value=="0020"){
		arrParam[5]=eval("txt_fsrefval"+p0+"12").value;   //거래처코드
		arrParam[6]=eval("txt_fsrvalnm"+p0+"12").value;   //거래처명
	}else{
		arrParam[5]="";   //거래처코드
		arrParam[6]="";   //거래처명
	}

  if(eval("txt_remark"+p0).value!=""){
		arrParam[7]=eval("txt_remark"+p0).value;   //적요
	}else{
		arrParam[7]="";   //적요
	}

	if(eval("gcem_chaamt"+p0).text!=0||eval("gcem_chaamt"+p0).text!=""){
		arrParam[8]=eval("gcem_daeamt"+p0).text;   //금액
	}

	if(eval("gcem_daeamt"+p0).text!=0||eval("gcem_daeamt"+p0).text!=""){
		arrParam[8]=eval("gcem_chaamt"+p0).text;   //금액
	}

	//alert(""+arrParam);
	strURL = "./Com_proof.html";
	strPos = "dialogWidth:415px;dialogHeight:359px;status:no;scroll:no;resizable:no";

	result = showModalDialog(strURL,arrParam,strPos);

	if (result != null) {
		arrResult = result.split(";");
		ln_SetDataHeader("GENRST");
		gcds_genrst.Addrow();
		//alert("arrResult[0]"+arrResult[0]);
		gcds_genrst.namevalue(gcds_genrst.rowposition,"FDCODE")=arrResult[0];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"FSDAT")=	arrResult[1];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"FSNBR")=	arrResult[2];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"FSSEQ")=	arrResult[3];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"RSVNO")=	arrResult[4];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"RSTDIV")=arrResult[5];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"RSTNO")=	arrResult[6];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"VEND_CD")=arrResult[7];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"REMARK")=arrResult[8];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"AMOUNT")=arrResult[9];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"RSVDATE")=arrResult[10];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"RSVMAN")=arrResult[11];
		gcds_genrst.namevalue(gcds_genrst.rowposition,"CURDATE")=	arrResult[12];
	}else{

	}
}

/******************************************************************************
	Description : 반제처리
	parameter   : p1 - 지점코드
	              p2 - 접수일자
                p3 - 접수번호
******************************************************************************/
function ln_Popup_Repay(p1,p2,p3){
  //alert("반제시작");
	var result="";
	//var arrParam	= new Array();
	var arrResult	= new Array();
	var strURL;	
	var strPos;
	var stratcode="";
	var stratkornam="";
	var strfsrefval="";
	var strfsrvalnm="";
	var strseq="";
	var temprow="";
	var strbanjaeref="";
	var strbanjaerefval=""; //반제단위값
	var strbanjaerefnm="";  //반제단위명칭
	var chaamt=0;
	var daeamt=0;
	
	
	if(!ln_Chk_Repay()) return;
	for (i=1;i<=g_row;i++){
		if(eval("chkbox"+i).checked==true&&eval("hid_flag"+i+"0").value=="T"){
			stratcode=eval("txt_atcode"+i).value; 
			stratkornam =eval("txt_atkornam"+i).value;
			strseq = eval("hid_fsseq"+i).value;
			temprow=i;
			
			_out:
			for(j=1;j<=3;j++){
				 for(k=1;k<=3;k++) {
						//alert("i::"+i+"::j::"+j+"::k::"+k);
						//alert("txt_fsrefcd::"+eval("txt_fsrefcd"+i+j+k).value);
						//alert("txt_fsrefval:"+eval("txt_fsrefval"+i+j+k).value);
						//alert("txt_fsrvalnm:"+eval("txt_fsrvalnm"+i+j+k).value);
						if(eval("txt_fsrefcd"+i+j+k).value=="0020"){
							 strfsrefval = eval("txt_fsrefval"+i+j+k).value;
							 strfsrvalnm = eval("txt_fsrvalnm"+i+j+k).value;
							 break _out;
						}
				 }//k	
			}//j


			_out2:
			for(j=1;j<=3;j++){
				 for(k=1;k<=3;k++) {
						//alert("hid_banjaeref"+eval("hid_banjaeref"+i).value);
						if(eval("txt_fsrefcd"+i+j+k).value==eval("hid_banjaeref"+i).value){
						   strbanjaeref = eval("hid_banjaeref"+i).value;
							 strbanjaerefval = eval("txt_fsrefval"+i+j+k).value;
							 strbanjaerefnm = eval("txt_fsrvalnm"+i+j+k).value;
							 break _out2;
						}
				 }//k	
			}//j
		}//if
	}//i

	//alert("strbanjaerefval"+strbanjaerefval);
	//alert("strbanjaerefnm"+strbanjaerefnm);
  
	g_arrParam[0]=stratcode;      //계정코드
	g_arrParam[1]=stratkornam;    //계정명
	g_arrParam[2]=strfsrefval;    //거래처코드
	g_arrParam[3]=strfsrvalnm;    //거래처명
	g_arrParam[4]=p1;						  //반제전표 FDCODE
	g_arrParam[5]=p2;						  //반제전표 FSDAT
	g_arrParam[6]=p3;						  //반제전표 FSNBR
	g_arrParam[7]=strseq;					//전표행번호 seq
	g_arrParam[8]=strbanjaeref;   // 
	g_arrParam[9]=strbanjaerefval;//반제단위값
	g_arrParam[10]=strbanjaerefnm; //반제단위값 명칭
  // alert("p1::"+p1+"p2::"+p2+"p3::"+p3+"::strseq::"+strseq);
 //	alert("stratcode"+stratcode+"stratkornam"+stratkornam+"strfsrefval"+strfsrefval+"strfsrvalnm"+strfsrvalnm);
	strURL = "./Commrepay_popup.html";
	strPos = "dialogWidth:878px;dialogHeight:490px;dialogTop:220px;dialogLeft:128px;status:no;scroll:no;resizable:no";

	//result = showModalDialog(strURL,arrParam,strPos);
	result = showModalDialog(strURL,window,strPos);


  //alert("result:"+result);
	if (result != null) {
		arrResult = result.split(";");;
	  
		//alert("0::"+ arrResult[0]);
		//alert("1::"+ arrResult[1]);
		//alert("2::"+ arrResult[2]);

		//eval("hid_banjaeyn"+temprow).value = arrResult[2]; 
		////////////////g_strbanjae=arrResult[2];

		//alert("hid_banjaeyn::"+ eval("hid_banjaeyn"+temprow).value);
		if(arrResult[0]!=0){         //차변이 0이 아닐 경우 대변 금액
			eval("gcem_daeamt"+temprow).text=arrResult[0];
			ln_Ref_lock('','3',temprow);
		}else if(arrResult[1]!=0){   //대변이 0이 아닐 경우 차변 금액
			eval("gcem_chaamt"+temprow).text=arrResult[1];
			ln_Ref_lock('','3',temprow);
		}

		_out3:
		for(j=1;j<=3;j++){
			for(k=1;k<=3;k++) {
				if(eval("txt_fsrefcd"+temprow+j+k).value==arrResult[2]){
					 eval("txt_fsrefval"+temprow+j+k).value=arrResult[3];
					 eval("txt_fsrvalnm"+temprow+j+k).value=arrResult[4];
					 break _out3;
				}
			}//k	
		}//j

		eval("chkbox"+temprow).checked =false;
		temprow="";
		 
	}else{
	  eval("gcem_chaamt"+temprow).text=0;
    eval("gcem_daeamt"+temprow).text=0;
		//eval("hid_banjaeyn"+temprow).value ="N";
		g_strbanjae="N";
		temprow="";
	}

  //금액
	i=0;
	chaamt=0;
	daeamt=0;
	for(i=1;i<=g_row;i++){			  
		if(eval("hid_flag"+i+"0").value=="T"){
			if (eval("gcem_chaamt"+i).text=="") eval("gcem_chaamt"+i).text=0;
			if (eval("gcem_daeamt"+i).text=="") eval("gcem_daeamt"+i).text=0;
			chaamt += parseInt(eval("gcem_chaamt"+i).text);
			daeamt += parseInt(eval("gcem_daeamt"+i).text);
		}
	}
	parent.ln_Sum_Amt(chaamt,daeamt);


	//alert("반제끝");
}

/******************************************************************************
	Description : seqno의 자리수를 설정
	parameter   : p1 - 현재숫자, p2 - 자리수
******************************************************************************/
/*********88
function ln_Seqno_Format(p1,p2){
  var seq="0";
	if (p2==5){
		if (p1>=1&&p1<10) seq="0000"+p1;
		if (p1>=10&&p1<100) seq="000"+p1;
		if (p1>=100&&p1<1000) seq="00"+p1;
		if (p1>=1000&&p1<10000) seq="0"+p1;
		if (p1>=10000&&p1<100000) seq=p1;
	}else if (p2==2){
		if (p1>=1&&p1<10) seq="0"+p1;
		if (p1>=10&&p1<100) seq=p1;
	}

	return seq;
}
*******/


/******************************************************************************
	Description : 포커서 변경 발생
	parameter   : p1 - 구분
	              p2 - object 
								p3 - 위치
******************************************************************************/
function ln_onblur(p1,p2,p3){
   var chaamt=0;
	 var daeamt=0;
	 var no="";

	 ln_Atcode_Amt_Chk(p3); //비용수익체크
	
	 if (p1=="01"){
			for(i=1;i<=g_row;i++){			  
				if(eval("hid_flag"+i+"0").value=="T"){
					if (eval("gcem_chaamt"+i).text=="") eval("gcem_chaamt"+i).text=0;
					if (eval("gcem_daeamt"+i).text=="") eval("gcem_daeamt"+i).text=0;
					chaamt += parseInt(eval("gcem_chaamt"+i).text);
					daeamt += parseInt(eval("gcem_daeamt"+i).text);
				}
			}
			parent.ln_Sum_Amt(chaamt,daeamt);

			//object가 차변금액일 경우 예산부서가 존재하면 예산잔액과 비교함.
			if(p2=="gcem_chaamt"){
					var no1=ln_Bgt_position_find(p3); //예산부서위치
					var no2=ln_Bgt_Detail_find(p3);   //세목위치

					if(eval("hid_bgtcnt"+p3).value!=0){ //예산계정이 세목이 존재하는 경우
						if((no1!=""&&no1!=undefined)&&(no2!=""&&no2!=undefined)){
							if(eval("txt_fsrefval"+no1).value!="" &&eval("txt_fsrefval"+no2).value!="" ){
							  //alert("test");
								//ln_Bgt_Amt_find('','','',p3);
								if(Number(eval("gcem_chaamt"+p3).text)>Number(parent.gcem_janamt.text)){
									/////alert("입력하신 금액이 예산 잔액금액보다 많습니다.");
									/////eval("gcem_chaamt"+p3).text=0;
									return;
								}
							}
						}
					}else if(eval("hid_bgtcmtype"+p3).value!=""&&eval("hid_bgtcnt"+p3).value==0){ //예산계정이 세목이 존재하지 않을 경우
            if(no1!=""&&no1!=undefined){
							if(eval("txt_fsrefval"+no1).value!=""){
							  //alert("test1");
								//ln_Bgt_Amt_find('','','',p3);
								if(Number(eval("gcem_chaamt"+p3).text)>Number(parent.gcem_janamt.text)){
									/////alert("입력하신 금액이 예산 잔액금액보다 많습니다.");
									////eval("gcem_chaamt"+p3).text=0;
									return;
								}
							}
						}
			   	}
			}
	 }else if(p1=="02"){
			for(i=1;i<=g_row;i++){
				if(eval("hid_flag"+i+"0").value=="T"){
					parent.ln_remark(eval("txt_remark"+i).value);
					break;
				}
			}
	 }

   //관리항목 마지막에서 Enter 시 새로운 라인 추가
	 //if(event.keyCode!=113) return;
}

/******************************************************************************
	Description : 미결전표 Detail 및 관리항목, 증빙구분 format 설정 
	parameter   : row - record 갯수
	     참고   : hid_flag_sel - S 조회시   A 추가 
******************************************************************************/
function ln_SetFormat(row){
 
  //alert("ln_SetFormat+ row :;" + row);
  var ls_html="";
	var p =0;
	var strbgcolor="";
	var strTF="";
	var ino1=0,ino2=0,ino3=0; //관리항목 번호
	var strdisplay="block";
	var strFlag="T";
	//var strFsseq="00000"
  //div1.innerHTML=ls_html; 
	
  if (row<1) return ; 

	for(i=1;i<=row;i++){
		p = i%2;
		if (p==0) strbgcolor = "";
		else if (p==1) strbgcolor = "";
   
		//조회시 모든 항목이 수정 안되게 함. 계정코드를 더블클릭시 색깔 변경하면서 수정 가능하게 함.
		strTF = "true"; //readonly
		//if (g_yn =="Y") strTF = true; //readonly
		//else  strTF = false;

		//strFsseq = ln_Seqno_Format(i,5);
		//alert("strFsseq"+strFsseq);

		if (i!=1){  //두번째 라인 상단부터 줄을 긋는다
		  //alert("ll"+i);
		  ls_html +="<table id=l"+i+" width=857px cellpadding=0 cellspacing=0 border=0 style=position:relative;left:0px>";
			ls_html +="	<tr>"
			ls_html +="		<td width=857px  height=2px bgcolor=#D7959D align=center colspan=8>";	
			ls_html +="	</tr>";
      ls_html +="</table>";
		}
    
		ls_html  +="<table id=t"+i+"0 width=857px cellpadding=0 cellspacing=0 border=0 style=position:relative;left:0px>";
		ls_html +="	<tr>";			
		ls_html +="		<td width=15px    align=center class=tab13 >";
    		//ls_html +="			<input type=hidden  id=hid_banjaeyn"+i+"  value='N'>";   
		ls_html +="			<input type=hidden  id=hid_banjaeref"+i+"  value='"+gcds_data01.namevalue(i,"BANJAEREF")+"'>"; 
    ls_html +="			<input type=hidden  id=hid_funddiv"+i+"    value='"+gcds_data01.namevalue(i,"FUNDDIV")+"'>"; 
    ls_html +="			<input type=hidden  id=hid_cnt_bf"+i+"     value='0'>"; 
		ls_html +="			<input type=hidden  id=hid_bgtcnt"+i+"     value=''>";
		ls_html +="			<input type=hidden  id=hid_bgtcmtype"+i+"  value=''>";		
		ls_html +="			<input type=hidden  id=hid_atdecr"+i+"  value=''>";
		ls_html +="			<input type=hidden  id=hid_atdebtyn"+i+"  value=''>";
		ls_html +="			<input type=hidden  id=hid_flag_del"+i+"  value='N'>";
		ls_html +="			<input type=hidden  id=row   value="+i+">";
		ls_html +="			<input type=hidden  id=hid_flag"+i+"0  value='T'>";
		ls_html +="			<input type=hidden  id=hid_flag_sel"+i+"0  value='S'>";
		ls_html +="			<input type=hidden  id=hid_fsseq"+i+"    value='"+gcds_data01.namevalue(i,"FSSEQ")+"' >";
		ls_html +="			<input type=hidden  id=cnt"+i+"    value='"+gcds_data01.namevalue(i,"CNT")+"' >";
		ls_html +="			<input type=hidden  id=hid_divcd"+i+"    value='"+gcds_data01.namevalue(i,"DIVCD")+"' >";
		ls_html +="			<input type=hidden  id=hid_bgtdiv"+i+"   value='"+gcds_data01.namevalue(i,"BGTDIV")+"' >";
    
		//예산관련 수정전 데이타====>
    ls_html +="			<input type=hidden  id=hid_Bbgtdiv"+i+"    value='"+gcds_data01.namevalue(i,"BGTDIV")+"' >";
		ls_html +="			<input type=hidden  id=hid_Bbgtdpt"+i+"    value='' >";
		ls_html +="			<input type=hidden  id=hid_Batcode"+i+"    value='"+gcds_data01.namevalue(i,"ATCODE")+"' >";
		ls_html +="			<input type=hidden  id=hid_Bfsrefcd"+i+"   value='' >";
		ls_html +="			<input type=hidden  id=hid_Bsatcode"+i+"   value='' >";
		ls_html +="			<input type=hidden  id=hid_Bfswrkdiv"+i+"  value='"+gcds_data01.namevalue(i,"FSWRKDIV")+"' >";
		ls_html +="			<input type=hidden  id=hid_Bchaamt"+i+"    value='"+gcds_data01.namevalue(i,"CHAAMT")+"' >";
	  ///<=========================
		ls_html +="			<input type=checkbox  id=chkbox"+i+"  style=width:15px;position:relative;top:-3px;  onclick=ln_position('"+i+"','chk')>";
		ls_html +="   </td>";  

    ls_html +="		<td width=25px    align=center class=tab19 >";
		ls_html +="		  <input type=text  id=txt_fsnum"+i+"  value='"+gcds_data01.namevalue(i,"FSNUM")+"' style=width:21px;heigth:18px;position:relative;top:0px; onclick=ln_position('"+i+"','')   maxlength=2 >";
		ls_html +="   </td>";

		ls_html +="		<td width=49px    align=center class=tab20>";
		ls_html +="			<input type=text  class=txt41 id=txt_atcode"+i+"   value='"+gcds_data01.namevalue(i,"ATCODE")+"'    style=width:47px;height:18px; readOnly="+strTF+"; maxlength=7; onclick=ln_position('"+i+"','ATCODE')>";
		ls_html +="   </td>";
		
		ls_html +="	  <td width=148px     align=center class=tab20 >";
		ls_html +="			<input type=text  class=txt41 id=txt_atkornam"+i+" value='"+gcds_data01.namevalue(i,"ATKORNAM")+"'  style=width:146px;height:18px; readOnly="+strTF+"; onkeydown=ln_Popup('01','txt_atkornam','"+i+"'); onclick=ln_position('"+i+"')>";
		ls_html +="   </td>";
		
		ls_html +="		<td width=90px  align=center  class=tab20 >";
	//<comment id='__NSID__'> 
	/*
    ls_html +="   <comment id='__NOSCRIPT_ID__'> ";
		ls_html +="	    <span id =chaamt></span> ";
		ls_html +="   </comment><SCRIPT>__ShowEmbedObject(__NOSCRIPT_ID__)<\/SCRIPT> ";
  */
		ls_html +="   <object  id='gcem_chaamt"+i+"' class=txt41 classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F  style=color:#0000ff;position:relative;left:0px;width:85px;height:16px; onfocus=ln_position('"+i+"')  onblur=ln_onblur('01','gcem_chaamt','"+i+"')>";				
		ls_html +="				<param name=Text			     value='"+gcds_data01.namevalue(i,"CHAAMT")+"'> ";
		ls_html +="       <param name=Border         value=false>";
		ls_html +="				<param name=Alignment		   value=2>";
		ls_html +="				<param name=Numeric			   value=true>";
		ls_html +="				<param name=IsComma			   value=true>";
		ls_html +="				<param name=MaxLength		   value=12>";
	  ls_html +="       <param name=ReadOnly       value='"+strTF+"'>";
		ls_html +="       <param name=InheritColor   value=true>";
		ls_html +="       <param name=SelectAll      value=true>";
	  ls_html +="       <param name=ReadOnlyForeColor   value=#0000FF>";
  //ls_html +="       <param name=ReadOnlyBackColor   value="+strbgcolor+"> "; 
		ls_html +="			</object> ";
	//</comment><script>__ws__(__NSID__);<\/script>
		ls_html +="			 ";
		ls_html +="    </td>";
		
		ls_html +="		<td width=90px   align=center  class=tab20  >";
		ls_html +="    <object  id=gcem_daeamt"+i+"  class=txt41 classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F  style=color:#ff0000;position:relative;left:0px;width:85px;height:16px; onfocus=ln_position('"+i+"') onblur=ln_onblur('01','gcem_daeamt','"+i+"') >";				
		ls_html +="				<param name=Text			     value='"+gcds_data01.namevalue(i,"DAEAMT")+"'> ";
		ls_html +="       <param name=Border         value=>";
		ls_html +="				<param name=Alignment		   value=2>";
		ls_html +="				<param name=Numeric			   value=true>";
		ls_html +="				<param name=IsComma			   value=true>";
		ls_html +="				<param name=MaxLength		   value=12>";
		ls_html +="       <param name=ReadOnly       value='"+strTF+"'>";
	//	ls_html +="       <param name=InheritColor   value=true>";
	  ls_html +="       <param name=SelectAll      value=true>";
		ls_html +="       <param name=ReadOnlyForeColor   value=#FF0000>";
		ls_html +="			</object> ";
		ls_html +="    </td>";

		ls_html +="		<td width=125px   align=center  class=tab20 ><nobr>";
		//ls_html +="			<input type=text class=txt41 id=txt_01 style=width:79px;height:19px;background-color:'"+strbgcolor+"';>";
		ls_html +="  <select disabled class=txt41 id=sel_documcd"+i+"  style=position:relative;left:0px;top:0px;font-size:12px;width:110px;  onclick='Select_onclick("+i+")'   onchange=ln_Sel_change("+i+",'')>";
		ls_html +="  	<option value=000> </option>";
		for(h=1;h<=gcds_documcd.countrow;h++){
			ls_html +=" <option value="+gcds_documcd.namevalue(h,"CDCODE")+">"+gcds_documcd.namevalue(h,"CDNAM")+" </option>";
		}
		ls_html +="  </select>";
    ls_html +="	<img src='../img/plus.gif' value='plus2.gif' id=img_plus1  onclick=ln_Popup_Tax('"+i+"','"+gcds_data01.namevalue(i,"FDCODE")+"','"+gcds_data01.namevalue(i,"FSDAT")+"','"+gcds_data01.namevalue(i,"FSNBR")+"','"+gcds_data01.namevalue(i,"FSSEQ")+"') style=position:relative;width:16px;left:-1px;top:2px;cursor:hand;>";
		ls_html +="	 <input type=hidden id=txt_documcd"+i+" value=''>"; 
		ls_html +="	 <input type=hidden id=hid_docuval"+i+" value='"+gcds_data01.namevalue(i,"DOCUVAL")+"' >";
		ls_html +="   </nobr></td>";

		ls_html +="		<td width=252px  align=center  class=tab20 >";
		ls_html +="			<input type=text class=txt41 id=txt_remark"+i+" value='"+gcds_data01.namevalue(i,"REMARK")+"'  style=width:242px;height:18px; readOnly='"+strTF+"' maxlength='33'; onclick=ln_position('"+i+"') onblur = ln_onblur('02','','"+i+"')>";
		ls_html +="   </td>";
		ls_html +="		<td width=62px  align=center  class=tab20 >";
		ls_html +="    <select disabled class=txt41 id=sel_fswrkdiv"+i+" style=position:relative;left:0px;top:0px;font-size:12px;width:59px;   onclick='Select_onclick("+i+")'  onchange=ln_Sel_change("+i+",'FSWRKDIV')>";
		for(h=1;h<=gcds_fswrkdiv.countrow;h++){
			ls_html +="  	<option value="+gcds_fswrkdiv.namevalue(h,"CDCODE")+">"+gcds_fswrkdiv.namevalue(h,"CDNAM")+" </option>";
	  }
		ls_html +="    </select>";
    ls_html +="   </td>";

		ls_html +="  </tr>";
		ls_html +="</table>";
	 
		var cnt = gcds_data01.namevalue(i,"CNT");
		//alert("cnt"+cnt);
		var xcnt=0;
		if (cnt==0||cnt==1|| cnt==2||cnt==3) xcnt=1;
		else if(cnt==4|| cnt==5||cnt==6)xcnt=2;
		else if(cnt==7|| cnt==8||cnt==9)xcnt=3
		else xcnt =1
    
		for (j=1;j<=3;j++){
      ino1 = 1+(j-1)*3;
			ino2 = 2+(j-1)*3;
			ino3 = 3+(j-1)*3;

			if (j>xcnt){
				strdisplay="none";
				strFlag="F";
			}else {
				strdisplay="block";
				strFlag="T";
			}

			//alert("j"+j+"strdisplay"+strdisplay);
			//alert("i::"+i+"::j::"+j+"1_FSREFSEQ0"+ino1+"::"+gcds_data01.namevalue(i,"FSREFSEQ0"+ino1));
			//alert("i::"+i+"::j::"+j+"2_FSREFSEQ0"+ino1+"::"+gcds_data01.namevalue(i,"FSREFSEQ0"+ino2));
			//alert("i::"+i+"::j::"+j+"3_FSREFSEQ0"+ino1+"::"+gcds_data01.namevalue(i,"FSREFSEQ0"+ino3));

      ls_html +="<table id=t"+i+""+j+" width=857px cellpadding=0 cellspacing=0 border=0 style=position:relative;left:0px;display:"+strdisplay+">";
			ls_html +="				<tr>";			
			ls_html +="					<td width=88px       class=tab20 align=center >";
			ls_html +="			      <input type=hidden  id=hid_flag"+i+""+j+"   value="+strFlag+">";
			
			ls_html +="						<input type=hidden  id=txt_fsrefseq"+i+j+"1 value='"+gcds_data01.namevalue(i,"FSREFSEQ0"+ino1)+"'>"; 	    
			ls_html +="						<input type=text    class=txt41 id=txt_fsrefnm"+i+j+"1 value='"+gcds_data01.namevalue(i,"FSREFNM0"+ino1)+"'  disabled style=width:88px;height:19px; onclick=ln_position('"+i+"') >"; 	
			ls_html +="						<input type=hidden  id=txt_fsrefcd"+i+j+"1 value='"+gcds_data01.namevalue(i,"FSREFCD0"+ino1)+"'>"; 	    
			ls_html +="						<input type=hidden  id=hid_type"+i+j+"1 value='"+gcds_data01.namevalue(i,"TYPE0"+ino1)+"' >";
			ls_html +="						<input type=hidden  id=hid_typeBf"+i+j+"1 value='"+gcds_data01.namevalue(i,"TYPE0"+ino1)+"' >";
			ls_html +="						<input type=hidden  id=hid_arbaldiv"+i+j+"1 value='"+gcds_data01.namevalue(i,"ARBALDIV0"+ino1)+"' >";
			//예산관련 수정전 데이타====>
      ls_html +="						<input type=hidden id=hid_fsrefcd"+i+j+"1  value='"+gcds_data01.namevalue(i,"FSREFCD0"+ino1)+"'>"; 	    
      ls_html +="						<input type=hidden id=hid_fsrefval"+i+j+"1 value='"+gcds_data01.namevalue(i,"FSREFVAL0"+ino1)+"' >";
			ls_html +="						<input type=hidden id=hid_fsrefcd"+i+j+"2  value='"+gcds_data01.namevalue(i,"FSREFCD0"+ino2)+"'>"; 	    
      ls_html +="						<input type=hidden id=hid_fsrefval"+i+j+"2 value='"+gcds_data01.namevalue(i,"FSREFVAL0"+ino2)+"' >";
			ls_html +="						<input type=hidden id=hid_fsrefcd"+i+j+"3  value='"+gcds_data01.namevalue(i,"FSREFCD0"+ino3)+"'>"; 	    
      ls_html +="						<input type=hidden id=hid_fsrefval"+i+j+"3 value='"+gcds_data01.namevalue(i,"FSREFVAL0"+ino3)+"' >";
			//<==========================
			ls_html +="				  </td>";

			ls_html +="					<td width=147px    class=tab20 align=center >";
			ls_html +="						<input type=text class=txt41 id=txt_fsrvalnm"+i+j+"1 value='"+gcds_data01.namevalue(i,"FSRVALNM0"+ino1)+"' style=color:#990000;width:147px;height:19px; readOnly=true;  onkeydown=ln_Popup2('txt_fsrefcd"+i+j+"1','txt_fsrvalnm','"+i+j+"','1',"+i+"); onclick=ln_position('"+i+"') ; onblur =ln_type_blur('txt_fsrefcd"+i+j+"1','hid_type','"+i+j+"','1','"+i+"');>";
			ls_html +="						<input type=hidden  id=txt_fsrefval"+i+j+"1 value='"+gcds_data01.namevalue(i,"FSREFVAL0"+ino1)+"' >";
			ls_html +="					</td>";

			ls_html +="					<td width=91px        class=tab20 align=center >";
			ls_html +="						<input type=hidden  id=txt_fsrefseq"+i+j+"2 value='"+gcds_data01.namevalue(i,"FSREFSEQ0"+ino2)+"'>"; 	    
			ls_html +="						<input type=text    class=txt41 id=txt_fsrefnm"+i+j+"2  value='"+gcds_data01.namevalue(i,"FSREFNM0"+ino2)+"' disabled style=width:86px;height:19px;  onclick=ln_position('"+i+"') >";
			ls_html +="						<input type=hidden  id=txt_fsrefcd"+i+j+"2  value='"+gcds_data01.namevalue(i,"FSREFCD0"+ino2)+"' >";
			ls_html +="						<input type=hidden  id=hid_type"+i+j+"2 value='"+gcds_data01.namevalue(i,"TYPE0"+ino2)+"' >";
			ls_html +="						<input type=hidden  id=hid_typeBf"+i+j+"2 value='"+gcds_data01.namevalue(i,"TYPE0"+ino2)+"' >";
			ls_html +="						<input type=hidden  id=hid_arbaldiv"+i+j+"2 value='"+gcds_data01.namevalue(i,"ARBALDIV0"+ino2)+"' >";
			ls_html +="				  </td>";

			ls_html +="					<td width=221px      class=tab20 align=center  >";
			ls_html +="						<input type=text   class=txt41 id=txt_fsrvalnm"+i+j+"2  value='"+gcds_data01.namevalue(i,"FSRVALNM0"+ino2)+"' style=position:relative;left:0px;color:#990000;width:217px;height:19px; readOnly="+strTF+"; onkeydown=ln_Popup2('txt_fsrefcd"+i+j+"2','txt_fsrvalnm','"+i+j+"','2',"+i+"); onclick=ln_position('"+i+"'); onblur =ln_type_blur('txt_fsrefcd"+i+j+"2','hid_type','"+i+j+"','2','"+i+"')>";
			ls_html +="						<input type=hidden  id=txt_fsrefval"+i+j+"2  value='"+gcds_data01.namevalue(i,"FSREFVAL0"+ino2)+"'>";
			ls_html +="					</td>";

			ls_html +="					<td width=90px        class=tab20 align=center >";
			ls_html +="						<input type=hidden  id=txt_fsrefseq"+i+j+"3 value='"+gcds_data01.namevalue(i,"FSREFSEQ0"+ino3)+"'>"; 	    
			ls_html +="						<input type=text    class=txt41 id=txt_fsrefnm"+i+j+"3 value='"+gcds_data01.namevalue(i,"FSREFNM0"+ino3)+"'  disabled  style=width:78px;height:19px; onclick=ln_position('"+i+"')>";
			ls_html +="						<input type=hidden  id=txt_fsrefcd"+i+j+"3 value='"+gcds_data01.namevalue(i,"FSREFCD0"+ino3)+"'  >";
			ls_html +="						<input type=hidden  id=hid_type"+i+j+"3 value='"+gcds_data01.namevalue(i,"TYPE0"+ino3)+"' >";
			ls_html +="						<input type=hidden  id=hid_typeBf"+i+j+"3 value='"+gcds_data01.namevalue(i,"TYPE0"+ino3)+"' >";
			ls_html +="						<input type=hidden  id=hid_arbaldiv"+i+j+"3 value='"+gcds_data01.namevalue(i,"ARBALDIV0"+ino3)+"' >";
			ls_html +="				  </td>";

			ls_html +="					<td width=284px      class=tab20 align=center >";	
			ls_html +="						<input type=text   class=txt41 id=txt_fsrvalnm"+i+j+"3 value='"+gcds_data01.namevalue(i,"FSRVALNM0"+ino3)+"' style=position:relative;left:-18px;color:#990000;width:185px;height:19px; readOnly="+strTF+"; onkeydown=ln_Popup2('txt_fsrefcd"+i+j+"3','txt_fsrvalnm','"+i+j+"','3',"+i+"); onclick=ln_position('"+i+"'); onblur =ln_type_blur('txt_fsrefcd"+i+j+"3','hid_type','"+i+j+"','3','"+i+"') >";
			ls_html +="						<input type=hidden id=txt_fsrefval"+i+j+"3 value='"+gcds_data01.namevalue(i,"FSREFVAL0"+ino3)+"' >";
			ls_html +="					</td>";
			ls_html +="				</tr>";	
		
			ls_html +="</table>";
		} //for j
  } //for i
  //prompt("", ls_html);
	//div1.innerHTML=ls_html;  
	__ws3__(div1,ls_html);

	g_row = row;
	g_seq=Number(gcds_data01.Max(4,0,0));  //fsseq
	
	for(i=1;i<=g_row;i++){
	  eval("sel_documcd"+i).value = gcds_data01.namevalue(i,"DOCUMCD");
		eval("sel_fswrkdiv"+i).value = gcds_data01.namevalue(i,"FSWRKDIV");
		var no1 =ln_Bgt_position_find(i); //예산부서 위치찾기
		var no2 =ln_Bgt_Detail_find(i);   //세목위치 찾기
		if((no1!=""&&no1!=undefined)&&(no2!=""&&no2!=undefined)){
			eval("hid_Bbgtdpt"+i).value = eval("txt_fsrefval"+no1).value;  //예산부서         
			eval("hid_Bfsrefcd"+i).value = eval("txt_fsrefcd"+no2).value;  //관리항목코드  

			//예산관리항목이 예산부서이면 세목은 00
			if(eval("txt_fsrefcd"+no2).value=="0003"){
				eval("hid_Bsatcode"+i).value="00";
			}else{
				eval("hid_Bsatcode"+i).value = eval("txt_fsrefval"+no2).value; //세목 
			}
		}
	}
}

/******************************************************************************
	Description : 전표 신규 등록시 
	parameter   : gubun - 'new' : 신규등록
	                      'add' : 추가등록
	              row - 라인갯수
								gubun2 - 'Tax' - 세금계산서 추가
******************************************************************************/
function ln_SetFormat_add(gubun, row, gubun2){

	//alert("ln_SetFormat_add :: row::"+row);
  //alert("gubun"+gubun);
	var strbgcolor="";
  var ls_html="";
  var bggubun =ln_bgcolor(row-1);
	var i=row;
	var strdisplay="block";
	var strFlag="T";

	if(bggubun==1)strbgcolor="";
	else strbgcolor="";

	if (gubun =='new'){
	  g_row=0;
		g_seq=0;
		g_fsnum="";
		ln_SetDataHeader("DTL");
		ln_Clear();
	}else if (gubun =='add' && row!=1) { //추가이면서 두번째 이상 레코드는 라인부터 작성
		ln_line_Add(0,g_row,1,'');
	}else if (gubun =='load'){
		//div1.innerHTML="";
		__ws2_Clear__(div1);
		g_seq=0;
		g_fsnum="";
		return
	}

		ls_html +="<table id=t"+i+"0 width=857px cellpadding=0 cellspacing=0 border=0 style=position:relative;left:0px>";
		ls_html +="	<tr>";			
		ls_html +="		<td width=15px    align=center class=tab13 >";
	//ls_html +="			<input type=hidden  id=hid_banjaeyn"+i+"  value='N'>";
	  ls_html +="			<input type=hidden  id=hid_banjaeref"+i+"   value=''>"; 
	  ls_html +="			<input type=hidden  id=hid_funddiv"+i+"   value=''>"; 
  	ls_html +="			<input type=hidden  id=hid_cnt_bf"+i+"    value='0'>"; 
	  ls_html +="			<input type=hidden  id=hid_bgtcnt"+i+"    value=''>";
		ls_html +="			<input type=hidden  id=hid_bgtcmtype"+i+"    value=''>";
	  ls_html +="			<input type=hidden  id=hid_atdecr"+i+"    value=''>";
		ls_html +="			<input type=hidden  id=hid_atdebtyn"+i+"  value=''>";
		ls_html +="			<input type=hidden  id=hid_flag_del"+i+"  value='N'>";
		ls_html +="			<input type=hidden  id=row  value="+i+">";
		ls_html +="			<input type=hidden  id=hid_flag"+i+"0    value='T'>";
		ls_html +="			<input type=hidden  id=hid_flag_sel"+i+"0  value='A'>";
		ls_html +="			<input type=hidden  id=hid_fsseq"+i+"    value='' >";
		ls_html +="			<input type=hidden  id=cnt"+i+"          value='' >";
		ls_html +="			<input type=hidden  id=hid_divcd"+i+"    value='' >";
		ls_html +="			<input type=hidden  id=hid_Bchaamt"+i+"  value='' >";
		ls_html +="		  <input type=hidden  id=hid_bgtdiv"+i+"   value='' >";
		ls_html +="			<input type=checkbox  id=chkbox"+i+"   style=width:15px;position:relative;top:-3px; onclick=ln_position('"+i+"','')>";
		ls_html +="   </td>";
		
		ls_html +="		<td width=25px    align=center class=tab19 >";
		ls_html +="		  <input type=text  id=txt_fsnum"+i+"  value='' style=width:21px;heigth:18px;position:relative;top:0px; onclick=ln_position('"+i+"','')   maxlength=2 >";
		ls_html +="   </td>";

		ls_html +="		<td width=49px    align=center class=tab20 >";
		ls_html +="			<input type=text  class=txt41 id=txt_atcode"+i+" value=''  style=width:47px;height:18px;   maxlength=7; onkeydown=ln_Popup_Find('01','txt_atcode','"+i+"'); onclick=ln_position('"+i+"')>";
		ls_html +="   </td>";
		
		ls_html +="	  <td width=148px     align=center class=tab20 >";
		ls_html +="			<input type=text   class=txt41 id=txt_atkornam"+i+" value='' style=width:146px;height:18px;ime-mode:active; onkeydown=ln_Popup('01','txt_atkornam','"+i+"'); onclick=ln_position('"+i+"')>";
		ls_html +="   </td>";
		
		ls_html +="		<td width=90px  align=center  class=tab20 >";
		ls_html +="    <object  id=gcem_chaamt"+i+" class=txt41 classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F  style=color:#0000ff;position:relative;left:0px;width:85px;height:16px; onfocus=ln_position('"+i+"'); onblur=ln_onblur('01','gcem_chaamt','"+i+"') >";				
		ls_html +="				<param name=Text			     value=0> ";
		ls_html +="       <param name=Border         value=false>";
		ls_html +="				<param name=Alignment		   value=2>";
		ls_html +="				<param name=Numeric			   value=true>";
		ls_html +="				<param name=IsComma			   value=true>";
		ls_html +="				<param name=MaxLength		   value=12>";
		//ls_html +="       <param name=ReadOnly       value=true>";
		ls_html +="       <param name=SelectAll      value=true>";
		ls_html +="       <param name=InheritColor   value=true>";
		ls_html +="       <param name=ReadOnlyForeColor   value=#0000FF>";
		ls_html +="			</object> ";                
		ls_html +="    </td>";
		
		ls_html +="		<td width=90px   align=center  class=tab20 >";
		ls_html +="    <object  id=gcem_daeamt"+i+"  class=txt41 classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F  style=color:#ff0000;position:relative;left:0px;width:85px;height:16px; onfocus=ln_position('"+i+"');  onblur=ln_onblur('01','gcem_daeamt','"+i+"')>";				
		ls_html +="				<param name=Text			     value=0> ";
		ls_html +="       <param name=Border         value=false>";
		ls_html +="				<param name=Alignment		   value=2>";
		ls_html +="				<param name=Numeric			   value=true>";
		ls_html +="				<param name=IsComma			   value=true>";
		ls_html +="				<param name=MaxLength		   value=12>";
		//ls_html +="       <param name=ReadOnly       value=true>";
		ls_html +="       <param name=SelectAll      value=true>";
		ls_html +="       <param name=InheritColor   value=true>";
		ls_html +="       <param name=ReadOnlyForeColor   value=#FF0000>";
		ls_html +="			</object> ";
		ls_html +="  </td>";
		
		ls_html +="	 <td width=125px   align=center  class=tab20><nobr>";
  	ls_html +="  <select class=txt41 id=sel_documcd"+i+"  style=disabled:false;position:relative;left:0px;top:0px;font-size:12px;width:110px; onclick='Select_onclick("+i+")'  onchange=ln_Sel_change("+i+",'')>";
	  ls_html +="  	<option value=000> </option>";

		for(h=1;h<=gcds_documcd.countrow;h++){
			ls_html +=" <option value="+gcds_documcd.namevalue(h,"CDCODE")+">"+gcds_documcd.namevalue(h,"CDNAM")+" </option>";
	  }
    ls_html +="  </select>";
		ls_html +="	 <img src='../img/plus.gif' value='plus2.gif' id=img_plus1 onclick=ln_Popup_Tax('"+i+"','','"+parent.gcem_fsdat02.text+"','','') style=position:relative;width:16px;left:-3px;top:2px;cursor:hand;>";
		ls_html +="	 <input type=hidden  id=txt_documcd"+i+" value='' >"; 
		ls_html +="	 <input type=hidden  id=hid_docuval"+i+" value='' >";
		ls_html +="  </nobr></td>";                         
		
		ls_html +="	 <td width=252px  align=center  class=tab20 >";
		ls_html +="			<input type=text class=txt41 id=txt_remark"+i+" value=''  style=width:242px;height:18px;ime-mode:active; maxlength='33'; onclick=ln_position('"+i+"'); onblur = ln_onblur('02','','"+i+"')>";
		ls_html +="  </td>";
		
		ls_html +="	 <td width=62px  align=center  class=tab20 >";
		ls_html +="    <select  class=txt41 id=sel_fswrkdiv"+i+" style=position:relative;left:0px;top:0px;font-size:12px;width:59px;  onclick='Select_onclick("+i+")' onchange=ln_Sel_change("+i+",'FSWRKDIV')>";
		for(h=1;h<=gcds_fswrkdiv.countrow;h++){
			ls_html +="  	<option value="+gcds_fswrkdiv.namevalue(h,"CDCODE")+">"+gcds_fswrkdiv.namevalue(h,"CDNAM")+" </option>";
	  }
		ls_html +="    </select>";
		ls_html +="   </td>";
		ls_html +="  </tr>";
		ls_html +="</table>";

		for (j=1;j<=3;j++){
			if (j>1){
				strdisplay="none";
				strFlag="F";
			}else {
				strdisplay="block";
				strFlag="T";
			}

			ls_html  +="<table id=t"+i+""+j+" width=857px cellpadding=0 cellspacing=0 border=0 style=position:relative;left:0px;display:"+strdisplay+">";
			ls_html +="				<tr>";			
			ls_html +="					<td width=88px       class=tab20 align=center >";
			ls_html +="			      <input type=hidden  id=hid_flag"+i+""+j+"  value="+strFlag+">";
			
			ls_html +="						<input type=hidden id=txt_fsrefseq"+i+j+"1 value='txt_fsrefseq"+i+j+"1'>"; 	    
			ls_html +="						<input type=text   class=txt41 id=txt_fsrefnm"+i+j+"1 value=''  disabled  style=width:88px;height:19px;  onclick=ln_position('"+i+"')>"; 	
			ls_html +="						<input type=hidden id=txt_fsrefcd"+i+j+"1 value=''>"; 	    
			ls_html +="						<input type=hidden  id=hid_type"+i+j+"1 value='' >";
			ls_html +="						<input type=hidden  id=hid_typeBf"+i+j+"1 value='' >";
			ls_html +="						<input type=hidden  id=hid_arbaldiv"+i+j+"1 value='' >";
		  //예산관련 수정전 데이타====>
      ls_html +="						<input type=hidden id=hid_fsrefcd"+i+j+"1  value=''>"; 	    
      ls_html +="						<input type=hidden id=hid_fsrefval"+i+j+"1 value='' >";
			ls_html +="						<input type=hidden id=hid_fsrefcd"+i+j+"2  value=''>"; 	    
      ls_html +="						<input type=hidden id=hid_fsrefval"+i+j+"2 value='' >";
			ls_html +="						<input type=hidden id=hid_fsrefcd"+i+j+"3  value=''>"; 	    
      ls_html +="						<input type=hidden id=hid_fsrefval"+i+j+"3 value='' >";
			//<==========================
			ls_html +="				  </td>";
			
			ls_html +="					<td width=147px    class=tab20 align=center >";
			ls_html +="						<input type=text class=txt41 id=txt_fsrvalnm"+i+j+"1 value=''  style=color:#990000;width:147px;height:19px;ime-mode:active; onkeydown=ln_Popup2('txt_fsrefcd"+i+j+"1','txt_fsrvalnm','"+i+j+"','1',"+i+"); onclick=ln_position('"+i+"'); onblur =ln_type_blur('txt_fsrefcd"+i+j+"1','hid_type','"+i+j+"','1','"+i+"');>";
			ls_html +="						<input type=hidden  id=txt_fsrefval"+i+j+"1 value='' >";
			ls_html +="					</td>";

			ls_html +="					<td width=91px      class=tab20 align=center >";
			ls_html +="						<input type=hidden id=txt_fsrefseq"+i+j+"2 value=''>"; 
			ls_html +="						<input type=text   class=txt41 id=txt_fsrefnm"+i+j+"2  value='' disabled style=width:86px;height:19px;  onclick=ln_position('"+i+"')>";
			ls_html +="						<input type=hidden id=txt_fsrefcd"+i+j+"2  value='' >";
			ls_html +="						<input type=hidden  id=hid_type"+i+j+"2 value='' >";
      ls_html +="						<input type=hidden  id=hid_typeBf"+i+j+"2 value='' >";
			ls_html +="						<input type=hidden  id=hid_arbaldiv"+i+j+"2 value='' >";
			ls_html +="				  </td>";
			
			ls_html +="					<td width=221px      class=tab20 align=center  >";
			ls_html +="						<input type=text   class=txt41 id=txt_fsrvalnm"+i+j+"2 value='' style=position:relative;left:0px;color:#990000;width:217px;height:19px;ime-mode:active; onkeydown=ln_Popup2('txt_fsrefcd"+i+j+"2','txt_fsrvalnm','"+i+j+"','2',"+i+"); onclick=ln_position('"+i+"'); onblur =ln_type_blur('txt_fsrefcd"+i+j+"2','hid_type','"+i+j+"','2','"+i+"')>";
			ls_html +="						<input type=hidden  id=txt_fsrefval"+i+j+"2 value=''>";
			ls_html +="					</td>";

			ls_html +="					<td width=90px       class=tab20 align=center >";
			ls_html +="						<input type=hidden id=txt_fsrefseq"+i+j+"3 value=''>"; 
			ls_html +="						<input type=text   class=txt41 id=txt_fsrefnm"+i+j+"3 value=''  disabled style=width:78px;height:19px; onclick=ln_position('"+i+"')>";
			ls_html +="						<input type=hidden id=txt_fsrefcd"+i+j+"3 value=''  >";
			ls_html +="						<input type=hidden  id=hid_type"+i+j+"3 value='' >";
			ls_html +="						<input type=hidden  id=hid_typeBf"+i+j+"3 value='' >";
			ls_html +="						<input type=hidden  id=hid_arbaldiv"+i+j+"3 value='' >";
			ls_html +="				  </td>";
			
			ls_html +="					<td width=284px      class=tab20 align=center >";	
			ls_html +="						<input type=text   class=txt41 id=txt_fsrvalnm"+i+j+"3 value='' style=position:relative;left:-18px;color:#990000;width:185px;height:19px;ime-mode:active; onkeydown=ln_Popup2('txt_fsrefcd"+i+j+"3','txt_fsrvalnm','"+i+j+"','3',"+i+"); onclick=ln_position('"+i+"'); onblur =ln_type_blur('txt_fsrefcd"+i+j+"3','hid_type','"+i+j+"','3','"+i+"')>";
			ls_html +="						<input type=hidden id=txt_fsrefval"+i+j+"3 value='' >";
			ls_html +="					</td>";
			ls_html +="				</tr>";	
			ls_html +="</table>";
	}

 //prompt("ls_html::",ls_html);
	if (gubun =='new'){
		//div1.innerHTML="";	
		__ws2_Clear__(div1);
		//div1.innerHTML=ls_html;  
		__ws3__(div1,ls_html);
		//예산관련
		parent.hid_cocode02.value="";
    parent.hid_actdat02.value="";
	}else if(gubun =='add'){
		///div1.innerHTML=div1.innerHTML+ls_html;
		__ws2__(div1,ls_html);

		//처음의 적요, 거래처, 부서를 자동으로 설정(증빙코드, 증빙값 추가) 
		//본부추가
		ln_Find_Remark();
     
		//alert("hid_docuval::"+eval("hid_docuval"+i).value);
		eval("sel_documcd"+i).value = g_documcd;
		eval("txt_documcd"+i).value = g_documcd;

		//증빙코드가 ''일경우 강제로 000
		if(eval("sel_documcd"+i).value==""&&eval("txt_documcd"+i).value==""){
      eval("sel_documcd"+i).value="000";
			eval("txt_documcd"+i).value="000";
		}

		if (gubun2=="Tax"){
			eval("hid_docuval"+i).value = g_docuval;
    }else{
			eval("hid_docuval"+i).value = "";
		}
		//alert("g_remark"+g_remark + "g_deptcd"+g_deptcd+ "g_deptnm"+g_deptnm+ "g_custcd"+g_custcd+ "g_custnm"+g_custnm); 
	  //ln_Insert_Remark(i);
	}

  g_seq = Number(g_seq)+1
	eval("hid_fsseq"+i).value=ln_Seqno_Format(g_seq,5); //전표행번호
	//순번적용
	eval("txt_fsnum"+i).value=ln_Fsnum_Find(i);  

  ln_position(i);//위치값지정

	
	eval("txt_atkornam"+i).focus();
	
}

/******************************************************************************
	Description : 전표순번 찾기
	parameter   : 
******************************************************************************/
function ln_Fsnum_Find(i){

  var temp =0; 
	//마지막을 찾아서 +1을 해서 구함.(전역변수 사용안함.)
  for(g=1;g<i;g++){
		if(eval("hid_flag_del"+g).value=="N"&&eval("hid_flag"+g+"0").value=="T"){
		  temp=eval("txt_fsnum"+g).value;
			//alert("temp"+temp);
			temp=Number(temp)+1;
			//alert("btemp"+temp);
		}
	}

	if (i==1)temp=i;
	return ln_Seqno_Format(Number(temp),3);
}

/******************************************************************************
	Description : 전표순번 재설정
	parameter   : 
	참고        : hid_flag_del N-수정  Y-삭제
	              hid_flag     T-보임, F-숨김
******************************************************************************/
function ln_Fsnum_Reset(){
  var temp =0; 
	//alert("g_row"+g_row);
  for(g=1;g<=g_row;g++){
		//if(eval("hid_flag_del"+g).value=="N"&&eval("hid_flag"+g+"0").value=="T"){
		if(eval("hid_flag"+g+"0").value=="T"){
			temp=Number(temp)+1;
			eval("txt_fsnum"+g).value=ln_Seqno_Format(Number(temp),3);
			//eval("chkbox"+g).checked=true;
			//ln_position(g,'chk','FSNUM');
		}
	}
	
}

/******************************************************************************
	Description : 전표등록시 계정 추가 할때 적요, 부서, 거래처 자동 가져오기
	              부서의 상위 본부 추가
								예산부서, 예산본부 추가
	parameter   : 
******************************************************************************/
function ln_Find_Remark(){
	//위치찾기
	var strDocumcd="";
	var strDocGB="";

	for(i=1;i<=g_row-1;i++){
		if(eval("hid_flag"+i+"0").value=="T"){
		 
			g_divcd=eval("hid_divcd"+i).value; //본부코드 복사

			if (g_remark==""){
				g_remark = eval("txt_remark"+i).value;
			}

			//일반증빙은 복사하지 않음.
			strDocumcd="";
	    strDocumcd=eval("sel_documcd"+i).value;
	    strDocGB=strDocumcd.substring(0,1);
			if(strDocGB="1"){
				if (g_documcd==""){
					g_documcd = eval("sel_documcd"+i).value;
					//g_documcd = eval("txt_documcd"+i).value;
				}

				if (g_docuval==""){
					g_docuval = eval("hid_docuval"+i).value;
				}
			}
			
			for(j=1;j<=3;j++){
			  //부서
				if(eval("txt_fsrefcd"+i+j+"1").value=="0002"){
           g_deptcd = eval("txt_fsrefval"+i+j+"1").value;
					 g_deptnm = eval("txt_fsrvalnm"+i+j+"1").value;
				}else if(eval("txt_fsrefcd"+i+j+"2").value=="0002"){
					 g_deptcd = eval("txt_fsrefval"+i+j+"2").value;
					 g_deptnm = eval("txt_fsrvalnm"+i+j+"2").value;
				}else if(eval("txt_fsrefcd"+i+j+"3").value=="0002"){
					 g_deptcd = eval("txt_fsrefval"+i+j+"3").value;
					 g_deptnm = eval("txt_fsrvalnm"+i+j+"3").value;
				}

        //거래처
				if(eval("txt_fsrefcd"+i+j+"1").value=="0020"){
           g_custcd = eval("txt_fsrefval"+i+j+"1").value;
					 g_custnm = eval("txt_fsrvalnm"+i+j+"1").value;
				}else if(eval("txt_fsrefcd"+i+j+"2").value=="0020"){
					 g_custcd = eval("txt_fsrefval"+i+j+"2").value;
					 g_custnm = eval("txt_fsrvalnm"+i+j+"2").value;
				}else if(eval("txt_fsrefcd"+i+j+"3").value=="0020"){
					 g_custcd = eval("txt_fsrefval"+i+j+"3").value;
					 g_custnm = eval("txt_fsrvalnm"+i+j+"3").value;
				}

   
        //예산부서
				if(eval("txt_fsrefcd"+i+j+"1").value=="0003"){
           g_bgtdept = eval("txt_fsrefval"+i+j+"1").value;
					 g_bgtdeptnm = eval("txt_fsrvalnm"+i+j+"1").value;
           g_bgtdiv = eval("hid_bgtdiv"+i).value;
				}else if(eval("txt_fsrefcd"+i+j+"2").value=="0003"){
					 g_bgtdept = eval("txt_fsrefval"+i+j+"2").value;
					 g_bgtdeptnm = eval("txt_fsrvalnm"+i+j+"2").value;
					 g_bgtdiv = eval("hid_bgtdiv"+i).value;
				}else if(eval("txt_fsrefcd"+i+j+"3").value=="0003"){
					 g_bgtdept = eval("txt_fsrefval"+i+j+"3").value;
					 g_bgtdeptnm = eval("txt_fsrvalnm"+i+j+"3").value;
					 g_bgtdiv = eval("hid_bgtdiv"+i).value;
				}
			} //for j
    }
	} //for i
}

/******************************************************************************
	Description : 전표등록시 계정 추가 할때 적요, 부서, 거래처 자동 넣어주기
	parameter   : i - 해당 텍스트 박스의 row
	수       정 : 증빙코드, 증빙value 추가
******************************************************************************/
function ln_Insert_Remark(i){

		  eval("txt_remark"+i).value = g_remark;
			eval("hid_divcd"+i).value = g_divcd;  //본부
			for(j=1;j<=3;j++){
				if(eval("txt_fsrefcd"+i+j+"1").value=="0002"){
           eval("txt_fsrefval"+i+j+"1").value=g_deptcd;
					 eval("txt_fsrvalnm"+i+j+"1").value=g_deptnm;
				}else if(eval("txt_fsrefcd"+i+j+"2").value=="0002"){
					 eval("txt_fsrefval"+i+j+"2").value=g_deptcd;
					 eval("txt_fsrvalnm"+i+j+"2").value=g_deptnm;
				}else if(eval("txt_fsrefcd"+i+j+"3").value=="0002"){
					 eval("txt_fsrefval"+i+j+"3").value=g_deptcd;
					 eval("txt_fsrvalnm"+i+j+"3").value=g_deptnm;
				}

				if(eval("txt_fsrefcd"+i+j+"1").value=="0020"){
           eval("txt_fsrefval"+i+j+"1").value=g_custcd;
					 eval("txt_fsrvalnm"+i+j+"1").value=g_custnm;
				}else if(eval("txt_fsrefcd"+i+j+"2").value=="0020"){
					 eval("txt_fsrefval"+i+j+"2").value=g_custcd;
					 eval("txt_fsrvalnm"+i+j+"2").value=g_custnm;
				}else if(eval("txt_fsrefcd"+i+j+"3").value=="0020"){
					 eval("txt_fsrefval"+i+j+"3").value=g_custcd;
					 eval("txt_fsrvalnm"+i+j+"3").value=g_custnm;
				}
        

				//예산부서
				if(eval("txt_fsrefcd"+i+j+"1").value=="0003"){
           eval("txt_fsrefval"+i+j+"1").value=g_bgtdept;
           eval("txt_fsrvalnm"+i+j+"1").value=g_bgtdeptnm; 
					 eval("hid_bgtdiv"+i).value=g_bgtdiv;
				}else if(eval("txt_fsrefcd"+i+j+"2").value=="0003"){
					 eval("txt_fsrefval"+i+j+"2").value=g_bgtdept;
					 eval("txt_fsrvalnm"+i+j+"2").value=g_bgtdeptnm; 
					 eval("hid_bgtdiv"+i).value=g_bgtdiv;
				}else if(eval("txt_fsrefcd"+i+j+"3").value=="0003"){
					 eval("txt_fsrefval"+i+j+"3").value=g_bgtdept;
					 eval("txt_fsrvalnm"+i+j+"3").value=g_bgtdeptnm; 
					 eval("hid_bgtdiv"+i).value=g_bgtdiv;
				}
			} //for j
}

/******************************************************************************
	Description : 전역변수 clear
	parameter   : 
******************************************************************************/
function ln_Clear(){ 	
	g_remark="";
	g_deptcd="";
	g_deptnm="";
	g_custcd="";
	g_custnm="";
	g_documcd="";
	g_docuval=""; 
	g_divcd="";
	g_taxval=0;
	g_bgtdept="";
	g_bgtdeptnm="";
	g_bgtdiv="";
	gcds_tax.ClearAll();
	gcds_bgt_insert.ClearAll();
	gcds_bgt_update.ClearAll();
	gcds_bgt_del.ClearAll();
	gcds_bgt_del_all.ClearAll();
	gcds_banjae.ClearAll();
	gcds_banjaemst.ClearAll();
}


/******************************************************************************
	Description : 관리항목 자금관련 clear
	parameter   : gubun - 구분
	              p3 - object (i+j 값)
								p4 - object (열 구분값 1,2,3)
								참고 : p2+p3+p4 - 해당 관리항목 코드 또는 명칭
								p5 - i position

******************************************************************************/
function ln_Ref_Fund_Clear(gubun,p3,p4,p5){ 	

	if(gubun=="1"){
		 //어음번호
		eval("txt_fsrefval"+p3+p4).value="";
		eval("txt_fsrvalnm"+p3+p4).value="";

		 //은행
		strPo="";
		strPo = ln_Ref_position_find(p5,"0022");
		eval("txt_fsrefval"+strPo).value ="";   //은행코드
		eval("txt_fsrvalnm"+strPo).value ="";   //은행명
		ln_Ref_lock(strPo,'1');
	}else if(gubun=="2"){
		//어음번호
		eval("txt_fsrefval"+p3+p4).value="";
		eval("txt_fsrvalnm"+p3+p4).value="";
		//거래처
		//strPo = ln_Ref_position_find(p5,"0020");
		//eval("txt_fsrefval"+strPo).value ="";  //거래처코드
		//eval("txt_fsrvalnm"+strPo).value ="";  //거래처
		//ln_Ref_lock(strPo,'2');
		//은행
		strPo="";
		strPo = ln_Ref_position_find(p5,"0022");
		eval("txt_fsrefval"+strPo).value ="";   //은행코드
		eval("txt_fsrvalnm"+strPo).value ="";   //은행명
		ln_Ref_lock(strPo,'2');
		//어음발생일
		strPo="";
		strPo = ln_Ref_position_find(p5,"0968");
		eval("txt_fsrefval"+strPo).value ="";   //
		eval("txt_fsrvalnm"+strPo).value ="";   //
		ln_Ref_lock(strPo,'2');
		//어음만기일
		strPo="";
		strPo = ln_Ref_position_find(p5,"0969");
		eval("txt_fsrefval"+strPo).value ="";   //
		eval("txt_fsrvalnm"+strPo).value ="";   //
		ln_Ref_lock(strPo,'2');
	}
}
/******************************************************************************
	Description : 비용계정과 수익계정 입력시 차대 체크
	parameter   : p3- 해당 텍스트 박스의 row
                계정코드가 4로 시작하는 비용 수익은 해당 계정의 기준차대로만 입력가능
******************************************************************************/
function ln_Atcode_Amt_Chk(p3){
   if(p3!=""){
		 var temp = eval("txt_atcode"+p3).value;
		 var str1char = temp.substring(0,1);
		 var str2char = temp.substring(0,2);
		 var str3char = temp.substring(0,3);

		 //alert("hid_atdecr::"+eval("hid_atdecr"+i).value);
     
		 if(str1char=="4"){
				if(eval("hid_atdecr"+p3).value=="1"){ //차변
					if(eval("gcem_daeamt"+p3).text!=0&&eval("gcem_daeamt"+p3).text!=""){
						alert("해당계정은 대변에 입력할 수 없습니다.");
						eval("gcem_daeamt"+p3).text=0;
						return;
					}
				}else if(eval("hid_atdecr"+p3).value=="2"){//대변
					if(eval("gcem_chaamt"+p3).text!=0&&eval("gcem_chaamt"+p3).text!=""){
						alert("해당계정은 차변에 입력할 수 없습니다.");
						eval("gcem_daeamt"+p3).text=0;
						return;
					}
				}

		 }
		 /*

		 if(str2char=="43"||str2char=="44"||str3char=="451"||str3char=="453"){
			 
				if(eval("gcem_daeamt"+p3).text!=0&&eval("gcem_daeamt"+p3).text!=""){
					alert("비용계정은 대변에 입력할 수 없습니다.");
					eval("gcem_daeamt"+p3).text=0;
					return;
				}
		 }

		 if(str3char=="411"||str3char=="450"||str3char=="452"){
				if(eval("gcem_chaamt"+p3).text!=0&&eval("gcem_chaamt"+p3).text!=""){
					alert("수익계정은 차변에 입력할 수 없습니다.");
					eval("gcem_daeamt"+p3).text=0;
					return;
				}
		}

		*/

		if((eval("gcem_chaamt"+p3).text!=0)&&(eval("gcem_daeamt"+p3).text!=0)){
				alert("차변금액과 대변금액을 확인 하십시요");
				eval("gcem_chaamt"+p3).focus();
				return;
		}
	}
}



/******************************************************************************
	Description : 반제계정의 경우 상대계정에 금액 입력 못함.
	parameter   : p3- 해당 텍스트 박스의 row
  
	추가수정
	Description : 반제계정을 입력할 경우 반제 팝업처리함. 
******************************************************************************/
function ln_Banjae_Amt_Chk(p3){
   var strfsdat = "";
	 var strfsdat = parent.gcem_fs02.text+parent.gcem_fsdat02.text
   
	 //alert("hid_atdecr::"+eval("hid_atdecr"+p3).value);
   
	 if(p3!=""){
			if(eval("hid_atdebtyn"+p3).value=="Y"){ //반제
				if(eval("hid_atdecr"+p3).value=="1"){ //차변
					if(eval("gcem_daeamt"+p3).text!=0&&eval("gcem_daeamt"+p3).text!=""){
						//alert("선택한 반제계정은 대변에 입력할 수 없습니다.");
						//eval("gcem_daeamt"+p3).text=0;
						//return;

						//거래처 확인
						if(!ln_Vend_Find(p3)) return;
            
						//항목체크 없앰
						for(i=1;i<=g_row;i++){
							if(eval("hid_flag"+i+"0").value=="T"){
								 eval("chkbox"+i).checked =false;
							}
						}

						//항목자동체크
            eval("chkbox"+p3).checked =true;
						//alert("1");
	          ln_Popup_Repay(parent.gclx_fdcode02.bindcolval,strfsdat,parent.gcem_fsnbr02.text);
					}
				}else if(eval("hid_atdecr"+p3).value=="2"){
					if(eval("gcem_chaamt"+p3).text!=0&&eval("gcem_chaamt"+p3).text!=""){
						//alert("선택한 반제계정은 차변에 입력할 수 없습니다.");
						//eval("gcem_chaamt"+p3).text=0;
						//return;

						//거래처 확인
						if(!ln_Vend_Find(p3)) return;

						//항목체크없앰
						for(i=1;i<=g_row;i++){
							if(eval("hid_flag"+i+"0").value=="T"){
								 eval("chkbox"+i).checked =false;
							}
						}
            
						//항목자동체크
            eval("chkbox"+p3).checked =true;
						//alert("2");
						ln_Popup_Repay(parent.gclx_fdcode02.bindcolval,strfsdat,parent.gcem_fsnbr02.text);
					}
				}
			}
	 }
}



/******************************************************************************
	Description : 거래처 찾기
	parameter   : p- row
******************************************************************************/
function ln_Vend_Find(p){
	_out:
	for (j=1;j<=3;j++){
		for(k=1;k<=3;k++) {
			//alert("i::"+i+"::j::"+j+"::k::"+k);
			//alert("txt_fsrefcd::"+eval("txt_fsrefcd"+i+j+k).value);
			//alert("txt_fsrefval:"+eval("txt_fsrefval"+i+j+k).value);
			if(eval("txt_fsrefcd"+p+j+k).value=="0020"){
				 if(eval("txt_fsrefval"+p+j+k).value==""){
						alert("거래처가 필요합니다.");
						return false;
						break _out;
				 }				
			}
		}// for k
	}// for j

	return true;
}

/******************************************************************************
	Description : 계정코드로 관리항목 수 설정
	parameter   :  p1 - 계정코드, p2- 계정명,    p3 -거래처코드   p4-거래처명   
	               p5 - 부서코드, p6- 부서명,    p7 - 적요,       p8 - 차변,     p9-대변
								 p10 - ((세금)계산서,신용카드,현금소득공제 : 번호)
								 p11 - ((세금)계산서,신용카드,현금소득공제 : 증빙코드)
								 p12 - 본부, p13 - 계산서일자
******************************************************************************/
function ln_Refcode_find(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13){
	var cnt =0;
	var xcnt=0;
	var j=0;
	var dblcount=0;
 
  //alert("DTL"+"p1:"+p1+":p2:"+p2+":p3:"+p3+":p4:"+p4+":p5:"+p5+":p6:"+p6+":p7:"+p7+":p8:"+p8+":p9:"+p9+":p10:"+p10+":p11:"+p11+":p12:"+p12+":p13:"+p13);
	if(p1!=""){
		gcds_code01.DataID = g_servlet+"/Account.actcode_s1f?v_str1="+p1+"&v_str2='ATCODE'&v_str3="+parent.gclx_fdcode02.bindcolval;                                               
		//prompt("gcds_code01",gcds_code01.DataID);
		gcds_code01.Reset();
		dblcount = gcds_code01.CountRow;
	}else{
    dblcount =1;
	}
  
	//alert("gcds_code01.CountRow" +gcds_code01.CountRow);
	//데이타 입력
	j=1
	eval("txt_atcode"+g_row).value=p1;
	eval("txt_atkornam"+g_row).value=p2;
	eval("txt_remark"+g_row).value=p7;
	eval("gcem_chaamt"+g_row).text=p8;
	eval("gcem_daeamt"+g_row).text=p9;
	eval("hid_docuval"+g_row).value=p10;
  //eval("sel_docuval"+g_row).value=p11;
  eval("sel_documcd"+g_row).value=p11;
	eval("txt_documcd"+g_row).value=p11;
	eval("hid_atdebtyn"+g_row).value=gcds_code01.namevalue(gcds_code01.rowposition,"ATDEBTYN"); //반제
	eval("hid_divcd"+g_row).value=p12;                                                          //본부

	//^^alert("hid_atdebtyn:::"+eval("hid_atdebtyn"+g_row).value);
	g_strbanjae = gcds_code01.namevalue(gcds_code01.rowposition,"ATDEBTYN"); //반제유무
	
	for(i=1;i<=dblcount;i++){
	    if(p1!=""){
				cnt = gcds_code01.namevalue(i,"CNT");
			}else{
        cnt=0;
			}

			if (cnt==0||cnt==1|| cnt==2||cnt==3) xcnt=1;
			else if(cnt==4|| cnt==5||cnt==6)xcnt=2;
			else if(cnt==7|| cnt==8||cnt==9)xcnt=3;
			else xcnt =1;
  
      //관리항목 Line 보여주기
			if ((cnt>=0)&&(cnt<=3)){
				eval("document.all.t"+g_row+"2.style.display='none';");
				eval("document.all.t"+g_row+"3.style.display='none';");
			}else if ((cnt>=4)&&(cnt<=6)){
				eval("document.all.t"+g_row+"2.style.display='block';");
				eval("document.all.t"+g_row+"3.style.display='none';");
			}else if (cnt>=7){
				eval("document.all.t"+g_row+"2.style.display='block';");
				eval("document.all.t"+g_row+"3.style.display='block';");
			}
     
			//관리항목 데이타 Clear
			ln_Ref_DataClear(g_row);

			//eval("hid_atdebtyn"+g_row).value =gcds_code01.namevalue(i,"ATDEBTYN"); //반제유무
      //g_strbanjae = gcds_code01.namevalue(i,"ATDEBTYN"); //반제유무
		 
      //부서 & 거래처
			j=1
			eval("txt_fsrefval"+g_row+j+"1").value=p5;
			eval("txt_fsrvalnm"+g_row+j+"1").value=p6;
			eval("txt_fsrefval"+g_row+j+"2").value=p3;
			eval("txt_fsrvalnm"+g_row+j+"2").value=p4;

	//		alert("xcnt::::"+xcnt);

			//관리항목가져오기
			if (xcnt==1){
				j=1;
				if(p1!=""){

					eval("txt_fsrefcd"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDCODE1");
					eval("txt_fsrefnm"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDNAM1");
					eval("txt_fsrefcd"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDCODE2");
					eval("txt_fsrefnm"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDNAM2");
					eval("txt_fsrefcd"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDCODE3");
					eval("txt_fsrefnm"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDNAM3");

					eval("hid_type"+g_row+j+"1").value=gcds_code01.namevalue(i,"TYPE1");
					eval("hid_type"+g_row+j+"2").value=gcds_code01.namevalue(i,"TYPE2");
					eval("hid_type"+g_row+j+"3").value=gcds_code01.namevalue(i,"TYPE3");
					eval("hid_arbaldiv"+g_row+j+"1").value=gcds_code01.namevalue(i,"ARBALDIV1");
					eval("hid_arbaldiv"+g_row+j+"2").value=gcds_code01.namevalue(i,"ARBALDIV2");
					eval("hid_arbaldiv"+g_row+j+"3").value=gcds_code01.namevalue(i,"ARBALDIV3");

					eval("txt_fsrefval"+g_row+j+"3").value="";
					eval("txt_fsrvalnm"+g_row+j+"3").value="";
				}else{
					eval("txt_fsrefcd"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDCODE1");
					eval("txt_fsrefnm"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDNAM1");
					eval("txt_fsrefcd"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDCODE2");
					eval("txt_fsrefnm"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDNAM2");
				}
			}else if (xcnt==2){
				j=1;
				if(p1!=""){
				
					eval("txt_fsrefcd"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDCODE1");
					eval("txt_fsrefnm"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDNAM1");
					eval("txt_fsrefcd"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDCODE2");
					eval("txt_fsrefnm"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDNAM2");
					eval("txt_fsrefcd"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDCODE3");
					eval("txt_fsrefnm"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDNAM3");

					eval("txt_fsrefval"+g_row+j+"3").value="";
					eval("txt_fsrvalnm"+g_row+j+"3").value="";

          eval("hid_type"+g_row+j+"1").value=gcds_code01.namevalue(i,"TYPE1");
					eval("hid_type"+g_row+j+"2").value=gcds_code01.namevalue(i,"TYPE2");
					eval("hid_type"+g_row+j+"3").value=gcds_code01.namevalue(i,"TYPE3");
					eval("hid_arbaldiv"+g_row+j+"1").value=gcds_code01.namevalue(i,"ARBALDIV1");
					eval("hid_arbaldiv"+g_row+j+"2").value=gcds_code01.namevalue(i,"ARBALDIV2");
					eval("hid_arbaldiv"+g_row+j+"3").value=gcds_code01.namevalue(i,"ARBALDIV3");

					j=2

     			eval("txt_fsrefcd"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDCODE4");
					eval("txt_fsrefnm"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDNAM4"); 
					eval("txt_fsrefcd"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDCODE5");
					eval("txt_fsrefnm"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDNAM5"); 
					eval("txt_fsrefcd"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDCODE6");
					eval("txt_fsrefnm"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDNAM6"); 

					eval("txt_fsrefval"+g_row+j+"1").value="";
					eval("txt_fsrvalnm"+g_row+j+"1").value="";
					eval("txt_fsrefval"+g_row+j+"2").value="";
					eval("txt_fsrvalnm"+g_row+j+"2").value="";
					eval("txt_fsrefval"+g_row+j+"3").value="";
					eval("txt_fsrvalnm"+g_row+j+"3").value="";


					eval("hid_type"+g_row+j+"1").value=gcds_code01.namevalue(i,"TYPE4");
					eval("hid_type"+g_row+j+"2").value=gcds_code01.namevalue(i,"TYPE5");
					eval("hid_type"+g_row+j+"3").value=gcds_code01.namevalue(i,"TYPE6");
					eval("hid_arbaldiv"+g_row+j+"1").value=gcds_code01.namevalue(i,"ARBALDIV4");
					eval("hid_arbaldiv"+g_row+j+"2").value=gcds_code01.namevalue(i,"ARBALDIV5");
					eval("hid_arbaldiv"+g_row+j+"3").value=gcds_code01.namevalue(i,"ARBALDIV6");

				}else{
					eval("txt_fsrefcd"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDCODE1");
					eval("txt_fsrefnm"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDNAM1");
					eval("txt_fsrefcd"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDCODE2");
					eval("txt_fsrefnm"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDNAM2");
				}
			}else if (xcnt==3){
				j=1;
				if(p1!=""){
					eval("txt_fsrefcd"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDCODE1");
					eval("txt_fsrefnm"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDNAM1");
					eval("txt_fsrefcd"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDCODE2");
					eval("txt_fsrefnm"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDNAM2");
					eval("txt_fsrefcd"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDCODE3");
					eval("txt_fsrefnm"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDNAM3");

					eval("txt_fsrefval"+g_row+j+"3").value="";
					eval("txt_fsrvalnm"+g_row+j+"3").value="";
          
					eval("hid_type"+g_row+j+"1").value=gcds_code01.namevalue(i,"TYPE1");
					eval("hid_type"+g_row+j+"2").value=gcds_code01.namevalue(i,"TYPE2");
					eval("hid_type"+g_row+j+"3").value=gcds_code01.namevalue(i,"TYPE3");
					eval("hid_arbaldiv"+g_row+j+"1").value=gcds_code01.namevalue(i,"ARBALDIV1");
					eval("hid_arbaldiv"+g_row+j+"2").value=gcds_code01.namevalue(i,"ARBALDIV2");
					eval("hid_arbaldiv"+g_row+j+"3").value=gcds_code01.namevalue(i,"ARBALDIV3");

					j=2;
					eval("txt_fsrefcd"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDCODE4");
					eval("txt_fsrefnm"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDNAM4"); 
					eval("txt_fsrefcd"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDCODE5");
					eval("txt_fsrefnm"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDNAM5"); 
					eval("txt_fsrefcd"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDCODE6");
					eval("txt_fsrefnm"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDNAM6");	

					eval("txt_fsrefval"+g_row+j+"1").value="";
					eval("txt_fsrvalnm"+g_row+j+"1").value="";
					eval("txt_fsrefval"+g_row+j+"2").value="";
					eval("txt_fsrvalnm"+g_row+j+"2").value="";
					eval("txt_fsrefval"+g_row+j+"3").value="";
					eval("txt_fsrvalnm"+g_row+j+"3").value="";

					eval("hid_type"+g_row+j+"1").value=gcds_code01.namevalue(i,"TYPE4");
					eval("hid_type"+g_row+j+"2").value=gcds_code01.namevalue(i,"TYPE5");
					eval("hid_type"+g_row+j+"3").value=gcds_code01.namevalue(i,"TYPE6");
					eval("hid_arbaldiv"+g_row+j+"1").value=gcds_code01.namevalue(i,"ARBALDIV4");
					eval("hid_arbaldiv"+g_row+j+"2").value=gcds_code01.namevalue(i,"ARBALDIV5");
					eval("hid_arbaldiv"+g_row+j+"3").value=gcds_code01.namevalue(i,"ARBALDIV6");

					j=3;
					eval("txt_fsrefcd"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDCODE7");   
					eval("txt_fsrefnm"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDNAM7");    
					eval("txt_fsrefcd"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDCODE8");   
					eval("txt_fsrefnm"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDNAM8");    
					eval("txt_fsrefcd"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDCODE9");   
					eval("txt_fsrefnm"+g_row+j+"3").value=gcds_code01.namevalue(i,"CDNAM9");    

					eval("txt_fsrefval"+g_row+j+"1").value="";
					eval("txt_fsrvalnm"+g_row+j+"1").value="";
					eval("txt_fsrefval"+g_row+j+"2").value="";
					eval("txt_fsrvalnm"+g_row+j+"2").value="";
					eval("txt_fsrefval"+g_row+j+"3").value="";
					eval("txt_fsrvalnm"+g_row+j+"3").value="";

					eval("hid_type"+g_row+j+"1").value=gcds_code01.namevalue(i,"TYPE7");
					eval("hid_type"+g_row+j+"2").value=gcds_code01.namevalue(i,"TYPE8");
					eval("hid_type"+g_row+j+"3").value=gcds_code01.namevalue(i,"TYPE9");
					eval("hid_arbaldiv"+g_row+j+"1").value=gcds_code01.namevalue(i,"ARBALDIV7");
					eval("hid_arbaldiv"+g_row+j+"2").value=gcds_code01.namevalue(i,"ARBALDIV8");
					eval("hid_arbaldiv"+g_row+j+"3").value=gcds_code01.namevalue(i,"ARBALDIV9");
				}else{
					eval("txt_fsrefcd"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDCODE1");
					eval("txt_fsrefnm"+g_row+j+"1").value=gcds_code01.namevalue(i,"CDNAM1");
					eval("txt_fsrefcd"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDCODE2");
					eval("txt_fsrefnm"+g_row+j+"2").value=gcds_code01.namevalue(i,"CDNAM2");
				}

			}//if

       //세금계산서를 가지고 있고 부서관리항목과 거래처 관리항목이 없을경우
			if(p10!=""&&gcds_code01.namevalue(i,"CDCODE1")==undefined&&gcds_code01.namevalue(i,"CDNAM1")==undefined
							&&gcds_code01.namevalue(i,"CDCODE2")==undefined&&gcds_code01.namevalue(i,"CDNAM2")==undefined){
				j=1;
				eval("txt_fsrefcd"+g_row+j+"1").value='0002';
				eval("txt_fsrefnm"+g_row+j+"1").value='부서코드';
				eval("txt_fsrefcd"+g_row+j+"2").value='0020';
				eval("txt_fsrefnm"+g_row+j+"2").value='거래처코드';
			}

			//계산서 일자가 존재하는 경우 관리항목에 SETTING함.
			for(k=1;k<=3;k++){
				for(g=1;g<=3;g++){
				  //alert("i"+g_row+"k"+k+"g"+g+"txt_fsrefcd"+eval("txt_fsrefcd"+g_row+k+g).value);
					if(eval("txt_fsrefcd"+g_row+k+g).value=="1048"||eval("txt_fsrefcd"+g_row+k+g).value=="0970"){
						eval("txt_fsrefval"+g_row+k+g).value=p13;
						eval("txt_fsrvalnm"+g_row+k+g).value=p13;
						//alert("g_row+j+i::"+g_row+j+i);
						return;
					}
				}
			}

	}//for
}


/******************************************************************************
	Description : 반제 세목의 경우 계정에 따라 관리항목값을 셋팅
	parameter   : p1 - 관리항목,   p2-관리항목값,    p3-관리항목값명
******************************************************************************/
function ln_Refcode_val(p1,p2,p3){
//  alert("p1"+p1+"p2"+p2+"p3"+p3);
 
  for( j=1;j<=3;j++){
		for(i=1;i<=3;i++){
			if(p1==eval("txt_fsrefcd"+g_row+j+i).value){
				eval("txt_fsrefval"+g_row+j+i).value=p2;
				eval("txt_fsrvalnm"+g_row+j+i).value=p3;
				//alert("g_row+j+i::"+g_row+j+i);
			  return;
			}
		}
	}
}

/******************************************************************************
	Description : 계정코드로 관리항목 수 설정
	parameter   :  p1 - 결재상태,            p2-fdcode,            p3-반제원접수date     p4-반제원접수nbr p5 - 반제원접수 seq,  
	               p6-  반제접수번호date,    p7 -반제접수번호 nbr, p8-반제접수번호 seq,  p9-반제여부,     p10- 반제원전표date
								 p11- 반제원전표nbr        p12-반제원전표순번,   p13 -반제차변금액,    p14-반제대변금액 p15- 반제전표번호date
                 p16 -반제전표번호 nbr,    p17-반제전표순번,
								 p18 - 일자 , p19 - 생성자
 ----------------------------------------------------------------------------------
 추가 된 파라미터 :		p12
******************************************************************************/
function ln_Banjae_Data_Save(p1, p2, p3, p4, p5, p6, p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19){
  
	//alert("p1:"+p1+"p2:"+p2+"p3:"+p3+"p4:"+p4+"p5:"+p5+"p6:"+p6+"p7:"+p7+"p8:"+p8+"p9:"+p9+"p10:"+p10+"p11:"+p11+"p12:"+p12);
  if(gcds_banjae.countrow<=0){
		ln_SetDataHeader("BANJAE");
	}
	gcds_banjae.AddRow();
	//alert("rowposition::"+gcds_banjae.rowposition);
  gcds_banjae.namevalue(gcds_banjae.rowposition,"FTSTAT")=p1;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"FDCODE")=p2;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"TSDAT")=p3;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"TSNBR")=p4;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"TSSEQ")=p5;

	gcds_banjae.namevalue(gcds_banjae.rowposition,"BTSDAT")=p6;   //반제접수일자
	gcds_banjae.namevalue(gcds_banjae.rowposition,"BTSNBR")=p7;   //반제접수번호
	gcds_banjae.namevalue(gcds_banjae.rowposition,"BTSSEQ")=p8;   //반제SEQ
	gcds_banjae.namevalue(gcds_banjae.rowposition,"BANJAEYN")=p9;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"SSDAT")=p10;  

	gcds_banjae.namevalue(gcds_banjae.rowposition,"SSNBR")=p11;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"FSNUM")=p12;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"BJDEAMT")=p13;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"BJCRAMT")=p14;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"BSDAT")=p15;

	gcds_banjae.namevalue(gcds_banjae.rowposition,"BSNBR")=p16;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"BSNUM")=p17;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"WRDT")=p18;
	gcds_banjae.namevalue(gcds_banjae.rowposition,"WRID")=p19;

}


/******************************************************************************
	Description :  반제 mst Data
	parameter   :  p1 - 지점코드,   p2- 접수일자    p3-접수번호       p4-접수행번호   p5 - 계정코드 
	               p6-  부서코드    p7 -거래처코드, p8-관리항목코드   p9-정산항목,    p10- 차변
								 p11- 대변        p12-정산상태,   p13 -전표일자     p14-전표번호    p15- 전표행번호
								 p16- 적요
								 p17- 작업일자    p18-작업자,     p19 -수정일자     p20-수정자      P21- 반제원전표의 금액
 ----------------------------------------------------------------------------------
******************************************************************************/
function ln_Banjaemst_Data_Save(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21){

	if(gcds_banjaemst.countrow<=0){
		ln_SetDataHeader("BANJAEMST");
	}
	gcds_banjaemst.AddRow();
	//alert("rowposition::"+gcds_banjaemst.rowposition);
  gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"FDCODE")=p1;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"TSDAT")=p2;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"TSNBR")=p3;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"TSSEQ")=p4;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"ATCODE")=p5;

	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"DEPTCD")=p6;   
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"VENDCD")=p7;   
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"FSREFCD")=p8;   
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"FSREFVAL")=p9;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"DEAMT")=p10;  

	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"CRAMT")=p11;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"STATUS")=p12;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"SSDAT")=p13;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"SSNBR")=p14;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"FSNUM")=p15;
  gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"REMARK")=p16;

	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"WRDT")=p17;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"WRID")=p18;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"UPDT")=p19;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"UPID")=p20;
	gcds_banjaemst.namevalue(gcds_banjaemst.rowposition,"AMT")=p21;

}

/******************************************************************************
	Description :  세금계산서 테이블에 접수번호 UPDATE
	parameter   :  p1 - 계산서번호, p2 - 일자 , p3 - 생성자 , p4 fsdat
******************************************************************************/
function ln_Tax_Data_Save(p1, p2, p3, p4){
  //alert("p1::"+p1+"::p2::"+ p2+"::p3::"+ p3+"::p4::"+p4);
	//alert("Countrow" + gcds_tax.Countrow);
	if (gcds_tax.Countrow==0){
	 // alert("setheader");
		ln_SetDataHeader("TAX");
	}
	gcds_tax.AddRow();
  gcds_tax.namevalue(gcds_tax.rowposition,"TAXNBR")=p1;
	gcds_tax.namevalue(gcds_tax.rowposition,"FDCODE")=parent.gclx_fdcode02.bindcolval;
	//gcds_tax.namevalue(gcds_tax.rowposition,"FSDAT")=parent.gcem_fs02.text+p4;
	gcds_tax.namevalue(gcds_tax.rowposition,"FSDAT")=p4;
	gcds_tax.namevalue(gcds_tax.rowposition,"FSNBR")="";
	gcds_tax.namevalue(gcds_tax.rowposition,"UPDT")=p2;
	gcds_tax.namevalue(gcds_tax.rowposition,"UPID")=p3;
} 

/******************************************************************************
	Description :  세금계산서 금액합계
	parameter   :  p1 - 계산서번호, p2-금액
******************************************************************************/
function ln_Tax_Sum(p1, p2){
	 // alert("p2:g_taxval"+p2);
		g_taxval = p2;
}

/******************************************************************************
	Description :  관리항목에서 value값 없이 들어오는 건을 value값에 넣어줌
	               만약 세목일경우(B) 예산금액 조회함.
	parameter   :  p1 - 관항목코드
	               p2 - 해당 object 명
                 p3 - object (i+j 값)
								 p4 - object (열 구분값 1,2,3)
								 p5 - i 위치
								 C - 관리항목에서 관리항목 필수 값체크
								 B - 세목(예산에서만 사용)
------------------------------------------------------------------------------
 추가사항     :  관리항목에서 관리항목명을 입력했을 경우 존재하지 않으면
                 관리항목명란을 Clear시킴.
								 만약 존재할경우 2개 이상이면 팝업을 띄움
								 한개일 경우는 코드값만 가져와서 넣어줌.
------------------------------------------------------------------------------
 추가사항2     : 자금관련 계정으로 조회 할 경우 자금관련 테이블에서 조회함. 
******************************************************************************/
function ln_type_blur(p1,p2,p3,p4,p5){
  
	//alert("00000p1:"+p1+":p2:"+p2+":p3:"+p3+":p4:"+p4+":p5:"+p5);
  //return;
  var strfsrefval="";
	var strfsvalnm="";
	var strPopGubun="";
	var strDivcd="";
  var strBgtdept="";
	var strBgtdeptnm="";
	var strBgtdivcd="";
  
  //계정코드가 없으면 return; 
	if(eval("txt_atcode"+p5).value=="") return;
	//alert("p4::"+p4);
  //alert("ln_type_blur::"+eval("hid_cnt_bf"+p5).value);
  if(p4>=eval("hid_cnt_bf"+p5).value){
		strposition=p3+p4;
	  ln_Row_Add(strposition,p5);
	}
  ///if(!ln_Chk_Popup(p1,p2,p3,p4,p5))return;
  strPopGubun = ln_PopGubun('1',p1,p5);
	
	if(strPopGubun=="1"){
	 	
  }else if(strPopGubun=="2"){
	  
	}else if(strPopGubun==""&&eval(p2+p3+p4).value=="C"){  //입력
		eval("txt_fsrefval"+p3+p4).value=eval("txt_fsrvalnm"+p3+p4).value;
		//날짜 체크
		if(eval("txt_fsrefcd"+p3+p4).value=="0966"||eval("txt_fsrefcd"+p3+p4).value=="0968"||eval("txt_fsrefcd"+p3+p4).value=="0969"||
		   eval("txt_fsrefcd"+p3+p4).value=="0970"||eval("txt_fsrefcd"+p3+p4).value=="1044"||eval("txt_fsrefcd"+p3+p4).value=="1048"||
			 eval("txt_fsrefcd"+p3+p4).value=="1051"||eval("txt_fsrefcd"+p3+p4).value=="1052"||eval("txt_fsrefcd"+p3+p4).value=="1053"||
			 eval("txt_fsrefcd"+p3+p4).value=="1089"||eval("txt_fsrefcd"+p3+p4).value=="1098"||eval("txt_fsrefcd"+p3+p4).value=="1099"||
		   eval("txt_fsrefcd"+p3+p4).value=="1125"||eval("txt_fsrefcd"+p3+p4).value=="1126"||eval("txt_fsrefcd"+p3+p4).value=="1127"||
			 eval("txt_fsrefcd"+p3+p4).value=="1130"||eval("txt_fsrefcd"+p3+p4).value=="1206"){
			 
			 if(eval("txt_fsrefval"+p3+p4).value!=""){
				 var strReturn= gf_ChkNumber(eval("txt_fsrefval"+p3+p4));
				 if(strReturn==false){
						eval("txt_fsrefval"+p3+p4).value="";
						eval("txt_fsrvalnm"+p3+p4).value="";
						//alert("날짜 형식이 맞지 않습니다.");
						eval("txt_fsrvalnm"+p3+p4).focus();
						return;
				 }
			 }
		}	
	}else{
	  //alert("step3 ::strPopGubun::" +strPopGubun);
	  if(event.keyCode!=113&&event.keyCode!=13){
			if(fn_trim(eval("txt_fsrvalnm"+p3+p4).value)!=""){
			  //alert("ln_type_blur::"+eval("txt_fsrefcd"+p3+p4).value);
				if(eval("txt_fsrefcd"+p3+p4).value=="0002"){      //부서
					gcds_commdtilnm.DataID = g_servlet+"/Account.hcdept_s1?v_str1=&v_str2="+eval("txt_fsrvalnm"+p3+p4).value;
					gcds_commdtilnm.Reset(); 
					strfsrefval = gcds_commdtilnm.namevalue(1,"DEPTCD");
					strfsvalnm = gcds_commdtilnm.namevalue(1,"DEPTNM");
					strDivcd=gcds_commdtilnm.namevalue(1,"DEPTCD2");  //본부
					strBgtdept=gcds_commdtilnm.namevalue(1,"BGTDEPT");
					strBgtdeptnm=gcds_commdtilnm.namevalue(1,"BGTDETPNM");
					strBgtdivcd=gcds_commdtilnm.namevalue(1,"BGTDIVCD");
				}else if(eval("txt_fsrefcd"+p3+p4).value=="0020"){  //거래처
					gcds_commdtilnm.DataID = g_servlet+"/Account.a010003_s0?v_str1=&v_str2="+eval("txt_fsrvalnm"+p3+p4).value;																					
					gcds_commdtilnm.Reset(); 
					strfsrefval = gcds_commdtilnm.namevalue(1,"VEND_CD");
					strfsvalnm = gcds_commdtilnm.namevalue(1,"VEND_NM");
				}else{                                              //그외....
					gcds_commdtilnm.DataID = g_servlet+"/Account.commdtil_s2f?v_str1="+eval("txt_fsrefcd"+p3+p4).value+"&v_str2="+eval("txt_fsrvalnm"+p3+p4).value+"&v_str3=";																				
					gcds_commdtilnm.Reset(); 
					strfsrefval = gcds_commdtilnm.namevalue(1,"CDCODE");
					strfsvalnm = gcds_commdtilnm.namevalue(1,"CDNAM");
				}

        //alert("gcds_commdtilnm.countrow::"+gcds_commdtilnm.countrow);
				//alert("event.keyCode::"+event.keyCode);
				if(gcds_commdtilnm.countrow==1){
					eval("txt_fsrefval"+p3+p4).value=strfsrefval;
					eval("txt_fsrvalnm"+p3+p4).value=strfsvalnm;
					//부서일경우 본부, 예산부서, 예산본부 가져옴.
          if(eval("txt_fsrefcd"+p3+p4).value=="0002"){
						eval("hid_divcd"+p5).value=strDivcd;
						_out:
						for(f=1;f<=3;f++){
							for (g=1;g<=3;g++){
								if (eval("txt_fsrefcd"+p5+f+g).value=="0003"){
										eval("txt_fsrefval"+p5+f+g).value=strBgtdept;   //예산부서
										eval("txt_fsrvalnm"+p5+f+g).value=strBgtdeptnm; //예산부서명
										eval("hid_bgtdiv"+p5).value=strBgtdivcd;        //예산본부코드
										//alert("step1::"+eval("hid_bgtdiv"+p5).value);
										break _out; 
								} 
							}//for g
						}//for f
							
            
            /*******************************************************************************
						세목체크할 때 만 예산체크함.....................................................
						//예산부서 조회  
						//1.세목이 존재 안하면 조회함.
						//2.세목이 존재하면 조회안
						
						if(eval("hid_bgtcnt"+p5).value!=0){      //예산계정 세목이 존재하는 경우
							ln_Bgt_Amt_find(p2,p3,p4,p5);
						}else if(eval("hid_bgtcmtype"+p5).value!=""&&eval("hid_bgtcnt"+p5).value==0){//예산계정 세목이 존재하지 않을 경우
							ln_Bgt_Amt_find('','','',p5);
						}
            ******************************************************************************/
					}
				}else if(gcds_commdtilnm.countrow>=2){
				  var obj ="txt_fsrefcd"+p3+p4;
					if(eval("txt_fsrefval"+p3+p4).value==""){
						//ln_Popup2(obj,'txt_fsrvalnm',p3,p4,p5)
						eval("txt_fsrefval"+p3+p4).value="";
					  eval("txt_fsrvalnm"+p3+p4).value="";
					}
				}else if(gcds_commdtilnm.countrow==0){
					eval("txt_fsrefval"+p3+p4).value="";
					eval("txt_fsrvalnm"+p3+p4).value="";
				}
			}//if(fn_trim(eval("txt_fsrvalnm"+p3+p4).value)!=""){
			
			//alert("BBB:::::::::::"+eval(p2+p3+p4).value);
			if(eval(p2+p3+p4).value=="B"){ //세목이면
        //alert("p5:::"+p5+":::hid_bgtcnt:::"+eval("hid_bgtcnt"+p5).value);
				if(eval("hid_bgtcnt"+p5).value!=0){      //예산계정 세목이 존재하는 경우
					//ln_Bgt_Amt_find(p2,p3,p4,p5);
				}else if(eval("hid_bgtcmtype"+p5).value!=""&&eval("hid_bgtcnt"+p5).value==0){//예산계정 세목이 존재하지 않을 경우
					if(fn_trim(eval("txt_fsrvalnm"+p3+p4).value)!=""){
						//ln_Bgt_Amt_find('','','',p5);
					}
				}
			}
		}
		
		//관리항목 조회
		if(fn_trim(eval("txt_fsrvalnm"+p3+p4).value)==""){
			eval("txt_fsrefval"+p3+p4).value="";

			//부서가 존재하지 않을 경우 예산본부도 함께 지움.....
			var spo=ln_Ref_position_find(p5,"0002");//부서
			if(eval("txt_fsrefval"+spo).value==""){
				eval("hid_bgtdiv"+p5).value ="";
			}
		}
	}//if


	//마지막인란에서 행추가함.//////////////////////////////////
	if(event.keyCode!=13) return;
	strposition=p3+p4;
	ln_Row_Add(strposition,p5);
	///////////////////////////////////////////////////////////
} 

/******************************************************************************
	Description :  예산금액 조회
	parameter   : // p1 - 구분( '1' - 부서, '2'-예산부서, '3' - 예산세목, '4'-차변금액)
	               p2 - 해당 object 명
                 p3 - object (i+j 값)
								 p4 - object (열 구분값 1,2,3)
								 p5 - i 위치(계정의 위치)
******************************************************************************/
function ln_Bgt_Amt_find(p2,p3,p4,p5){

  ////alert("ln_Bgt_Amt_find::");

	var stryyyy = parent.gcem_actdat02.text;
	var strmm = fn_trim(stryyyy.substring(4,6));
			stryyyy = fn_trim(stryyyy.substring(0,4));
	var strbgtdiv="";                                   //예산본부
	var strbgtdept="";                                  //예산부서
	var stratcode = "";                                 //계정과목
	var strrefcd= "";//fn_trim(eval("txt_fsrefcd"+p3+p4).value);      //세목의 관리항목코드
	var strrefval="";//fn_trim(eval("txt_fsrefval"+p3+p4).value);     //세목값
	var strfswrkdiv="";                                 //예산타입
	var no1="";                                         //관리항목 위치	
	var no2="";                                         //세목
	no1 = ln_Bgt_position_find(p5);                     //예산부서 찾기
	no2 = ln_Bgt_Detail_find(p5);                       //세목위치 찾기

	if(no1==""||no1==undefined){
		alert("예산부서가 존재하지 않습니다.");
		return;
	}

	if(eval("hid_bgtcmtype"+p5).value!=""){
		if(eval("hid_bgtcnt"+p5).value!="0"){
			if(no2==""||no2==undefined){
				alert("세목이 존재하지 않습니다.");
				return;
			}
		}
	}

  if(eval("gcem_chaamt"+p5).text==0||eval("gcem_chaamt"+p5).text==""){
		alert("금액을 입력하십시요.");
		return;
	}
  
	//alert("no2:::"+no2)
	if(eval("hid_bgtcnt"+p5).value!="0"&&eval("hid_bgtcnt"+p5).value!=""){
		strrefcd =  fn_trim(eval("txt_fsrefcd"+no2).value);
		strrefval = fn_trim(eval("txt_fsrefval"+no2).value);
	}else{
		//예산부서가 예산관리항목인 경우 세목은 00로 설정
		if(no2==""||no2==undefined){
			strrefcd="";
			strrefval="";
		}else{
			if(eval("txt_fsrefcd"+no2).value=="0003"){
				strrefcd=fn_trim(eval("txt_fsrefcd"+no2).value);
				strrefval="00";	 //세목  
			}else{
				strrefcd=fn_trim(eval("txt_fsrefcd"+no2).value);
				strrefval=fn_trim(eval("txt_fsrefval"+no2).value);	
			}
		}
	}

	strbgtdept= fn_trim(eval("txt_fsrefval"+no1).value);

	if(strbgtdept=="1080"){
		strbgtdiv="1000";
	}else{
    strbgtdiv = fn_trim(eval("hid_bgtdiv"+p5).value);
	}
	stratcode = fn_trim(eval("txt_atcode"+p5).value);

	//if(stryyyy==""){ alert("예산년도가 없습니다."); return;}
	//else if(strbgtdiv=="") { alert("예산본부가 없습니다."); return;}
	//else if(strbgtdept==""){ alert("예산부서가 없습니다."); return;}
	//else if(stratcode=="") { alert("계정코드가 없습니다.");  return;}
	//else if(strrefcd=="")  { alert("세목의 관리항목이 없습니다.");  return;}	

  ////alert("hid_bgtcmtype::"+eval("hid_bgtcmtype"+i).value);
	////alert("hid_bgtcnt::"+eval("hid_bgtcnt"+i).value);

	if(eval("hid_bgtcmtype"+p5).value!=""){
		if(eval("hid_bgtcnt"+p5).value!="0"){
			if(strrefval=="") { ///alert("999세목이 없습니다."); return;
			}
		}
	}
	
	ln_Bgt_Amt_Clear();

	//eval("sel_fswrkdiv"+p5).value='02';
	strfswrkdiv = fn_trim(eval("sel_fswrkdiv"+p5).value);
	//alert("strrefcd:"+strrefcd+"strrefval:"+strrefval);

	if(strfswrkdiv!="02"){
		return;
	}

  //^^alert("예산금액조회");
 	//예산 금액 조회
	if(ln_Bgt_Query(stryyyy,strbgtdiv,strbgtdept,stratcode,strrefcd,strrefval,strmm,strfswrkdiv,p5)){

		parent.gcem_realbgt.text=gcds_bgt.namevalue(gcds_bgt.rowposition,"REALBGT");
		parent.gcem_results.text=gcds_bgt.namevalue(gcds_bgt.rowposition,"RESULTS");
		parent.gcem_bresults.text=gcds_bgt.namevalue(gcds_bgt.rowposition,"BRESULTS");
		parent.gcem_janamt.text=gcds_bgt.namevalue(gcds_bgt.rowposition,"JANAMT");
		
		if(gcds_bgt.countrow>0){
			if(Number(eval("gcem_chaamt"+p5).text)>Number(parent.gcem_janamt.text)){
				alert("입력하신 금액이 예산 잔액금액보다 많습니다.");
				//eval("gcem_chaamt"+p5).text=0;
			}
		}else{
		  alert("예산이 없습니다.");
			ln_Bgt_Amt_Clear();
		}
	}else{
	  alert("예산이 없습니다.");
		parent.gcem_realbgt.text=0;
		parent.gcem_results.text=0;
		parent.gcem_bresults.text=0;
		parent.gcem_janamt.text=0;
	}
}

/******************************************************************************
	Description :  예산금액 초기화
	parameter   : 
******************************************************************************/
function ln_Bgt_Amt_Clear(){
	parent.gcem_realbgt.text=0;
	parent.gcem_results.text=0;
	parent.gcem_bresults.text=0;
	parent.gcem_janamt.text=0;
}

/******************************************************************************
	Description :  예산조회
	               예산타입이  부서비 기타(05) 공통(15) 경우 년예산 조회
                 그 외 월예산조회
                 ==> 2006.05.15 변경 내용
								 예산부서가 예산본부일경우 년예산조회 (예산본부-substring(2,4) = 00
								 예산부서가 예산부서일경우 월예산조회
	parameter   :  p5 - i position
******************************************************************************/
function ln_Bgt_Query(stryyyy,strbgtdiv,strbgtdept,stratcode,strrefcd,strrefval,strmm,strfswrkdiv,p5){
  //예산조회
	//alert("ln_Bgt_Query + 예산조회");
	//alert("strfswrkdiv:"+strfswrkdiv);
	//alert("stryyyy"+stryyyy+"strbgtdiv"+strbgtdiv+"strbgtdept"+strbgtdept+"stratcode"+stratcode+"strrefcd"+strrefcd+"strrefval"+strrefval+"strmm"+strmm+"strfswrkdiv"+strfswrkdiv);

	if(strfswrkdiv=="02"){ //적용
		//예산 금액 찾기
		//alert("strbgtdept.substring(2,4)::"+strbgtdept.substring(2,4));
		if(strbgtdept.substring(2,4)=="00"||strbgtdept.substring(2,4)=="10"){  //본부, 공통
		  if(stryyyy!=""&&strbgtdiv!=""&&strbgtdept!=""&&stratcode!=""&&strrefcd!=""&&strrefcd!=""){
				gcds_bgt.DataID = g_servlet+"/Account.a020001_s17?v_str1="+parent.gclx_fdcode02.bindcolval
																											 +"&v_str2="+stryyyy
																											 +"&v_str3="+strbgtdiv
																											 +"&v_str4="+strbgtdept
																											 +"&v_str5="+stratcode
																											 +"&v_str6="+strrefcd
																											 +"&v_str7="+strrefval;
																											 //+"&v_str8="+strfswrkdiv;
				prompt("yyyy",gcds_bgt.DataID);
				gcds_bgt.Reset();
			}
		}else{
		  if(stryyyy!=""&&strbgtdiv!=""&&strbgtdept!=""&&stratcode!=""&&strrefcd!=""&&strrefcd!=""&&strmm!=""){
				gcds_bgt.DataID = g_servlet+"/Account.a020001_s18?v_str1="+parent.gclx_fdcode02.bindcolval
																											 +"&v_str2="+stryyyy
																											 +"&v_str3="+strbgtdiv
																											 +"&v_str4="+strbgtdept
																											 +"&v_str5="+stratcode
																											 +"&v_str6="+strrefcd
																											 +"&v_str7="+strrefval
																											 +"&v_str8="+strmm;
																											 //+"&v_str9="+strfswrkdiv;
				prompt("yymm",gcds_bgt.DataID);
				gcds_bgt.Reset();
			}
		}
		return true
	}else{ //미적용
		return false;
	}
}

/******************************************************************************
	Description :  자동기표일경우 입력된 건은 모두 lock으로 표시함.
	parameter   :  p5 - row : position
******************************************************************************/
function ln_lock(row, gubun){
   
	 if(gubun=="1"){ //세금계산서
	   /*
		 if(eval("chkbox"+row).value!="") {
				eval("chkbox"+row).disabled=true;
		 }else{
				eval("chkbox"+row).disabled=false;
		 }
		 */

		 if(eval("txt_fsnum"+row).value!="") {
				eval("txt_fsnum"+row).disabled=true;
		 }else{
				eval("txt_fsnum"+row).disabled=false;
		 }

     /*
		 if(eval("txt_atcode"+row).value!="") {
				eval("txt_atcode"+row).disabled=true;
		 }else{
				eval("txt_atcode"+row).disabled=false;
		 }

		 if(eval("txt_atkornam"+row).value!=""){
				eval("txt_atkornam"+row).disabled=true;
		 }else{
				eval("txt_atkornam"+row).disabled=false;
		 }

		 if(eval("gcem_chaamt"+row).text!="") {
				eval("gcem_chaamt"+row).readOnly=true;
		 }else{
				eval("gcem_chaamt"+row).readOnly=false;
		 }

		 if(eval("gcem_daeamt"+row).text!=""){
				eval("gcem_daeamt"+row).readOnly=true;
		 }else{
				eval("gcem_daeamt"+row).readOnly=false;
		 }
     */

		 if(eval("sel_documcd"+row).text!=""){
				eval("sel_documcd"+row).disabled=true;
		 }else{
				eval("sel_documcd"+row).disabled=false;
		 }

     /*
		 if(eval("txt_remark"+row).value!="") {
				eval("txt_remark"+row).disabled=true;
		 }else{
				eval("txt_remark"+row).disabled=false;
		 }
		 */
		
		 if(eval("sel_fswrkdiv"+row).text!=""){
				eval("sel_fswrkdiv"+row).disabled=true;
		 }else{
				//eval("sel_fswrkdiv"+row).disabled=false;
		 }

			for( j=1;j<=3;j++){
				for(i=1;i<=3;i++){
					if(eval("txt_fsrefcd"+row+j+i).value=="0002"){//부서가 아닐경우
            eval("txt_fsrefval"+row+j+i).disabled=false;
						eval("txt_fsrvalnm"+row+j+i).disabled=false;	
					}else{
						if(eval("txt_fsrefval"+row+j+i).value!=""){
							eval("txt_fsrefval"+row+j+i).disabled=true;
						}else{
							eval("txt_fsrefval"+row+j+i).disabled=false;
						}

						if(eval("txt_fsrvalnm"+row+j+i).value!=""){
							eval("txt_fsrvalnm"+row+j+i).disabled=true;	
						}else{
							eval("txt_fsrvalnm"+row+j+i).disabled=false;	
						}
					}
				}
			}
		}else{//6반제
			if(eval("chkbox"+row).value!="") {
				eval("chkbox"+row).disabled=true;
		 }else{
				eval("chkbox"+row).disabled=false;
		 }

		 if(eval("txt_fsnum"+row).value!="") {
				eval("txt_fsnum"+row).disabled=true;
		 }else{
				eval("txt_fsnum"+row).disabled=false;
		 }

		 if(eval("txt_atcode"+row).value!="") {
				eval("txt_atcode"+row).disabled=true;
		 }else{
				eval("txt_atcode"+row).disabled=false;
		 }

		 if(eval("txt_atkornam"+row).value!=""){
				eval("txt_atkornam"+row).disabled=true;
		 }else{
				eval("txt_atkornam"+row).disabled=false;
		 }

		 if(eval("gcem_chaamt"+row).text!="") {
				eval("gcem_chaamt"+row).readOnly=true;
		 }else{
				eval("gcem_chaamt"+row).readOnly=false;
		 }

		 if(eval("gcem_daeamt"+row).text!=""){
				eval("gcem_daeamt"+row).readOnly=true;
		 }else{
				eval("gcem_daeamt"+row).readOnly=false;
		 }

		 if(eval("sel_documcd"+row).text!=""){
				eval("sel_documcd"+row).disabled=true;
		 }else{
				eval("sel_documcd"+row).disabled=false;
		 }

		 if(eval("txt_remark"+row).value!="") {
				eval("txt_remark"+row).disabled=true;
		 }else{
				eval("txt_remark"+row).disabled=false;
		 }
		
		 if(eval("sel_fswrkdiv"+row).text!=""){
				eval("sel_fswrkdiv"+row).disabled=true;
		 }else{
				//eval("sel_fswrkdiv"+row).disabled=false;
		 }

			for( j=1;j<=3;j++){
				for(i=1;i<=3;i++){
					if(eval("txt_fsrefval"+row+j+i).value!=""){
						eval("txt_fsrefval"+row+j+i).disabled=true;
					}else{
						eval("txt_fsrefval"+row+j+i).disabled=false;
					}
					if(eval("txt_fsrvalnm"+row+j+i).value!=""){
						eval("txt_fsrvalnm"+row+j+i).disabled=true;	
					}else{
						eval("txt_fsrvalnm"+row+j+i).disabled=false;	
					}
				}
			}
		}//if gubun
}


/******************************************************************************
	Description :  자금관련 해서 가져온 데이타는 lock(반제도 사용)
	parameter   :  strPo: position
******************************************************************************/
function ln_Ref_lock(strPo,gubun,row){
   
	if(gubun=="1"){ //발생
		if(eval("txt_fsrvalnm"+strPo).value!=""){
			eval("txt_fsrvalnm"+strPo).disabled=true;	
		}else{
			eval("txt_fsrvalnm"+strPo).disabled=false;	
		}
	}else if(gubun=="2"){//정산
		if(eval("txt_fsrvalnm"+strPo).value!=""){
			eval("txt_fsrvalnm"+strPo).disabled=true;	
		}else{
			eval("txt_fsrvalnm"+strPo).disabled=false;	
		}
	}else if(gubun=="3"&&row!=""){//금액
		eval("gcem_daeamt"+row).ReadOnly=true; 
		eval("gcem_chaamt"+row).ReadOnly=true;
	}
}


/******************************************************************************
	Description :  자금관련 계정 구분
	parameter   :  gubun 구분(체크위치,
	               p1 -object
								 p5 -row
	참     고   : //지급어음 & 차변 =0 대변 <>0 (발생 ==> Popup)
								//지급어음 & 차변<>0 대변 = 0 (정산 ==> Popup)
								//받을어음 & 차변 =0 대변 <>0 (정산 ==> Popup)
								//받을어음 & 차변<>0 대변 = 0 (발생 ==> 입력)
******************************************************************************/
function ln_PopGubun(gubun, p1, p5){
	var strPopGb="";
	
	if(gubun=="1"){
		if(eval(p1).value=="0967"&&eval("hid_funddiv"+p5).value=="60"&& eval("gcem_chaamt"+p5).text==0 && eval("gcem_daeamt"+p5).text!=0){
			strPopGb="1";
		}else if(eval(p1).value=="0967"&&eval("hid_funddiv"+p5).value=="60"&& eval("gcem_chaamt"+p5).text!=0 && eval("gcem_daeamt"+p5).text==0){
			strPopGb="2";
		}else if(eval(p1).value=="0967"&&eval("hid_funddiv"+p5).value=="50"&& eval("gcem_chaamt"+p5).text==0 && eval("gcem_daeamt"+p5).text!=0){
			strPopGb="2";
		}
	}else if(gubun=="2"){
		if(eval("hid_funddiv"+p5).value=="60"&& eval("gcem_chaamt"+p5).text==0&&eval("gcem_daeamt"+p5).text!=0){
			strPopGb="1";
		}else if(eval("hid_funddiv"+p5).value=="60"&& eval("gcem_chaamt"+p5).text!=0&&eval("gcem_daeamt"+p5).text==0){
			strPopGb="2";
		}else if(eval("hid_funddiv"+p5).value=="50"&& eval("gcem_chaamt"+p5).text==0&&eval("gcem_daeamt"+p5).text!=0){
			strPopGb="2";
		}
	}
  return strPopGb;
}
/******************************************************************************
	Description :  결재요청 체크.
	parameter   :  
	참       고 :  전표번호가 있으면서, 계정이 둘이상 존재할 경우만 결재요청 가능함.
	               전표상태가 대기중이어야하 함.
******************************************************************************/
function ln_Confirm_Chk(){
 
	if(parent.gcem_fs02.text!=""&&parent.gcem_fsdat02.text!=""&&parent.gcem_fsnbr02.text!=""){
		if(parent.gcem_fsnbr02.text=="000000"){
			return false;
		}
   
		if(g_row<2){
			return false;
		}
		return true;
	}
}

/******************************************************************************
	Description :  예산본부찾기
	parameter   :  p1 - row position, p2-부서명, 
	참       고 :  부서명으로 예산본부찾기
******************************************************************************/
function ln_Find_Bgtdiv(p1,p2){

	var strbgtfind="false"; //예산부서가 없음.
	var strpo="";
	
	_out:
	for(f=1;f<=3;f++){
		for (g=1;g<=3;g++){
			if (eval("txt_fsrefcd"+p1+f+g).value=="0003"){
			    strbgtfind="true";			
					strpo = p1+f+g ; 
					break _out; 
			} 
		}//for g
	}//for f

	//^^alert("strbgtfind"+ strbgtfind);
				
  if(strbgtfind=="true"){
		gcds_commdtilnm.DataID = g_servlet+"/Account.hcdept_s1?v_str1=&v_str2="+p2;
		//prompt("",gcds_commdtilnm.DataID);
		gcds_commdtilnm.Reset(); 
		eval("hid_bgtdiv"+p1).value=gcds_commdtilnm.namevalue(1,"BGTDIVCD");
		eval("txt_fsrefval"+strpo).value=gcds_commdtilnm.namevalue(1,"BGTDEPT");
		eval("txt_fsrvalnm"+strpo).value=gcds_commdtilnm.namevalue(1,"BGTDETPNM");
	  //alert("hid_bgtdiv::"+eval("hid_bgtdiv"+p1).value);
	}else{
		if(fn_trim(p2)=="공통"){//부서가 공통일경우 예산본부는 회사공통
			eval("hid_bgtdiv"+p1).value="1000";
		}
	}
}


/******************************************************************************
	Description :  예산금액조회
	parameter   : 
******************************************************************************/
function ln_BgtFind(){
  var cnt=0;
	var po=0;
  
	for(i=1;i<=g_row;i++){
		if(eval("hid_flag"+i+"0").value=="T"){
      if(eval("txt_atcode"+i).value!=""&&eval("txt_atkornam"+i).value!=""){  //계정과목이 존재하는 경우
				if(eval("chkbox"+i).checked==true){
					cnt+=1;
			    po=i;
				}
			}
		}
	}

	if(cnt>1){
		alert("한 건만 선택해 주십시요.");
	}else if(cnt==0){
    alert("예산 조회 항목을 선택해 주십시요.");
	}else{
		if(fn_trim(eval("sel_fswrkdiv"+po).value)!="02"){
			alert("예산 적용건이 아닙니다.");
		}else{
			ln_Bgt_Amt_find('','','',po);
		}
	}
}
</script>

<!-----------------------------------------------------------------------------
		D A T A S E T   C O M P O N E N T S   D E C L A R A T I O N
------------------------------------------------------------------------------>
<comment id="__NSID__"><object  id=gcds_mst classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id=gcds_data01 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- detail과 관리항목 update 용 -->
<comment id="__NSID__"><object  id=gcds_data02 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 


<!-- detail과 관리항목 건별삭제 -->
<comment id="__NSID__"><object  id=gcds_del01 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- detail과 관리항목 전체삭제 -->
<comment id="__NSID__"><object  id=gcds_del02 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 저장시 지점코드,접수일자, 전표순번을 return 받음 -->
<!-- <comment id="__NSID__"><object  id=gcds_key classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
</object></comment><script>__ws__(__NSID__);</script> 
 -->
<!-- 계정코드로 관리항목 가져오기  부가세-->
<comment id="__NSID__"><object  id=gcds_code01 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 
<!-- 계정코드로 관리항목 가져오기  전표등록-->
<comment id="__NSID__"><object  id=gcds_code02 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 반제정보  -->
<comment id="__NSID__"><object  id=gcds_banjae classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id=gcds_banjae2 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id=gcds_banjaemst classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 증빙구분 - 매입매출증빙  -->
<comment id="__NSID__"><object  id=gcds_tax classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 증빙구분 - 일반증빙  -->
<comment id="__NSID__"><object  id=gcds_genrst classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 세금계산서 연결건수  -->
<comment id="__NSID__"><object  id=gcds_taxcnt classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 대체전표 REPORT START -->
<comment id="__NSID__"><object  id=gcds_print classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id=gcds_prttemp1 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id=gcds_prttemp2 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 
<!-- 대체전표 REPORT END -->

<!-- 증빙코드 -->
<comment id="__NSID__"><object  id=gcds_documcd classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 예산타입 -->
<comment id="__NSID__"><object  id=gcds_fswrkdiv classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 전표번호생성 -->
<comment id="__NSID__"><object  id=gcds_slipno classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 예산조회 -->
<comment id="__NSID__"><object  id=gcds_bgt classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 예산등록 - 전표등록시 반영 -->
<comment id="__NSID__"><object  id=gcds_bgt_insert classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 예산등록 - 전표수정시 반영-->
<comment id="__NSID__"><object  id=gcds_bgt_update classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 예산등록 - 전표삭제시 반영-->
<comment id="__NSID__"><object  id=gcds_bgt_del classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 예산등록 - 예산총계정원장 반영-->
<comment id="__NSID__"><object  id=gcds_bgt_geled classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 예산등록 - 전표 전체삭제시 반영-->
<comment id="__NSID__"><object  id=gcds_bgt_del_all classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 마감체크-->
<comment id="__NSID__"><object  id=gcds_slip_close classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 현업 및 회계관련 부서 확인-->
<comment id="__NSID__"><object  id=gcds_dept2 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 순번 update함-->
<comment id="__NSID__"><object  id=gcds_fsnum classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 


<comment id="__NSID__"><object  id=gcds_data01_1 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id=gcds_data01_2 classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 



<!-- 관리항목명찾기-->
<comment id="__NSID__"><object  id=gcds_commdtilnm classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 관리항목명찾기-->
<comment id="__NSID__"><object  id=gcds_name classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 반제계정찾기-->
<comment id="__NSID__"><object  id=gcds_banjae_atcode classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="SyncLoad" VALUE="true">
</object></comment><script>__ws__(__NSID__);</script> 


<!-----------------------------------------------------------------------------
	  T R A N S A C T I O N   C O M P O N E N T S   D E C L A R A T I O N
------------------------------------------------------------------------------>
<!-- 입력/수정 -->
<comment id="__NSID__"><object  id=gctr_data01 classid=clsid:0a2233ad-e771-11d2-973d-00104b15e56f viewastext>
	<param name="keyname"			value="toinb_dataid4">
	<param name="keyvalue"    value="a020001_t1f(I:USER=gcds_mst,I:USER2=gcds_data01,I:USER3=gcds_data02,I:USER4=gcds_del01,I:USER6=gcds_banjae,I:USER14=gcds_banjaemst,I:USER7=gcds_tax,I:USER8=gcds_genrst,I:USER9=gcds_bgt_insert,I:USER10=gcds_bgt_update,I:USER11=gcds_bgt_del,I:USER12=gcds_bgt_geled,I:USER13=gcds_fsnum,O:USER5=gcds_slipno)">   
</object></comment><script>__ws__(__NSID__);</script> 


<!-- 전체 삭제  -->
<comment id="__NSID__"><object  id=gctr_data02 classid=clsid:0a2233ad-e771-11d2-973d-00104b15e56f viewastext>
	<param name="keyname"			value="toinb_dataid4">
	<param name="keyvalue"    value="a020001_t2f(I:USER=gcds_del02,I:USER22=gcds_bgt_del_all)">   
</object></comment><script>__ws__(__NSID__);</script> 


<!-- Detail 건별  삭제  -->
<comment id="__NSID__"><object  id=gctr_data03 classid=clsid:0a2233ad-e771-11d2-973d-00104b15e56f viewastext>
	<param name="keyname"			value="toinb_dataid4">
	<param name="keyvalue"    value="a020001_t3f(I:USER=gcds_del01)">   
</object></comment><script>__ws__(__NSID__);</script>  


<!-----------------------------------------------------------------------------
					D A T A S E T   C O M P O N E N T' S
		M A N D A T O R Y   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language=JavaScript  for=gcds_data01 event="OnLoadStarted()" >
	//parent.document.all.LowerFrame.style.visibility="visible";
    document.all.LowerFrame.style.visibility="visible";
	//alert("start");
</script>

<script language=JavaScript  for=gcds_data01 event="OnLoadError()">
	  //alert("에러가 발생 했습니다.");
	  window.status="조회가 완료 되었습니다.";
</script>

<script language=JavaScript  for=gcds_data01 event="OnLoadCompleted(rowcount)">
  //ft_cnt1.innerText = "조회건수 : " + rowcount + " 건";
  //alert("end" + rowcount);
  if (gcds_data01.namevalue(rowcount,"FSSEQ")==""){
	
	}else{
	  ln_SetFormat(rowcount);
	}
 
	if (rowcount ==0 ){
		alert("검색된 데이타가 없습니다.");
	}else{
	  g_yn = gcds_data01.namevalue(gcds_data01.rowposition,"FSSTAT");
		ln_onblur('01','','') //차변대변 금액합계
	} 
	window.status = " 조회가 완료 되었습니다.";
	//parent.document.all.LowerFrame.style.visibility="hidden";
	document.all.LowerFrame.style.visibility="hidden";
</script>

<script language=JavaScript  for=gcds_banjae2 event=OnLoadCompleted(rowcount)>
 
</script>

<script language=JavaScript  for=gcds_prttemp1 event=OnLoadCompleted(rowcount)>
	if(rowcount>=1){
	  ln_PrintSubQuery();
	}
</script>

<script language=JavaScript  for=gcds_prttemp2 event=OnLoadCompleted(rowcount)>
	if(rowcount>=1){
	  document.all.LowerFrame.style.visibility="visible";
	  ln_PrintSubQuery2();
		document.all.LowerFrame.style.visibility="hidden";
	}else{
		alert("출력할 정보가 없습니다.");
	}
	
</script>


<!-----------------------------------------------------------------------------
					G A U C E   C O M P O N E N T' S
		G E N E R A L   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>

<!-----------------------------------------------------------------------------
				T R A N S A C T I O N   C O M P O N E N T' S
		M A N D A T O R Y   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javascript" for="gctr_data01" event="onsuccess()">
  var temp="";
  parent.gclx_fdcode02.bindcolval = gcds_slipno.namevalue(gcds_slipno.rowposition,"FDCODE");
	temp = gcds_slipno.namevalue(gcds_slipno.rowposition,"FSDAT");
  parent.gcem_fs02.text = temp.substring(0,1);
	parent.gcem_fsdat02.text = temp.substring(1,9);
	parent.gcem_fsnbr02.text = gcds_slipno.namevalue(gcds_slipno.rowposition,"FSNBR");
	//alert("::"+gcds_slipno.namevalue(gcds_slipno.rowposition,"FDCODE"));
																								
	alert("작업이 성공적으로 완료되었습니다.");

	gcds_mst.ClearData();
	gcds_data02.ClearData();
	gcds_data01.ClearData();
	gcds_del01.ClearData();
	gcds_banjae.ClearData();
</script>
<script language="javascript" for="gctr_data02" event="onsuccess()">
	alert("작업이 성공적으로 완료되었습니다.");
</script>

<script language="javascript" for="gctr_data01" event="onfail()">
	alert("작업이 성공적으로 완료되지 못했습니다.");
	gcds_mst.ClearData();
	gcds_data02.ClearData();
	gcds_data01.ClearData();
	gcds_del01.ClearData();
	gcds_banjae.ClearData();
	alert("Error Code : " + gctr_data01.ErrorCode + "\n" + "Error Message : " + gctr_data01.ErrorMsg + "\n");

</script>
<script language="javascript" for="gctr_data02" event="onfail()">
	alert("작업이 성공적으로 완료되지 못했습니다.");
</script>

</HEAD>

<!-----------------------------------------------------------------------------
						B O D Y   D E F I N I T I O N
------------------------------------------------------------------------------>

<body bgcolor="#FFFFFF" topmargin="0" marginheight="0" leftmargin="0" marginwidth="0" onload="ln_Start();">
<div id=div1></div>
<!-- <table width=876 cellpadding=0 cellspacing=0 border=0 style=position:relative;left:3px>	<tr>		<td width=80px bgcolor=#eeeeee class=tab15 align=center>		테스트</td>	</tr></table> -->
	<!--   <comment id="__NSID__"><object  id=gclx_documcd3 classid=clsid:60109D65-70C0-425C-B3A4-4CB001513C69 	style=position:relative;left:0px;top:0px;font-size:12px;width:79px;> ";
	   		<param name=ComboDataID			value=gcds_comcode01>
	 		<param name=CBDataColumns		value=CDCODE,CDNAM>
	 		<param name=SearchColumn		value=CDNAM>
	  		<param name=ListExprFormat	value=CDNAM^0^80>
   		<param name=BindColumn			value=CDCODE>
    </object></comment><script>__ws__(__NSID__);</script>  -->


<!-- ==================================================================================================================
						L O A D I N G  B A R   D E F I N I T I O N
========================================================================================================================-->
<iframe id="LowerFrame" name="work" style="visibility:hidden;position:absolute;left:280px;top:100px;" FrameBorder="0" src="../../Common/img/flash/loading.swf" width="320px" height="42px"></iframe> 


<!-----------------------------------------------------------------------------
						B I N D   D E F I N I T I O N
------------------------------------------------------------------------------>
<!-- 전표등록 Detail-->
<comment id="__NSID__"><object  id=gcbn_data02 classid=CLSID:9C9AB433-EA85-11D2-A4F9-00608CEBEE49> 
	<param name=DataID    value=gcds_data01>
	<param name=BindInfo  value=''>
</object></comment><script>__ws__(__NSID__);</script> 

<!-----------------------------------------------------------------------------
			R E P O R T   D E F I N I T I O N - 대 체 전 표
------------------------------------------------------------------------------>
<comment id="__NSID__"><object  id=gcrp_print  classid=clsid:37D13B2F-E5EB-11D2-973D-00104B15E56F VIEWASTEXT>
	<param NAME="MasterDataID"			VALUE="gcds_print">
	<param NAME="DetailDataID"			VALUE="gcds_print">
	<PARAM NAME="PaperSize"					VALUE="A4">	
	<PARAM NAME="FixPaperSize"			VALUE="true">
	<PARAM NAME="PrintMargine"      VALUE="false">
	<PARAM NAME="LandScape"					VALUE="true">
  <PARAM NAME="PrintSetupDlgFlag" VALUE="true">
	<PARAM NAME="PreviewZoom"				VALUE="100">
	<PARAM NAME="Format" VALUE="
<B>id=DHeader ,left=0,top=0 ,right=2871 ,bottom=455 ,face='Arial' ,size=10 ,penwidth=1
	<X>left=1130 ,top=34 ,right=1969 ,bottom=108 ,backcolor=#000000 ,border=true ,penstyle=solid ,penwidth=1</X>
	<X>left=1122 ,top=21 ,right=1955 ,bottom=101 ,backcolor=#C0C0C0 ,border=true ,penstyle=solid ,penwidth=1</X>
	<L> left=2024 ,top=344 ,right=2024 ,bottom=452 </L>
	<L> left=241 ,top=452 ,right=2823 ,bottom=452 ,penstyle=solid ,penwidth=2 ,pencolor=#000000 </L>
	<T>id='Page : #p of #t' ,left=2397 ,top=180 ,right=2818 ,bottom=233 ,align='right' ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<L> left=2823 ,top=344 ,right=2823 ,bottom=452 ,penstyle=solid ,penwidth=2 ,pencolor=#000000 </L>
	<T>id='대    변' ,left=2429 ,top=402 ,right=2815 ,bottom=447 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<T>id='차    변' ,left=2032 ,top=402 ,right=2418 ,bottom=447 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<L> left=2421 ,top=344 ,right=2421 ,bottom=452 </L>
	<T>id='외화차변' ,left=2032 ,top=349 ,right=2418 ,bottom=394 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<T>id='외화대변' ,left=2429 ,top=349 ,right=2815 ,bottom=394 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<L> left=1445 ,top=344 ,right=1445 ,bottom=452 </L>
	<T>id='관리항목' ,left=1159 ,top=402 ,right=1442 ,bottom=447 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<T>id='순번' ,left=246 ,top=349 ,right=341 ,bottom=447 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<L> left=241 ,top=344 ,right=241 ,bottom=452 ,penstyle=solid ,penwidth=2 ,pencolor=#000000 </L>
	<L> left=344 ,top=344 ,right=344 ,bottom=452 </L>
	<L> left=344 ,top=397 ,right=2823 ,bottom=397 </L>
	<L> left=241 ,top=344 ,right=2823 ,bottom=344 ,penstyle=solid ,penwidth=2 ,pencolor=#000000 </L>
	<T>id='증빙명' ,left=1834 ,top=349 ,right=2021 ,bottom=394 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<T>id='부서명/사업CODE' ,left=1159 ,top=349 ,right=1442 ,bottom=394 ,face='굴림' ,size=9 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<C>id='CURDT', left=1122, top=291, right=1953, bottom=336 ,mask='회계일자 : XXXX년 XX월 XX일', face='굴림', size=12, bold=true, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='DATA03', left=241, top=230, right=900, bottom=283, align='left', face='굴림', size=10, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='DATA02', left=241, top=177, right=900, bottom=230, align='left', face='굴림', size=10, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='DATA01', left=241, top=132, right=900, bottom=177, align='left', face='굴림', size=10, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<T>id='' ,left=1834 ,top=402 ,right=2021 ,bottom=447 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<L> left=1154 ,top=344 ,right=1154 ,bottom=452 </L>
	<T>id='세목/세세목' ,left=868 ,top=349 ,right=1151 ,bottom=394 ,align='left' ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<T>id='적     요' ,left=349 ,top=402 ,right=1151 ,bottom=447 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<T>id='계정과목명' ,left=349 ,top=349 ,right=863 ,bottom=394 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<T>id='대   체   전   표' ,left=1124 ,top=24 ,right=1950 ,bottom=95 ,face='HY중고딕' ,size=16 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#C0C0C0</T>
	<L> left=1828 ,top=344 ,right=1828 ,bottom=452 </L>
	<T>id='관리항목' ,left=1450 ,top=402 ,right=1826 ,bottom=447 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<T>id='거 래 처' ,left=1450 ,top=349 ,right=1826 ,bottom=394 ,face='굴림' ,size=10 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFBF0</T>
	<C>id='DATA04', left=2514, top=283, right=2823, bottom=336, face='굴림', size=10, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='DATA05', left=241, top=283, right=900, bottom=336, align='left', face='굴림', size=10, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<T>id='전 표 번 호 :' ,left=2302 ,top=283 ,right=2514 ,bottom=336 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
</B>
<B>id=default ,left=0,top=0 ,right=2871 ,bottom=130 ,face='Arial' ,size=10 ,penwidth=1
	<L> left=344 ,top=58 ,right=2823 ,bottom=58 ,penstyle=solid ,penwidth=1 ,pencolor=#A0A0A4 </L>
	<L> left=241 ,top=124 ,right=2823 ,bottom=124 ,penstyle=solid ,penwidth=2 ,pencolor=#000000 </L>
	<C>id='{CURROW}', left=246, top=0, right=341, bottom=122 ,mask='XXXX/XX/XX', face='굴림', size=10, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<L> left=241 ,top=0 ,right=241 ,bottom=124 ,penstyle=solid ,penwidth=2 ,pencolor=#000000 </L>
	<L> left=2823 ,top=0 ,right=2823 ,bottom=124 ,penstyle=solid ,penwidth=2 ,pencolor=#000000 </L>
	<L> left=2421 ,top=0 ,right=2421 ,bottom=124 </L>
	<L> left=344 ,top=0 ,right=344 ,bottom=124 </L>
	<C>id='FODAEAMT', left=2429, top=0, right=2815, bottom=56, align='right', face='굴림', size=14, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='{decode(DAEAMT,0,,DAEAMT)}', left=2429, top=61, right=2815, bottom=119, align='right', face='굴림', size=14, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='REMARK', left=349, top=66, right=1151, bottom=122, align='left', face='굴림', size=10, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='ATKORNAM', left=349, top=0, right=863, bottom=56, align='left', face='굴림', size=11, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='DETITLE', left=868, top=0, right=1151, bottom=56, align='left', face='굴림', size=8, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<L> left=1154 ,top=0 ,right=1154 ,bottom=124 </L>
	<C>id='FSRVALNM013', left=1159, top=66, right=1442, bottom=122, align='left', face='굴림', size=9, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='FSRVALNM011', left=1159, top=0, right=1442, bottom=56, align='left', face='굴림', size=9, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<L> left=1445 ,top=0 ,right=1445 ,bottom=124 </L>
	<C>id='FSRVALNM014', left=1450, top=66, right=1826, bottom=122, align='left', face='굴림', size=9, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='FSRVALNM012', left=1450, top=0, right=1826, bottom=56, align='left', face='굴림', size=9, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<L> left=1828 ,top=0 ,right=1828 ,bottom=124 </L>
	<C>id='{decode(CHAAMT,0,,CHAAMT)}', left=2032, top=66, right=2418, bottom=122, align='right', face='굴림', size=14, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='FOCHAAMT', left=2032, top=0, right=2418, bottom=56, align='right', face='굴림', size=14, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<L> left=2024 ,top=0 ,right=2024 ,bottom=124 </L>
	<C>id='', left=1834, top=66, right=2021, bottom=122, face='굴림', size=9, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='DOCUVAL', left=1834, top=0, right=2021, bottom=56, face='굴림', size=8, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
</B>
<B>id=Footer ,left=0 ,top=1500 ,right=2871 ,bottom=2000 ,face='Arial' ,size=10 ,penwidth=1
	<T>id='합    계' ,left=1482 ,top=16 ,right=1852 ,bottom=77 ,face='굴림' ,size=12 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<L> left=241 ,top=8 ,right=241 ,bottom=82 </L>
	<L> left=2823 ,top=8 ,right=2823 ,bottom=82 </L>
	<T>id='─金 :' ,left=246 ,top=16 ,right=558 ,bottom=77 ,face='굴림' ,size=12 ,bold=true ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<L> left=241 ,top=8 ,right=2823 ,bottom=8 </L>
	<L> left=1474 ,top=8 ,right=1474 ,bottom=82 </L>
	<C>id='CHASUM', left=1865, top=16, right=2328, bottom=77, align='right', face='굴림', size=14, bold=true, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<C>id='DAESUM', left=2342, top=16, right=2818, bottom=77, align='right', face='굴림', size=14, bold=true, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
	<L> left=2331 ,top=8 ,right=2331 ,bottom=82 </L>
	<L> left=241 ,top=82 ,right=2823 ,bottom=82 </L>
	<L> left=241 ,top=87 ,right=2823 ,bottom=87 </L>
	<T>id='수  령  인' ,left=246 ,top=98 ,right=664 ,bottom=143 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='예  산' ,left=672 ,top=98 ,right=892 ,bottom=143 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='자      금' ,left=900 ,top=98 ,right=1315 ,bottom=143 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='사   장' ,left=2627 ,top=98 ,right=2818 ,bottom=143 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='부사장' ,left=2442 ,top=98 ,right=2622 ,bottom=143 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<L> left=241 ,top=148 ,right=2823 ,bottom=148 </L>
	<L> left=241 ,top=212 ,right=1320 ,bottom=212 </L>
	<T>id='결   재' ,left=1326 ,top=98 ,right=1471 ,bottom=143 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='성  명' ,left=246 ,top=153 ,right=434 ,bottom=209 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='서  명' ,left=445 ,top=153 ,right=664 ,bottom=209 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='확  인' ,left=672 ,top=153 ,right=892 ,bottom=209 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='담  당' ,left=900 ,top=153 ,right=1087 ,bottom=209 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='확  인' ,left=1098 ,top=153 ,right=1315 ,bottom=209 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='본부장' ,left=2249 ,top=98 ,right=2432 ,bottom=143 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='중  역' ,left=2058 ,top=98 ,right=2241 ,bottom=143 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='부서장' ,left=1865 ,top=98 ,right=2048 ,bottom=143 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='검  토' ,left=1672 ,top=98 ,right=1852 ,bottom=143 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<T>id='담  당' ,left=1482 ,top=98 ,right=1664 ,bottom=143 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<L> left=1855 ,top=8 ,right=1855 ,bottom=82 </L>
	<L> left=241 ,top=400 ,right=2823 ,bottom=400 ,penstyle=solid ,penwidth=2 ,pencolor=#000000 </L>
	<I>id='../../common/img/icon.jpg' ,left=2447 ,top=402 ,right=2826 ,bottom=484</I>
	<L> left=241 ,top=386 ,right=2823 ,bottom=386 </L>
	<L> left=1090 ,top=151 ,right=1090 ,bottom=386 </L>
	<L> left=1320 ,top=90 ,right=1320 ,bottom=386 </L>
	<L> left=2823 ,top=90 ,right=2823 ,bottom=386 </L>
	<L> left=2622 ,top=90 ,right=2622 ,bottom=386 </L>
	<L> left=2434 ,top=90 ,right=2434 ,bottom=386 </L>
	<L> left=2244 ,top=90 ,right=2244 ,bottom=386 </L>
	<L> left=2053 ,top=90 ,right=2053 ,bottom=386 </L>
	<L> left=1855 ,top=90 ,right=1855 ,bottom=386 </L>
	<L> left=1667 ,top=90 ,right=1667 ,bottom=386 </L>
	<L> left=1474 ,top=90 ,right=1474 ,bottom=386 </L>
	<L> left=241 ,top=90 ,right=241 ,bottom=386 </L>
	<L> left=894 ,top=90 ,right=894 ,bottom=386 </L>
	<L> left=667 ,top=90 ,right=667 ,bottom=386 </L>
	<L> left=439 ,top=151 ,right=439 ,bottom=386 </L>
	<T>id='담당부' ,left=1326 ,top=153 ,right=1471 ,bottom=262 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<L> left=1320 ,top=267 ,right=2622 ,bottom=267 </L>
	<T>id='경리부' ,left=1326 ,top=273 ,right=1471 ,bottom=384 ,face='굴림' ,size=10 ,bold=false ,underline=false ,italic=false ,forecolor=#000000 ,backcolor=#FFFFFF</T>
	<C>id='CURDT2', left=246, top=418, right=667, bottom=463, align='left' ,mask='출력일자: XXXX/XX/XX', face='굴림', size=10, bold=false, underline=false, italic=false, forecolor=#000000, backcolor=#FFFFFF</C>
</B>
">
</object></comment><script>__ws__(__NSID__);</script> 

</body>
</html>