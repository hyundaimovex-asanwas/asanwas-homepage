<!-------------------------------------------------------------------------------
+ 시 스 템 명	:	세금계산서관리 - Popup
+ 프로그램 ID	: Comtax_popup
+ 기 능 정 의	: 조회|등록|저장|삭제
+ 최 초 이 력	: 이순미
-----------------------------------------------------------------------------
+ 수 정 내 용 :	전표입력시 사용하기 위해 수정   
                전표입력, 수정시 하나 저장 버튼으로 처리함.
+ 수   정  자 : 정영식 
+ 수 정 일 자 :
-----------------------------------------------------------------------------
+ 서 블 릿 명	: comtax_popup_s1,comtax_popup_t0,comtax_popup_t1,comtax_popup_t2
------------------------------------------------------------------------------>

<html>
<head>
<title>세금계산서관리 - Popup</title>
<meta http-equiv="Content-Type" content="text/html; charset=euc-kr">
<!-----------------------------------------------------------------------------
		S T Y L E   S H E E T   L I N K   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<link rel="stylesheet" href="../../common/include/common.css">

<!-----------------------------------------------------------------------------
		C O M M O N   M O D U L E   S C R I P T S( MESSAGE & FUNCTION )
------------------------------------------------------------------------------>
<Script language="javascript" src="../../common/include/PubFun.js"></script>

<!-----------------------------------------------------------------------------
		L O C A L   S T Y L E   S H E E T   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<style type="text/css">
<!--
//-->
</style>

<!-----------------------------------------------------------------------------
		L O C A L   S C R I P T   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javascript">
var g_fdcod="";     //지점코드   
var g_fsdat="";			//전표일자   
var g_fsnbr="";			//전표번호   
var g_fsseq="";			//전표행번호 
var g_fsrefval="";  //거래처코드 
var g_fsrvalnm="";  //거래처명   
var g_documcd="";   //증빙구분

get_cookdata();
gs_date = gcurdate.substring(0,4) + gcurdate.substring(5,7) + gcurdate.substring(8,10);
gs_date2 = gcurdate.substring(0,4) + gcurdate.substring(5,7);

/******************************************************************************
	Description : 페이지 로딩
	parameter   : strParam[0] - 지점코드
	              strParam[1] - 전표일자
                strParam[2] - 전표번호
								strParam[3] - 전표행번호
								strParam[4] - 거래처코드
								strParam[5] - 거래처명
******************************************************************************/
function ln_Start(){
	
	var strParam = new Array();
	strParam=window.dialogArguments;
  //alert("strParam[0]"+strParam[0]+"strParam[1]"+strParam[1]+"strParam[2]"+strParam[2]+"strParam[3]"+strParam[3]+"strParam[4]"+strParam[4]+"strParam[5]"+strParam[5]);
  
	g_fdcod=strParam[0];      //지점코드   
	g_fsdat=strParam[1];			//전표일자   
	g_fsnbr=strParam[2];			//전표번호   
	g_fsseq=strParam[3];			//전표행번호 
	g_fsrefval=strParam[4];   //거래처코드 
	g_fsrvalnm=strParam[5];   //거래처명   
	g_documcd =strParam[6];   //증빙구분   

	//alert("strParam[4]"+strParam[4]);
	//alert("g_fsrefval"+g_fsrefval);
  ln_Before();	
	ln_Find_Acnnbr();         //계산서번호 찾기
	ln_THeder("02");	        //Dtl Header 생성
}

/******************************************************************************
	Description : 전표Detail에서 계산서 번호 찾기
	parameter   : p1 - 지점코드
	              p2 - 전표일자
                p3 - 전표번호
								p4 - 전표행번호
******************************************************************************/
function ln_Find_Acnnbr(p1,p2,p3,p4){ 
	gcds_acnnbr.DataID = "/services/servlet/Account.comtax_popup_s2?v_str1="+g_fdcod+"&v_str2="+g_fsdat+"&v_str3="+g_fsnbr+"&v_str4="+g_fsseq;
	//prompt("",gcds_acnnbr.DataID);
	gcds_acnnbr.Reset(); 
}

/******************************************************************************
	Description : 계산서 Master 조회
	parameter   : p - 계산서번호
******************************************************************************/
function ln_Query_Mst(p){ 
	gcds_data1.DataID = "/services/servlet/Account.comtax_popup_s3?v_str1="+p;
	gcds_data1.Reset(); 
}

/******************************************************************************
	Description : 세금계산서 상세조회
	parameter   : p - 계산서번호
******************************************************************************/
function ln_Query(p){ 

	gcds_data2.DataID = "/services/servlet/Account.comtax_popup_s1?v_str1="+p;
	//prompt("",gcds_data2.DataID);
	gcds_data2.Reset(); 
}


/******************************************************************************
	Description : 계산서번호 MaxCnt
******************************************************************************/
/*
function ln_Query3(){ 
	gcds_data3.DataID = "/services/servlet/Account.a040001_s3?v_str1="; 
	gcds_data3.Reset();
}
*/

/******************************************************************************
	Description : 추가
	parameter   : p - 구분 '1' - Master,
	                       '2' - Detail
******************************************************************************/
function ln_Add(p){

/*
	var obj = eval("gcds_data"+e);
	var row1 = gcds_data1.rowposition;
	var row2 = gcds_data2.rowposition;
	var row3 = gcds_data3.rowposition;
*/
	if (p=='1') {	      //Mst 
	  ln_THeder("01");
		gcds_data1.AddRow();
		gcem_taxdat.text	= gs_date;
		//gclx_taxknd.BindColVal = "1";
		gcra_cocode.CodeValue="01";
		gcra_taxiodiv.CodeValue = "1";


	}else if (p=='2') {	//Dtl
		gcds_data2.AddRow();
		var cnt2  = gcds_data2.countrow;
		var taxmm = gcem_taxdat.text;
		gcds_data2.namevalue(cnt2,"TAXMM")  = taxmm.substring(4,6);
		gcds_data2.namevalue(cnt2,"TAXDT")  = taxmm.substring(6,8);
	}


}

/******************************************************************************
	Description : 세금계산서MST/DTL Heder 생성
******************************************************************************/
function ln_THeder(p){

	if (p=="01") {
		var Theder_mst = "TAXNBR:STRING,COCODE:STRING,TAXIODIV:STRING,TAXDIV:STRING,TAXKND:STRING,"
						    	 + "CCCODE:STRING,TAXDAT:STRING,TAXSUM:DECIMAL,TAXVATAMT:DECIMAL,TAXTOT:DECIMAL,"
						    	 + "REMARK:STRING,TAXCDNBR:STRING,FSDAT:STRING,FSNBR:STRING,TAXKIDIV:STRING,"
						    	 + "WRDT:STRING,WRID:STRING,UPDT:STRING,UPID:STRING,FDCODE:STRING";
		gcds_data1.SetDataHeader(Theder_mst);
  }else if(p=="02") {
		var Theder_dtl = "TAXNBR:STRING,TAXSEQ:STRING,TAXPDTNAM:STRING,TAXSTD:STRING,TAXQTY:DECIMAL,"
							     + "TAXPRIC:DECIMAL,TAXSUM:DECIMAL,TAXVATAMT:DECIMAL,BIGO:STRING,"
							     + "WRDT:STRING,WRID:STRING,UPDT:STRING,UPID:STRING,"
							     + "TAXMM:STRING,TAXDT:STRING";
		gcds_data2.SetDataHeader(Theder_dtl);
	}else if(p=="03") {
		var Theder_key = "TAXNBR:STRING";
		gcds_acnnbr_key.SetDataHeader(Theder_key);
	}else if(p=="04") {
		var Theder_key = "FSVATAMT:DECIMAL";
		gcds_acnnbr_key.SetDataHeader(Theder_key);
	}
}


/******************************************************************************
	Description : 입력/수정체크
  parameter   : 
******************************************************************************/
function ln_Chk(){
	return true;
}

/******************************************************************************
	Description : 삭제 체크
  parameter   : 
******************************************************************************/
function ln_Chk2(){
/*
	if ( ){
		alert("계산서번호가 존재하지 않아 삭제할 수 없습니다.");
		return;
	}*/
	return true;
}



/******************************************************************************
	Description : 저장
  parameter   : e - 1 : mst
	                  2 : dtl
										3 : mst update (공급가액,부가세,합계금액)
******************************************************************************/
function ln_Save(e){
 
  //alert("start");
  //parent.parent.ln_Query('04');
	//dialogArguments.ln_Start();
  //alert("end");

	if(ln_Chk()){
		if (gcds_data1.IsUpdated||gcds_data2.IsUpdated){
			if (confirm("저장하시겠습니까?")){	
			  ln_THeder('03');
				ln_THeder('04');
				gctr_data0.Action = g_servlet+"/Account.comtax_popup_t0?";
				//prompt("gcds_data1",gcds_data1.text);
				//prompt("gcds_data2",gcds_data2.text);
				gctr_data0.Parameters = "v_str1=" + gs_date + ",v_str2=" + gcem_taxnbr.text+",v_str3=" + gusrid+ ",v_str4=" +g_fdcod+",v_str5=" +g_fsdat+ ",v_str6=" +g_fsnbr+",v_str7="+g_fsseq;
				gctr_data0.post();
        
				//alert("TAXNBR::" + gcds_acnnbr_key.namevalue(1,"TAXNBR"))
				ln_Query_Mst(gcds_acnnbr_key.namevalue(1,"TAXNBR"));
				ln_Query(gcds_acnnbr_key.namevalue(1,"TAXNBR"));

       // alert("FSVATAMT::"+gcds_fsvat.namevalue(1,"FSVATAMT"));
        window.returnValue = gcds_fsvat.namevalue(1,"FSVATAMT");
				//window.close();
				//var opener = window.dialogArguments;

				//opener.document.ln_test();
				//window.returnValue = gcds_fsvat.namevalue(1,"FSVATAMT");
	                   	 
			}	
		}
	}
	
}

/******************************************************************************
	Description : 삭제
  Parameter   : p -1 : master
                   2 : detail
******************************************************************************/
function ln_Delete(p) {

	if(p=="1"){
		if(ln_Chk2()){
		  gcds_data1.deleterow(gcds_data1.rowposition);
			if (gcds_data1.IsUpdated){
				if (confirm("삭제하시겠습니까?")){	
				  ln_THeder('04');
					gctr_data0.Action = g_servlet+"/Account.comtax_popup_t0?";
				  //prompt("gcds_data1",gcds_data1.text);
					//prompt("gcds_data2",gcds_data2.text);
					gctr_data0.Parameters = "v_str1=" + gs_date + ",v_str2=" + gcem_taxnbr.text+",v_str3=" + gusrid+ ",v_str4=" +g_fdcod+",v_str5=" +g_fsdat+ ",v_str6=" +g_fsnbr+",v_str7="+g_fsseq;
					gctr_data0.post();
					//ln_Query(gcds_acnnbr_key.namevalue(1,"TAXNBR"));
          window.returnValue = gcds_fsvat.namevalue(1,"FSVATAMT");
					gcds_data2.ClearAll();
				}	
			}
		}
	}else if(p==2){
		if(ln_Chk2()){
		  gcds_data2.deleterow(gcds_data2.rowposition);
			if (gcds_data2.IsUpdated){
				if (confirm("삭제하시겠습니까?")){	
				  ln_THeder('04');
					gctr_data0.Action = g_servlet+"/Account.comtax_popup_t0?";
					//prompt("gcds_data1",gcds_data1.text);
					//prompt("gcds_data2",gcds_data2.text);
					gctr_data0.Parameters = "v_str1=" + gs_date + ",v_str2=" + gcem_taxnbr.text+",v_str3=" + gusrid+ ",v_str4=" +g_fdcod+",v_str5=" +g_fsdat+ ",v_str6=" +g_fsnbr+",v_str7="+g_fsseq;
					gctr_data0.post();

					//alert("TAXNBR::" + gcds_acnnbr_key.namevalue(1,"TAXNBR"))
					ln_Query_Mst(gcds_acnnbr_key.namevalue(1,"TAXNBR"));
					window.returnValue = gcds_fsvat.namevalue(1,"FSVATAMT");
					//ln_Query(gcds_acnnbr_key.namevalue(1,"TAXNBR"));
				}	
			}
		}
	}
}

/******************************************************************************
	Description : 취소
******************************************************************************/
function ln_Cancel(){

}

/******************************************************************************
	Description : 엑셀
******************************************************************************/
function ln_Excel(){

}

/******************************************************************************
	Description : 선조회
******************************************************************************/
function ln_Before(){ 

	gcem_taxdat.text  = gs_date;					//계산서일자

		//계산서종류[입력]
	gcds_taxknd.DataID = "/services/servlet/Account.commdtil_s1?v_str1=0013"; 
	gcds_taxknd.Reset();

	//지점코드[입력]
	gcds_fdcode.DataID = "/services/servlet/Account.a010003_s1?v_str1="; 
	gcds_fdcode.Reset();

	//거래처코드[입력]
	gcds_cccode.DataID = "/services/servlet/Account.vendcode_s1?v_str1="; 
	gcds_cccode.Reset();

	//귀속구분[입력]
	gcds_taxdiv.DataID = "/services/servlet/Account.commdtil_s1?v_str1=0014"; 
	gcds_taxdiv.Reset();

	//신용카드관리[입력]
	gcds_taxcdnbr.DataID = "/services/servlet/Account.taxcdnbr_s1?v_str1="; 
	gcds_taxcdnbr.Reset();

}

/******************************************************************************
	Description : 거래처 조회 
	Parameter   : p - 거래처 코드
******************************************************************************/
function ln_Vend_Query(p){
	gcds_cccode.DataID = "/services/servlet/Account.vendcode_s1?v_str1="+p; 
	//prompt("",gcds_cccode.DataID);
	gcds_cccode.Reset();
}

/******************************************************************************
	Description : 거래처 기본조회 항목
******************************************************************************/
/*
function ln_Vend(){
 // alert("gcds_cccode.rowposition"+gcds_cccode.rowposition);
	txt_vddirect.value = gcds_cccode.namevalue(gcds_cccode.rowposition, "VD_DIRECT");		//대표자
	txt_bsnscnd.value  = gcds_cccode.namevalue(gcds_cccode.rowposition, "BSNS_CND");		//업태
	txt_bsnsknd.value  = gcds_cccode.namevalue(gcds_cccode.rowposition, "BSNS_KND");		//종목
}
*/

/******************************************************************************
	Description : 찾기 - 거래처코드
******************************************************************************/
function ln_Popup(p){

	if (p!="A") {
		var arrResult	= new Array();
		var strURL;	
		var strPos;
		var row1 = gcds_data1.rowposition;

		strURL = "./Gczm_vender_popup.html";
		strPos = "dialogWidth:494px;dialogHeight:379px;status:no;scroll:no;resizable:no";
		arrResult = showModalDialog(strURL,'',strPos);

		if (arrResult != null) {
			arrParam = arrResult.split(";");
			gcem_cccode.text   = arrParam[0];
			txt_fdcodenm.value = arrParam[1];
			txt_vddirect.value = arrParam[2];
			txt_bsnscnd.value  = arrParam[3];
			txt_bsnsknd.value  = arrParam[4];
		} else {
			gcem_cccode.text	 = "";
			txt_fdcodenm.value = "";
			txt_vddirect.value = "";
			txt_bsnscnd.value  = "";
			txt_bsnsknd.value  = "";
		}
	}else{ return false; }
}

/******************************************************************************
	Description : 창닫기
	parameter   : A - 선택
******************************************************************************/
function ln_Close(p){
	if (p=="A") {
		var row = gcds_data1.rowposition;
		window.returnValue = gcds_data1.namevalue(row,"TAXNBR") + ";";
		window.close();
	} else {
		window.close();
	}
}
</script>

<!-----------------------------------------------------------------------------
		D A T A S E T   C O M P O N E N T S   D E C L A R A T I O N
------------------------------------------------------------------------------>
<comment id="__NSID__"><object  id="gcds_data1" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" VIEWASTEXT> 
	<PARAM NAME="SYNCLOAD" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id="gcds_data2" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" VIEWASTEXT> 
	<PARAM NAME="SYNCLOAD" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id="gcds_data3" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" VIEWASTEXT> 
	<PARAM NAME="SYNCLOAD" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id="gcds_fdcode" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" VIEWASTEXT> 
	<PARAM NAME="SYNCLOAD" VALUE="false"><!-- 지점코드[입력] -->
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id="gcds_cccode" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" VIEWASTEXT> 
	<PARAM NAME="SYNCLOAD" VALUE="false"><!-- 거래처코드[입력] -->
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id="gcds_taxdiv" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" VIEWASTEXT> 
	<PARAM NAME="SYNCLOAD" VALUE="false"><!-- 귀속구분[입력] -->
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id="gcds_taxknd" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" VIEWASTEXT> 
	<PARAM NAME="SYNCLOAD" VALUE="true"><!-- 계산서종류[입력] -->
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id="gcds_taxcdnbr" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" VIEWASTEXT> 
	<PARAM NAME="SYNCLOAD" VALUE="false"><!-- 신용카드관리[입력] -->
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id="gcds_acnnbr" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" VIEWASTEXT> 
	<PARAM NAME="SYNCLOAD" VALUE="false"><!-- 전표Detail에서 계산서번호 찾기 -->
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 계산서 번호 생성 후 Return -->
<comment id="__NSID__"><object  id="gcds_acnnbr_key" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" VIEWASTEXT> 
</object></comment><script>__ws__(__NSID__);</script> 

<!-- 부가세 금액 Return -->
<comment id="__NSID__"><object  id="gcds_fsvat" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" VIEWASTEXT> 
</object></comment><script>__ws__(__NSID__);</script> 

<!-----------------------------------------------------------------------------
	  T R A N S A C T I O N   C O M P O N E N T S   D E C L A R A T I O N
------------------------------------------------------------------------------>
<comment id="__NSID__"><object  id="gctr_data0" classid="clsid:0A2233AD-E771-11D2-973D-00104B15E56F" VIEWASTEXT>
	<PARAM NAME="KeyName"  VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="comtax_popup_t0(I:USER=gcds_data1,I:USER2=gcds_data2, O:USER3=gcds_acnnbr_key, O:USER4=gcds_fsvat)">   
</object></comment><script>__ws__(__NSID__);</script> 


<comment id="__NSID__"><object  id="gctr_data1" classid="clsid:0A2233AD-E771-11D2-973D-00104B15E56F" VIEWASTEXT>
	<PARAM NAME="KeyName"  VALUE="toinb_dataid4">
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id="gctr_data2" classid="clsid:0A2233AD-E771-11D2-973D-00104B15E56F" VIEWASTEXT>
	<PARAM NAME="KeyName"  VALUE="toinb_dataid4">
</object></comment><script>__ws__(__NSID__);</script> 

<comment id="__NSID__"><object  id="gctr_data3" classid="clsid:0A2233AD-E771-11D2-973D-00104B15E56F" VIEWASTEXT>
	<PARAM NAME="KeyName"  VALUE="toinb_dataid4">
</object></comment><script>__ws__(__NSID__);</script> 

<!-----------------------------------------------------------------------------
					D A T A S E T   C O M P O N E N T' S
		M A N D A T O R Y   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javascript" for="gcds_data1" event="OnLoadStarted()">
	window.status="데이타 조회중입니다..잠시만 기다려 주십시오.";
	document.all.LowerFrame.style.visibility="visible";
</script>

<script language="javascript" for="gcds_data1" event="onloadCompleted(row,colid)">
	window.status="조회가 완료 되었습니다.";
	document.all.LowerFrame.style.visibility="hidden";
	if (row<1) { alert("검색된 데이터가 없습니다."); 
	}else{
	 // alert("row"+row);
    //alert("gcds_data1"+gcds_data1.nameval);
		//ln_Vend();	//거래처항목

		//alert("카드번호"+gcds_data1.namevalue(gcds_data1.rowpsition,"TAXCDNBR"));
		//alert("귀속구분"+gcds_data1.namevalue(gcds_data1.rowpsition,"TAXDIV"));
		ln_Vend_Query(gcds_data1.namevalue(gcds_data1.rowpsition,"CCCODE"));// 거래처 조회
	}
</script>

<script language="javascript" for="gcds_data2" event="OnLoadStarted()">
	window.status="데이타 조회중입니다..잠시만 기다려 주십시오.";
	document.all.LowerFrame.style.visibility="visible";
</script>

<script language="javascript" for="gcds_data2" event="onloadCompleted(row,colid)">
	window.status="조회가 완료 되었습니다.";
	document.all.LowerFrame.style.visibility="hidden";

	if (row<1) { return; 
	}else{
		gcem_taxsum.text		= gcds_data2.Sum(7,0,0);												//공급가액
		gcem_taxvatamt.text = gcds_data2.Sum(8,0,0);												//부가세액
		gcem_taxtot.text		= gcds_data2.Sum(7,0,0)+gcds_data2.Sum(8,0,0);	//합계
		
	///	if(gcds_data1.IsUpdated) { ln_Save('3');	}
	}
</script>

<script language="javascript" for="gcds_data3" event="onloadCompleted(row,colid)">
	var strmax = gcds_data3.namevalue(row,"CNT");
	ln_Query(Number(strmax));	//Number(strmax-1)
</script>

<script language="javascript" for="gcds_cccode" event="onloadCompleted(row,colid)">
	//gcds_cccode.InsertRow(1);
	//gcds_cccode.NameValue(1,"VEND_CD")="";
	//gcds_cccode.NameValue(1,"VEND_NM")="";
	//gclx_cccode.index=0;
  
	gcem_cccode.text=g_fsrefval;    //거래처코드
  txt_fdcodenm.value=g_fsrvalnm;  //거래처명
  txt_vddirect.value = gcds_cccode.namevalue(gcds_cccode.rowposition, "VD_DIRECT");		//대표자
	txt_bsnscnd.value  = gcds_cccode.namevalue(gcds_cccode.rowposition, "BSNS_CND");		//업태
	txt_bsnsknd.value  = gcds_cccode.namevalue(gcds_cccode.rowposition, "BSNS_KND");		//종목
</script>

<script language="javascript" for="gcds_taxdiv" event="onloadCompleted(row,colid)">
	gcds_taxdiv.InsertRow(1);
	gcds_taxdiv.NameValue(1,"CDCODE")="";
	gcds_taxdiv.NameValue(1,"CDNAM")="";
	gclx_taxdiv.index=0;
</script>

<script language="javascript" for="gcds_taxcdnbr" event="onloadCompleted(row,colid)">
	//window.status="조회가 완료 되었습니다.";
	//document.all.LowerFrame.style.visibility="hidden";

	gcds_taxcdnbr.InsertRow(1);
	gcds_taxcdnbr.NameValue(1,"CANBR")="";
	gcds_taxcdnbr.NameValue(1,"CANBR")="";
	gclx_taxcdnbr.index=0;
</script>

<script language="javascript" for="gcds_fdcode" event="onloadCompleted(row,colid)">
	gcds_fdcode.InsertRow(1);
	gcds_fdcode.NameValue(1,"FDCODE")="";
	gcds_fdcode.NameValue(1,"FDNAME")="";
	gclx_fdcode.index=0;
</script>

<script language="javascript" for="gcds_acnnbr" event="onloadCompleted(row,colid)">
	
  //alert("row::"+row+":::"+gcds_acnnbr.namevalue(1,"ACNNBR"));
	if(row<=0){
		alert("전표를 먼저 입력하십시요!");
	}else{
		if (gcds_acnnbr.namevalue(1,"ACNNBR")==""||gcds_acnnbr.namevalue(1,"ACNNBR")==null){ //계산서신규등록
			//신규입력
			//지점코드,전표일자,전표번호,행번호
			//alert("계산서 신규입력");
			ln_Add('1');
			//alert("g_documcd"+g_documcd);
			if (g_documcd=="001"){
				gclx_taxknd.BindColVal="1"; //세금계산서
			}else if(g_documcd=="002"){
				gclx_taxknd.BindColVal="2"; //계산서
			}

			gclx_fdcode.BindColVal=g_fdcod; //지점
			ln_Vend_Query(g_fsrefval);// 거래처 조회
			//ln_Vend();
			gcem_fsdat.text=g_fsdat;  // 전표번호  
			gcem_fsnbr.text=g_fsnbr;
			//gclx_cccode.bindcolval="";

			gcds_data1.namevalue(gcds_data1.rowposition,"WRDT")=gs_date;
			gcds_data1.namevalue(gcds_data1.rowposition,"WRID")=gusrid;
		}else{ //계산서 번호로 조회
			gcem_taxnbr.text = gcds_acnnbr.namevalue(1,"ACNNBR");
			ln_Query_Mst(gcem_taxnbr.text);
			ln_Query(gcds_acnnbr.namevalue(1,"ACNNBR"));
		}
	}

</script>

<!-----------------------------------------------------------------------------
					G A U C E   C O M P O N E N T' S
		G E N E R A L   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javascript" for="gcgd_data1" event="OnKeyPress()">
	//ln_Vend();	//거래처항목
</script>

<script language="javascript" for="gcgd_data1" event="OnClick()">
	//ln_Vend();	//거래처항목
	ln_Query2();//세금계산서 상세조회
</script>


<script language="javascript" for="gcgd_data2" event="OnExit(row,colid,olddata)">

  if (gcgd_data2.GetColumn()=="TAXSUM" ){
		gcem_taxsum.text = gcds_data2.Sum(7,0,0);				    								//공급가액
	  gcem_taxtot.text = gcds_data2.Sum(7,0,0)+gcds_data2.Sum(8,0,0);	    //합계
	}else if (gcgd_data2.GetColumn()=="TAXVATAMT"){
		gcem_taxvatamt.text = gcds_data2.Sum(8,0,0);												//부가세액
		gcem_taxtot.text = gcds_data2.Sum(7,0,0)+gcds_data2.Sum(8,0,0);	    //합계
	}		
</script>


<!-----------------------------------------------------------------------------
				T R A N S A C T I O N   C O M P O N E N T' S
		M A N D A T O R Y   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javascript" for="gctr_data0" event="onsuccess()">
	alert("작업이 성공적으로 완료되었습니다.");
</script>

<script language="javascript" for="gctr_data0" event="onfail()">
	alert("작업이 성공적으로 완료되지 못했습니다.");
	alert("Error Code : " + gctr_data0.ErrorCode + "\n" + "Error Message : " + gctr_data0.ErrorMsg + "\n");
</script>

<script language="javascript" for="gctr_data1" event="onsuccess()">
	alert("작업이 성공적으로 완료되었습니다.");
</script>

<script language="javascript" for="gctr_data1" event="onfail()">
	alert("작업이 성공적으로 완료되지 못했습니다.");
</script>

<script language="javascript" for="gctr_data2" event="onsuccess()">
	alert("작업이 성공적으로 완료되었습니다.");
	gcem_taxsum.text		= gcds_data2.Sum(7,0,0);												//공급가액
	gcem_taxvatamt.text = gcds_data2.Sum(8,0,0);												//부가세액
	gcem_taxtot.text		= gcds_data2.Sum(7,0,0)+gcds_data2.Sum(8,0,0);	//합계
//	if(gcds_data1.IsUpdated) { ln_Save('3');	}
</script>

<script language="javascript" for="gctr_data2" event="onfail()">
	alert("작업이 성공적으로 완료되지 못했습니다.");
</script>

</head>
<!-----------------------------------------------------------------------------
						B O D Y   D E F I N I T I O N
------------------------------------------------------------------------------>
<BODY border="0" cellpadding="0" cellspacing="0" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" OnLoad="ln_Start()">
<table width="620px" height="0" border="0" cellpadding="0" cellspacing="0">
	<tr height="30px">
		<td colspan="2">
			<div id=top_btn_visible style="display:block">
			<table width="615px" cellpadding="0" cellspacing="0" border="0" style="position:relative;left:3px;">
			  <tr> 
					<td width="215" background="../../Common/img/com_t_bg.gif">
					   <IMG height=47 src="../img/a040001_head.gif" width=197>
					</td>
					<td width="561" align="right"  valign=middle background="../../Common/img/com_t_bg.gif">
						<img name="btn_del"		src="../../Common/img/btn/com_b_delete.gif" style="cursor:hand;position:relative;top:2px"	 onclick="ln_Delete('1')">
						<!-- <img name="btn_add"		src="../../common/img/btn/com_b_insert.gif" style="cursor:hand;position:relative;top:2px"	 onclick="ln_Add('1')"> -->
						<img name="btn_save"	src="../../Common/img/btn/com_b_save.gif"		style="cursor:hand;position:relative;top:2px"	 onclick="ln_Save('1')">&nbsp;
					</td>
				</tr>
			</table>
			</div>
		</td>
	</tr>
	<tr>
		<td cellpadding="0" cellspacing="0" valign="top" style="padding-left:0px;">
			<table border="0" cellpadding=0 cellspacing=0 style="position:relative;left:0px;">
				<tr><td></td>
			<td>
				<table border="0" cellpadding=0 cellspacing=0 style="position:relative;left:4px;border:0 solid #708090;border-bottom-width:1px;border-right-width:1px;">
					<tr> 
						<td class="tab37" width="80px;" bgcolor="#eeeeee"><nobr>계산서번호</nobr></td>
						<td class="tab18" width="125px;">
							<comment id="__NSID__"><object  id=gcem_taxnbr class="txtbox" style="position:relative;left:3px;top:1px;width:75px;height:20px;"  classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F>
								<param name=Text          value="">
								<param name=Alignment			value=0>
								<param name=Border	      value=True>
								<param name=ClipMode			value=true>
								<param name=Format	      value="######-####">
								<param name=MaxLength     value=10>
								<param name=PromptChar	  value="_">
								<param name=BackColor     value="#CCCCCC">
								<param name=InheritColor  value=false>
								<param name=Enable				value=false>
							</object></comment><script>__ws__(__NSID__);</script> 
						</td>
						<td class="tab14" width="80px;" bgcolor="#eeeeee"><nobr>사업소</nobr></td>
						<td class="tab18" width="113px">
							<comment id="__NSID__"><object  id=gcra_cocode class="txtbox" classid=CLSID:754F3DC4-0C79-4C92-AD64-A806D8FF2AB0 					style="position:relative;left:0px;top:0px;height:20;width:120;cursor:hand;">
								<param name=Cols     value="2">
								<param name=Format   value="01^고성,02^서울">
							</object></comment><script>__ws__(__NSID__);</script> 
						</td>
						<td class="tab14" width="80px;" bgcolor="#eeeeee"><nobr>지점</nobr></td>
						<td class="tab31" width="123px">
							<comment id="__NSID__"><object  id=gclx_fdcode classid=clsid:60109D65-70C0-425C-B3A4-4CB001513C69  style="position:relative;left:3px;top:1px;width:117px;height:110px;">
								<param name=ComboDataID			value="gcds_fdcode">
								<param name=CBDataColumns		value="FDCODE,FDNAME">
								<param name=SearchColumn		value="FDNAME">
								<param name=Sort						value=false>
								<param name=ListExprFormat	value="FDNAME^0^117">
								<param name=BindColumn			value="FDCODE">
								<param name=Enable			    value="false">
							</object></comment><script>__ws__(__NSID__);</script> 
						</td>
					</tr>
					<tr> 
						<td class="tab33" width="80px;" bgcolor="#eeeeee"><nobr>계산서일자</nobr></td>
						<td class="tab19" width="103px;">
							<comment id="__NSID__"><object  id=gcem_taxdat classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F 
								style="position:relative;left:3px;top:2px;width:70px;height:20px;" class="txtbox">
									<param name=Alignment			value=0>
									<param name=Border	      value=true>
									<param name=Format	      value="YYYY/MM/DD">
									<param name=PromptChar	  value="_">
									<param name=Enable				value="true">
							</object></comment><script>__ws__(__NSID__);</script> 
							<img src="../img/calender.gif" value="calender.gif" id=img_calendar1 OnClick="__GetCallCalendar('gcem_taxdat', 'Text')" style="position:relative;width:20px;left:9px;top:1px;cursor:hand;">
						</td>
						<td class="tab11" width="80px;" bgcolor="#eeeeee"><nobr>계산서종류</nobr></td>
						<td class="tab19" width="113px;">
							<comment id="__NSID__"><object  id=gclx_taxknd   classid=clsid:60109D65-70C0-425C-B3A4-4CB001513C69  style="position:relative;left:3px;top:0px;width:110px;height:110px;">
								<param name=ComboDataID			value="gcds_taxknd">
								<param name=CBDataColumns		value="CDCODE,CDNAM">
								<param name=SearchColumn		value="CDNAM">
								<param name=Sort						value=false>
								<param name=Enable          value="false">
								<param name=ListExprFormat	value="CDNAM^0^90">
								<param name=BindColumn			value="CDCODE">
							</object></comment><script>__ws__(__NSID__);</script> 
						</td>
						<td class="tab11" width="80px;" bgcolor="#eeeeee"><nobr>계산서구분</nobr></td>
						<td class="tab22" width="123px">
							<comment id="__NSID__"><object  id=gcra_taxiodiv classid=CLSID:754F3DC4-0C79-4C92-AD64-A806D8FF2AB0
								style="position:relative;left:0px;top:0px;height:20;width:120;cursor:hand;">
								<param name=Cols     value="2">
								<param name=Format   value="1^매입,2^매출">
							</object></comment><script>__ws__(__NSID__);</script> 
						</td>
					</tr>
					<tr> 
						<td class="tab33" width="80px;" bgcolor="#eeeeee"><nobr>거래처코드</nobr></td>
						<td class="tab22" width="103px" colspan="5"><nobr>
							<comment id="__NSID__"><object  id=gcem_cccode classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F	style="position:relative;top:2px;left:3px;width:90px">
								<param name=Text				value="">
								<param name=Alignment		value=0>
								<param name=Border			value=true>
								<param name=Format			value="#############">
								<param name=PromptChar	value="_">
								<param name=ReadOnly    value=true>
								<param name=ReadOnlyBackColor   value="#D7D7D7">
							</object></comment><script>__ws__(__NSID__);</script> &nbsp;
							<img name="btn_find" src="../../Common/img/btn/com_b_find.gif"	style="position:relative;top:3px;left:-2px;cursor:hand"	 onclick="ln_Popup('A')">
							<input id=txt_fdcodenm type="text" class="txt11" style="position:relative;top:-3px;left:3px;width:378px;background-color:#d7d7d7" readonly></nobr>
						</td>
					</tr>
					<tr> 
						<td class="tab33" width="80px;" bgcolor="#eeeeee"><nobr>대표자</nobr></td>
						<td class="tab19" width="103px;" >
							<input id=txt_vddirect type="text" class="txt11" style="position:relative;left:3px;width:118px;background-color:#d7d7d7"  readOnly>
						</td>
						<td class="tab11" width="80px;" bgcolor="#eeeeee"><nobr>업태</nobr></td>
						<td class="tab19" width="113px">
							<input id=txt_bsnscnd type="text" class="txt11" style="position:relative;left:3px;width:110px;background-color:#d7d7d7" readOnly>
						</td>
						<td class="tab11" width="80px;" bgcolor="#eeeeee"><nobr>종목</nobr></td>
						<td class="tab22" width="123px">
							<input id=txt_bsnsknd type="text" class="txt11" style="position:relative;left:3px;width:117px;background-color:#d7d7d7" readOnly>
						</td>
					</tr>
					<tr> 
						<td class="tab33" width="80px;" bgcolor="#eeeeee"><nobr>신용카드번호</nobr></td>
						<td class="tab19" width="125px;">
							<comment id="__NSID__"><object  id=gclx_taxcdnbr  classid=clsid:60109D65-70C0-425C-B3A4-4CB001513C69 height=106 style="position:relative;left:3px;top:0px;font-size:12px;width:120px;height:200px;">
								<param name=ComboDataID			value=gcds_taxcdnbr>
								<param name=SearchColumn		value="CANBR">
								<param name=Sort            value="false">
								<param name=SearchColumn		value="CANBR">
								<param name=ListExprFormat	value="CANBR^0^120">
								<param name=BindColumn			value="CANBR">
							</object></comment><script>__ws__(__NSID__);</script> 	
						</td>
						<td class="tab11" bgcolor="#eeeeee"><nobr>귀속구분</nobr></td>
						<td class="tab22" width="123px" colspan="3">
							<comment id="__NSID__"><object  id=gclx_taxdiv classid=clsid:60109D65-70C0-425C-B3A4-4CB001513C69 height=106 style="position:relative;left:3px;top:0px;font-size:12px;width:320px;height:200px;">
								<param name=ComboDataID			value="gcds_taxdiv">
								<param name=CBDataColumns		value="CDCODE,CDNAM">
								<param name=SearchColumn		value="CDNAM">
								<param name=Sort						value=false>
								<param name=ListExprFormat	value="CDNAM^0^295">
								<param name=BindColumn			value="CDCODE">
							</object></comment><script>__ws__(__NSID__);</script> 
						</td>
					</tr>
					<tr> 
						<td class="tab33" width="80px;" bgcolor="#eeeeee"><nobr>적요</nobr></td>
						<td class="tab19" colspan="3"><input id=txt_remark type="text" class="txt11" style="position:relative;left:3px;width:317px;"></td>
						<td class="tab11" width="80px;" bgcolor="#eeeeee"><nobr>전표번호</nobr></td>
						<td class="tab22" width="123px">
							<comment id="__NSID__"><object  id=gcem_fsdat classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F	style="position:relative;left:3px;top:2px;width:60px">
								<param name=Text				value="">
								<param name=Alignment		value=0>
								<param name=Border			value=true>
								<param name=ClipMode		value=true>
								<param name=Numeric			value=false>
								<param name=Format			value="#########">
								<param name=PromptChar	value="_">
								<param name=ReadOnly    value=true>
								<param name=ReadOnlyBackColor   value="#D7D7D7">

							</object></comment><script>__ws__(__NSID__);</script> &nbsp;-
							<comment id="__NSID__"><object  id=gcem_fsnbr classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F	style="position:relative;left:3px;top:2px;width:45px">
								<param name=Text				value="">
								<param name=Alignment		value=0>
								<param name=Border			value=true>
								<param name=ClipMode		value=true>
								<param name=Numeric			value=false>
								<param name=Format			value="######">
								<param name=PromptChar	value="_">
                <param name=ReadOnly    value=true>
								<param name=ReadOnlyBackColor   value="#D7D7D7">

							</object></comment><script>__ws__(__NSID__);</script> 
						</td>
					</tr>
					<tr>
						<td class="tab16" width="80px" bgcolor="#eeeeee" align="center">공급가액</td>
						<td class="tab23" width="125px">
							<comment id="__NSID__"><object  id=gcem_taxsum classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F	style="position:relative;left:3px;width:120px">
								<param name=Text				value="">
								<param name=Alignment		value=2>
								<param name=Border			value=true>
								<param name=ClipMode		value=true>
								<param name=Numeric			value=true>
								<param name=IsComma     value=true>
                <param name=MaxLength   value=15>
								<param name=ReadOnly    value=true>
								<param name=ReadOnlyBackColor   value="#D7D7D7">


							</object></comment><script>__ws__(__NSID__);</script> 
						</td>
						<td class="tab23" width="80px" bgcolor="#eeeeee" align="center">부가세액</td>
						<td class="tab23" width="85px">
							<comment id="__NSID__"><object  id=gcem_taxvatamt classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F	style="position:relative;left:3px;width:110px">
								<param name=Text				value="">
								<param name=Alignment		value=2>
								<param name=Border			value=true>
								<param name=ClipMode		value=true>
								<param name=Numeric			value=true>
								<param name=IsComma     value=true>
                <param name=MaxLength   value=13>
								<param name=ReadOnly    value=true>
								<param name=ReadOnlyBackColor   value="#D7D7D7">

							</object></comment><script>__ws__(__NSID__);</script> 
						</td>
						<td class="tab23" width="80px" bgcolor="#eeeeee" align="center">합계금액</td>
						<td width="82px">
							<comment id="__NSID__"><object  id=gcem_taxtot classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F	style="position:relative;left:3px;width:117px">
								<param name=Text				value="">
								<param name=Alignment		value=2>
								<param name=Border			value=true>
								<param name=ClipMode		value=true>
								<param name=Numeric			value=true>
								<param name=IsComma     value=true>
                <param name=MaxLength   value=16>
								<param name=ReadOnly    value=true>
								<param name=ReadOnlyBackColor   value="#D7D7D7">

							</object></comment><script>__ws__(__NSID__);</script> 
						</td>
				</table>
			</td>
		</tr>
	</table>

	<table border="0" cellpadding="0" cellspacing="0" style="position:relative;top:5px;left:4px;">
		<tr>
			<td> 
				<comment id="__NSID__"><object  id=gcte_disp classid=clsid:ED382953-E907-11D3-B694-006097AD7252 
					style="width:600px;height:20px">
						<PARAM NAME="BackColor"					VALUE="#cccccc">
						<PARAM NAME="titleHeight"				VALUE="20px">
						<PARAM NAME="DisableBackColor"	VALUE="#eeeeee">
						<PARAM NAME="Format"						VALUE="
							<T>divid=layer1  title='세금계산서 세부항목'</T>									
						">
				</object></comment><script>__ws__(__NSID__);</script> 
			</td>
		</tr>
	</table>
</td>
</tr>
</table>


<!---------[TAB 1] 세금계산서세부항목 ----------->
<div id="layer1" style="position:absolute; top:254px; left:4px; visibility:hidden; border:1 solid #708090">
  <table cellpadding=0 cellspacing=0 border=0>
		<tr>
			<td style="width:600px" align="right" valign="bottom">
			<!-- 	<img name="btn_select" border="0" src="../../common/img/btn/com_b_select.gif" style="cursor:hand;position:relative;top:250px;left:-110px" onClick="ln_Close('A')"> -->
				<img name="btn_close" border="0" src="../../Common/img/btn/com_b_close.gif" style="cursor:hand;position:relative;top:250px;left:-170px" onClick="ln_Close('C')"><!-- 왼쪽으로더 이동 -->
				<img name="btn_del_2"	 src="../../Common/img/btn/com_b_delete.gif" style="position:relative;top:2px;cursor:hand" onclick="ln_Delete('2')">
				<img name="btn_add_2"	 src="../../Common/img/btn/com_b_insert.gif" style="position:relative;top:2px;cursor:hand" onclick="ln_Add('2')">
				<!-- <img name="btn_save_2" src="../../common/img/btn/com_b_save.gif"   style="position:relative;top:2px;cursor:hand" onclick="ln_Save('2')"> -->
		  </td>
			<td width="4px;"></td>
		</tr> 
		<tr>
		  <td style="width:465;border:0 solid #708090;border-top-width:1px" colspan="2">
				<comment id="__NSID__"><object  id=gcgd_data2 style="width:610px;height:200px;border:0 solid #777777" classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
					<PARAM NAME="DataID"			VALUE="gcds_data2">
					<PARAM NAME="Editable"		VALUE="true">
					<PARAM NAME="viewSummary" VALUE="0">
					<PARAM NAME="ColSizing"		VALUE="true">
					<PARAM NAME="SortView"		VALUE="left">
					<PARAM NAME="BorderStyle" VALUE="0">
					<param name="Fillarea"		VALUE="true">
					<PARAM NAME="Format"			VALUE="
					<C>ID=TAXMM			Name='월'				HeadAlign=Center HeadBgColor=#B9D4DC Width=20  align=center SumText='' SumBgColor=#C3D0DB </C>
					<C>ID=TAXDT			Name='일'				HeadAlign=Center HeadBgColor=#B9D4DC Width=20  align=center SumText='' SumBgColor=#C3D0DB </C>
					<C>ID=TAXPDTNAM Name='품목명'		HeadAlign=Center HeadBgColor=#B9D4DC Width=115 align=LEFT		SumText='' SumBgColor=#C3D0DB </C>
					<C>ID=TAXSTD		Name='규격'			HeadAlign=Center HeadBgColor=#B9D4DC Width=60	 align=LEFT		SumText='' SumBgColor=#C3D0DB </C>
					<C>ID=TAXQTY		Name='수량'			HeadAlign=Center HeadBgColor=#B9D4DC Width=60  align=right	SumText='' SumBgColor=#C3D0DB </C> 
					<C>ID=TAXPRIC   Name='단가'			HeadAlign=Center HeadBgColor=#B9D4DC Width=60  align=right	SumText='' SumBgColor=#C3D0DB </C> 
					<C>ID=TAXSUM		Name='공급가액'	HeadAlign=Center HeadBgColor=#B9D4DC Width=80  align=right	SumBgColor=#C3D0DB</C>
					<C>ID=TAXVATAMT Name='부가세액'	HeadAlign=Center HeadBgColor=#B9D4DC Width=80  align=right	SumText=@sum SumBgColor=#C3D0DB</C>
					<C>ID=BIGO			Name='비고'			HeadAlign=Center HeadBgColor=#B9D4DC Width=80  align=LEFT		SumText=''	 SumBgColor=#C3D0DB</C>
					">
				</object></comment><script>__ws__(__NSID__);</script> 
				<fieldset style="width:612;height:20px;border:0 solid #708090;border-top-width:1px;text-align:left;">
					&nbsp;<font id=ft_cnt2 style="position:relative;top:4px;"></font>
				</fieldset>
			</td>
		</tr>
	</table>
</div>

<!-----------------------------------------------------------------------------
			B I N D  D E F I N I T I O N
------------------------------------------------------------------------------>
<comment id="__NSID__"><object  id=gcbn_data1 classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID"				VALUE="gcds_data1">
	<PARAM NAME="ActiveBind"		VALUE="true">
	<PARAM NAME="BindInfo"			VALUE="
	<C>Col=TAXNBR				Ctrl=gcem_taxnbr				Param=text				</C>
	<C>Col=COCODE				Ctrl=gcra_cocode				Param=CodeValue		</C>
	<C>Col=TAXDAT				Ctrl=gcem_taxdat				Param=text				</C>
	<C>Col=TAXIODIV			Ctrl=gcra_taxiodiv			Param=CodeValue		</C>
	<C>Col=TAXKND				Ctrl=gclx_taxknd				Param=BindColVal	</C>
	<C>Col=TAXDIV				Ctrl=gclx_taxdiv				Param=BindColVal	</C>
	<C>Col=TAXCDNBR			Ctrl=gclx_taxcdnbr			Param=BindColVal	</C>
	<C>Col=FSDAT				Ctrl=gcem_fsdat					Param=text				</C>
	<C>Col=FSNBR				Ctrl=gcem_fsnbr					Param=text				</C>
	<C>Col=CCCODE				Ctrl=gcem_cccode				Param=text				</C>
	<C>Col=VEND_NM			Ctrl=txt_fdcodenm				Param=value				</C>
	<C>Col=VDDIRECT			Ctrl=txt_vddirect				Param=Value				</C>
	<C>Col=BSNSCND			Ctrl=txt_bsnscnd				Param=Value				</C>
	<C>Col=BSNSKND			Ctrl=txt_bsnsknd				Param=Value				</C>
	<C>Col=REMARK				Ctrl=txt_remark					Param=Value				</C>
	<C>Col=TAXSUM				Ctrl=gcem_taxsum				Param=text				</C>
	<C>Col=TAXVATAMT		Ctrl=gcem_taxvatamt			Param=text				</C>
	<C>Col=TAXTOT				Ctrl=gcem_taxtot				Param=text				</C>
	<C>Col=VD_DIRECT		Ctrl=txt_vddirect				Param=Value				</C>
	<C>Col=BSNS_CND			Ctrl=txt_bsnscnd				Param=Value				</C>
	<C>Col=BSNS_KND			Ctrl=txt_bsnsknd				Param=Value				</C>
	<C>Col=FDCODE				Ctrl=gclx_fdcode				Param=BindColVal	</C>
">
</object></comment><script>__ws__(__NSID__);</script> 

<iframe id="LowerFrame" name="work" style="visibility:hidden; 	position:absolute; left:140px; top:220px;" FrameBorder="0" src="../../Common/img/flash/loading.swf" width="320px" height="42px"></iframe> 

</body>
</html>