<!-------------------------------------------------------------------------------
+ 시 스 템 명	:	SYSTEM
+ 프로그램 ID	: COM0060.HTML
+ 기 능 정 의	: 조회,저장
+ 변 경 이 력	: 
+ 서 블 릿 명	: 
------------------------------------------------------------------------------>

<html>
<head>
<title>개인프로그램관리</title>
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Content-Type" content="text/html; charset=euc-kr">
<!-----------------------------------------------------------------------------
		S T Y L E   S H E E T   L I N K   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<link rel="stylesheet" href="../../common/include/common.css">

<!-----------------------------------------------------------------------------
		C O M M O N   M O D U L E   S C R I P T S( MESSAGE & FUNCTION )
------------------------------------------------------------------------------>
<Script language="javascript" src="../../common/include/PubFun.js"></script>

<!-----------------------------------------------------------------------------
		L O C A L   S T Y L E   S H E E T   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<style type="text/css">
<!--
//-->
</style>

<!-----------------------------------------------------------------------------
		L O C A L   S C R I P T   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javascript">
get_cookdata();
lfn_init();

/******************************************************************************
	Description : 페이지 로딩
******************************************************************************/
function ln_Start() {
	gcds_bas1.DataID = "/services/servlet/common.hdasan_sys?gstr1="; 
	gcds_bas1.Reset();
	
	gcds_selusr.DataID = "/services/servlet/common.hdasan_user2?gstr1=A&gstr2="; 
	gcds_selusr.Reset();

	ln_Query();
}

/******************************************************************************
	Description : 조회
******************************************************************************/
function ln_Query(){
	gcds_user.DataID = "/services/servlet/common.hdasan_user2?gstr1=A&gstr2="; 
	gcds_user.Reset();
}

/******************************************************************************
	Description : 추가
******************************************************************************/
function ln_Add(g){

}

/******************************************************************************
	Description : 저장
******************************************************************************/
function ln_Save(){
	if (gcds_usrpgm.countrow <1) {
		alert("저장하실 정보가 없습니다.");
	} else {
		if (gcds_usrpgm.IsUpdated || gcds_selusr.IsUpdated)	{
			if (confirm("해당 선택된 정보를 저장하겠습니까 ?")) {
				gctr_usrpgm.Action = "/services/servlet/common.com0060t1";
				gctr_usrpgm.post();
			}
		}
	}
}

/******************************************************************************
	Description : 삭제
******************************************************************************/
function ln_Delete(g){

}

/******************************************************************************
	Description : 취소
******************************************************************************/
function ln_Cancel(){

}

/******************************************************************************
	Description : 출력
******************************************************************************/
function ln_Print(){

}

/******************************************************************************
	Description : 엑셀
******************************************************************************/
function ln_Excel(){

}

/******************************************************************************
	Description :
******************************************************************************/
function ln_Selpgm(t,a,e){
	gcds_usrpgm.DataID = "/services/servlet/common.com0060s1?v_str1=" + t + "&v_str2=" + a + "&v_str3=" + e; 
	gcds_usrpgm.Reset();
//	prompt('',gcds_usrpgm.DataID);
}
</script>

<!-----------------------------------------------------------------------------
		D A T A S E T   C O M P O N E N T S   D E C L A R A T I O N
------------------------------------------------------------------------------>
<comment id="__NSID__"><object id="gcds_user" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" >
	<PARAM NAME="syncload" VALUE="true">
	<PARAM NAME="sortexpr" VALUE="+deptnm+paygnm+userid">
 </OBJECT></comment><script>__ws__(__NSID__);</script>

<comment id="__NSID__"><object id="gcds_selusr" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" >
	<PARAM NAME="syncload" VALUE="true">
	<PARAM NAME="sortexpr" VALUE="+deptnm+paygnm+userid">
 </OBJECT></comment><script>__ws__(__NSID__);</script>

<comment id="__NSID__"><object id="gcds_bas1" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" >
	<PARAM NAME="syncload" VALUE="true">
	<PARAM NAME="sortexpr" VALUE="+scdnm">
 </OBJECT></comment><script>__ws__(__NSID__);</script>

<comment id="__NSID__"><object id="gcds_bas" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" >
	<PARAM NAME="syncload" VALUE="true">
 </OBJECT></comment><script>__ws__(__NSID__);</script>

<comment id="__NSID__"><object id="gcds_usrpgm" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" >
	<PARAM NAME="syncload" VALUE="true">
 </OBJECT></comment><script>__ws__(__NSID__);</script>

<!-----------------------------------------------------------------------------
	  T R A N S A C T I O N   C O M P O N E N T S   D E C L A R A T I O N
------------------------------------------------------------------------------>
<comment id="__NSID__"><object id="gctr_usrpgm" classid="clsid:0A2233AD-E771-11D2-973D-00104B15E56F" VIEWASTEXT>
	<PARAM NAME="KeyName"  VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="common.com0060t1(I:PGM=gcds_usrpgm,I:USER=gcds_selusr)">
 </OBJECT></comment><script>__ws__(__NSID__);</script>

<!-----------------------------------------------------------------------------
					D A T A S E T   C O M P O N E N T' S
		M A N D A T O R Y   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javascript" for="gcds_bas1" event="OnLoadStarted()">
	window.status="데이타 조회중입니다..잠시만 기다려 주십시오.";
	document.all.LowerFrame.style.visibility="visible";
</script>

<script language="javascript" for="gcds_user" event="onloadCompleted(row,colid)">
	window.status="조회가 완료 되었습니다.";
	document.all.LowerFrame.style.visibility="hidden";
	ft_cnt.innerText = "조회건수 : " + row + " 건";
	if (row <1) alert("검색된 데이터가 없습니다.");
</script>

<!-----------------------------------------------------------------------------
					G A U C E   C O M P O N E N T' S
		G E N E R A L   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javaScript" for="gcgd_user" event="onclick(row,colid)">//사용자 
	if (row<1) {
		gcds_user.SortExpr = colid+"+";
		gcds_user.Sort();
		gcds_user.rowposition = 1;
	} else {
		gcds_bas.ClearData();
		gcds_usrpgm.ClearData();
	}
</script>

<script language="javaScript"	for="gcgd_bas1"	event="onclick(row)">//시스템
	if (row > 0) {
		gcds_bas.clearall();
		gcds_usrpgm.clearall();

		var str1 = gcds_bas1.namevalue(row, "SCODE");
		var str2 = gcds_user.namevalue(gcds_user.rowposition,"USERID");

		gcds_bas.dataid = "/services/servlet/common.hdasan_sys?gstr1=" + str1; 
		gcds_bas.Reset();

		ln_Selpgm('A',str1,str2);
	}
</script>

<script language="javaScript" for="gcgd_bas" event="onclick(row)">//중분류
	if (row > 0) {
		gcds_usrpgm.clearall();

		var str1 = gcds_bas.namevalue(row,"SCODE");
		var str2 = gcds_user.namevalue(gcds_user.rowposition,"USERID");

		ln_Selpgm('B',str1,str2);
	}
</script>

<script language="javaScript"		for="gcgd_selusr"	event="onclick(row,colid)">//사용자 
/*	if (row <1) {
		gcds_selusr.SortExpr = colid+"+";
		gcds_selusr.Sort();
		gcds_selusr.rowposition = 1;
	} else {
		if (gcds_selusr.namevalue(row,"CHK") == "F") gcds_selusr.namevalue(row,"CHK") = "T";
		else gcds_selusr.namevalue(row,"CHK") = "F";
	}
*/
if (row <1 && colid=="CHK") {
	if (gcds_selusr.namevalue(1,"CHK") == "T") {
			for (var i=1;i<=gcds_selusr.countrow;i++) gcds_selusr.namevalue(i,"CHK") = "F";
	} else {
			for (var i=1;i<=gcds_selusr.countrow;i++) gcds_selusr.namevalue(i,"CHK") = "T";
	}
}

</script>

<script language="javaScript"		for="gcgd_usrpgm"	event="onclick(row,colid)">
	if (row <1 && colid=="CHK") {
		if (gcds_usrpgm.namevalue(1,"CHK") == "T") {
			for (var i=1;i<=gcds_usrpgm.countrow;i++) gcds_usrpgm.namevalue(i,"CHK") = "F";
		} else {
			for (var i=1;i<=gcds_usrpgm.countrow;i++) gcds_usrpgm.namevalue(i,"CHK") = "T";
		}
	}
</script>


<!-----------------------------------------------------------------------------
				T R A N S A C T I O N   C O M P O N E N T' S
		M A N D A T O R Y   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javascript" for="gctr_usrpgm" event="onsuccess()">
	alert("작업이 성공적으로 완료되었습니다.");
	gcds_usrpgm.ClearData();
	gcds_selusr.reset();
</script>

</head>

<!-----------------------------------------------------------------------------
						B O D Y   D E F I N I T I O N
------------------------------------------------------------------------------>
<BODY border="0" cellpadding="0" cellspacing="0" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" OnLoad="ln_Start()">

<table width="876" cellpadding="0" cellspacing="0" border="0" style="position:relative;left:3px">
	<tr> 
		<td background="../../common/img/com_t_bg.gif"><img src="../../common/img/com_sys06_head.gif"></td>
    <td width="685" align="right" background="../../common/img/com_t_bg.gif" style="padding-top:4px;">
			<img src="../../common/img/btn/com_b_save.gif" id=btn_save style="cursor:hand" onclick="ln_Save()"> 
			<img src="../../common/img/btn/com_b_query.gif" id=btn_query style="cursor:hand" onclick="ln_Query()">&nbsp;
		</td>
	</tr>
  <tr> 
    <td colspan="2"> 
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr> 
					<td colspan="2">
						<comment id="__NSID__"><object id=gcgd_user classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 style="width:440px; height:159px;border:1 solid #777777" viewastext>
              <PARAM NAME="DataID"			VALUE="gcds_user">
              <PARAM NAME="Editable"		VALUE="false">
              <PARAM NAME="BorderStyle" VALUE="0">
              <PARAM NAME="Indwidth"		VALUE="0">
							<PARAM NAME="Fillarea"		VALUE="true">
							<PARAM NAME="sortview"		VALUE="left">
						  <PARAM NAME="Format"			VALUE="  
								<C> Name='부서'			ID=DEPTNM		HeadAlign=Center	HeadBgColor=#B9D4DC Width=160	align=left,		edit=none, suppress=1,sort=true</C> 
								<C> Name='직위'			ID=PAYGNM		HeadAlign=Center	HeadBgColor=#B9D4DC Width=100	align=left,		edit=none, suppress=2,sort=true</C> 
								<C> Name='사번'			ID=USERID		HeadAlign=Center	HeadBgColor=#B9D4DC Width=80	align=center, edit=none,sort=true</C> 
								<C> Name='사용자명'	ID=USERNAME	HeadAlign=Center	HeadBgColor=#B9D4DC Width=83	align=center, edit=none,sort=true</C>
							">
             </OBJECT></comment><script>__ws__(__NSID__);</script>
						<comment id="__NSID__"><object id=gcgd_bas1 classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49  style="position:relative;left:5px;width:210px; height:159px; border:1 solid #777777" viewastext>
              <PARAM NAME="DataID"			VALUE="gcds_bas1">
              <PARAM NAME="Editable"		VALUE="false">
              <PARAM NAME="BorderStyle" VALUE="0">
              <PARAM NAME="Indwidth"		VALUE="0">
							<PARAM NAME="Fillarea"		VALUE="true">
						  <PARAM NAME="Format"			VALUE="  
								<C> Name='No'				ID={CURROW}	HeadAlign=Center	HeadBgColor=#B9D4DC	Width=50	align=center</C>
								<C> Name='시스템명'	ID=SCDNM		HeadAlign=Center HeadBgColor=#B9D4DC Width=144 align=center</C> 
							">
             </OBJECT></comment><script>__ws__(__NSID__);</script>
						<comment id="__NSID__"><object id=gcgd_bas classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49  style="position:relative;left:10px;width:210px; height:159px; border:1 solid #777777" viewastext>
              <PARAM NAME="DataID"			VALUE="gcds_bas">
              <PARAM NAME="Editable"		VALUE="false">
              <PARAM NAME="BorderStyle" VALUE="0">
              <PARAM NAME="Indwidth"		VALUE="0">
							<PARAM NAME="Fillarea"		VALUE="true">
						  <PARAM NAME="Format"			VALUE="  
								<C> Name='No'				ID={CURROW}	HeadAlign=Center	HeadBgColor=#B9D4DC	Width=50	align=center</C>
								<C> Name='메뉴분류'	ID=SCDNM		HeadAlign=Center HeadBgColor=#B9D4DC Width=144 align=center</C> 
							">
             </OBJECT></comment><script>__ws__(__NSID__);</script>
					</td>
				</tr>
				<tr><td colspan="2" height="10px"></td></tr>
				<tr>
					<td>
						<comment id="__NSID__"><object id=gcgd_usrpgm classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49  style="position:relative;top:0px;width:360px; height:299px; border:1 solid #777777" viewastext>
              <PARAM NAME="DataID"			VALUE="gcds_usrpgm">
              <PARAM NAME="Editable"		VALUE="true">
              <PARAM NAME="BorderStyle" VALUE="0">
              <PARAM NAME="Indwidth"		VALUE="0">
							<PARAM NAME="Fillarea"		VALUE="true">
						  <PARAM NAME="Format"			VALUE="  
								<C> Name='No'									ID={CURROW}	HeadAlign=Center	HeadBgColor=#B9D4DC	Width=50	align=center</C>
								<C> Name='프로그램ID'					ID=PGMID		HeadAlign=Center	HeadBgColor=#B9D4DC Width=100 align=center	Edit=none</C>
								<C> Name='사용 프로그램명'		ID=PGMNM		HeadAlign=Center	HeadBgColor=#B9D4DC Width=130 align=left		Edit=none</C> 
								<F> Name='선택'								ID=CHK			HeadAlign=Center	HeadBgColor=#B9D4DC Width=63	align=center, Editstyle=checkbox, cursor=hand</F> 
							">
             </OBJECT></comment><script>__ws__(__NSID__);</script>
						<fieldset style="width:362px;height:20px;border:1 solid #708090;border-top-width:0px;text-align:left;">
							&nbsp;<font id=ft_cnt style="position:relative;top:3px;"></font>
						</fieldset>
					</td>
					<td>
						<comment id="__NSID__"><object id=gcgd_selusr classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 style="width:505px; height:319px;border:1 solid #777777" viewastext>
              <PARAM NAME="DataID"			VALUE="gcds_selusr">
              <PARAM NAME="Editable"		VALUE="true">
              <PARAM NAME="BorderStyle" VALUE="0">
              <PARAM NAME="Indwidth"		VALUE="0">
							<PARAM NAME="Fillarea"		VALUE="true">
						  <PARAM NAME="Format"			VALUE="  
								<C> Name='부서'			ID=DEPTNM		HeadAlign=Center	HeadBgColor=#B9D4DC Width=170	align=left,		edit=none, suppress=1</C> 
								<C> Name='직위'			ID=PAYGNM		HeadAlign=Center	HeadBgColor=#B9D4DC Width=100	align=left,		edit=none, suppress=2</C> 
								<C> Name='사번'			ID=USERID		HeadAlign=Center	HeadBgColor=#B9D4DC Width=80	align=center, edit=none</C> 
								<C> Name='사용자명'	ID=USERNAME	HeadAlign=Center	HeadBgColor=#B9D4DC Width=80	align=center, edit=none</C>
								<C> Name='선택'			ID=CHK			HeadAlign=Center	HeadBgColor=#B9D4DC Width=60	align=center, Editstyle=checkbox, cursor=hand</C> 
							">
             </OBJECT></comment><script>__ws__(__NSID__);</script>
					</td>
				</tr>
			</table>
    </td>
  </tr>
</table>
	
</body>
</html>

<iframe id="LowerFrame" name="work" style="visibility:hidden; 	position:absolute; left:280px; top:220px;" FrameBorder="0" src="../../common/img/flash/loading.swf" width="320px" height="42px"></iframe> 
