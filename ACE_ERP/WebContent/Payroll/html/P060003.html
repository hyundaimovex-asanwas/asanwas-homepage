<!-------------------------------------------------------------------------------
+ 시 스 템 명	:	급여/소속별급여현황
+ 프로그램 ID	: p060003.HTML
+ 기 능 정 의	: 조회|엑셀
+ 변 경 이 력	: 
+ 수 정 이 력	: 이순미 - 2005.08.08 - 소스 정리
+ 서 블 릿 명	: p060003_s1
------------------------------------------------------------------------------>

<html>
<head>
<title>소속별급여현황</title>
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Content-Type" content="text/html; charset=euc-kr">
<!-----------------------------------------------------------------------------
		S T Y L E   S H E E T   L I N K   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<link rel="stylesheet" href="../../common/include/common.css">

<!-----------------------------------------------------------------------------
		C O M M O N   M O D U L E   S C R I P T S( MESSAGE & FUNCTION )
------------------------------------------------------------------------------>
<Script language="javascript" src="../../common/include/PubFun.js"></script>

<!-----------------------------------------------------------------------------
		L O C A L   S T Y L E   S H E E T   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<style type="text/css">
<!--
//-->
</style>

<!-----------------------------------------------------------------------------
		L O C A L   S C R I P T   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javascript">
get_cookdata();
lfn_init();
var gs_date = gcurdate.substr(0,4) + gcurdate.substr(5,2) + gcurdate.substr(8,2);
var gs_date2 = gcurdate.substr(0,4) + gcurdate.substr(5,2);

/******************************************************************************
	Description : 페이지 로딩
******************************************************************************/
function ln_Start(){
	gcem_yyyy_mm_1.Text=gs_date2
	gcem_yyyy_mm_2.Text=gs_date2
	gcds_dept.DataID ="/services/servlet/Person.hcdept_s2?v_str1="; //소속정보
	gcds_dept.Reset();

  ln_Jikwi();

}

/******************************************************************************
	Description : 조회
******************************************************************************/
function ln_Query(){

	var str_Format=""
	 + "<FC> Name='소속' ID=DEPTNM BgColor='#f5f5f5'  	HeadAlign=Center HeadBgColor=#B9D4DC Width=120 SumBgColor=#C3D0DB SumText='합계' align=LEFT  </FC> "
	 +  " <FC>Id=CrossTabSum Name='계'  BgColor='#f5f5f5' HeadBgColor=#B9D4DC width=100   align=right   Value={CrossTabSum(GUBUNSUM)}  sumBgColor=#C3D0DB      </FC>"
	 +  "  <R> Name=$xkeyname_$$ HeadBgColor=#B9D4DC    "
	 +  "	<C>ID=GUBUNSUM_$$      Name='$xkeyname_$$'       width=80  align=right HeadBgColor=#B9D4DC sumBgColor=#C3D0DB  SumText='@sum' </C> "
	 +  " </R> ";
	gcgd_create.Format=str_Format;

	var str1 = gcem_yyyy_mm_1.Text;  //지급구분
	var str2 = gcem_yyyy_mm_2.Text;  //급여항목구분
	var str3 = gclx_select_ec01az.BindColVal;
	gcds_grid_ec01az.ClearData();

	gcds_grid_ec01az.DataID = "/services/servlet/Payroll.p060003_s1?v_str1="+str1
													 +"&v_str2="+str2
													 +"&v_str3="+str3;
	gcds_grid_ec01az.Reset(); 
}

/******************************************************************************
	Description : 
******************************************************************************/
function ln_Jikwi(){
	var str1 = gcem_yyyy_mm_1.Text;  //지급구분
	var str2 = gcem_yyyy_mm_2.Text;  //급여항목구분
	var str3 = fn_trim(gclx_select_ec01az.BindColVal);

	gcds_select_ec02az.DataID = "/services/servlet/Payroll.p060001_s2?v_str1="+str1
	                         +"&v_str2="+str2
												   +"&v_str3="+str3;
	gcds_select_ec02az.Reset(); 
}

/******************************************************************************
	Description : 
******************************************************************************/
function ln_JikwiFormat(){
	var str_Format=""
	 + "<FC> Name='소속' ID=DEPTNM  BgColor='#f5f5f5' 	HeadAlign=Center HeadBgColor=#B9D4DC Width=120 SumBgColor=#C3D0DB SumText='합계' align=LEFT  </FC> "
	+" <FC> Name='계' ID='GUBUNSUM'  BgColor='#f5f5f5'	Head HeadBgColor=#B9D4DC Width=90   SumBgColor=#C3D0DB	 SumText=@sum  </FC> ";
	for( i=1;gcds_select_ec02az.countrow >= i; i++)	{
			str_Format+="<C> Name='" +gcds_select_ec02az.namevalue(i,"MINORNM")+"' ID='F"+i+"_AMT'  	Head HeadBgColor=#B9D4DC Width=90  SumBgColor=#C3D0DB align=RIGHT Edit=Numeric  SumText=@sum </C> ";
	}
	gcgd_create.Format=str_Format;
	document.all.LowerFrame.style.visibility="hidden";
}

/*******************************************************************************
  Description : Grid 데이터를 Excel을 실행시켜 출력
******************************************************************************/
function ln_Excel(){
	if (gcds_grid_ec01az.countrow<1) alert("다운로드하실 자료가 없습니다.");
	else gcgd_create.RunExcel('소속별급여현황');
}


</script>

<!-----------------------------------------------------------------------------
		D A T A S E T   C O M P O N E N T S   D E C L A R A T I O N
------------------------------------------------------------------------------>
<comment id="__NSID__"><object id="gcds_dept" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" > 
	<PARAM NAME="SYNCLOAD" VALUE="true">
	<PARAM NAME="SortExpr" VALUE="+TREECD">
</object></comment><script>__ws__(__NSID__);</script>

<comment id="__NSID__"><object id="gcds_select_ec02az" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" > 
	<PARAM NAME="SYNCLOAD" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script> <!--직위 동적 그리드 포맷-->

<comment id="__NSID__"><object id="gcds_grid_ec01az" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" > 
	<PARAM NAME="SYNCLOAD" VALUE="false">
</object></comment><script>__ws__(__NSID__);</script>

<comment id="__NSID__"><object id="tb_CDataSet" classid="clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49" > 
	<param name=DataID		value="gcds_grid_ec01az">
	<param name=Logical		value="true">
	<param name=GroupExpr	value="DEPTNM: DEPTCD,PAYGRDNM,GUBUNSUM">
</object></comment><script>__ws__(__NSID__);</script>

<!-----------------------------------------------------------------------------
	  T R A N S A C T I O N   C O M P O N E N T S   D E C L A R A T I O N
------------------------------------------------------------------------------>

<!-----------------------------------------------------------------------------
					D A T A S E T   C O M P O N E N T' S
		M A N D A T O R Y   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>
<script language="javascript" for="gcds_dept" event="OnLoadStarted()">
	window.status="데이타 조회중입니다..잠시만 기다려 주십시오.";
	document.all.LowerFrame.style.visibility="visible";
</script>

<script language="javascript" for="gcds_dept" event="onloadCompleted(row,colid)">
	gcds_dept.InsertRow(1);
	gcds_dept.NameValue(1,"DEPTCD")="";
	gcds_dept.NameValue(1,"DEPTNM")="전체";
	gclx_select_ec01az.index=0;
	//document.all.LowerFrame.style.visibility="hidden";
	window.status="데이타 조회가 완료되었습니다.";
</script>

<script language="javascript" for="gcds_select_ec02az" event="OnLoadStarted()">
	window.status="데이타 조회중입니다..잠시만 기다려 주십시오.";
	document.all.LowerFrame.style.visibility="visible";
</script>

<script language="javascript" for="gcds_select_ec02az" event="onloadCompleted(row,colid)">
	window.status="데이타 조회가 완료되었습니다.";
	if(gcds_select_ec02az.countrow > 0)	{
		ln_JikwiFormat();
	}	else	{
		document.all.LowerFrame.style.visibility="hidden";
	}
</script>

<script language="javascript" for="gcds_grid_ec01az" event="OnLoadStarted()">
	ft_cnt1.innerText="데이타 조회중입니다.";
	document.all.LowerFrame.style.visibility="visible";
</script>

<script language="javascript" for="gcds_grid_ec01az" event="onloadcompleted(row,colid)">
	ft_cnt1.innerText = "조회건수 : " + row + " 건";
	window.status="조회가 완료 되었습니다.";
	document.all.LowerFrame.style.visibility="hidden";

	if(gcds_grid_ec01az.countrow <=0)
			alert("조회된 데이타가 없습니다.");
</script>

<script language="javascript" for="tb_CDataSet" event="onloadcompleted(row,colid)">
	if(row !=0)	{
	//콤마생성 문제로 시작 생성
	var str1=gcds_grid_ec01az.Sum(5,0,0)+"";
		if(parseInt(str1.length/3) >1)	{
		var str2="";
		var j=0;
			if((str1.length%3) != 0)	{
				str2=str1.substring(0,str1.length%3)+",";
				j=str1.length%3;
			}
			for(var i=1; i <=(parseInt(str1.length/3)-1); i++){
				str2+=str1.substring(j,j+3)+",";
				j+=3;
			}
			str2+=str1.substring((str1.length-3),str1.length);
		}	else	{
			var str2=str1;
		}
		//콤마생성 문제로 끝
	gcgd_create.ColumnProp('CrossTabSum', 'SumText')  = str2;
	gcgd_create.ColumnProp('CrossTabSum', 'SumTextAlign') = "right";
	}else{ }
	ft_cnt1.innerText = "조회건수 : " + row + " 건";
</script>

<!-----------------------------------------------------------------------------
					G A U C E   C O M P O N E N T' S
		G E N E R A L   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>

<!-----------------------------------------------------------------------------
				T R A N S A C T I O N   C O M P O N E N T' S
		M A N D A T O R Y   E V E N T S   S P E C I F I C A T I O N
------------------------------------------------------------------------------>

</head>

<!-----------------------------------------------------------------------------
						B O D Y   D E F I N I T I O N
------------------------------------------------------------------------------>
<body bgcolor="#FFFFFF" topmargin="0" marginheight="0" leftmargin="0" marginwidth="0" onload="ln_Start()">

<table width="877" cellpadding="0" cellspacing="0" border="0" style="position:relative;left:3px">
  <tr> 
    <td  background="../../common/img/com_t_bg.gif"><img src="../img/p060003_head.gif"></td>
    <td  align="right" style="padding-top:4px;" background="../../common/img/com_t_bg.gif">
			<img src="../../common/img/btn/com_b_excel.gif" style="cursor:hand"  onclick="ln_Excel()">  
			<img src="../../common/img/btn/com_b_query.gif" style="cursor:hand" onclick="ln_Query()">&nbsp;</td>
  </tr>
  <tr> 
    <td COLSPAN=2>
	<table  cellpadding="1" cellspacing="0" border="0"      
	   style='width:877px;height:30px;font-size:9pt;background-color:#ffffff;BORDER-LEFT-WIDTH:1px;border:1 solid #708090'>
    <tr> 
			<td width="10" style="border:0 solid #708090;border-right-width:1px;"  bgcolor="#eeeeee"><nobr>&nbsp;지급년월&nbsp;</nobr></td>
			<td style="border:0 solid #708090;border-right-width:0px;">&nbsp;
				<comment id="__NSID__"><object id=gcem_yyyy_mm_1 classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F  tabindex="1" style="position:relative; left:1px;top:1px; width:50px; height:20px; font-family:dotum; font-size:9pt; " class=objclsEme1  validFeatures="ignoreStatus=yes" validExp="">
					<param name=Text          value="">
					<param name=Alignment			value=0>
					<param name=Border	      value=True>
					<param name=ClipMode			value=true>
					<param name=Numeric	      value=false>
					<param name=Format	      value="YYYY/MM">
					<param name=MaxLength     value=6>
					<param name=PromptChar	  value="_">
					<param name=IsComma	      value=false>
					<param name=BackColor     value="#CCCCCC">
					<param name=InheritColor  value=false>
				</object></comment><script>__ws__(__NSID__);</script></nobr>
			</td> 
			<td><nobr>&#45;</nobr></td> 
			<td style="border:0 solid #708090;border-right-width:1px;"><nobr>
				<comment id="__NSID__"><object id=gcem_yyyy_mm_2 classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F  tabindex="1"  style="position:relative; left:1px;top:1px; width:50px; height:20px; font-family:dotum; font-size:9pt; " class=objclsEme1  validFeatures="ignoreStatus=yes" validExp="">
					<param name=Text          value="">
					<param name=Alignment			value=0>
					<param name=Border	      value=True>
					<param name=ClipMode			value=true>
					<param name=Numeric	      value=false>
					<param name=Format	      value="YYYY/MM">
					<param name=MaxLength     value=6>
					<param name=PromptChar	  value="_">
					<param name=IsComma	      value=false>
					<param name=BackColor     value="#CCCCCC">
					<param name=InheritColor  value=false>
				</object></comment><script>__ws__(__NSID__);</script>&nbsp;</nobr>
			</td> 
      <td width="10" style="border:0 solid #708090;border-right-width:1px;"  bgcolor="#eeeeee"><nobr>&nbsp;소속&nbsp;</nobr></td>
			<td width="10" style="border:0 solid #708090;border-right-width:0px;"><nobr>
				<comment id="__NSID__"><object id=gclx_select_ec01az  name="gclx_select_ec01az" classid=clsid:60109D65-70C0-425C-B3A4-4CB001513C69   style="position:relative;left:8px;top:2px;font-size:12px;width:120px;height:200px;">
					<param name=ComboDataID			value="gcds_dept"> 
					<param name=SearchColumn		value="DEPTCD^DEPTNM">
					<param name=Sort            value="false">
					<param name=SortColumn			value="DEPTCD">
					<param name=ListExprFormat	value="DEPTNM^0^130">
					<param name=BindColumn			value="DEPTCD">
				</object></comment><script>__ws__(__NSID__);</script>&nbsp;&nbsp;</nobr>
			</td>  
			<td width="100%" style="border:0 solid #708090;border-right-width:0px;"><nobr>&nbsp;</nobr></td>  
		</tr>
	</table>		
	</td>
  </tr>
  <tr><td height=3></td></tr>  
  <tr><td COLSPAN=2></td></tr>
  <tr> 
    <td colspan=2> 
      <table width="870" cellpadding="0" cellspacing="0" border="0">
        <tr> 
          <td style="border-bottom-width:0px;">
						<comment id="__NSID__"><OBJECT classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 id=gcgd_create  style="WIDTH: 874px; HEIGHT: 410px;border:1 solid #777777;display:block;" viewastext>
							<PARAM NAME="DataID"					VALUE="tb_CDataSet">
							<PARAM NAME="Editable"        VALUE="True">
							<PARAM NAME="BorderStyle"     VALUE="0">
							<param name="Fillarea"				VALUE="true">
							<param name="ViewSummary"			VALUE="1">
							<PARAM NAME="Format"					VALUE="  
								<FC> Name='소속' ID=DEPTNM  BgColor='#f5f5f5' HeadAlign=Center HeadBgColor=#B9D4DC Width=120 SumBgColor=#C3D0DB SumText='합계'
								    align=LEFT  </C> 
								<FC> Name='계' ID=CrossTabSum  	HeadAlign=Center HeadBgColor=#B9D4DC Width=90  SumBgColor=#C3D0DB align=RIGHT Edit=Numeric align=center </FC> 
       					">
            </OBJECT></comment><script>__ws__(__NSID__);</script>
						<fieldset id=ft_div1 style="width: 876px;height:20px;background-color:#FFFFFF;border:1 solid #708090;border-top-width:0px;text-align:LEFT;">
							<font id=ft_cnt1 style="position:relative;top:4px;"></font>&nbsp;
						</fieldset>
					</td>
					<td width=3></td>
				</tr>
			</table>
		</td>
	</tr>
</table>

<iframe id="LowerFrame" name="work" style="visibility:hidden; 	position:absolute; left:280px; top:220px;" FrameBorder="0" src="../../common/img/flash/loading.swf" width="320px" height="42px"></iframe> 

</body>
</html>