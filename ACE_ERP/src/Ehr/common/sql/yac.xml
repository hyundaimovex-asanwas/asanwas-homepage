

<sqls>
<!-- 연말정산 -->



<!--
***********************************************************************
* @UseCase     : YACA001
* @description : 연말정산 전송매체
***********************************************************************
* 2015/02/11     이동훈        최초작성.
***********************************************************************
-->

    <!-- 연말정산 전송매체 검색 -->
    <sql name="YACA001_SHR_14">
        <description>연말정산상세내역조회</description>
        <query>
            <![CDATA[
          
             SELECT ASNHR.SF_GET_DPTNAME('01', 'A4', PERSON.DPT_CD) AS  DPT_NM
                   ,ACC.ENO_NO
                   ,PERSON.ENO_NM
                   ,PERSON.CET_NO                  
                   ,PERSON.RET_YMD AS RET_YN
                   ,SUBSTR(PERSON.RET_YMD,1,4)||SUBSTR(PERSON.RET_YMD,5,2)||SUBSTR(PERSON.RET_YMD,7,2) AS RET_YMD                      
                   ,ASNHR.SF_GET_COMMNAME('01', 'A2', PERSON.JOB_CD) AS JOB_NM
                   ,NVL(ACC.TAX_INCOME, 0)+NVL(ACC.YAB_INCOME, 0) AS TAX_INCOME
                   ,NVL(ACC.MGR_AMT, 0)     AS MGR_AMT
                   ,NVL(ACC.MNI_AMT, 0)     AS MNI_AMT
                   ,NVL(ACC.BADD_AMT, 0)    AS BADD_AMT
                   ,NVL(ACC.SPSB_AMT, 0)    AS SPSB_AMT
                   ,NVL(ACC.GDED_AMT, 0)    AS GDED_AMT
                   ,NVL(ACC.GOL_AMT, 0)     AS GOL_AMT
                   ,NVL(ACC.TBL_DED, 0)     AS TBL_DED
                   ,NVL(ACC.WDD_AMT, 0)     AS WDD_AMT
                   ,NVL(ACC.OTX_DED, 0)     AS OTX_DED
                   ,NVL(ACC.NPEN_DED, 0)     AS NPEN_DED                   
                   ,NVL(ACC.HINS_DED, 0) + NVL(ACC.HINU_DED, 0) AS HIN_DED
                   ,NVL(ACC.LOAN_DED, 0)     AS LOAN_DED
                   ,NVL(ACC.LONG_DED, 0)     AS LONG_DED
                   ,NVL(ACC.DON_FWD, 0)     AS DON_FWD                   
                   ,NVL(ACC.VEN_DED, 0)     AS VEN_DED
                   ,NVL(ACC.INDED_TOT, 0)     AS INDED_TOT
                   ,NVL(ACC.PER_DED, 0)     AS PER_DED
                   ,NVL(ACC.SAVE_DED, 0)     AS SAVE_DED
                   ,NVL(ACC.CARD_DED, 0)     AS CARD_DED
                   ,NVL(ACC.SAJU_DED, 0)     AS SAJU_DED
                   ,NVL(ACC.LSS_DED, 0)     AS LSS_DED
                   ,NVL(ACC.INDED_EXC, 0)   AS INDED_EXC
                   ,NVL(ACC.TTAX_STD, 0)     AS TTAX_STD
                   ,NVL(ACC.TAX_AMT, 0)     AS TAX_AMT
                   ,NVL(ACC.HGR_DED, 0)     AS HGR_DED
                   ,NVL(ACC.AGE_AMT, 0)     AS AGE_AMT
                   ,NVL(ACC.ANN_DED, 0)    AS ANN_DED
                   ,NVL(ACC.MIN_DED, 0)    AS MIN_DED
                   ,NVL(ACC.MMA_DED, 0)    AS MMA_DED
                   ,NVL(ACC.EDU_DED, 0)     AS EDU_DED
                   ,0     AS GOV1_DED
                   ,0     AS GOV2_DED
                   ,0     AS LC1_DED
                   ,0     AS LC23_DED
                   ,NVL(ACC.CPC_DED, 0)     AS CPC_DED
                   ,NVL(ACC.NSE_TOT, 0)     AS NSE_TOT
                   ,NVL(ACC.STA_TOT, 0)     AS STA_TOT
                   ,NVL(ACC.MRENT_DED, 0)   AS MRENT_DED
                   ,NVL(ACC.TDED_TOT, 0)   AS TDED_TOT
                   ,NVL(ACC.DGG_TAX, 0)    AS DGG_TAX
                   ,NVL(ACC.DJM_TAX, 0)    AS DJM_TAX
                   ,NVL(ACC.DBW_TAX, 0)    AS DBW_TAX
                   ,NVL(ACC.AGG_TAX, 0)    AS AGG_TAX
                   ,NVL(ACC.AJM_TAX, 0)    AS AJM_TAX
                   ,NVL(ACC.CONT_TAX, 0)    AS CONT_TAX
                   ,NVL(ACC.DRE_INTX, 0)    AS DRE_INTX
                   ,NVL(ACC.DRE_CTTX, 0)    AS DRE_CTTX
                   ,NVL(ACC.DRE_DFTX, 0)    AS DRE_DFTX
               FROM ASNHR.T_AC_RETACC_14 ACC
                   ,T_CM_PERSON PERSON
              WHERE ACC.PIS_YY      = ? 
                AND PERSON.ENO_NO   = ACC.ENO_NO
           ORDER BY PERSON.JOB_CD, ACC.ENO_NO
            ]]>
        </query>
    </sql>
    
      <!-- 연말정산 전송매체 검색 -->
    <sql name="YACA001_SHR_15">
        <description>연말정산상세내역조회</description>
        <query>
            <![CDATA[
          
             SELECT ASNHR.SF_GET_DPTNAME('01', 'A4', PERSON.DPT_CD) AS  DPT_NM
                   ,ACC.ENO_NO
                   ,PERSON.ENO_NM
                   ,PERSON.CET_NO                  
                   ,PERSON.RET_YMD AS RET_YN
                   ,SUBSTR(PERSON.RET_YMD,1,4)||SUBSTR(PERSON.RET_YMD,5,2)||SUBSTR(PERSON.RET_YMD,7,2) AS RET_YMD                      
                   ,ASNHR.SF_GET_COMMNAME('01', 'A2', PERSON.JOB_CD) AS JOB_NM
                   ,NVL(ACC.TAX_INCOME, 0)+NVL(ACC.YAB_INCOME, 0) AS TAX_INCOME
                   ,NVL(ACC.MGR_AMT, 0)     AS MGR_AMT
                   ,NVL(ACC.MNI_AMT, 0)     AS MNI_AMT
                   ,NVL(ACC.BADD_AMT, 0)    AS BADD_AMT
                   ,NVL(ACC.SPSB_AMT, 0)    AS SPSB_AMT
                   ,NVL(ACC.GDED_AMT, 0)    AS GDED_AMT
                   ,NVL(ACC.GOL_AMT, 0)     AS GOL_AMT
                   ,NVL(ACC.TBL_DED, 0)     AS TBL_DED
                   ,NVL(ACC.WDD_AMT, 0)     AS WDD_AMT
                   ,NVL(ACC.OTX_DED, 0)     AS OTX_DED
                   ,NVL(ACC.NPEN_DED, 0)     AS NPEN_DED                   
                   ,NVL(ACC.HINS_DED, 0) + NVL(ACC.HINU_DED, 0) AS HIN_DED
                   ,NVL(ACC.LOAN_DED, 0)     AS LOAN_DED
                   ,NVL(ACC.LONG_DED, 0)     AS LONG_DED
                   ,NVL(ACC.DON_FWD, 0)     AS DON_FWD                   
                   ,NVL(ACC.VEN_DED, 0)     AS VEN_DED
                   ,NVL(ACC.INDED_TOT, 0)     AS INDED_TOT
                   ,NVL(ACC.PER_DED, 0)     AS PER_DED
                   ,NVL(ACC.SAVE_DED, 0)     AS SAVE_DED
                   ,NVL(ACC.CARD_DED, 0)     AS CARD_DED
                   ,NVL(ACC.SAJU_DED, 0)     AS SAJU_DED
                   ,NVL(ACC.LSS_DED, 0)     AS LSS_DED
                   ,NVL(ACC.INDED_EXC, 0)   AS INDED_EXC
                   ,NVL(ACC.TTAX_STD, 0)     AS TTAX_STD
                   ,NVL(ACC.TAX_AMT, 0)     AS TAX_AMT
                   ,NVL(ACC.HGR_DED, 0)     AS HGR_DED
                   ,NVL(ACC.AGE_AMT, 0)     AS AGE_AMT
                   ,NVL(ACC.ANN_DED, 0)    AS ANN_DED
                   ,NVL(ACC.MIN_DED, 0)    AS MIN_DED
                   ,NVL(ACC.MMA_DED, 0)    AS MMA_DED
                   ,NVL(ACC.EDU_DED, 0)     AS EDU_DED
                   ,0     AS GOV1_DED
                   ,0     AS GOV2_DED
                   ,0     AS LC1_DED
                   ,0     AS LC23_DED
                   ,NVL(ACC.CPC_DED, 0)     AS CPC_DED
                   ,NVL(ACC.NSE_TOT, 0)     AS NSE_TOT
                   ,NVL(ACC.STA_TOT, 0)     AS STA_TOT
                   ,NVL(ACC.MRENT_DED, 0)   AS MRENT_DED
                   ,NVL(ACC.TDED_TOT, 0)   AS TDED_TOT
                   ,NVL(ACC.DGG_TAX, 0)    AS DGG_TAX
                   ,NVL(ACC.DJM_TAX, 0)    AS DJM_TAX
                   ,NVL(ACC.DBW_TAX, 0)    AS DBW_TAX
                   ,NVL(ACC.AGG_TAX, 0)    AS AGG_TAX
                   ,NVL(ACC.AJM_TAX, 0)    AS AJM_TAX
                   ,NVL(ACC.CONT_TAX, 0)    AS CONT_TAX
                   ,NVL(ACC.DRE_INTX, 0)    AS DRE_INTX
                   ,NVL(ACC.DRE_CTTX, 0)    AS DRE_CTTX
                   ,NVL(ACC.DRE_DFTX, 0)    AS DRE_DFTX
               FROM ASNHR.T_AC_RETACC_15 ACC
                   ,T_CM_PERSON PERSON
              WHERE ACC.PIS_YY      = ? 
                AND PERSON.ENO_NO   = ACC.ENO_NO
           ORDER BY PERSON.JOB_CD, ACC.ENO_NO
            ]]>
        </query>
    </sql>
    
    

    <!-- 연말정산 전송매체 검색 -->
    <sql name="YACA001_SHR_142">
        <description>연말정산상세내역조회</description>
        <query>
            <![CDATA[
          
             SELECT ASNHR.SF_GET_DPTNAME('01', 'A4', PERSON.DPT_CD) AS  DPT_NM
                   ,ACC.ENO_NO
                   ,PERSON.ENO_NM
                   ,PERSON.CET_NO                  
                   ,PERSON.RET_YMD AS RET_YN
                   ,SUBSTR(PERSON.RET_YMD,1,4)||SUBSTR(PERSON.RET_YMD,5,2)||SUBSTR(PERSON.RET_YMD,7,2) AS RET_YMD                      
                   ,ASNHR.SF_GET_COMMNAME('01', 'A2', PERSON.JOB_CD) AS JOB_NM
                   ,NVL(ACC.TAX_INCOME, 0)+NVL(ACC.YAB_INCOME, 0) AS TAX_INCOME
                   ,NVL(ACC.MGR_AMT, 0)     AS MGR_AMT
                   ,NVL(ACC.MNI_AMT, 0)     AS MNI_AMT
                   ,NVL(ACC.BADD_AMT, 0)    AS BADD_AMT
                   ,NVL(ACC.SPSB_AMT, 0)    AS SPSB_AMT
                   ,NVL(ACC.GDED_AMT, 0)    AS GDED_AMT
                   ,NVL(ACC.GOL_AMT, 0)     AS GOL_AMT
                   ,NVL(ACC.TBL_DED, 0)     AS TBL_DED
                   ,NVL(ACC.WDD_AMT, 0)     AS WDD_AMT
                   ,NVL(ACC.OTX_DED, 0)     AS OTX_DED
                   ,NVL(ACC.NPEN_DED, 0)     AS NPEN_DED                   
                   ,NVL(ACC.HINS_DED, 0) + NVL(ACC.HINU_DED, 0) AS HIN_DED
                   ,NVL(ACC.LOAN_DED, 0)     AS LOAN_DED
                   ,NVL(ACC.LONG_DED, 0)     AS LONG_DED
                   ,NVL(ACC.DON_FWD, 0)     AS DON_FWD                   
                   ,NVL(ACC.VEN_DED, 0)     AS VEN_DED
                   ,NVL(ACC.INDED_TOT, 0)     AS INDED_TOT
                   ,NVL(ACC.PER_DED, 0)     AS PER_DED
                   ,NVL(ACC.SAVE_DED, 0)     AS SAVE_DED
                   ,NVL(ACC.CARD_DED, 0)     AS CARD_DED
                   ,NVL(ACC.SAJU_DED, 0)     AS SAJU_DED
                   ,NVL(ACC.LSS_DED, 0)     AS LSS_DED
                   ,NVL(ACC.INDED_EXC, 0)   AS INDED_EXC
                   ,NVL(ACC.TTAX_STD, 0)     AS TTAX_STD
                   ,NVL(ACC.TAX_AMT, 0)     AS TAX_AMT
                   ,NVL(ACC.HGR_DED, 0)     AS HGR_DED
                   ,NVL(ACC.AGE_AMT, 0)     AS AGE_AMT
                   ,NVL(ACC.ANN_DED, 0)    AS ANN_DED
                   ,NVL(ACC.MIN_DED, 0)    AS MIN_DED
                   ,NVL(ACC.MMA_DED, 0)    AS MMA_DED
                   ,NVL(ACC.EDU_DED, 0)     AS EDU_DED
                   ,0     AS GOV1_DED
                   ,0     AS GOV2_DED
                   ,0     AS LC1_DED
                   ,0     AS LC23_DED
                   ,NVL(ACC.CPC_DED, 0)     AS CPC_DED
                   ,NVL(ACC.NSE_TOT, 0)     AS NSE_TOT
                   ,NVL(ACC.STA_TOT, 0)     AS STA_TOT
                   ,NVL(ACC.MRENT_DED, 0)   AS MRENT_DED
                   ,NVL(ACC.TDED_TOT, 0)   AS TDED_TOT
                   ,NVL(ACC.DGG_TAX, 0)    AS DGG_TAX
                   ,NVL(ACC.DJM_TAX, 0)    AS DJM_TAX
                   ,NVL(ACC.DBW_TAX, 0)    AS DBW_TAX
                   ,NVL(ACC.AGG_TAX, 0)    AS AGG_TAX
                   ,NVL(ACC.AJM_TAX, 0)    AS AJM_TAX
                   ,NVL(ACC.CONT_TAX, 0)    AS CONT_TAX
                   ,NVL(ACC.DRE_INTX, 0)    AS DRE_INTX
                   ,NVL(ACC.DRE_CTTX, 0)    AS DRE_CTTX
                   ,NVL(ACC.DRE_DFTX, 0)    AS DRE_DFTX
               FROM ASNHR.T_AC_RETACC_142 ACC
                   ,T_CM_PERSON PERSON
              WHERE ACC.PIS_YY      = ? 
                AND PERSON.ENO_NO   = ACC.ENO_NO
           ORDER BY PERSON.JOB_CD, ACC.ENO_NO
            ]]>
        </query>
    </sql>

    <!-- 연말정산 파일출력 -->
    <sql name="YACA001_SHR_FILE_14_AB">
        <description>연말정산 파일출력(A,B)</description>
        <query>
            <![CDATA[
            SELECT ROW_NUMBER() OVER(ORDER BY NPN_NO) AS NUM,
                   NPN_NO
            FROM (
            SELECT 'A'||
                   '20'||
                   '227'||
                   RPAD(?,8)||
                   '2'||
                   RPAD(' ',6)||
                   RPAD('asan99',20)||
                   '9000'||
                   RPAD('2218113834',10)||
                   RPAD('현대아산주식회사',40)||
                   RPAD('인재지원',30)||
                   RPAD('임보이',30)||
                   RPAD('02-3669-3635',15)||
                   TO_CHAR('1','FM00000')||
                   '101'||
                   RPAD(' ',1342) AS NPN_NO
            FROM   ASNHR.T_AC_RETACC_14

            UNION

            SELECT 'B'||
                   '20'||
                   '227'||
                   TO_CHAR(1,'FM000000')||
                   RPAD('2218113834',10)||
                   RPAD('현대아산주식회사',40)||
                   RPAD('조건식',30)||
                   RPAD('1401110011714',13)||
                   TO_CHAR(NVL(YAC.YAC_CNT,0),'FM0000000')||
                   TO_CHAR(NVL(YAB.YAB_CNT,0),'FM0000000')||
                   TO_CHAR(NVL(YAC.TAX_INCOME,0) + NVL(YAC.YAB_INCOME,0),'FM00000000000000')||
                   TO_CHAR(NVL(YAC.DGG_TAX,0),'FM0000000000000')||
                   TO_CHAR(NVL(YAC.DJM_TAX,0),'FM0000000000000')||
                   TO_CHAR(NVL(YAC.DBW_TAX,0),'FM0000000000000')||
                   TO_CHAR(NVL(YAC.TAX_TOT,0),'FM0000000000000')||
                   '1'||
                   RPAD(' ',1334) AS NPN_NO
            FROM  (SELECT COUNT(*) YAB_CNT
                   FROM   ASNHR.T_AC_DUTYPLACE
                   WHERE  PIS_YY = '2014'
                   AND ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')
                   ) YAB,
                  (SELECT COUNT(*) YAC_CNT,
                          SUM(TAX_INCOME) TAX_INCOME,
                          SUM(YAB_INCOME) YAB_INCOME,
                          SUM(GREATEST(DGG_TAX,0)) DGG_TAX,
                          SUM(GREATEST(DBW_TAX,0)) DBW_TAX,
                          SUM(GREATEST(DJM_TAX,0)) DJM_TAX,
                          SUM(GREATEST(NVL(DGG_TAX,0),0) + GREATEST(NVL(DBW_TAX,0),0) + GREATEST(NVL(DJM_TAX,0),0) ) TAX_TOT
                   FROM   ASNHR.T_AC_RETACC_14
                   WHERE PIS_YY = '2014'
                   AND   GBN_TAG= '8'
                   AND ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')
                   
                   ) YAC
            )
            ]]>
        </query>
    </sql>
    
    
      <!-- 연말정산 파일출력 -->
    <sql name="YACA001_SHR_FILE_15_AB">
        <description>연말정산 파일출력(A,B)</description>
        <query>
            <![CDATA[
            SELECT ROW_NUMBER() OVER(ORDER BY NPN_NO) AS NUM,
                   NPN_NO
            FROM (
            SELECT 'A'||
                   '20'||
                   '227'||
                   RPAD(?,8)||
                   '2'||
                   RPAD(' ',6)||
                   RPAD('asan99',20)||
                   '9000'||
                   RPAD('2218113834',10)||
                   RPAD('현대아산주식회사',40)||
                   RPAD('인재지원',30)||
                   RPAD('임보이',30)||
                   RPAD('02-3669-3635',15)||
                   TO_CHAR('1','FM00000')||
                   '101'||
                   RPAD(' ',1432) AS NPN_NO
            FROM   ASNHR.T_AC_RETACC_15

            UNION

            SELECT 'B'||
                   '20'||
                   '227'||
                   TO_CHAR(1,'FM000000')||
                   RPAD('2218113834',10)||
                   RPAD('현대아산주식회사',40)||
                   RPAD('조건식',30)||
                   RPAD('1401110011714',13)||
                   TO_CHAR(NVL(YAC.YAC_CNT,0),'FM0000000')||
                   TO_CHAR(NVL(YAB.YAB_CNT,0),'FM0000000')||
                   TO_CHAR(NVL(YAC.TAX_INCOME,0) + NVL(YAC.YAB_INCOME,0),'FM00000000000000')||
                   TO_CHAR(NVL(YAC.DGG_TAX,0),'FM0000000000000')||
                   TO_CHAR(NVL(YAC.DJM_TAX,0),'FM0000000000000')||
                   TO_CHAR(NVL(YAC.DBW_TAX,0),'FM0000000000000')||
                   TO_CHAR(NVL(YAC.TAX_TOT,0),'FM0000000000000')||
                   '1'||
                   RPAD(' ',1424) AS NPN_NO
            FROM  (SELECT COUNT(*) YAB_CNT
                   FROM   ASNHR.T_AC_DUTYPLACE
                   WHERE  PIS_YY = '2015'
                  -- AND ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')
                   ) YAB,
                  (SELECT COUNT(*) YAC_CNT,
                          SUM(TAX_INCOME) TAX_INCOME,
                          SUM(YAB_INCOME) YAB_INCOME,
                          SUM(GREATEST(DGG_TAX,0)) DGG_TAX,
                          SUM(GREATEST(DBW_TAX,0)) DBW_TAX,
                          SUM(GREATEST(DJM_TAX,0)) DJM_TAX,
                          SUM(GREATEST(NVL(DGG_TAX,0),0) + GREATEST(NVL(DBW_TAX,0),0) + GREATEST(NVL(DJM_TAX,0),0) ) TAX_TOT
                   FROM   ASNHR.T_AC_RETACC_14
                   WHERE PIS_YY = '2015'
                   AND   GBN_TAG= '8'
                  -- AND ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')
                   
                   ) YAC
            )
            ]]>
        </query>
    </sql>
    

    <!-- 연말정산 파일출력 -->
    <sql name="YACA001_SHR_FILE_14_AB_142">
        <description>연말정산 파일출력(A,B)</description>
        <query>
            <![CDATA[
            SELECT ROW_NUMBER() OVER(ORDER BY NPN_NO) AS NUM,
                   NPN_NO
            FROM (
            SELECT 'A'||
                   '20'||
                   '227'||
                   RPAD(?,8)||
                   '2'||
                   RPAD(' ',6)||
                   RPAD('asan99',20)||
                   '9000'||
                   RPAD('2218113834',10)||
                   RPAD('현대아산주식회사',40)||
                   RPAD('인재지원',30)||
                   RPAD('임보이',30)||
                   RPAD('02-3669-3635',15)||
                   TO_CHAR('1','FM00000')||
                   '101'||
                   RPAD(' ',1402) AS NPN_NO
            FROM   ASNHR.T_AC_RETACC_142

            UNION

            SELECT 'B'||
                   '20'||
                   '227'||
                   TO_CHAR(1,'FM000000')||
                   RPAD('2218113834',10)||
                   RPAD('현대아산주식회사',40)||
                   RPAD('조건식',30)||
                   RPAD('1401110011714',13)||
                   TO_CHAR(NVL(YAC.YAC_CNT,0),'FM0000000')||
                   TO_CHAR(NVL(YAB.YAB_CNT,0),'FM0000000')||
                   TO_CHAR(NVL(YAC.TAX_INCOME,0) + NVL(YAC.YAB_INCOME,0),'FM00000000000000')||
                   TO_CHAR(NVL(YAC.DGG_TAX,0),'FM0000000000000')||
                   TO_CHAR(NVL(YAC.DJM_TAX,0),'FM0000000000000')||
                   TO_CHAR(NVL(YAC.DBW_TAX,0),'FM0000000000000')||
                   TO_CHAR(NVL(YAC.TAX_TOT,0),'FM0000000000000')||
                   '1'||
                   RPAD(' ',1394) AS NPN_NO
            FROM  (SELECT COUNT(*) YAB_CNT
                   FROM   ASNHR.T_AC_DUTYPLACE
                   WHERE  PIS_YY = '2014'
                   AND ENO_NO IN (
										'1990033','1990040','1990041','1990044','1990089','1990104','1990105',
										'2000023','2010005','2010012','2020005','2020008','2020009','2020011','2020013','2020016','2020025','2020030',
										'2030002','2030005','2030007','2030009',
										'2040001','2040006','2040012','2040013','2040020','2040023','2040024','2040025','2040038','2040042',
										'2040046','2040066','2040067','2040068','2040070','2040071','2040076','2040078','2040080','2040081',
										'2050004','2050009','2050010','2050012','2050013','2050014','2050015','2050017','2050019','2050022','2050023','2050026',
										'2050029','2050030','2050032','2050033','2050036','2050039','2050042','2050046','2050050','2050053','2050056','2050060','2050063',
										'2060004','2060005','2060007','2060009','2060017','2060024','2060026','2060027',
										'2070007','2070016','2070018','2070019','2070021','2070026','2070027','2070030','2070039','2070043',
										'2080003','2080007','2080009','2080012','2080018','2080019','2080021','2080025','2080028','2080031','2080033','2080046',
										'2090002','2090011','2100002','2100003','2100004','2100007','2100016',
										'2110003','2110005','2110007','2110013','2110014','2110016','2110017',
										'2120003','2120007','2120008','2120026','2120029','2120030','2120032','2120033',
										'2130003','2130004','2130005','2130006','2130008','2130010','2130012','2130013','2130015','2130019','2130020','2130021','2130025',
										'2130026','2130027','2130028','2130030','2130033','2130035','2130037','2130039','2130041','2130043','2130045',
										'2140001','2140003','2140004','2140007','2140008','2140009','2140010','2140011','2140012','2140013','2140014','2140015',
										'2140018','2140019','2140021','2140022','2140023','2140025','2140027','2140028','2140032','2140033','2140034',
										'3110012','3120014','3120023','3130008','3130009','3130013','3140010','3140017','3140026')                   
                   ) YAB,
                  (SELECT COUNT(*) YAC_CNT,
                          SUM(TAX_INCOME) TAX_INCOME,
                          SUM(YAB_INCOME) YAB_INCOME,
                          SUM(GREATEST(DGG_TAX,0)) DGG_TAX,
                          SUM(GREATEST(DBW_TAX,0)) DBW_TAX,
                          SUM(GREATEST(DJM_TAX,0)) DJM_TAX,
                          SUM(GREATEST(NVL(DGG_TAX,0),0) + GREATEST(NVL(DBW_TAX,0),0) + GREATEST(NVL(DJM_TAX,0),0) ) TAX_TOT
                   FROM   ASNHR.T_AC_RETACC_142
                   WHERE PIS_YY = '2014'
                   AND   GBN_TAG= '8'
                   AND ENO_NO IN (
										'1990033','1990040','1990041','1990044','1990089','1990104','1990105',
										'2000023','2010005','2010012','2020005','2020008','2020009','2020011','2020013','2020016','2020025','2020030',
										'2030002','2030005','2030007','2030009',
										'2040001','2040006','2040012','2040013','2040020','2040023','2040024','2040025','2040038','2040042',
										'2040046','2040066','2040067','2040068','2040070','2040071','2040076','2040078','2040080','2040081',
										'2050004','2050009','2050010','2050012','2050013','2050014','2050015','2050017','2050019','2050022','2050023','2050026',
										'2050029','2050030','2050032','2050033','2050036','2050039','2050042','2050046','2050050','2050053','2050056','2050060','2050063',
										'2060004','2060005','2060007','2060009','2060017','2060024','2060026','2060027',
										'2070007','2070016','2070018','2070019','2070021','2070026','2070027','2070030','2070039','2070043',
										'2080003','2080007','2080009','2080012','2080018','2080019','2080021','2080025','2080028','2080031','2080033','2080046',
										'2090002','2090011','2100002','2100003','2100004','2100007','2100016',
										'2110003','2110005','2110007','2110013','2110014','2110016','2110017',
										'2120003','2120007','2120008','2120026','2120029','2120030','2120032','2120033',
										'2130003','2130004','2130005','2130006','2130008','2130010','2130012','2130013','2130015','2130019','2130020','2130021','2130025',
										'2130026','2130027','2130028','2130030','2130033','2130035','2130037','2130039','2130041','2130043','2130045',
										'2140001','2140003','2140004','2140007','2140008','2140009','2140010','2140011','2140012','2140013','2140014','2140015',
										'2140018','2140019','2140021','2140022','2140023','2140025','2140027','2140028','2140032','2140033','2140034',
										'3110012','3120014','3120023','3130008','3130009','3130013','3140010','3140017','3140026')    
                   ) YAC
            )
            ]]>
        </query>
    </sql>

    <!-- 연말정산 신고 파일출력 -->
    <sql name="YACA001_SHR_FILE_14_ETC">
        <description>연말정산신고 파일출력</description>
        <query>
            <![CDATA[
				SELECT VIEW_1.SEL_KEY as yac_sel_key,
				       VIEW_1.REC_TAG as yac_rec_tag,
				       VIEW_1.TAX_CD as yac_tax_cd,
				       VIEW_1.COMP_CD as yac_comp_cd,
				       VIEW_1.CNT as yac_cnt,
				       VIEW_1.NAM_KOR as yac_nam_kor,
				       VIEW_1.CET_NO as yac_cet_no,
				       VIEW_1.ZIP_NO as yac_zip_no,
				       VIEW_1.JUSO as yac_juso,
				       VIEW_1.JAS_NM as yac_jas_nm,
				       VIEW_1.JAO_NO as yac_jao_no,
				       (VIEW_1.SALT_AMTS - VIEW_1.OUTT_AMTS) as yac_salt_amts,
				       VIEW_1.SALT_AMTT as yac_salt_amtt,
				       (VIEW_1.FREE_INCOME - VIEW_1.OUTT_AMTS) as yac_free_income,
				       VIEW_1.TAX_INCOME as yac_tax_income,
				       VIEW_1.OUTT_AMTS as yac_outt_amts,       
				       VIEW_1.MGR_AMT as yac_mgr_amt,
				       VIEW_1.MNI_AMT as yac_mni_amt,
				       VIEW_1.BADD_AMT as yac_badd_amt,
				       NVL(VIEW_1.SOU_CNT,'0') as yac_sou_cnt,
				       VIEW_1.SPSB_AMT as yac_spsb_amt,
				       NVL(VIEW_1.DFM_CNT,'0') as yac_dfm_cnt,
				       VIEW_1.GDED_AMT as yac_gded_amt,
				       NVL(VIEW_1.GOL_CNT,'0') as yac_gol_cnt,
				       VIEW_1.GOL_AMT as yac_gol_amt,
				       NVL(VIEW_1.TRB_CNT,'0') as yac_trb_cnt,
				       VIEW_1.TBL_DED as yac_tbl_ded,
				       
				       VIEW_1.WDD_AMT as yac_wdd_amt,
				       NVL(VIEW_1.ONE_AMT,'0')  as yac_one_amt,       

				       NVL(VIEW_1.HINU_AMT,'0')  as YAC_HINU_AMT,
				       NVL(VIEW_1.HINS_AMT,'0')  as YAC_HINS_AMT,   					   

				       VIEW_1.LH1_AMT as YAC_LH1_AMT,
				       VIEW_1.LH2_AMT as YAC_LH2_AMT,       
				       VIEW_1.LH3_AMT as YAC_LH3_AMT,
				       VIEW_1.LH4_AMT as YAC_LH4_AMT,
				       VIEW_1.LH5_AMT as YAC_LH5_AMT,
				       VIEW_1.LH6_AMT as YAC_LH6_AMT,
				       VIEW_1.LH7_AMT as YAC_LH7_AMT,
				       VIEW_1.LH8_AMT as YAC_LH8_AMT,   
				       VIEW_1.DON_FWD as YAC_DON_FWD,	
				       VIEW_1.PER_DED as YAC_PER_DED,				       			        

				       VIEW_1.CPC_DED as yac_cpc_ded,
				       VIEW_1.NSE_TOT as yac_nse_tot,
				       GREATEST(VIEW_1.INDED_TOT,0) as yac_inded_tot,
				       VIEW_1.CARD_DED as yac_card_ded,
				       VIEW_1.SAVE_DED as yac_save_ded,
				       VIEW_1.SAVE1_DED as yac_save1_ded,
				       VIEW_1.SAVE2_DED as yac_save2_ded,
				       VIEW_1.SAVE3_DED as yac_save3_ded,
				       VIEW_1.SAJU_AMT as YAC_SAJU_AMT,
				       VIEW_1.LSS_DED as YAC_LSS_AMT,				       
				       VIEW_1.ETC_TOT as YAC_ETC_TOT,				       
				       VIEW_1.VEN_DED as yac_ven_ded,
				       GREATEST(VIEW_1.TTAX_STD,0) as yac_ttax_std,
				       VIEW_1.TAX_AMT as yac_tax_amt,
				       VIEW_1.HGR_DED as yac_hgr_ded,
				       VIEW_1.AGE_AMT as YAC_AGE_AMT,		
				       
				       VIEW_1.ANN_AMT as YAC_ANN_AMT,					       
				       VIEW_1.ANN_DED as YAC_ANN_DED,					       
				       VIEW_1.LIN_AMT as YAC_LIN_AMT,					       
				       VIEW_1.MIN_DED as YAC_MIN_DED,					       
				       		              
				       VIEW_1.MMA_AMT as YAC_MMA_AMT,
				       VIEW_1.MMA_DED as YAC_MMA_DED,				       
				       VIEW_1.EDU_AMT as YAC_EDU_AMT,       
				       VIEW_1.EDU_DED as YAC_EDU_DED,				       		       
				       		       
				       VIEW_1.GOV1_AMT as YAC_GOV1_AMT,					       
				       VIEW_1.GOV1_DED as YAC_GOV1_DED,					       
				       VIEW_1.GOV2_AMT as YAC_GOV2_AMT,					       
				       VIEW_1.GOV2_DED as YAC_GOV2_DED,					       
				       		              
				       VIEW_1.LC1_AMT as YAC_LC1_AMT,
				       VIEW_1.LC1_DED as YAC_LC1_DED,				       
				       VIEW_1.LC23_AMT as YAC_LC23_AMT,       
				       VIEW_1.LC23_DED as YAC_LC23_DED,						       		       
				       		       
				       VIEW_1.MRENT_DED as YAC_MRENT_DED,					       		       
				       VIEW_1.TDED_TOT as yac_tded_tot,
				       GREATEST(VIEW_1.DGG_TAX,0) as yac_dgg_tax,
				       VIEW_1.DBW_TAX as yac_dbw_tax,
				       GREATEST(VIEW_1.DJM_TAX,0) as yac_djm_tax,
				       VIEW_1.JAL_AMT as yac_jal_amt,
				       VIEW_1.JAC_AMT as YAC_JAC_AMT,
				       VIEW_1.JAN_AMT as yac_jan_amt,
				       VIEW_1.INCM_TAX as yac_incm_tax,
				       VIEW_1.CITI_TAX as yac_citi_tax,
				       VIEW_1.HIR_YMD as ems_hir_ymd,
				       VIEW_1.RET_YMD as ems_ret_ymd,
				       VIEW_1.STA_TOT as yac_sta_tot,
				       VIEW_1.NPEN_DED as yac_npen_ded,

				       VIEW_1.SEA_FREE as yac_sea_free,
				       VIEW_1.GOV_DED as yac_gov_ded,
				       VIEW_1.OTX_DED as yac_otx_ded,
				       VIEW_1.CASH_AMT as yac_cash_amt,

				       VIEW_1.DRE_INTX as yac_dre_intx,
				       VIEW_1.DRE_CTTX as yac_dre_cttx,
				       VIEW_1.DRE_DFTX as yac_dre_dftx,
				       VIEW_1.HOL_YN as yac_hol_yn,
				       
				       VIEW_1.REL_CD1 as REL_CD1,
				       VIEW_1.NAM_KOR1 as NAM_KOR1,
				       VIEW_1.CET_NO1 as CET_NO1,
				       VIEW_1.BAS_MAN1 as BAS_MAN1,
				       VIEW_1.TRB_MAN1 as TRB_MAN1,
				       VIEW_1.WCT_MAN1 as WCT_MAN1,
				       VIEW_1.GOL_MAN1 as GOL_MAN1,
				       VIEW_1.ONE_MAN1 as ONE_MAN1,        
				       VIEW_1.INV_NTS1 as INV_NTS1,
				       VIEW_1.INV2_NTS1 as INV2_NTS1,				       
				       VIEW_1.MED_NTS1 as MED_NTS1,
				       VIEW_1.EDU_NTS1 as EDU_NTS1,
				       VIEW_1.CARD_NTS1 as CARD_NTS1,
				       VIEW_1.DIR_CARD_NTS1 as DIR_CARD_NTS1,
				       VIEW_1.CASH_NTS1 as CASH_NTS1,
				       VIEW_1.MARKET_NTS1 as MARKET_NTS1,       
				       VIEW_1.PUBLIC_NTS1 as PUBLIC_NTS1,       
				       VIEW_1.LC3_AMT_NTS1 as LC3_AMT_NTS1,
				       VIEW_1.INV_AMT1 as INV_AMT1,
				       VIEW_1.INV2_AMT1 as INV2_AMT1,				       
				       VIEW_1.MED_AMT1 as MED_AMT1,
				       VIEW_1.EDU_AMT1 as EDU_AMT1,
				       VIEW_1.CARD_AMT1 as CARD_AMT1,
				       VIEW_1.DIR_CARD_AMT1 as DIR_CARD_AMT1,
				       VIEW_1.MARKET_AMT1 as MARKET_AMT1,       
				       VIEW_1.PUBLIC_AMT1 as PUBLIC_AMT1,       
				       VIEW_1.LC3_AMT1 as LC3_AMT1,	   
				       
				       VIEW_1.REL_CD2 as REL_CD2,
				       VIEW_1.NAM_KOR2 as NAM_KOR2,
				       VIEW_1.CET_NO2 as CET_NO2,
				       VIEW_1.BAS_MAN2 as BAS_MAN2,
				       VIEW_1.TRB_MAN2 as TRB_MAN2,
				       VIEW_1.WCT_MAN2 as WCT_MAN2,
				       VIEW_1.GOL_MAN2 as GOL_MAN2,
				       VIEW_1.ONE_MAN2 as ONE_MAN2,       
				       VIEW_1.INV_NTS2 as INV_NTS2,
				       VIEW_1.INV2_NTS2 as INV2_NTS2,				       
				       VIEW_1.MED_NTS2 as MED_NTS2,
				       VIEW_1.EDU_NTS2 as EDU_NTS2,
				       VIEW_1.CARD_NTS2 as CARD_NTS2,
				       VIEW_1.DIR_CARD_NTS2 as DIR_CARD_NTS2,
				       VIEW_1.CASH_NTS2 as CASH_NTS2,
				       VIEW_1.MARKET_NTS2 as MARKET_NTS2,        
				       VIEW_1.PUBLIC_NTS2 as PUBLIC_NTS2,      
				       VIEW_1.LC3_AMT_NTS2 as LC3_AMT_NTS2,
				       VIEW_1.INV_AMT2 as INV_AMT2,
				       VIEW_1.INV2_AMT2 as INV2_AMT2,				       
				       VIEW_1.MED_AMT2 as MED_AMT2,
				       VIEW_1.EDU_AMT2 as EDU_AMT2,
				       VIEW_1.CARD_AMT2 as CARD_AMT2,
				       VIEW_1.DIR_CARD_AMT2 as DIR_CARD_AMT2,
				       VIEW_1.MARKET_AMT2 as MARKET_AMT2,             
				       VIEW_1.PUBLIC_AMT2 as PUBLIC_AMT2,       
				       VIEW_1.LC3_AMT2 as LC3_AMT2,
				       
				       VIEW_1.REL_CD3 as REL_CD3,
				       VIEW_1.NAM_KOR3 as NAM_KOR3,
				       VIEW_1.CET_NO3 as CET_NO3,
				       VIEW_1.BAS_MAN3 as BAS_MAN3,
				       VIEW_1.TRB_MAN3 as TRB_MAN3,
				       VIEW_1.WCT_MAN3 as WCT_MAN3,
				       VIEW_1.GOL_MAN3 as GOL_MAN3,
				       VIEW_1.ONE_MAN3 as ONE_MAN3,        
				       VIEW_1.INV_NTS3 as INV_NTS3,
				       VIEW_1.INV2_NTS3 as INV2_NTS3,				       
				       VIEW_1.MED_NTS3 as MED_NTS3,
				       VIEW_1.EDU_NTS3 as EDU_NTS3,
				       VIEW_1.CARD_NTS3 as CARD_NTS3,
				       VIEW_1.DIR_CARD_NTS3 as DIR_CARD_NTS3,
				       VIEW_1.CASH_NTS3 as CASH_NTS3,
				       VIEW_1.MARKET_NTS3 as MARKET_NTS3,          
				       VIEW_1.PUBLIC_NTS3 as PUBLIC_NTS3,        
				       VIEW_1.LC3_AMT_NTS3 as LC3_AMT_NTS3,
				       VIEW_1.INV_AMT3 as INV_AMT3,
				       VIEW_1.INV2_AMT3 as INV2_AMT3,				       
				       VIEW_1.MED_AMT3 as MED_AMT3,
				       VIEW_1.EDU_AMT3 as EDU_AMT3,
				       VIEW_1.CARD_AMT3 as CARD_AMT3,
				       VIEW_1.DIR_CARD_AMT3 as DIR_CARD_AMT3,
				       VIEW_1.MARKET_AMT3 as MARKET_AMT3,             
				       VIEW_1.PUBLIC_AMT3 as PUBLIC_AMT3,        
				       VIEW_1.LC3_AMT3 as LC3_AMT3,
				       
				       VIEW_1.REL_CD4 as REL_CD4,
				       VIEW_1.NAM_KOR4 as NAM_KOR4,
				       VIEW_1.CET_NO4 as CET_NO4,
				       VIEW_1.BAS_MAN4 as BAS_MAN4,
				       VIEW_1.TRB_MAN4 as TRB_MAN4,
				       VIEW_1.WCT_MAN4 as WCT_MAN4,
				       VIEW_1.GOL_MAN4 as GOL_MAN4,
				       VIEW_1.ONE_MAN4 as ONE_MAN4,        
				       VIEW_1.INV_NTS4 as INV_NTS4,
				       VIEW_1.INV2_NTS4 as INV2_NTS4,				       
				       VIEW_1.MED_NTS4 as MED_NTS4,
				       VIEW_1.EDU_NTS4 as EDU_NTS4,
				       VIEW_1.CARD_NTS4 as CARD_NTS4,
				       VIEW_1.DIR_CARD_NTS4 as DIR_CARD_NTS4,
				       VIEW_1.CASH_NTS4 as CASH_NTS4,
				       VIEW_1.MARKET_NTS4 as MARKET_NTS4,        
				       VIEW_1.PUBLIC_NTS4 as PUBLIC_NTS4,         
				       VIEW_1.LC3_AMT_NTS4 as LC3_AMT_NTS4,
				       VIEW_1.INV_AMT4 as INV_AMT4,
				       VIEW_1.INV2_AMT4 as INV2_AMT4,				       
				       VIEW_1.MED_AMT4 as MED_AMT4,
				       VIEW_1.EDU_AMT4 as EDU_AMT4,
				       VIEW_1.CARD_AMT4 as CARD_AMT4,
				       VIEW_1.DIR_CARD_AMT4 as DIR_CARD_AMT4,
				       VIEW_1.MARKET_AMT4 as MARKET_AMT4,             
				       VIEW_1.PUBLIC_AMT4 as PUBLIC_AMT4,       
				       VIEW_1.LC3_AMT4 as LC3_AMT4,
				       
				       VIEW_1.REL_CD5 as REL_CD5,
				       VIEW_1.NAM_KOR5 as NAM_KOR5,
				       VIEW_1.CET_NO5 as CET_NO5,
				       VIEW_1.BAS_MAN5 as BAS_MAN5,
				       VIEW_1.TRB_MAN5 as TRB_MAN5,
				       VIEW_1.WCT_MAN5 as WCT_MAN5,
				       VIEW_1.GOL_MAN5 as GOL_MAN5,
				       VIEW_1.ONE_MAN5 as ONE_MAN5,        
				       VIEW_1.INV_NTS5 as INV_NTS5,
				       VIEW_1.INV2_NTS5 as INV2_NTS5,				       
				       VIEW_1.MED_NTS5 as MED_NTS5,
				       VIEW_1.EDU_NTS5 as EDU_NTS5,
				       VIEW_1.CARD_NTS5 as CARD_NTS5,
				       VIEW_1.DIR_CARD_NTS5 as DIR_CARD_NTS5,
				       VIEW_1.CASH_NTS5 as CASH_NTS5,
				       VIEW_1.MARKET_NTS5 as MARKET_NTS5,        
				       VIEW_1.PUBLIC_NTS5 as PUBLIC_NTS5,       
				       VIEW_1.LC3_AMT_NTS5 as LC3_AMT_NTS5,
				       VIEW_1.INV_AMT5 as INV_AMT5,
				       VIEW_1.INV2_AMT5 as INV2_AMT5,				       
				       VIEW_1.MED_AMT5 as MED_AMT5,
				       VIEW_1.EDU_AMT5 as EDU_AMT5,
				       VIEW_1.CARD_AMT5 as CARD_AMT5,
				       VIEW_1.DIR_CARD_AMT5 as DIR_CARD_AMT5,
				       VIEW_1.MARKET_AMT5 as MARKET_AMT5,             
				       VIEW_1.PUBLIC_AMT5 as PUBLIC_AMT5,       
				       VIEW_1.LC3_AMT5 as LC3_AMT5,
				       
				       VIEW_1.PEN_GUBUN_CD_1 as PEN_GUBUN_CD_1,
				       VIEW_1.ABA_CD_1 as ABA_CD_1,
				       VIEW_1.ABA_NM_1 as ABA_NM_1,
				       VIEW_1.ACC_NO_1 as ACC_NO_1,
					   VIEW_1.AMOUNT_1 as AMOUNT_1,
					   VIEW_1.DED_AMT_1 as DED_AMT_1,
					   VIEW_1.PEN_GUBUN_CD_2 as PEN_GUBUN_CD_2,
				       VIEW_1.ABA_CD_2 as ABA_CD_2,
				       VIEW_1.ABA_NM_2 as ABA_NM_2,
				       VIEW_1.ACC_NO_2 as ACC_NO_2,
					   VIEW_1.AMOUNT_2 as AMOUNT_2,
					   VIEW_1.DED_AMT_2 as DED_AMT_2,
					   VIEW_1.PEN_GUBUN_CD_3 as PEN_GUBUN_CD_3,
				       VIEW_1.ABA_CD_3 as ABA_CD_3,
				       VIEW_1.ABA_NM_3 as ABA_NM_3,
				       VIEW_1.ACC_NO_3 as ACC_NO_3,
					   VIEW_1.AMOUNT_3 as AMOUNT_3,
					   VIEW_1.DED_AMT_3 as DED_AMT_3,
					   VIEW_1.PEN_GUBUN_CD_4 as PEN_GUBUN_CD_4,
				       VIEW_1.ABA_CD_4 as ABA_CD_4,
				       VIEW_1.ABA_NM_4 as ABA_NM_4,
				       VIEW_1.ACC_NO_4 as ACC_NO_4,
					   VIEW_1.AMOUNT_4 as AMOUNT_4,
					   VIEW_1.DED_AMT_4 as DED_AMT_4,
					   VIEW_1.PEN_GUBUN_CD_5 as PEN_GUBUN_CD_5,
				       VIEW_1.ABA_CD_5 as ABA_CD_5,
				       VIEW_1.ABA_NM_5 as ABA_NM_5,
				       VIEW_1.ACC_NO_5 as ACC_NO_5,
					   VIEW_1.AMOUNT_5 as AMOUNT_5,
					   VIEW_1.DED_AMT_5 as DED_AMT_5,
					   VIEW_1.PEN_GUBUN_CD_6 as PEN_GUBUN_CD_6,
				       VIEW_1.ABA_CD_6 as ABA_CD_6,
				       VIEW_1.ABA_NM_6 as ABA_NM_6,
				       VIEW_1.ACC_NO_6 as ACC_NO_6,
					   VIEW_1.AMOUNT_6 as AMOUNT_6,
					   VIEW_1.DED_AMT_6 as DED_AMT_6,
					   VIEW_1.PEN_GUBUN_CD_7 as PEN_GUBUN_CD_7,
				       VIEW_1.ABA_CD_7 as ABA_CD_7,
				       VIEW_1.ABA_NM_7 as ABA_NM_7,
				       VIEW_1.ACC_NO_7 as ACC_NO_7,
					   VIEW_1.AMOUNT_7 as AMOUNT_7,
					   VIEW_1.DED_AMT_7 as DED_AMT_7,
					   VIEW_1.PEN_GUBUN_CD_8 as PEN_GUBUN_CD_8,
				       VIEW_1.ABA_CD_8 as ABA_CD_8,
				       VIEW_1.ABA_NM_8 as ABA_NM_8,
				       VIEW_1.ACC_NO_8 as ACC_NO_8,
					   VIEW_1.AMOUNT_8 as AMOUNT_8,
					   VIEW_1.DED_AMT_8 as DED_AMT_8,
					   VIEW_1.PEN_GUBUN_CD_9 as PEN_GUBUN_CD_9,
				       VIEW_1.ABA_CD_9 as ABA_CD_9,
				       VIEW_1.ABA_NM_9 as ABA_NM_9,
				       VIEW_1.ACC_NO_9 as ACC_NO_9,
					   VIEW_1.AMOUNT_9 as AMOUNT_9,
					   VIEW_1.DED_AMT_9 as DED_AMT_9,
					   VIEW_1.PEN_GUBUN_CD_10 as PEN_GUBUN_CD_10,
				       VIEW_1.ABA_CD_10 as ABA_CD_10,
				       VIEW_1.ABA_NM_10 as ABA_NM_10,
				       VIEW_1.ACC_NO_10 as ACC_NO_10,
					   VIEW_1.AMOUNT_10 as AMOUNT_10,
					   VIEW_1.DED_AMT_10 as DED_AMT_10,
					   VIEW_1.PEN_GUBUN_CD_11 as PEN_GUBUN_CD_11,
				       VIEW_1.ABA_CD_11 as ABA_CD_11,
				       VIEW_1.ABA_NM_11 as ABA_NM_11,
				       VIEW_1.ACC_NO_11 as ACC_NO_11,
					   VIEW_1.AMOUNT_11 as AMOUNT_11,
					   VIEW_1.DED_AMT_11 as DED_AMT_11,
					   VIEW_1.PEN_GUBUN_CD_12 as PEN_GUBUN_CD_12,
				       VIEW_1.ABA_CD_12 as ABA_CD_12,
				       VIEW_1.ABA_NM_12 as ABA_NM_12,
				       VIEW_1.ACC_NO_12 as ACC_NO_12,
					   VIEW_1.AMOUNT_12 as AMOUNT_12,
					   VIEW_1.DED_AMT_12 as DED_AMT_12,
					   VIEW_1.PEN_GUBUN_CD_13 as PEN_GUBUN_CD_13,
				       VIEW_1.ABA_CD_13 as ABA_CD_13,
				       VIEW_1.ABA_NM_13 as ABA_NM_13,
				       VIEW_1.ACC_NO_13 as ACC_NO_13,
					   VIEW_1.AMOUNT_13 as AMOUNT_13,
					   VIEW_1.DED_AMT_13 as DED_AMT_13,
					   VIEW_1.PEN_GUBUN_CD_14 as PEN_GUBUN_CD_14,
				       VIEW_1.ABA_CD_14 as ABA_CD_14,
				       VIEW_1.ABA_NM_14 as ABA_NM_14,
				       VIEW_1.ACC_NO_14 as ACC_NO_14,
					   VIEW_1.AMOUNT_14 as AMOUNT_14,
					   VIEW_1.DED_AMT_14 as DED_AMT_14,
					   VIEW_1.PEN_GUBUN_CD_15 as PEN_GUBUN_CD_15,
				       VIEW_1.ABA_CD_15 as ABA_CD_15,
				       VIEW_1.ABA_NM_15 as ABA_NM_15,
				       VIEW_1.ACC_NO_15 as ACC_NO_15,
					   VIEW_1.AMOUNT_15 as AMOUNT_15,
					   VIEW_1.DED_AMT_15 as DED_AMT_15
				 FROM
				 (SELECT YAC.ENO_NO||'C'||YAC.PIS_YY||YAC.PIS_MM SEL_KEY,
				         'C' REC_TAG,
		                 '20227' TAX_CD,
		                 '2218113834' COMP_CD,
		                 EMS.NAM_KOR,
				         EMS.CET_NO,
		                 EMS.ZIP_NO,
		                 EMS.JUSO,
		                 NVL(YAB.CNT,0) CNT,
		                 '' JAS_NM,
				         '' JAO_NO,
				         YAC.TAX_INCOME SALT_AMTS,
				         YAC.TAX_INCOME SALT_AMTT,
				         YAC.FREE_INCOME + NVL(YAB.JAG_AMT,0) FREE_INCOME,
				         YAC.TAX_INCOME + YAC.YAB_INCOME TAX_INCOME,
				         YAC.INJUNG_AMT OUTT_AMTS,
				         YAC.MGR_AMT,
				         YAC.MNI_AMT,
		                 YAC.BADD_AMT,
				         YAC.SOU_CNT,
		                 YAC.SPSB_AMT,
		                 YAC.DFM_CNT,
		                 YAC.GDED_AMT,
		                 YAC.GOL_CNT,
		                 YAC.GOL_AMT,

				         YAC.TRB_CNT,
		                 YAC.TBL_DED,
		                 YAC.WDD_AMT,
				         YAC.ONE_AMT,
				         
				         --DECODE(NVL(YAC.NSE_TOT,0), 0, 0, YAC.HINU_AMT+NVL(YAB.JAH_AMT,0)) HINU_AMT,
				         --DECODE(NVL(YAC.NSE_TOT,0), 0, 0, YAC.HINS_AMT+NVL(YAB.JAP_AMT,0)) HINS_AMT,
				         
				         --YAC.HINU_DED+NVL(YAB.JAH_AMT,0) HINU_AMT,
				         --YAC.HINS_DED+NVL(YAB.JAP_AMT,0) HINS_AMT,				         

				         YAC.HINU_DED HINU_AMT,
				         YAC.HINS_DED HINS_AMT,	
				         				         
		                 --LEAST(YAC.LH1_AMT,3000000) LH1_AMT,
		                 --LEAST(YAC.LH2_AMT,3000000) LH2_AMT,
		                 --LEAST(YAC.LH3_AMT,7500000) LH3_AMT,
		                 --LEAST(YAC.LH4_AMT,6000000) LH4_AMT,		                 
		                 --LEAST(YAC.LH5_AMT,10000000) LH5_AMT,
		                 --LEAST(YAC.LH6_AMT,15000000) LH6_AMT,
		                 --LEAST(YAC.LH7_AMT,15000000) LH7_AMT,
		                 --LEAST(YAC.LH7_AMT,5000000) LH8_AMT,	
		                 
		                 NVL(YAC.LOAN_DED,0) AS LH1_AMT,
		                 NVL(YAC.PLOAN_DED,0) AS LH2_AMT,
		                 NVL(YAC.LH3_AMT,0) AS LH3_AMT,
		                 
				         NVL(LONG1.LONG_DED,0) AS LH4_AMT,         
				         NVL(LONG2.LONG_DED,0) AS LH5_AMT,
				         NVL(LONG3.LONG_DED,0) AS LH6_AMT,
				         NVL(LONG4.LONG_DED,0) AS LH7_AMT,
				         NVL(LONG5.LONG_DED,0) AS LH8_AMT,		                 
		                 
		                 YAC.DON_FWD,	
		                 YAC.PER_DED,		

				         YAC.CPC_DED,
				         YAC.NSE_TOT,
		                 YAC.INDED_TOT,
				         NVL(YAC.CARD_DED,0) CARD_DED, 
				         YAC.SAVE_DED, 
		                 YAC.SAVE1_DED, 
		                 YAC.SAVE2_DED, 
		                 YAC.SAVE3_DED, 
		                 YAC.SAJU_AMT, 
		                 YAC.LSS_DED, 		   
		                 NVL(YAC.PER_DED,0) + NVL(YAC.SAVE1_DED,0) + NVL(YAC.SAVE2_DED,0) + NVL(YAC.SAVE3_DED,0) + NVL(YAC.CARD_DED,0) + NVL(YAC.SAJU_AMT,0) + NVL(YAC.LSS_DED,0) ETC_TOT,		                               
				         NVL(YAC.VEN_DED,0) VEN_DED,
				         YAC.TTAX_STD ,
		                 YAC.TAX_AMT,
		                 YAC.HGR_DED,
		                 YAC.AGE_AMT,	
		                 LEAST(YAC.ANN_AMT,4000000) ANN_AMT, 		                 
		                 NVL(YAC.ANN_DED,0) ANN_DED, 	    
		                 LEAST(YAC.LIN_AMT,1000000) LIN_AMT,			                 
		                 NVL(YAC.MIN_DED,0) MIN_DED,			
		                            
		                 NVL(YAC.MHEA_AMT,0) + NVL(YAC.OHEA_AMT,0) + NVL(YAC.HAN_AMT,0) MMA_AMT,	
		                 NVL(YAC.MMA_DED,0) MMA_DED,	
		                 NVL(YAC.GRA_AMT,0) + NVL(YAC.HED_AMT,0) + NVL(YAC.EDU_AMT1,0) + NVL(YAC.EDU_AMT2,0) + NVL(YAC.EDU_AMT3,0) + NVL(YAC.EDU_AMT4,0) + NVL(YAC.EDU_AMT5,0) EDU_AMT,			                 		          
		                 NVL(YAC.EDU_DED,0) EDU_DED,	
		                 		              
		                 0 GOV1_AMT,			                 		                 
		                 NVL(YAC.GOV_DED,0) GOV1_DED,
		                 GREATEST((NVL(YAC.GOV_NTS,0) + NVL(YAC.GOV_AMT,0) - 100000 ),0)  GOV2_AMT,			                 		                 
		                 NVL(YAC.GOV2_DED,0) GOV2_DED,				                 		              
		                 		              		                 
		                 NVL(YAC.LC1_NTS,0) + NVL(YAC.LC1_AMT,0) LC1_AMT,			                 		                 
		                 NVL(YAC.LC1_DED,0) LC1_DED,
		                 NVL(YAC.LC2_NTS,0) + NVL(YAC.LC2_AMT,0) + NVL(YAC.LC3_NTS,0) + NVL(YAC.LC3_AMT,0) LC23_AMT,			                 		                 
		                 NVL(YAC.LC23_DED,0) LC23_DED,		                 
 
		                 NVL(YAC.MRENT_DED,0) MRENT_DED,
		                                  		                 
				         YAC.TDED_TOT,
		                 YAC.DGG_TAX,
		                 YAC.DBW_TAX,
		                 YAC.DJM_TAX,
				         NVL(YAB.JAL_AMT,0) JAL_AMT,
				         NVL(YAB.JAC_AMT,0) JAC_AMT,				         
		                 NVL(YAB.JAN_AMT,0) JAN_AMT,
				         YAC.INCM_TAX,
		                 YAC.CITI_TAX,
				         EMS.HIR_YMD HIR_YMD, 
		                 EMS.RET_YMD RET_YMD,
		                 
		                 DECODE(NVL(YAC.VEN_DED,0) + NVL(YAC.NSE_TOT,0) + NVL(YAC.MRENT_DED,0), 0, NVL(YAC.STA_TOT,0)) STA_TOT,
		                 
				         --NVL(YAC.STA_TOT,0) STA_TOT, 
		                 
		                 
		                 
		                 NVL(YAC.NPEN_DED,0) NPEN_DED,
				         
				         YAC.SEA_FREE SEA_FREE,  
		                 YAC.GOV_DED GOV_DED, 
		                 YAC.OTX_DED, 
				         YAC.CASH_AMT CASH_AMT, 

				         YAC.DRE_INTX, 
		                 YAC.DRE_CTTX, 
		                 YAC.DRE_DFTX, 
		                 DECODE(YAC.HOL_YN,'Y','1','2') HOL_YN,
				         '' REL_CD1,  '' NAM_KOR1, '' CET_NO1,
				         '' BAS_MAN1, '' TRB_MAN1,  '' WCT_MAN1,  '' GOL_MAN1,   '' ONE_MAN1,
				         '' INV_NTS1, '' INV2_NTS1, '' MED_NTS1, '' EDU_NTS1, '' CARD_NTS1, '' DIR_CARD_NTS1,'' CASH_NTS1, '' MARKET_NTS1, '' PUBLIC_NTS1,'' LC3_AMT_NTS1,
				         '' INV_AMT1, '' INV2_AMT1, '' MED_AMT1, '' EDU_AMT1, '' CARD_AMT1, '' DIR_CARD_AMT1, '' MARKET_AMT1, '' PUBLIC_AMT1,'' LC3_AMT1,
				         '' REL_CD2,  '' NAM_KOR2, '' CET_NO2,
				         '' BAS_MAN2, '' TRB_MAN2,  '' WCT_MAN2,  '' GOL_MAN2,  '' ONE_MAN2,
				         '' INV_NTS2, '' INV2_NTS2, '' MED_NTS2, '' EDU_NTS2, '' CARD_NTS2, '' DIR_CARD_NTS2,'' CASH_NTS2, '' MARKET_NTS2, '' PUBLIC_NTS2,'' LC3_AMT_NTS2,
				         '' INV_AMT2, '' INV2_AMT2, '' MED_AMT2, '' EDU_AMT2, '' CARD_AMT2, '' DIR_CARD_AMT2, '' MARKET_AMT2, '' PUBLIC_AMT2,'' LC3_AMT2,
				         '' REL_CD3,  '' NAM_KOR3, '' CET_NO3,
				         '' BAS_MAN3, '' TRB_MAN3,  '' WCT_MAN3,  '' GOL_MAN3,   '' ONE_MAN3,
				         '' INV_NTS3, '' INV2_NTS3, '' MED_NTS3, '' EDU_NTS3, '' CARD_NTS3, '' DIR_CARD_NTS3,'' CASH_NTS3, '' MARKET_NTS3, '' PUBLIC_NTS3,'' LC3_AMT_NTS3,
				         '' INV_AMT3, '' INV2_AMT3, '' MED_AMT3, '' EDU_AMT3, '' CARD_AMT3, '' DIR_CARD_AMT3, '' MARKET_AMT3, '' PUBLIC_AMT3,'' LC3_AMT3,
				         '' REL_CD4,  '' NAM_KOR4, '' CET_NO4,
				         '' BAS_MAN4, '' TRB_MAN4,  '' WCT_MAN4,  '' GOL_MAN4,   '' ONE_MAN4,
				         '' INV_NTS4, '' INV2_NTS4, '' MED_NTS4, '' EDU_NTS4, '' CARD_NTS4, '' DIR_CARD_NTS4,'' CASH_NTS4, '' MARKET_NTS4, '' PUBLIC_NTS4,'' LC3_AMT_NTS4,
				         '' INV_AMT4, '' INV2_AMT4, '' MED_AMT4, '' EDU_AMT4, '' CARD_AMT4, '' DIR_CARD_AMT4, '' MARKET_AMT4, '' PUBLIC_AMT4,'' LC3_AMT4,
				         '' REL_CD5,  '' NAM_KOR5, '' CET_NO5,
				         '' BAS_MAN5, '' TRB_MAN5,  '' WCT_MAN5,  '' GOL_MAN5,  '' ONE_MAN5,
				         '' INV_NTS5, '' INV2_NTS5, '' MED_NTS5, '' EDU_NTS5, '' CARD_NTS5, '' DIR_CARD_NTS5,'' CASH_NTS5, '' MARKET_NTS5, '' PUBLIC_NTS5,'' LC3_AMT_NTS5,
				         '' INV_AMT5, '' INV2_AMT5, '' MED_AMT5, '' EDU_AMT5, '' CARD_AMT5, '' DIR_CARD_AMT5, '' MARKET_AMT5, '' PUBLIC_AMT5,'' LC3_AMT5,
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				    FROM ASNHR.T_AC_RETACC_14 YAC,
				         (SELECT ENO_NO, ENO_NM AS NAM_KOR,
				                 SUBSTR(CET_NO,1,6)||SUBSTR(CET_NO,8,7) CET_NO,
				                 ZIP_NO,ADR_CT||' '||ADDRESS JUSO,
				                 GREATEST(NVL(TO_CHAR(HIR_YMD,'YYYYMMDD'),' '),'20140101') HIR_YMD,
				                 LEAST(NVL(TO_CHAR(RET_YMD,'YYYYMMDD'),'20141231'),'20141231') RET_YMD
				          FROM ASNHR.T_CM_PERSON ) EMS,
				         (SELECT ENO_NO,COUNT(*) CNT,
				            SUM(NVL(JAC_AMT,0)) JAC_AMT,				         
				            SUM(NVL(JAL_AMT,0)) JAL_AMT, 
                   			SUM(NVL(JAN_AMT,0)) JAN_AMT,
				            SUM(NVL(JAG_AMT,0)) JAG_AMT,
				            SUM(NVL(JAH_AMT,0)) JAH_AMT,
				            SUM(NVL(JAP_AMT,0)) JAP_AMT
				            FROM ASNHR.T_AC_DUTYPLACE
				           WHERE (PIS_YY = '2014')
				          GROUP BY ENO_NO) YAB,       
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_14 WHERE PIS_YY = '2014' AND LH4_AMT != '0')  LONG1,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_14 WHERE PIS_YY = '2014' AND LH5_AMT != '0')  LONG2,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_14 WHERE PIS_YY = '2014' AND LH6_AMT != '0')  LONG3,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_14 WHERE PIS_YY = '2014' AND LH7_AMT != '0')  LONG4,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_14 WHERE PIS_YY = '2014' AND LH8_AMT != '0')  LONG5     				          
				 WHERE YAC.PIS_YY = '2014'
				   AND YAC.GBN_TAG = '8'
				   AND YAC.ENO_NO  = EMS.ENO_NO
				   AND YAC.ENO_NO  = YAB.ENO_NO (+)
				   AND YAC.ENO_NO  = LONG1.ENO_NO(+)   
				   AND YAC.ENO_NO  = LONG2.ENO_NO(+)
				   AND YAC.ENO_NO  = LONG3.ENO_NO(+)   
				   AND YAC.ENO_NO  = LONG4.ENO_NO(+)   
				   AND YAC.ENO_NO  = LONG5.ENO_NO(+)    
				   AND EMS.ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')				          
   				
				 UNION
				
				 SELECT x.ENO_NO||'D'||PIS_YY||PIS_MM SEL_KEY,
				        'D' REC_TAG,
                		'20227' TAX_CD,
                		'2218113834' COMP_CD,
                		'' NAM_KOR,
    				    EMS.CET_NO CET_NO,
                		'' ZIP_NO,
                		'' JUSO,
		                0 CNT,
		                JAS_NM,
		                JAO_NO,
    				    JAA_AMT + JAB_AMT SALT_AMTS, 
                		JAA_AMT + JAB_AMT + JAC_AMT + JAD_AMT + JAI_AMT SALT_AMTT,
	                    0 FREE_INCOME,
	                    0 TAX_INCOME,
		                0 OUTT_AMTS,				         
		                0 MGR_AMT,
		                0 MNI_AMT,
		                0 BADD_AMT,
		                '' SOU_CNT,
		                0 SPSB_AMT,
		                '' DFM_CNT,
	                    0 GDED_AMT, 
		                '' GOL_CNT, 
		                0 GOL_AMT, 
	                    '' TRB_CNT,
		                0 TBL_DED,
		                0 WDD_AMT,
                		0 ONE_AMT,
		                0 HINU_AMT,
		                0 HINS_AMT,
		                0 LH1_AMT, 
		                0 LH2_AMT,
		                0 LH3_AMT, 
	                    0 LH4_AMT, 
		                0 LH5_AMT, 
		                0 LH6_AMT, 
		                0 LH7_AMT, 
		                0 LH8_AMT,
		                0 DON_FWD,	
		                0 PER_DED,			                	                
	                    0 CPC_DED,
		                0 NSE_TOT,
		                0 INDED_TOT,
	                    0 CARD_DED, 
		                0 SAVE_DED, 
		                0 SAVE1_DED, 
		                0 SAVE2_DED, 
		                0 SAVE3_DED,  
		                0 SAJU_AMT, 
		                0 LSS_AMT,  
		                0 ETC_TOT, 		                		                
		                0 VEN_DED,
	                    0 TTAX_STD, 
		                0 TAX_AMT,  
		                0 HGR_DED,   
		                0 AGE_AMT,  
	                    0 ANN_AMT, 
		                0 ANN_DED,  
		                0 LIN_AMT,   
		                0 MIN_DED,
	                    0 MMA_AMT,
		                0 MMA_DED,
	                    0 EDU_AMT,
		                0 EDU_DED, 
	                    0 GOV1_AMT,  		                
	                    0 GOV1_DED,		
	                    0 GOV2_AMT,  		                
	                    0 GOV2_DED,		                    
	                    0 LC1_AMT,  		                
	                    0 LC1_DED,		
	                    0 LC23_AMT,  		                
	                    0 LC23_DED,		
		                0 MRENT_DED,	                                                                        
	                    0 TDED_TOT,  
		                0 DGG_TAX,
		                0 DBW_TAX,
	                    0 DJM_TAX,
		                0 JAL_AMT,
		                0 JAC_AMT,
		                0 JAN_AMT,
		                JAL_AMT INCM_TAX,
		                JAN_AMT CITI_TAX,
	                    GREATEST(HIR_YMD,'20140101') HIR_YMD,
	                    LEAST(RET_YMD,'20141231') RET_YMD,
	                    0 STA_TOT, 
		                0 NPEN_DED, 
	                    0 SEA_FREE,  
		                0 GOV_DED, 
		                0 OTX_DED, 
	                    0 CASH_AMT, 
		                0 DRE_INTX, 
		                0 DRE_CTTX, 
		                0 DRE_DFTX, 
		                '2' HOL_YN,
				         '' REL_CD1,  '' NAM_KOR1, '' CET_NO1,
				         '' BAS_MAN1, '' TRB_MAN1, '' WCT_MAN1,  '' GOL_MAN1,   '' ONE_MAN1,
				         '' INV_NTS1, '' INV2_NTS1, '' MED_NTS1, '' EDU_NTS1, '' CARD_NTS1, '' DIR_CARD_NTS1,'' CASH_NTS1, '' MARKET_NTS1, '' PUBLIC_NTS1,'' LC3_AMT_NTS1,
				         '' INV_AMT1, '' INV2_AMT1, '' MED_AMT1, '' EDU_AMT1, '' CARD_AMT1, '' DIR_CARD_AMT1, '' MARKET_AMT1, '' PUBLIC_AMT1,'' LC3_AMT1,
				         '' REL_CD2,  '' NAM_KOR2, '' CET_NO2,
				         '' BAS_MAN2, '' TRB_MAN2,  '' WCT_MAN2,  '' GOL_MAN2,  '' ONE_MAN2,
				         '' INV_NTS2, '' INV2_NTS2, '' MED_NTS2, '' EDU_NTS2, '' CARD_NTS2, '' DIR_CARD_NTS2,'' CASH_NTS2, '' MARKET_NTS2, '' PUBLIC_NTS2,'' LC3_AMT_NTS2,
				         '' INV_AMT2, '' INV2_AMT2, '' MED_AMT2, '' EDU_AMT2, '' CARD_AMT2, '' DIR_CARD_AMT2, '' MARKET_AMT2, '' PUBLIC_AMT2,'' LC3_AMT2,
				         '' REL_CD3,  '' NAM_KOR3, '' CET_NO3,
				         '' BAS_MAN3, '' TRB_MAN3,  '' WCT_MAN3,  '' GOL_MAN3,  '' ONE_MAN3,
				         '' INV_NTS3, '' INV2_NTS3, '' MED_NTS3, '' EDU_NTS3, '' CARD_NTS3, '' DIR_CARD_NTS3,'' CASH_NTS3, '' MARKET_NTS3, '' PUBLIC_NTS3,'' LC3_AMT_NTS3,
				         '' INV_AMT3, '' INV2_AMT3, '' MED_AMT3, '' EDU_AMT3, '' CARD_AMT3, '' DIR_CARD_AMT3, '' MARKET_AMT3, '' PUBLIC_AMT3,'' LC3_AMT3,
				         '' REL_CD4,  '' NAM_KOR4, '' CET_NO4,
				         '' BAS_MAN4, '' TRB_MAN4,  '' WCT_MAN4,  '' GOL_MAN4,  '' ONE_MAN4,
				         '' INV_NTS4, '' INV2_NTS4, '' MED_NTS4, '' EDU_NTS4, '' CARD_NTS4, '' DIR_CARD_NTS4,'' CASH_NTS4, '' MARKET_NTS4, '' PUBLIC_NTS4,'' LC3_AMT_NTS4,
				         '' INV_AMT4, '' INV2_AMT4, '' MED_AMT4, '' EDU_AMT4, '' CARD_AMT4, '' DIR_CARD_AMT4, '' MARKET_AMT4, '' PUBLIC_AMT4,'' LC3_AMT4,
				         '' REL_CD5,  '' NAM_KOR5, '' CET_NO5,
				         '' BAS_MAN5, '' TRB_MAN5,  '' WCT_MAN5,  '' GOL_MAN5,  '' ONE_MAN5,
				         '' INV_NTS5, '' INV2_NTS5, '' MED_NTS5, '' EDU_NTS5, '' CARD_NTS5, '' DIR_CARD_NTS5,'' CASH_NTS5, '' MARKET_NTS5, '' PUBLIC_NTS5,'' LC3_AMT_NTS5,
				         '' INV_AMT5, '' INV2_AMT5, '' MED_AMT5, '' EDU_AMT5, '' CARD_AMT5, '' DIR_CARD_AMT5, '' MARKET_AMT5, '' PUBLIC_AMT5,'' LC3_AMT5,
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				   FROM ASNHR.T_AC_DUTYPLACE x,
				 (SELECT ENO_NO,ENO_NM AS NAM_KOR,
				         SUBSTR(CET_NO,1,6)||SUBSTR(CET_NO,8,7) CET_NO,
				         ZIP_NO,ADR_CT||ADDRESS JUSO
				    FROM ASNHR.T_CM_PERSON ) EMS
				   WHERE PIS_YY = '2014'
				     AND x.ENO_NO = EMS.ENO_NO
				     AND EMS.ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')				          
				
				 UNION

				 SELECT a.ENO_NO||'E1'||B.PIS_YY||'12', 'E', '20227', '2218113834', '',
				        B.CET_NO,
		                '','',0,'','',0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,'0',0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,'','',0,0,0,0,0,0,0,0,0,'2',
				        B.REL_CD,  
		                B.NAM_KOR, 
		                B.CET_NO,  
		                B.BAS_MAN,  
		                B.TRB_MAN, 
		                B.WCT_MAN, 
		                B.GOL_MAN, 
		                B.ONE_MAN,
				        NVL(B.INV_NTS,'0'), 
				        NVL(B.INV2_NTS,'0'), 				        
		                NVL(B.MED_NTS,'0'), 
		                NVL(B.EDU_NTS,'0'),
				        NVL(B.CARD_NTS,'0'),
		                NVL(B.DIR_CARD_NTS,'0'), 
		                NVL(B.CASH_NTS,'0'),  
		                NVL(B.MARKET_NTS,'0'), 
		                NVL(B.PUBLIC_NTS,'0'), 
		                NVL(B.LC3_AMT_NTS,'0'),
				        NVL(B.INV_AMT,'0'), 
				        NVL(B.INV2_AMT,'0'), 				        
		                NVL(B.MED_AMT,'0'), 
		                NVL(B.EDU_AMT,'0'),
				        NVL(B.CARD_AMT,'0'),
		                NVL(B.DIR_CARD_AMT,'0'), 
		                NVL(B.MARKET_AMT,'0'), 
		                NVL(B.PUBLIC_AMT,'0'), 
		                NVL(B.LC3_AMT,'0'),
				        C.REL_CD,  
		                C.NAM_KOR, 
		                C.CET_NO,  
		                C.BAS_MAN,  
		                C.TRB_MAN, 
		                C.WCT_MAN, 
		                C.GOL_MAN, 
		                C.ONE_MAN,
				        NVL(C.INV_NTS,'0'), 
				        NVL(C.INV2_NTS,'0'), 				        
		                NVL(C.MED_NTS,'0'), 
		                NVL(C.EDU_NTS,'0'),
				        NVL(C.CARD_NTS,'0'),
		                NVL(C.DIR_CARD_NTS,'0'), 
		                NVL(C.CASH_NTS,'0'), 
		                NVL(C.MARKET_NTS,'0'), 
		                NVL(C.PUBLIC_NTS,'0'), 
		                NVL(C.LC3_AMT_NTS,'0'),
				        NVL(C.INV_AMT,'0'), 
				        NVL(C.INV2_AMT,'0'), 				        
		                NVL(C.MED_AMT,'0'), 
		                NVL(C.EDU_AMT,'0'),
				        NVL(C.CARD_AMT,'0'),
		                NVL(C.DIR_CARD_AMT,'0'), 
		                NVL(C.MARKET_AMT,'0'), 
		                NVL(C.PUBLIC_AMT,'0'), 
		                NVL(C.LC3_AMT,'0'),
				        D.REL_CD,  
		                D.NAM_KOR, 
		                D.CET_NO,  
		                D.BAS_MAN,  
		                D.TRB_MAN, 
		                D.WCT_MAN, 
		                D.GOL_MAN, 
		                D.ONE_MAN,
				        NVL(D.INV_NTS,'0'), 
				        NVL(D.INV2_NTS,'0'), 				        
		                NVL(D.MED_NTS,'0'), 
		                NVL(D.EDU_NTS,'0'),
				        NVL(D.CARD_NTS,'0'),
		                NVL(D.DIR_CARD_NTS,'0'), 
		                NVL(D.CASH_NTS,'0'), 
		                NVL(D.MARKET_NTS,'0'), 
		                NVL(D.PUBLIC_NTS,'0'), 
		                NVL(D.LC3_AMT_NTS,'0'),
				        NVL(D.INV_AMT,'0'), 
				        NVL(D.INV2_AMT,'0'), 				        
		                NVL(D.MED_AMT,'0'), 
		                NVL(D.EDU_AMT,'0'),
				        NVL(D.CARD_AMT,'0'),
		                NVL(D.DIR_CARD_AMT,'0'),  
		                NVL(D.MARKET_AMT,'0'), 
		                NVL(D.PUBLIC_AMT,'0'), 
		                NVL(D.LC3_AMT,'0'),
				        E.REL_CD,  
		                E.NAM_KOR, 
		                E.CET_NO,  
		                E.BAS_MAN,  
		                E.TRB_MAN,  
		                E.WCT_MAN, 
		                E.GOL_MAN, 
		                E.ONE_MAN,
				        NVL(E.INV_NTS,'0'), 
				        NVL(E.INV2_NTS,'0'), 				        
		                NVL(E.MED_NTS,'0'), 
		                NVL(E.EDU_NTS,'0'),
				        NVL(E.CARD_NTS,'0'),
		                NVL(E.DIR_CARD_NTS,'0'), 
		                NVL(E.CASH_NTS,'0'), 
		                NVL(E.MARKET_NTS,'0'), 
		                NVL(E.PUBLIC_NTS,'0'), 
		                NVL(E.LC3_AMT_NTS,'0'),
				        NVL(E.INV_AMT,'0'), 
				        NVL(E.INV2_AMT,'0'), 				        
		                NVL(E.MED_AMT,'0'), 
		                NVL(E.EDU_AMT,'0'),
				        NVL(E.CARD_AMT,'0'),
		                NVL(E.DIR_CARD_AMT,'0'),  
		                NVL(E.MARKET_AMT,'0'), 
		                NVL(E.PUBLIC_AMT,'0'), 
		                NVL(E.LC3_AMT,'0'),
				        F.REL_CD,  
		                F.NAM_KOR, 
		                F.CET_NO,  
		                F.BAS_MAN,  
		                F.TRB_MAN,  
		                F.WCT_MAN, 
		                F.GOL_MAN, 
		                F.ONE_MAN,
				        NVL(F.INV_NTS,'0'), 
				        NVL(F.INV2_NTS,'0'), 				        
		                NVL(F.MED_NTS,'0'), 
		                NVL(F.EDU_NTS,'0'),
				        NVL(F.CARD_NTS,'0'),
		                NVL(F.DIR_CARD_NTS,'0'), 
		                NVL(F.CASH_NTS,'0'), 
		                NVL(F.MARKET_NTS,'0'), 
		                NVL(F.PUBLIC_NTS,'0'), 
		                NVL(F.LC3_AMT_NTS,'0'),
				        NVL(F.INV_AMT,'0'), 
				        NVL(F.INV2_AMT,'0'), 				        
		                NVL(F.MED_AMT,'0'), 
		                NVL(F.EDU_AMT,'0'),
				        NVL(F.CARD_AMT,'0'),
		                NVL(F.DIR_CARD_AMT,'0'),  
		                NVL(F.MARKET_AMT,'0'), 
		                NVL(F.PUBLIC_AMT,'0'), 
		                NVL(F.LC3_AMT,'0'),
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				
				FROM (SELECT ENO_NO
				        FROM ASNHR.T_AC_FAMILY_14
				       WHERE PIS_YY = '2014'
				    GROUP BY ENO_NO) A,
				     (SELECT A.ENO_NO ENO_NO, A.REL_CD, REPLACE(A.NAM_KOR,' ','') NAM_KOR, A.CET_NO, A.PIS_YY PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,               
				             '0' INV_NTS,				             
				             TO_CHAR(NVL(A.LIN_AMT_NTS,0) + NVL(A.LIH_AMT_NTS,0)) INV2_NTS,
				             TO_CHAR(NVL(A.MED_AMT_NTS,0) + NVL(A.LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(A.EDU_AMT_NTS,0) + NVL(A.HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(A.CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(A.DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(A.CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(A.MARKET_AMT_NTS,0)) MARKET_NTS,  
				             TO_CHAR(NVL(A.PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                             
				             TO_CHAR(NVL(B.HINU_AMT,0) + NVL(B.HINS_AMT,0) + NVL(C.JAH_AMT,0) + NVL(C.JAP_AMT,0)) INV_AMT,
				             TO_CHAR(NVL(A.LIN_AMT,0) + NVL(A.LIH_AMT,0)) INV2_AMT,				             
				             TO_CHAR(NVL(A.MED_AMT,0) + NVL(A.LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(A.EDU_AMT,0) + NVL(A.HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(A.CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(A.DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(A.MARKET_AMT,0)) MARKET_AMT,    
				             TO_CHAR(NVL(A.PUBLIC_AMT,0)) PUBLIC_AMT,                        
				             TO_CHAR(A.LC1_AMT+A.LC2_AMT+A.LC3_AMT+GREATEST(B.GOV_AMT-100000,0)) LC3_AMT,
				             TO_CHAR(NVL(A.LC2_AMT_NTS,0)+NVL(A.LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_14 A, ASNHR.T_AC_RETACC_14 B,
				            (SELECT ENO_NO, SUM(JAH_AMT) JAH_AMT, SUM(JAP_AMT) JAP_AMT FROM ASNHR.T_AC_DUTYPLACE WHERE PIS_YY = '2014' GROUP BY ENO_NO) C
				      WHERE A.PIS_YY = '2014' AND A.REL_CD = '0'
				        AND A.PIS_YY = B.PIS_YY 
				        AND B.GBN_TAG = '8'
				        AND A.ENO_NO = B.ENO_NO
				        AND A.ENO_NO = C.ENO_NO(+)) B,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,         
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,               
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,				             
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,         
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                   
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_14
				      WHERE PIS_YY = '2014' AND SEQ_NO = '2') C,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,               
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,             
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,               
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_14
				      WHERE PIS_YY = '2014' AND SEQ_NO = '3') D,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,               
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,             
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_14
				      WHERE PIS_YY = '2014' AND SEQ_NO = '4') E,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,               
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                             
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_14
				      WHERE PIS_YY = '2014' AND SEQ_NO = '5') F,
				      (SELECT ENO_NO, CHI_CNT
				         FROM ASNHR.T_AC_RETACC_14
				        WHERE PIS_YY = '2014'
                ) G
				WHERE A.ENO_NO = B.ENO_NO(+)
				  AND A.ENO_NO = C.ENO_NO(+)
				  AND A.ENO_NO = D.ENO_NO(+)
				  AND A.ENO_NO = E.ENO_NO(+)
				  AND A.ENO_NO = F.ENO_NO(+)
				  AND A.ENO_NO = G.ENO_NO(+)
				  AND A.ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')				          
				
				 UNION
				
				 SELECT a.ENO_NO||'E2'||B.PIS_YY||'12', 'E', '20227', '2218113834', '',
				        SUBSTR(G.CET_NO,1,6)||SUBSTR(G.CET_NO,8,7),
		                '','',0,'','',0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,'0',0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,'','',0,0,0,0,0,0,0,0,0,'2',
				        B.REL_CD,  
		                B.NAM_KOR, 
		                B.CET_NO,  
		                B.BAS_MAN,  
		                B.TRB_MAN, 
		                B.WCT_MAN, 
		                B.GOL_MAN, 
		                B.ONE_MAN,
				        NVL(B.INV_NTS,'0'), 
				        NVL(B.INV2_NTS,'0'), 				        
		                NVL(B.MED_NTS,'0'), 
		                NVL(B.EDU_NTS,'0'),
				        NVL(B.CARD_NTS,'0'), 
		                NVL(B.DIR_CARD_NTS,'0'), 
		                NVL(B.CASH_NTS,'0'), 
		                NVL(B.MARKET_NTS,'0'), 
		                NVL(B.PUBLIC_NTS,'0'), 
		                NVL(B.LC3_AMT_NTS,'0'),
				        NVL(B.INV_AMT,'0'), 
				        NVL(B.INV2_AMT,'0'), 				        
		                NVL(B.MED_AMT,'0'), 
		                NVL(B.EDU_AMT,'0'),
				        NVL(B.CARD_AMT,'0'), 
		                NVL(B.DIR_CARD_AMT,'0'),
		                NVL(B.MARKET_AMT,'0'), 
		                NVL(B.PUBLIC_AMT,'0'), 
		                NVL(B.LC3_AMT,'0'),
				        C.REL_CD,  
		                C.NAM_KOR, 
		                C.CET_NO,  
		                C.BAS_MAN,  
		                C.TRB_MAN,  
		                C.WCT_MAN, 
		                C.GOL_MAN, 
		                C.ONE_MAN,
				        NVL(C.INV_NTS,'0'), 
				        NVL(C.INV2_NTS,'0'), 				        
		                NVL(C.MED_NTS,'0'), 
		                NVL(C.EDU_NTS,'0'),
				        NVL(C.CARD_NTS,'0'), 
		                NVL(C.DIR_CARD_NTS,'0'), 
		                NVL(C.CASH_NTS,'0'), 
		                NVL(C.MARKET_NTS,'0'), 
		                NVL(C.PUBLIC_NTS,'0'), 
		                NVL(C.LC3_AMT_NTS,'0'),
				        NVL(C.INV_AMT,'0'), 
				        NVL(C.INV2_AMT,'0'), 				        
		                NVL(C.MED_AMT,'0'), 
		                NVL(C.EDU_AMT,'0'),
				        NVL(C.CARD_AMT,'0'), 
		                NVL(C.DIR_CARD_AMT,'0'), 
		                NVL(C.MARKET_AMT,'0'), 
		                NVL(C.PUBLIC_AMT,'0'), 
		                NVL(C.LC3_AMT,'0'),
				        D.REL_CD,  
		                D.NAM_KOR, 
		                D.CET_NO,  
		                D.BAS_MAN,  
		                D.TRB_MAN, 
		                D.WCT_MAN, 
		                D.GOL_MAN,  
		                D.ONE_MAN,
				        NVL(D.INV_NTS,'0'), 
				        NVL(D.INV2_NTS,'0'), 				        
		                NVL(D.MED_NTS,'0'), 
		                NVL(D.EDU_NTS,'0'),
				        NVL(D.CARD_NTS,'0'), 
		                NVL(D.DIR_CARD_NTS,'0'), 
		                NVL(D.CASH_NTS,'0'), 
		                NVL(D.MARKET_NTS,'0'), 
		                NVL(D.PUBLIC_NTS,'0'), 
		                NVL(D.LC3_AMT_NTS,'0'),
				        NVL(D.INV_AMT,'0'), 
				        NVL(D.INV2_AMT,'0'), 				        
		                NVL(D.MED_AMT,'0'), 
		                NVL(D.EDU_AMT,'0'),
				        NVL(D.CARD_AMT,'0'),  
		                NVL(D.DIR_CARD_AMT,'0'), 
		                NVL(D.MARKET_AMT,'0'), 
		                NVL(D.PUBLIC_AMT,'0'), 
		                NVL(D.LC3_AMT,'0'),
				        E.REL_CD,  
		                E.NAM_KOR, 
		                E.CET_NO,  
		                E.BAS_MAN,  
		                E.TRB_MAN, 
		                E.WCT_MAN, 
		                E.GOL_MAN, 
		                E.ONE_MAN,
				        NVL(E.INV_NTS,'0'), 
				        NVL(E.INV2_NTS,'0'), 				        
		                NVL(E.MED_NTS,'0'), 
		                NVL(E.EDU_NTS,'0'),
				        NVL(E.CARD_NTS,'0'), 
		                NVL(E.DIR_CARD_NTS,'0'), 
		                NVL(E.CASH_NTS,'0'), 
		                NVL(E.MARKET_NTS,'0'), 
		                NVL(E.PUBLIC_NTS,'0'), 
		                NVL(E.LC3_AMT_NTS,'0'),
				        NVL(E.INV_AMT,'0'), 
				        NVL(E.INV2_AMT,'0'), 				        
		                NVL(E.MED_AMT,'0'), 
		                NVL(E.EDU_AMT,'0'),
				        NVL(E.CARD_AMT,'0'), 
		                NVL(E.DIR_CARD_AMT,'0'), 
		                NVL(E.MARKET_AMT,'0'), 
		                NVL(E.PUBLIC_AMT,'0'), 
		                NVL(E.LC3_AMT,'0'),
				        F.REL_CD,  
		                F.NAM_KOR, 
		                F.CET_NO,  
		                F.BAS_MAN,  
		                F.TRB_MAN, 
		                F.WCT_MAN, 
		                F.GOL_MAN, 
		                F.ONE_MAN,
				        NVL(F.INV_NTS,'0'), 
				        NVL(F.INV2_NTS,'0'), 				        
		                NVL(F.MED_NTS,'0'), 
		                NVL(F.EDU_NTS,'0'),
				        NVL(F.CARD_NTS,'0'), 
		                NVL(F.DIR_CARD_NTS,'0'), 
		                NVL(F.CASH_NTS,'0'),  
		                NVL(F.MARKET_NTS,'0'), 
		                NVL(F.PUBLIC_NTS,'0'), 
		                NVL(F.LC3_AMT_NTS,'0'),
				        NVL(F.INV_AMT,'0'), 
				        NVL(F.INV2_AMT,'0'), 				        
		                NVL(F.MED_AMT,'0'), 
		                NVL(F.EDU_AMT,'0'),
				        NVL(F.CARD_AMT,'0'), 
		                NVL(F.DIR_CARD_AMT,'0'), 
		                NVL(F.MARKET_AMT,'0'), 
		                NVL(F.PUBLIC_AMT,'0'), 
		                NVL(F.LC3_AMT,'0'),
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				FROM (SELECT ENO_NO
				        FROM ASNHR.T_AC_FAMILY_14
				       WHERE PIS_YY = '2014'
				         AND SEQ_NO >= '6'
				    GROUP BY ENO_NO) A,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,             
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,             
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_14
				      WHERE PIS_YY = '2014' AND SEQ_NO = '6') B,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,             
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,    
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_14
				      WHERE PIS_YY = '2014' AND SEQ_NO = '7') C,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,              
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,                 
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_14
				      WHERE PIS_YY = '2014' AND SEQ_NO = '8') D,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,              
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,    
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                   
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_14
				      WHERE PIS_YY = '2014' AND SEQ_NO = '9') E,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN, 
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,              
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,   
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                   
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_14
				      WHERE PIS_YY = '2014' AND SEQ_NO = '10') F, ASNHR.T_CM_PERSON G,
				    (SELECT ENO_NO, CHI_CNT
				       FROM ASNHR.T_AC_RETACC_14
				      WHERE PIS_YY = '2014'
				        AND GBN_TAG = '8') H
				WHERE A.ENO_NO = B.ENO_NO(+)
				  AND A.ENO_NO = C.ENO_NO(+)
				  AND A.ENO_NO = D.ENO_NO(+)
				  AND A.ENO_NO = E.ENO_NO(+)
				  AND A.ENO_NO = F.ENO_NO(+)
				  AND A.ENO_NO = G.ENO_NO
				  AND A.ENO_NO = H.ENO_NO(+)
				  AND A.ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')				          
				
				  UNION
				
				  SELECT EMS.ENO_NO||'F'||'2014'||'12', 'F', '20227', '2218113834', '',
				         EMS.CET_NO,
		                '','',0,'','',0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,'0',0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,'','',0,0,0,0,0,0,0,0,0,'2',
				         '' REL_CD1,  
		                 '' NAM_KOR1, 
		                 '' CET_NO1,
				         '' BAS_MAN1, 
		                 '' TRB_MAN1,  
		                 '' WCT_MAN1,  
		                 '' GOL_MAN1, 
		                 '' ONE_MAN1,
				         '' INV_NTS1, 
				         '' INV2_NTS1, 				         
		                 '' MED_NTS1, 
		                 '' EDU_NTS1, 
		                 '' CARD_NTS1, 
		                 '' DIR_CARD_NTS1,
		                 '' CASH_NTS1, 
		                 '' MARKET_NTS1,  
		                 '' MARKET_NTS1,
		                 '' LC3_AMT_NTS1,
				         '' INV_AMT1, 
				         '' INV2_AMT1, 				         
		                 '' MED_AMT1, 
		                 '' EDU_AMT1, 
		                 '' CARD_AMT1, 
		                 '' DIR_CARD_AMT1, 
		                 '' MARKET_AMT1,  
		                 '' MARKET_AMT1,
		                 '' LC3_AMT1,
				         '' REL_CD2,  
		                 '' NAM_KOR2, 
		                 '' CET_NO2,
				         '' BAS_MAN2, 
		                 '' TRB_MAN2,  
		                 '' WCT_MAN2,  
		                 '' GOL_MAN2,                
		                 '' ONE_MAN2,
				         '' INV_NTS2, 
				         '' INV2_NTS2, 				         
		                 '' MED_NTS2, 
		                 '' EDU_NTS2, 
		                 '' CARD_NTS2, 
		                 '' DIR_CARD_NTS2,
		                 '' CASH_NTS2, 
		                 '' MARKET_NTS2, 
		                 '' MARKET_NTS2, 
		                 '' LC3_AMT_NTS2,
				         '' INV_AMT2, 
				         '' INV2_AMT2, 				         
		                 '' MED_AMT2, 
		                 '' EDU_AMT2, 
		                 '' CARD_AMT2, 
		                 '' DIR_CARD_AMT2, 
		                 '' MARKET_AMT2, 
		                 '' MARKET_AMT2, 
		                 '' LC3_AMT2,
				         '' REL_CD3,  
		                 '' NAM_KOR3, 
		                 '' CET_NO3,
				         '' BAS_MAN3, 
		                 '' TRB_MAN3,  
		                 '' WCT_MAN3,  
		                 '' GOL_MAN3,             
		                 '' ONE_MAN3,
				         '' INV_NTS3,
				         '' INV2_NTS3,				         
		                 '' MED_NTS3, 
		                 '' EDU_NTS3, 
		                 '' CARD_NTS3, 
		                 '' DIR_CARD_NTS3,
		                 '' CASH_NTS3, 
		                 '' MARKET_NTS3, 
		                 '' MARKET_NTS3, 
		                 '' LC3_AMT_NTS3,
				         '' INV_AMT3, 
				         '' INV2_AMT3, 				         
		                 '' MED_AMT3, 
		                 '' EDU_AMT3, 
		                 '' CARD_AMT3, 
		                 '' DIR_CARD_AMT3, 
		                 '' MARKET_AMT3, 
		                 '' MARKET_AMT3, 
		                 '' LC3_AMT3,
				         '' REL_CD4,  
		                 '' NAM_KOR4, 
		                 '' CET_NO4,
				         '' BAS_MAN4, 
		                 '' TRB_MAN4,  
		                 '' WCT_MAN4,  
		                 '' GOL_MAN4,            
		                 '' ONE_MAN4,
				         '' INV_NTS4, 
				         '' INV2_NTS4, 				         
		                 '' MED_NTS4, 
		                 '' EDU_NTS4, 
		                 '' CARD_NTS4, 
		                 '' DIR_CARD_NTS4,
		                 '' CASH_NTS4, 
		                 '' MARKET_NTS4, 
		                 '' MARKET_NTS4, 
		                 '' LC3_AMT_NTS4,
				         '' INV_AMT4, 
				         '' INV2_AMT4, 				         
		                 '' MED_AMT4, 
		                 '' EDU_AMT4, 
		                 '' CARD_AMT4, 
		                 '' DIR_CARD_AMT4, 
		                 '' MARKET_AMT4, 
		                 '' MARKET_AMT4, 
		                 '' LC3_AMT4,
				         '' REL_CD5,  
		                 '' NAM_KOR5, 
		                 '' CET_NO5,
				         '' BAS_MAN5, 
		                 '' TRB_MAN5,  
		                 '' WCT_MAN5,  
		                 '' GOL_MAN5,           
		                 '' ONE_MAN5,
				         '' INV_NTS5, 
				         '' INV2_NTS5, 				         
		                 '' MED_NTS5, 
		                 '' EDU_NTS5, 
		                 '' CARD_NTS5, 
		                 '' DIR_CARD_NTS5,
		                 '' CASH_NTS5, 
		                 '' MARKET_NTS5, 
		                 '' MARKET_NTS5, 
		                 '' LC3_AMT_NTS5,
				         '' INV_AMT5, 
				         '' INV2_AMT5, 				         
		                 '' MED_AMT5, 
		                 '' EDU_AMT5, 
		                 '' CARD_AMT5, 
		                 '' DIR_CARD_AMT5, 
		                 '' MARKET_AMT5, 
		                 '' MARKET_AMT5, 
		                 '' LC3_AMT5,
				         PEN1.PEN_GUBUN_CD PEN_GUBUN_CD_1, PEN1.ABA_CD ABA_CD_1, SUBSTR(PEN1.ABA_NM,0,30) ABA_NM_1, 
				         PEN1.ACC_NO ACC_NO_1, PEN1.AMOUNT AMOUNT_1, NVL(PEN1.DED_AMT,0) DED_AMT_1,
				         PEN2.PEN_GUBUN_CD PEN_GUBUN_CD_2, PEN2.ABA_CD ABA_CD_2, SUBSTR(PEN2.ABA_NM,0,30) ABA_NM_2, 
				         PEN2.ACC_NO ACC_NO_2, PEN2.AMOUNT AMOUNT_2, NVL(PEN2.DED_AMT,0) DED_AMT_2,
				         PEN3.PEN_GUBUN_CD PEN_GUBUN_CD_3, PEN3.ABA_CD ABA_CD_3, SUBSTR(PEN3.ABA_NM,0,30) ABA_NM_3, 
				         PEN3.ACC_NO ACC_NO_3, PEN3.AMOUNT AMOUNT_3, NVL(PEN3.DED_AMT,0) DED_AMT_3,
				         PEN4.PEN_GUBUN_CD PEN_GUBUN_CD_4, PEN4.ABA_CD ABA_CD_4, SUBSTR(PEN4.ABA_NM,0,30) ABA_NM_4, 
				         PEN4.ACC_NO ACC_NO_4, PEN4.AMOUNT AMOUNT_4, NVL(PEN4.DED_AMT,0) DED_AMT_4,
				         PEN5.PEN_GUBUN_CD PEN_GUBUN_CD_5, PEN5.ABA_CD ABA_CD_5, SUBSTR(PEN5.ABA_NM,0,30) ABA_NM_5, 
				         PEN5.ACC_NO ACC_NO_5, PEN5.AMOUNT AMOUNT_5, NVL(PEN5.DED_AMT,0) DED_AMT_5,
				         PEN6.PEN_GUBUN_CD PEN_GUBUN_CD_6, PEN6.ABA_CD ABA_CD_6, SUBSTR(PEN6.ABA_NM,0,30) ABA_NM_6, 
				         PEN6.ACC_NO ACC_NO_6, PEN6.AMOUNT AMOUNT_6, NVL(PEN6.DED_AMT,0) DED_AMT_6,
				         PEN7.PEN_GUBUN_CD PEN_GUBUN_CD_7, PEN7.ABA_CD ABA_CD_7, SUBSTR(PEN7.ABA_NM,0,30) ABA_NM_7, 
				         PEN7.ACC_NO ACC_NO_7, PEN7.AMOUNT AMOUNT_7, NVL(PEN7.DED_AMT,0) DED_AMT_7,
				         PEN8.PEN_GUBUN_CD PEN_GUBUN_CD_8, PEN8.ABA_CD ABA_CD_8, SUBSTR(PEN8.ABA_NM,0,30) ABA_NM_8, 
				         PEN8.ACC_NO ACC_NO_8, PEN8.AMOUNT AMOUNT_8, NVL(PEN8.DED_AMT,0) DED_AMT_8,
				         PEN9.PEN_GUBUN_CD PEN_GUBUN_CD_9, PEN9.ABA_CD ABA_CD_9, SUBSTR(PEN9.ABA_NM,0,30) ABA_NM_9, 
				         PEN9.ACC_NO ACC_NO_9, PEN9.AMOUNT AMOUNT_9, NVL(PEN9.DED_AMT,0) DED_AMT_9,
				         PEN10.PEN_GUBUN_CD PEN_GUBUN_CD_10, PEN10.ABA_CD ABA_CD_10, SUBSTR(PEN10.ABA_NM,0,30) ABA_NM_10, 
				         PEN10.ACC_NO ACC_NO_10, PEN10.AMOUNT AMOUNT_10, NVL(PEN10.DED_AMT,0) DED_AMT_10,
				         PEN11.PEN_GUBUN_CD PEN_GUBUN_CD_11, PEN11.ABA_CD ABA_CD_11, SUBSTR(PEN11.ABA_NM,0,30) ABA_NM_11, 
				         PEN11.ACC_NO ACC_NO_11, PEN11.AMOUNT AMOUNT_11, NVL(PEN11.DED_AMT,0) DED_AMT_11,
				         PEN12.PEN_GUBUN_CD PEN_GUBUN_CD_12, PEN12.ABA_CD ABA_CD_12, SUBSTR(PEN12.ABA_NM,0,30) ABA_NM_12, 
				         PEN12.ACC_NO ACC_NO_12, PEN12.AMOUNT AMOUNT_12, NVL(PEN12.DED_AMT,0) DED_AMT_12,
				         PEN13.PEN_GUBUN_CD PEN_GUBUN_CD_13, PEN13.ABA_CD ABA_CD_13, SUBSTR(PEN13.ABA_NM,0,30) ABA_NM_13, 
				         PEN13.ACC_NO ACC_NO_13, PEN13.AMOUNT AMOUNT_13, NVL(PEN13.DED_AMT,0) DED_AMT_13,
				         PEN14.PEN_GUBUN_CD PEN_GUBUN_CD_14, PEN14.ABA_CD ABA_CD_14, SUBSTR(PEN14.ABA_NM,0,30) ABA_NM_14, 
				         PEN14.ACC_NO ACC_NO_14, PEN14.AMOUNT AMOUNT_14, NVL(PEN14.DED_AMT,0) DED_AMT_14,
				         PEN15.PEN_GUBUN_CD PEN_GUBUN_CD_15, PEN15.ABA_CD ABA_CD_15, SUBSTR(PEN15.ABA_NM,0,30) ABA_NM_15, 
				         PEN15.ACC_NO ACC_NO_15, PEN15.AMOUNT AMOUNT_15, NVL(PEN15.DED_AMT,0) DED_AMT_15
				    FROM
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '0') PEN1,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '1') PEN2,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '2') PEN3,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '3') PEN4,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '4') PEN5,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '5') PEN6,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '6') PEN7,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '7') PEN8,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '8') PEN9,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '9') PEN10,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '10') PEN11,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '11') PEN12,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '12') PEN13,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '13') PEN14,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '14') PEN15,
				         (SELECT ENO_NO,ENO_NM AS NAM_KOR,
				                 SUBSTR(CET_NO,1,6)||SUBSTR(CET_NO,8,7) CET_NO,
				                 ZIP_NO,ADR_CT||' '||ADDRESS JUSO,
				                 GREATEST(NVL(TO_CHAR(HIR_YMD,'YYYYMMDD'),' '),'20140101') HIR_YMD,
				                 LEAST(NVL(TO_CHAR(RET_YMD,'YYYYMMDD'),'20141231'),'20141231') RET_YMD
				          FROM ASNHR.T_CM_PERSON ) EMS,
				          ASNHR.T_AC_RETACC_14 YAC
					 WHERE PEN1.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN2.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN3.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN4.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN5.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN6.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN7.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN8.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN9.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN10.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN11.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN12.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN13.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN14.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN15.ENO_NO(+)  = EMS.ENO_NO
					   AND YAC.PIS_YY = '2014' 
					   AND YAC.GBN_TAG = '8'
					   AND YAC.ENO_NO = EMS.ENO_NO
					   AND EMS.ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')				          
					   
				 ) VIEW_1
				 ORDER BY VIEW_1.SEL_KEY
            ]]>
        </query>
    </sql>

      <!-- 연말정산 신고 파일출력 -->
    <sql name="YACA001_SHR_FILE_15_ETC">
        <description>연말정산신고 파일출력</description>
        <query>
            <![CDATA[
				SELECT VIEW_1.SEL_KEY as yac_sel_key,
				       VIEW_1.REC_TAG as yac_rec_tag,
				       VIEW_1.TAX_CD as yac_tax_cd,
				       VIEW_1.COMP_CD as yac_comp_cd,
				       VIEW_1.CNT as yac_cnt,
				       VIEW_1.NAM_KOR as yac_nam_kor,
				       VIEW_1.CET_NO as yac_cet_no,
				       VIEW_1.ZIP_NO as yac_zip_no,
				       VIEW_1.JUSO as yac_juso,
				       VIEW_1.JAS_NM as yac_jas_nm,
				       VIEW_1.JAO_NO as yac_jao_no,
				       (VIEW_1.SALT_AMTS - VIEW_1.OUTT_AMTS) as yac_salt_amts,
				       VIEW_1.SALT_AMTT as yac_salt_amtt,
				       (VIEW_1.FREE_INCOME - VIEW_1.OUTT_AMTS) as yac_free_income,
				       VIEW_1.TAX_INCOME as yac_tax_income,
				       VIEW_1.OUTT_AMTS as yac_outt_amts,       
				       VIEW_1.MGR_AMT as yac_mgr_amt,
				       VIEW_1.MNI_AMT as yac_mni_amt,
				       VIEW_1.BADD_AMT as yac_badd_amt,
				       NVL(VIEW_1.SOU_CNT,'0') as yac_sou_cnt,
				       VIEW_1.SPSB_AMT as yac_spsb_amt,
				       NVL(VIEW_1.DFM_CNT,'0') as yac_dfm_cnt,
				       VIEW_1.GDED_AMT as yac_gded_amt,
				       NVL(VIEW_1.GOL_CNT,'0') as yac_gol_cnt,
				       VIEW_1.GOL_AMT as yac_gol_amt,
				       NVL(VIEW_1.TRB_CNT,'0') as yac_trb_cnt,
				       VIEW_1.TBL_DED as yac_tbl_ded,
				       
				       VIEW_1.WDD_AMT as yac_wdd_amt,
				       NVL(VIEW_1.ONE_AMT,'0')  as yac_one_amt,       

				       NVL(VIEW_1.HINU_AMT,'0')  as YAC_HINU_AMT,
				       NVL(VIEW_1.HINS_AMT,'0')  as YAC_HINS_AMT,   					   

				       VIEW_1.LH1_AMT as YAC_LH1_AMT,
				       VIEW_1.LH2_AMT as YAC_LH2_AMT,       
				       VIEW_1.LH3_AMT as YAC_LH3_AMT,
				       VIEW_1.LH4_AMT as YAC_LH4_AMT,
				       VIEW_1.LH5_AMT as YAC_LH5_AMT,
				       VIEW_1.LH6_AMT as YAC_LH6_AMT,
				       VIEW_1.LH7_AMT as YAC_LH7_AMT,
				       VIEW_1.LH8_AMT as YAC_LH8_AMT,   
				       VIEW_1.DON_FWD as YAC_DON_FWD,	
				       VIEW_1.PER_DED as YAC_PER_DED,				       			        

				       VIEW_1.CPC_DED as yac_cpc_ded,
				       VIEW_1.NSE_TOT as yac_nse_tot,
				       GREATEST(VIEW_1.INDED_TOT,0) as yac_inded_tot,
				       VIEW_1.CARD_DED as yac_card_ded,
				       VIEW_1.SAVE_DED as yac_save_ded,
				       VIEW_1.SAVE1_DED as yac_save1_ded,
				       VIEW_1.SAVE2_DED as yac_save2_ded,
				       VIEW_1.SAVE3_DED as yac_save3_ded,
				       VIEW_1.SAJU_AMT as YAC_SAJU_AMT,
				       VIEW_1.LSS_DED as YAC_LSS_AMT,				       
				       VIEW_1.ETC_TOT as YAC_ETC_TOT,				       
				       VIEW_1.VEN_DED as yac_ven_ded,
				       GREATEST(VIEW_1.TTAX_STD,0) as yac_ttax_std,
				       VIEW_1.TAX_AMT as yac_tax_amt,
				       VIEW_1.HGR_DED as yac_hgr_ded,
				       VIEW_1.AGE_AMT as YAC_AGE_AMT,		
				       
				       VIEW_1.ANN_AMT as YAC_ANN_AMT,					       
				       VIEW_1.ANN_DED as YAC_ANN_DED,					       
				       VIEW_1.LIN_AMT as YAC_LIN_AMT,					       
				       VIEW_1.MIN_DED as YAC_MIN_DED,					       
				       		              
				       VIEW_1.MMA_AMT as YAC_MMA_AMT,
				       VIEW_1.MMA_DED as YAC_MMA_DED,				       
				       VIEW_1.EDU_AMT as YAC_EDU_AMT,       
				       VIEW_1.EDU_DED as YAC_EDU_DED,				       		       
				       		       
				       VIEW_1.GOV1_AMT as YAC_GOV1_AMT,					       
				       VIEW_1.GOV1_DED as YAC_GOV1_DED,					       
				       VIEW_1.GOV2_AMT as YAC_GOV2_AMT,					       
				       VIEW_1.GOV2_DED as YAC_GOV2_DED,					       
				       		              
				       VIEW_1.LC1_AMT as YAC_LC1_AMT,
				       VIEW_1.LC1_DED as YAC_LC1_DED,				       
				       VIEW_1.LC23_AMT as YAC_LC23_AMT,       
				       VIEW_1.LC23_DED as YAC_LC23_DED,						       		       
				       		       
				       VIEW_1.MRENT_DED as YAC_MRENT_DED,					       		       
				       VIEW_1.TDED_TOT as yac_tded_tot,
				       GREATEST(VIEW_1.DGG_TAX,0) as yac_dgg_tax,
				       VIEW_1.DBW_TAX as yac_dbw_tax,
				       GREATEST(VIEW_1.DJM_TAX,0) as yac_djm_tax,
				       VIEW_1.JAL_AMT as yac_jal_amt,
				       VIEW_1.JAC_AMT as YAC_JAC_AMT,
				       VIEW_1.JAN_AMT as yac_jan_amt,
				       VIEW_1.INCM_TAX as yac_incm_tax,
				       VIEW_1.CITI_TAX as yac_citi_tax,
				       VIEW_1.HIR_YMD as ems_hir_ymd,
				       VIEW_1.RET_YMD as ems_ret_ymd,
				       VIEW_1.STA_TOT as yac_sta_tot,
				       VIEW_1.NPEN_DED as yac_npen_ded,

				       VIEW_1.SEA_FREE as yac_sea_free,
				       VIEW_1.GOV_DED as yac_gov_ded,
				       VIEW_1.OTX_DED as yac_otx_ded,
				       VIEW_1.CASH_AMT as yac_cash_amt,

				       VIEW_1.DRE_INTX as yac_dre_intx,
				       VIEW_1.DRE_CTTX as yac_dre_cttx,
				       VIEW_1.DRE_DFTX as yac_dre_dftx,
				       VIEW_1.HOL_YN as yac_hol_yn,
				       
				       VIEW_1.REL_CD1 as REL_CD1,
				       VIEW_1.NAM_KOR1 as NAM_KOR1,
				       VIEW_1.CET_NO1 as CET_NO1,
				       VIEW_1.BAS_MAN1 as BAS_MAN1,
				       VIEW_1.TRB_MAN1 as TRB_MAN1,
				       VIEW_1.WCT_MAN1 as WCT_MAN1,
				       VIEW_1.GOL_MAN1 as GOL_MAN1,
				       VIEW_1.ONE_MAN1 as ONE_MAN1,        
				       VIEW_1.INV_NTS1 as INV_NTS1,
				       VIEW_1.INV2_NTS1 as INV2_NTS1,				       
				       VIEW_1.MED_NTS1 as MED_NTS1,
				       VIEW_1.EDU_NTS1 as EDU_NTS1,
				       VIEW_1.CARD_NTS1 as CARD_NTS1,
				       VIEW_1.DIR_CARD_NTS1 as DIR_CARD_NTS1,
				       VIEW_1.CASH_NTS1 as CASH_NTS1,
				       VIEW_1.MARKET_NTS1 as MARKET_NTS1,       
				       VIEW_1.PUBLIC_NTS1 as PUBLIC_NTS1,       
				       VIEW_1.LC3_AMT_NTS1 as LC3_AMT_NTS1,
				       VIEW_1.INV_AMT1 as INV_AMT1,
				       VIEW_1.INV2_AMT1 as INV2_AMT1,				       
				       VIEW_1.MED_AMT1 as MED_AMT1,
				       VIEW_1.EDU_AMT1 as EDU_AMT1,
				       VIEW_1.CARD_AMT1 as CARD_AMT1,
				       VIEW_1.DIR_CARD_AMT1 as DIR_CARD_AMT1,
				       VIEW_1.MARKET_AMT1 as MARKET_AMT1,       
				       VIEW_1.PUBLIC_AMT1 as PUBLIC_AMT1,       
				       VIEW_1.LC3_AMT1 as LC3_AMT1,	   
				       
				       VIEW_1.REL_CD2 as REL_CD2,
				       VIEW_1.NAM_KOR2 as NAM_KOR2,
				       VIEW_1.CET_NO2 as CET_NO2,
				       VIEW_1.BAS_MAN2 as BAS_MAN2,
				       VIEW_1.TRB_MAN2 as TRB_MAN2,
				       VIEW_1.WCT_MAN2 as WCT_MAN2,
				       VIEW_1.GOL_MAN2 as GOL_MAN2,
				       VIEW_1.ONE_MAN2 as ONE_MAN2,       
				       VIEW_1.INV_NTS2 as INV_NTS2,
				       VIEW_1.INV2_NTS2 as INV2_NTS2,				       
				       VIEW_1.MED_NTS2 as MED_NTS2,
				       VIEW_1.EDU_NTS2 as EDU_NTS2,
				       VIEW_1.CARD_NTS2 as CARD_NTS2,
				       VIEW_1.DIR_CARD_NTS2 as DIR_CARD_NTS2,
				       VIEW_1.CASH_NTS2 as CASH_NTS2,
				       VIEW_1.MARKET_NTS2 as MARKET_NTS2,        
				       VIEW_1.PUBLIC_NTS2 as PUBLIC_NTS2,      
				       VIEW_1.LC3_AMT_NTS2 as LC3_AMT_NTS2,
				       VIEW_1.INV_AMT2 as INV_AMT2,
				       VIEW_1.INV2_AMT2 as INV2_AMT2,				       
				       VIEW_1.MED_AMT2 as MED_AMT2,
				       VIEW_1.EDU_AMT2 as EDU_AMT2,
				       VIEW_1.CARD_AMT2 as CARD_AMT2,
				       VIEW_1.DIR_CARD_AMT2 as DIR_CARD_AMT2,
				       VIEW_1.MARKET_AMT2 as MARKET_AMT2,             
				       VIEW_1.PUBLIC_AMT2 as PUBLIC_AMT2,       
				       VIEW_1.LC3_AMT2 as LC3_AMT2,
				       
				       VIEW_1.REL_CD3 as REL_CD3,
				       VIEW_1.NAM_KOR3 as NAM_KOR3,
				       VIEW_1.CET_NO3 as CET_NO3,
				       VIEW_1.BAS_MAN3 as BAS_MAN3,
				       VIEW_1.TRB_MAN3 as TRB_MAN3,
				       VIEW_1.WCT_MAN3 as WCT_MAN3,
				       VIEW_1.GOL_MAN3 as GOL_MAN3,
				       VIEW_1.ONE_MAN3 as ONE_MAN3,        
				       VIEW_1.INV_NTS3 as INV_NTS3,
				       VIEW_1.INV2_NTS3 as INV2_NTS3,				       
				       VIEW_1.MED_NTS3 as MED_NTS3,
				       VIEW_1.EDU_NTS3 as EDU_NTS3,
				       VIEW_1.CARD_NTS3 as CARD_NTS3,
				       VIEW_1.DIR_CARD_NTS3 as DIR_CARD_NTS3,
				       VIEW_1.CASH_NTS3 as CASH_NTS3,
				       VIEW_1.MARKET_NTS3 as MARKET_NTS3,          
				       VIEW_1.PUBLIC_NTS3 as PUBLIC_NTS3,        
				       VIEW_1.LC3_AMT_NTS3 as LC3_AMT_NTS3,
				       VIEW_1.INV_AMT3 as INV_AMT3,
				       VIEW_1.INV2_AMT3 as INV2_AMT3,				       
				       VIEW_1.MED_AMT3 as MED_AMT3,
				       VIEW_1.EDU_AMT3 as EDU_AMT3,
				       VIEW_1.CARD_AMT3 as CARD_AMT3,
				       VIEW_1.DIR_CARD_AMT3 as DIR_CARD_AMT3,
				       VIEW_1.MARKET_AMT3 as MARKET_AMT3,             
				       VIEW_1.PUBLIC_AMT3 as PUBLIC_AMT3,        
				       VIEW_1.LC3_AMT3 as LC3_AMT3,
				       
				       VIEW_1.REL_CD4 as REL_CD4,
				       VIEW_1.NAM_KOR4 as NAM_KOR4,
				       VIEW_1.CET_NO4 as CET_NO4,
				       VIEW_1.BAS_MAN4 as BAS_MAN4,
				       VIEW_1.TRB_MAN4 as TRB_MAN4,
				       VIEW_1.WCT_MAN4 as WCT_MAN4,
				       VIEW_1.GOL_MAN4 as GOL_MAN4,
				       VIEW_1.ONE_MAN4 as ONE_MAN4,        
				       VIEW_1.INV_NTS4 as INV_NTS4,
				       VIEW_1.INV2_NTS4 as INV2_NTS4,				       
				       VIEW_1.MED_NTS4 as MED_NTS4,
				       VIEW_1.EDU_NTS4 as EDU_NTS4,
				       VIEW_1.CARD_NTS4 as CARD_NTS4,
				       VIEW_1.DIR_CARD_NTS4 as DIR_CARD_NTS4,
				       VIEW_1.CASH_NTS4 as CASH_NTS4,
				       VIEW_1.MARKET_NTS4 as MARKET_NTS4,        
				       VIEW_1.PUBLIC_NTS4 as PUBLIC_NTS4,         
				       VIEW_1.LC3_AMT_NTS4 as LC3_AMT_NTS4,
				       VIEW_1.INV_AMT4 as INV_AMT4,
				       VIEW_1.INV2_AMT4 as INV2_AMT4,				       
				       VIEW_1.MED_AMT4 as MED_AMT4,
				       VIEW_1.EDU_AMT4 as EDU_AMT4,
				       VIEW_1.CARD_AMT4 as CARD_AMT4,
				       VIEW_1.DIR_CARD_AMT4 as DIR_CARD_AMT4,
				       VIEW_1.MARKET_AMT4 as MARKET_AMT4,             
				       VIEW_1.PUBLIC_AMT4 as PUBLIC_AMT4,       
				       VIEW_1.LC3_AMT4 as LC3_AMT4,
				       
				       VIEW_1.REL_CD5 as REL_CD5,
				       VIEW_1.NAM_KOR5 as NAM_KOR5,
				       VIEW_1.CET_NO5 as CET_NO5,
				       VIEW_1.BAS_MAN5 as BAS_MAN5,
				       VIEW_1.TRB_MAN5 as TRB_MAN5,
				       VIEW_1.WCT_MAN5 as WCT_MAN5,
				       VIEW_1.GOL_MAN5 as GOL_MAN5,
				       VIEW_1.ONE_MAN5 as ONE_MAN5,        
				       VIEW_1.INV_NTS5 as INV_NTS5,
				       VIEW_1.INV2_NTS5 as INV2_NTS5,				       
				       VIEW_1.MED_NTS5 as MED_NTS5,
				       VIEW_1.EDU_NTS5 as EDU_NTS5,
				       VIEW_1.CARD_NTS5 as CARD_NTS5,
				       VIEW_1.DIR_CARD_NTS5 as DIR_CARD_NTS5,
				       VIEW_1.CASH_NTS5 as CASH_NTS5,
				       VIEW_1.MARKET_NTS5 as MARKET_NTS5,        
				       VIEW_1.PUBLIC_NTS5 as PUBLIC_NTS5,       
				       VIEW_1.LC3_AMT_NTS5 as LC3_AMT_NTS5,
				       VIEW_1.INV_AMT5 as INV_AMT5,
				       VIEW_1.INV2_AMT5 as INV2_AMT5,				       
				       VIEW_1.MED_AMT5 as MED_AMT5,
				       VIEW_1.EDU_AMT5 as EDU_AMT5,
				       VIEW_1.CARD_AMT5 as CARD_AMT5,
				       VIEW_1.DIR_CARD_AMT5 as DIR_CARD_AMT5,
				       VIEW_1.MARKET_AMT5 as MARKET_AMT5,             
				       VIEW_1.PUBLIC_AMT5 as PUBLIC_AMT5,       
				       VIEW_1.LC3_AMT5 as LC3_AMT5,
				       
				       VIEW_1.PEN_GUBUN_CD_1 as PEN_GUBUN_CD_1,
				       VIEW_1.ABA_CD_1 as ABA_CD_1,
				       VIEW_1.ABA_NM_1 as ABA_NM_1,
				       VIEW_1.ACC_NO_1 as ACC_NO_1,
					   VIEW_1.AMOUNT_1 as AMOUNT_1,
					   VIEW_1.DED_AMT_1 as DED_AMT_1,
					   VIEW_1.PEN_GUBUN_CD_2 as PEN_GUBUN_CD_2,
				       VIEW_1.ABA_CD_2 as ABA_CD_2,
				       VIEW_1.ABA_NM_2 as ABA_NM_2,
				       VIEW_1.ACC_NO_2 as ACC_NO_2,
					   VIEW_1.AMOUNT_2 as AMOUNT_2,
					   VIEW_1.DED_AMT_2 as DED_AMT_2,
					   VIEW_1.PEN_GUBUN_CD_3 as PEN_GUBUN_CD_3,
				       VIEW_1.ABA_CD_3 as ABA_CD_3,
				       VIEW_1.ABA_NM_3 as ABA_NM_3,
				       VIEW_1.ACC_NO_3 as ACC_NO_3,
					   VIEW_1.AMOUNT_3 as AMOUNT_3,
					   VIEW_1.DED_AMT_3 as DED_AMT_3,
					   VIEW_1.PEN_GUBUN_CD_4 as PEN_GUBUN_CD_4,
				       VIEW_1.ABA_CD_4 as ABA_CD_4,
				       VIEW_1.ABA_NM_4 as ABA_NM_4,
				       VIEW_1.ACC_NO_4 as ACC_NO_4,
					   VIEW_1.AMOUNT_4 as AMOUNT_4,
					   VIEW_1.DED_AMT_4 as DED_AMT_4,
					   VIEW_1.PEN_GUBUN_CD_5 as PEN_GUBUN_CD_5,
				       VIEW_1.ABA_CD_5 as ABA_CD_5,
				       VIEW_1.ABA_NM_5 as ABA_NM_5,
				       VIEW_1.ACC_NO_5 as ACC_NO_5,
					   VIEW_1.AMOUNT_5 as AMOUNT_5,
					   VIEW_1.DED_AMT_5 as DED_AMT_5,
					   VIEW_1.PEN_GUBUN_CD_6 as PEN_GUBUN_CD_6,
				       VIEW_1.ABA_CD_6 as ABA_CD_6,
				       VIEW_1.ABA_NM_6 as ABA_NM_6,
				       VIEW_1.ACC_NO_6 as ACC_NO_6,
					   VIEW_1.AMOUNT_6 as AMOUNT_6,
					   VIEW_1.DED_AMT_6 as DED_AMT_6,
					   VIEW_1.PEN_GUBUN_CD_7 as PEN_GUBUN_CD_7,
				       VIEW_1.ABA_CD_7 as ABA_CD_7,
				       VIEW_1.ABA_NM_7 as ABA_NM_7,
				       VIEW_1.ACC_NO_7 as ACC_NO_7,
					   VIEW_1.AMOUNT_7 as AMOUNT_7,
					   VIEW_1.DED_AMT_7 as DED_AMT_7,
					   VIEW_1.PEN_GUBUN_CD_8 as PEN_GUBUN_CD_8,
				       VIEW_1.ABA_CD_8 as ABA_CD_8,
				       VIEW_1.ABA_NM_8 as ABA_NM_8,
				       VIEW_1.ACC_NO_8 as ACC_NO_8,
					   VIEW_1.AMOUNT_8 as AMOUNT_8,
					   VIEW_1.DED_AMT_8 as DED_AMT_8,
					   VIEW_1.PEN_GUBUN_CD_9 as PEN_GUBUN_CD_9,
				       VIEW_1.ABA_CD_9 as ABA_CD_9,
				       VIEW_1.ABA_NM_9 as ABA_NM_9,
				       VIEW_1.ACC_NO_9 as ACC_NO_9,
					   VIEW_1.AMOUNT_9 as AMOUNT_9,
					   VIEW_1.DED_AMT_9 as DED_AMT_9,
					   VIEW_1.PEN_GUBUN_CD_10 as PEN_GUBUN_CD_10,
				       VIEW_1.ABA_CD_10 as ABA_CD_10,
				       VIEW_1.ABA_NM_10 as ABA_NM_10,
				       VIEW_1.ACC_NO_10 as ACC_NO_10,
					   VIEW_1.AMOUNT_10 as AMOUNT_10,
					   VIEW_1.DED_AMT_10 as DED_AMT_10,
					   VIEW_1.PEN_GUBUN_CD_11 as PEN_GUBUN_CD_11,
				       VIEW_1.ABA_CD_11 as ABA_CD_11,
				       VIEW_1.ABA_NM_11 as ABA_NM_11,
				       VIEW_1.ACC_NO_11 as ACC_NO_11,
					   VIEW_1.AMOUNT_11 as AMOUNT_11,
					   VIEW_1.DED_AMT_11 as DED_AMT_11,
					   VIEW_1.PEN_GUBUN_CD_12 as PEN_GUBUN_CD_12,
				       VIEW_1.ABA_CD_12 as ABA_CD_12,
				       VIEW_1.ABA_NM_12 as ABA_NM_12,
				       VIEW_1.ACC_NO_12 as ACC_NO_12,
					   VIEW_1.AMOUNT_12 as AMOUNT_12,
					   VIEW_1.DED_AMT_12 as DED_AMT_12,
					   VIEW_1.PEN_GUBUN_CD_13 as PEN_GUBUN_CD_13,
				       VIEW_1.ABA_CD_13 as ABA_CD_13,
				       VIEW_1.ABA_NM_13 as ABA_NM_13,
				       VIEW_1.ACC_NO_13 as ACC_NO_13,
					   VIEW_1.AMOUNT_13 as AMOUNT_13,
					   VIEW_1.DED_AMT_13 as DED_AMT_13,
					   VIEW_1.PEN_GUBUN_CD_14 as PEN_GUBUN_CD_14,
				       VIEW_1.ABA_CD_14 as ABA_CD_14,
				       VIEW_1.ABA_NM_14 as ABA_NM_14,
				       VIEW_1.ACC_NO_14 as ACC_NO_14,
					   VIEW_1.AMOUNT_14 as AMOUNT_14,
					   VIEW_1.DED_AMT_14 as DED_AMT_14,
					   VIEW_1.PEN_GUBUN_CD_15 as PEN_GUBUN_CD_15,
				       VIEW_1.ABA_CD_15 as ABA_CD_15,
				       VIEW_1.ABA_NM_15 as ABA_NM_15,
				       VIEW_1.ACC_NO_15 as ACC_NO_15,
					   VIEW_1.AMOUNT_15 as AMOUNT_15,
					   VIEW_1.DED_AMT_15 as DED_AMT_15
				 FROM
				 (SELECT YAC.ENO_NO||'C'||YAC.PIS_YY||YAC.PIS_MM SEL_KEY,
				         'C' REC_TAG,
		                 '20227' TAX_CD,
		                 '2218113834' COMP_CD,
		                 EMS.NAM_KOR,
				         EMS.CET_NO,
		                 EMS.ZIP_NO,
		                 EMS.JUSO,
		                 NVL(YAB.CNT,0) CNT,
		                 '' JAS_NM,
				         '' JAO_NO,
				         YAC.TAX_INCOME SALT_AMTS,
				         YAC.TAX_INCOME SALT_AMTT,
				         YAC.FREE_INCOME + NVL(YAB.JAG_AMT,0) FREE_INCOME,
				         YAC.TAX_INCOME + YAC.YAB_INCOME TAX_INCOME,
				         YAC.INJUNG_AMT OUTT_AMTS,
				         YAC.MGR_AMT,
				         YAC.MNI_AMT,
		                 YAC.BADD_AMT,
				         YAC.SOU_CNT,
		                 YAC.SPSB_AMT,
		                 YAC.DFM_CNT,
		                 YAC.GDED_AMT,
		                 YAC.GOL_CNT,
		                 YAC.GOL_AMT,

				         YAC.TRB_CNT,
		                 YAC.TBL_DED,
		                 YAC.WDD_AMT,
				         YAC.ONE_AMT,
				         
				         --DECODE(NVL(YAC.NSE_TOT,0), 0, 0, YAC.HINU_AMT+NVL(YAB.JAH_AMT,0)) HINU_AMT,
				         --DECODE(NVL(YAC.NSE_TOT,0), 0, 0, YAC.HINS_AMT+NVL(YAB.JAP_AMT,0)) HINS_AMT,
				         
				         --YAC.HINU_DED+NVL(YAB.JAH_AMT,0) HINU_AMT,
				         --YAC.HINS_DED+NVL(YAB.JAP_AMT,0) HINS_AMT,				         

				         YAC.HINU_DED HINU_AMT,
				         YAC.HINS_DED HINS_AMT,	
				         				         
		                 --LEAST(YAC.LH1_AMT,3000000) LH1_AMT,
		                 --LEAST(YAC.LH2_AMT,3000000) LH2_AMT,
		                 --LEAST(YAC.LH3_AMT,7500000) LH3_AMT,
		                 --LEAST(YAC.LH4_AMT,6000000) LH4_AMT,		                 
		                 --LEAST(YAC.LH5_AMT,10000000) LH5_AMT,
		                 --LEAST(YAC.LH6_AMT,15000000) LH6_AMT,
		                 --LEAST(YAC.LH7_AMT,15000000) LH7_AMT,
		                 --LEAST(YAC.LH7_AMT,5000000) LH8_AMT,	
		                 
		                 NVL(YAC.LOAN_DED,0) AS LH1_AMT,
		                 NVL(YAC.PLOAN_DED,0) AS LH2_AMT,
		                 NVL(YAC.LH3_AMT,0) AS LH3_AMT,
		                 
				         NVL(LONG1.LONG_DED,0) AS LH4_AMT,         
				         NVL(LONG2.LONG_DED,0) AS LH5_AMT,
				         NVL(LONG3.LONG_DED,0) AS LH6_AMT,
				         NVL(LONG4.LONG_DED,0) AS LH7_AMT,
				         NVL(LONG5.LONG_DED,0) AS LH8_AMT,		                 
		                 
		                 YAC.DON_FWD,	
		                 YAC.PER_DED,		

				         YAC.CPC_DED,
				         YAC.NSE_TOT,
		                 YAC.INDED_TOT,
				         NVL(YAC.CARD_DED,0) CARD_DED, 
				         YAC.SAVE_DED, 
		                 YAC.SAVE1_DED, 
		                 YAC.SAVE2_DED, 
		                 YAC.SAVE3_DED, 
		                 YAC.SAJU_AMT, 
		                 YAC.LSS_DED, 		   
		                 NVL(YAC.PER_DED,0) + NVL(YAC.SAVE1_DED,0) + NVL(YAC.SAVE2_DED,0) + NVL(YAC.SAVE3_DED,0) + NVL(YAC.CARD_DED,0) + NVL(YAC.SAJU_AMT,0) + NVL(YAC.LSS_DED,0) ETC_TOT,		                               
				         NVL(YAC.VEN_DED,0) VEN_DED,
				         YAC.TTAX_STD ,
		                 YAC.TAX_AMT,
		                 YAC.HGR_DED,
		                 YAC.AGE_AMT,	
		                 LEAST(YAC.ANN_AMT,4000000) ANN_AMT, 		                 
		                 NVL(YAC.ANN_DED,0) ANN_DED, 	    
		                 LEAST(YAC.LIN_AMT,1000000) LIN_AMT,			                 
		                 NVL(YAC.MIN_DED,0) MIN_DED,			
		                            
		                 NVL(YAC.MHEA_AMT,0) + NVL(YAC.OHEA_AMT,0) + NVL(YAC.HAN_AMT,0) MMA_AMT,	
		                 NVL(YAC.MMA_DED,0) MMA_DED,	
		                 NVL(YAC.GRA_AMT,0) + NVL(YAC.HED_AMT,0) + NVL(YAC.EDU_AMT1,0) + NVL(YAC.EDU_AMT2,0) + NVL(YAC.EDU_AMT3,0) + NVL(YAC.EDU_AMT4,0) + NVL(YAC.EDU_AMT5,0) EDU_AMT,			                 		          
		                 NVL(YAC.EDU_DED,0) EDU_DED,	
		                 		              
		                 0 GOV1_AMT,			                 		                 
		                 NVL(YAC.GOV_DED,0) GOV1_DED,
		                 GREATEST((NVL(YAC.GOV_NTS,0) + NVL(YAC.GOV_AMT,0) - 100000 ),0)  GOV2_AMT,			                 		                 
		                 NVL(YAC.GOV2_DED,0) GOV2_DED,				                 		              
		                 		              		                 
		                 NVL(YAC.LC1_NTS,0) + NVL(YAC.LC1_AMT,0) LC1_AMT,			                 		                 
		                 NVL(YAC.LC1_DED,0) LC1_DED,
		                 NVL(YAC.LC2_NTS,0) + NVL(YAC.LC2_AMT,0) + NVL(YAC.LC3_NTS,0) + NVL(YAC.LC3_AMT,0) LC23_AMT,			                 		                 
		                 NVL(YAC.LC23_DED,0) LC23_DED,		                 
 
		                 NVL(YAC.MRENT_DED,0) MRENT_DED,
		                                  		                 
				         YAC.TDED_TOT,
		                 YAC.DGG_TAX,
		                 YAC.DBW_TAX,
		                 YAC.DJM_TAX,
				         NVL(YAB.JAL_AMT,0) JAL_AMT,
				         NVL(YAB.JAC_AMT,0) JAC_AMT,				         
		                 NVL(YAB.JAN_AMT,0) JAN_AMT,
				         YAC.INCM_TAX,
		                 YAC.CITI_TAX,
				         EMS.HIR_YMD HIR_YMD, 
		                 EMS.RET_YMD RET_YMD,
		                 
		                 DECODE(NVL(YAC.VEN_DED,0) + NVL(YAC.NSE_TOT,0) + NVL(YAC.MRENT_DED,0), 0, NVL(YAC.STA_TOT,0)) STA_TOT,
		                 
				         --NVL(YAC.STA_TOT,0) STA_TOT, 
		                 
		                 
		                 
		                 NVL(YAC.NPEN_DED,0) NPEN_DED,
				         
				         YAC.SEA_FREE SEA_FREE,  
		                 YAC.GOV_DED GOV_DED, 
		                 YAC.OTX_DED, 
				         YAC.CASH_AMT CASH_AMT, 

				         YAC.DRE_INTX, 
		                 YAC.DRE_CTTX, 
		                 YAC.DRE_DFTX, 
		                 DECODE(YAC.HOL_YN,'Y','1','2') HOL_YN,
				         '' REL_CD1,  '' NAM_KOR1, '' CET_NO1,
				         '' BAS_MAN1, '' TRB_MAN1,  '' WCT_MAN1,  '' GOL_MAN1,   '' ONE_MAN1,
				         '' INV_NTS1, '' INV2_NTS1, '' MED_NTS1, '' EDU_NTS1, '' CARD_NTS1, '' DIR_CARD_NTS1,'' CASH_NTS1, '' MARKET_NTS1, '' PUBLIC_NTS1,'' LC3_AMT_NTS1,
				         '' INV_AMT1, '' INV2_AMT1, '' MED_AMT1, '' EDU_AMT1, '' CARD_AMT1, '' DIR_CARD_AMT1, '' MARKET_AMT1, '' PUBLIC_AMT1,'' LC3_AMT1,
				         '' REL_CD2,  '' NAM_KOR2, '' CET_NO2,
				         '' BAS_MAN2, '' TRB_MAN2,  '' WCT_MAN2,  '' GOL_MAN2,  '' ONE_MAN2,
				         '' INV_NTS2, '' INV2_NTS2, '' MED_NTS2, '' EDU_NTS2, '' CARD_NTS2, '' DIR_CARD_NTS2,'' CASH_NTS2, '' MARKET_NTS2, '' PUBLIC_NTS2,'' LC3_AMT_NTS2,
				         '' INV_AMT2, '' INV2_AMT2, '' MED_AMT2, '' EDU_AMT2, '' CARD_AMT2, '' DIR_CARD_AMT2, '' MARKET_AMT2, '' PUBLIC_AMT2,'' LC3_AMT2,
				         '' REL_CD3,  '' NAM_KOR3, '' CET_NO3,
				         '' BAS_MAN3, '' TRB_MAN3,  '' WCT_MAN3,  '' GOL_MAN3,   '' ONE_MAN3,
				         '' INV_NTS3, '' INV2_NTS3, '' MED_NTS3, '' EDU_NTS3, '' CARD_NTS3, '' DIR_CARD_NTS3,'' CASH_NTS3, '' MARKET_NTS3, '' PUBLIC_NTS3,'' LC3_AMT_NTS3,
				         '' INV_AMT3, '' INV2_AMT3, '' MED_AMT3, '' EDU_AMT3, '' CARD_AMT3, '' DIR_CARD_AMT3, '' MARKET_AMT3, '' PUBLIC_AMT3,'' LC3_AMT3,
				         '' REL_CD4,  '' NAM_KOR4, '' CET_NO4,
				         '' BAS_MAN4, '' TRB_MAN4,  '' WCT_MAN4,  '' GOL_MAN4,   '' ONE_MAN4,
				         '' INV_NTS4, '' INV2_NTS4, '' MED_NTS4, '' EDU_NTS4, '' CARD_NTS4, '' DIR_CARD_NTS4,'' CASH_NTS4, '' MARKET_NTS4, '' PUBLIC_NTS4,'' LC3_AMT_NTS4,
				         '' INV_AMT4, '' INV2_AMT4, '' MED_AMT4, '' EDU_AMT4, '' CARD_AMT4, '' DIR_CARD_AMT4, '' MARKET_AMT4, '' PUBLIC_AMT4,'' LC3_AMT4,
				         '' REL_CD5,  '' NAM_KOR5, '' CET_NO5,
				         '' BAS_MAN5, '' TRB_MAN5,  '' WCT_MAN5,  '' GOL_MAN5,  '' ONE_MAN5,
				         '' INV_NTS5, '' INV2_NTS5, '' MED_NTS5, '' EDU_NTS5, '' CARD_NTS5, '' DIR_CARD_NTS5,'' CASH_NTS5, '' MARKET_NTS5, '' PUBLIC_NTS5,'' LC3_AMT_NTS5,
				         '' INV_AMT5, '' INV2_AMT5, '' MED_AMT5, '' EDU_AMT5, '' CARD_AMT5, '' DIR_CARD_AMT5, '' MARKET_AMT5, '' PUBLIC_AMT5,'' LC3_AMT5,
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				    FROM ASNHR.T_AC_RETACC_15 YAC,
				         (SELECT ENO_NO, ENO_NM AS NAM_KOR,
				                 SUBSTR(CET_NO,1,6)||SUBSTR(CET_NO,8,7) CET_NO,
				                 ZIP_NO,ADR_CT||' '||ADDRESS JUSO,
				                 GREATEST(NVL(TO_CHAR(HIR_YMD,'YYYYMMDD'),' '),'20150101') HIR_YMD,
				                 LEAST(NVL(TO_CHAR(RET_YMD,'YYYYMMDD'),'20151231'),'20151231') RET_YMD
				          FROM ASNHR.T_CM_PERSON ) EMS,
				         (SELECT ENO_NO,COUNT(*) CNT,
				            SUM(NVL(JAC_AMT,0)) JAC_AMT,				         
				            SUM(NVL(JAL_AMT,0)) JAL_AMT, 
                   			SUM(NVL(JAN_AMT,0)) JAN_AMT,
				            SUM(NVL(JAG_AMT,0)) JAG_AMT,
				            SUM(NVL(JAH_AMT,0)) JAH_AMT,
				            SUM(NVL(JAP_AMT,0)) JAP_AMT
				            FROM ASNHR.T_AC_DUTYPLACE
				           WHERE (PIS_YY = '2015')
				          GROUP BY ENO_NO) YAB,       
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_15 WHERE PIS_YY = '2015' AND LH4_AMT != '0')  LONG1,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_15 WHERE PIS_YY = '2015' AND LH5_AMT != '0')  LONG2,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_15 WHERE PIS_YY = '2015' AND LH6_AMT != '0')  LONG3,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_15 WHERE PIS_YY = '2015' AND LH7_AMT != '0')  LONG4,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_15 WHERE PIS_YY = '2015' AND LH8_AMT != '0')  LONG5     				          
				 WHERE YAC.PIS_YY = '2015'
				   AND YAC.GBN_TAG = '8'
				   AND YAC.ENO_NO  = EMS.ENO_NO
				   AND YAC.ENO_NO  = YAB.ENO_NO (+)
				   AND YAC.ENO_NO  = LONG1.ENO_NO(+)   
				   AND YAC.ENO_NO  = LONG2.ENO_NO(+)
				   AND YAC.ENO_NO  = LONG3.ENO_NO(+)   
				   AND YAC.ENO_NO  = LONG4.ENO_NO(+)   
				   AND YAC.ENO_NO  = LONG5.ENO_NO(+)    
				   --AND EMS.ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')				          
   				
				 UNION
				
				 SELECT x.ENO_NO||'D'||PIS_YY||PIS_MM SEL_KEY,
				        'D' REC_TAG,
                		'20227' TAX_CD,
                		'2218113834' COMP_CD,
                		'' NAM_KOR,
    				    EMS.CET_NO CET_NO,
                		'' ZIP_NO,
                		'' JUSO,
		                0 CNT,
		                JAS_NM,
		                JAO_NO,
    				    JAA_AMT + JAB_AMT SALT_AMTS, 
                		JAA_AMT + JAB_AMT + JAC_AMT + JAD_AMT + JAI_AMT SALT_AMTT,
	                    0 FREE_INCOME,
	                    0 TAX_INCOME,
		                0 OUTT_AMTS,				         
		                0 MGR_AMT,
		                0 MNI_AMT,
		                0 BADD_AMT,
		                '' SOU_CNT,
		                0 SPSB_AMT,
		                '' DFM_CNT,
	                    0 GDED_AMT, 
		                '' GOL_CNT, 
		                0 GOL_AMT, 
	                    '' TRB_CNT,
		                0 TBL_DED,
		                0 WDD_AMT,
                		0 ONE_AMT,
		                0 HINU_AMT,
		                0 HINS_AMT,
		                0 LH1_AMT, 
		                0 LH2_AMT,
		                0 LH3_AMT, 
	                    0 LH4_AMT, 
		                0 LH5_AMT, 
		                0 LH6_AMT, 
		                0 LH7_AMT, 
		                0 LH8_AMT,
		                0 DON_FWD,	
		                0 PER_DED,			                	                
	                    0 CPC_DED,
		                0 NSE_TOT,
		                0 INDED_TOT,
	                    0 CARD_DED, 
		                0 SAVE_DED, 
		                0 SAVE1_DED, 
		                0 SAVE2_DED, 
		                0 SAVE3_DED,  
		                0 SAJU_AMT, 
		                0 LSS_AMT,  
		                0 ETC_TOT, 		                		                
		                0 VEN_DED,
	                    0 TTAX_STD, 
		                0 TAX_AMT,  
		                0 HGR_DED,   
		                0 AGE_AMT,  
	                    0 ANN_AMT, 
		                0 ANN_DED,  
		                0 LIN_AMT,   
		                0 MIN_DED,
	                    0 MMA_AMT,
		                0 MMA_DED,
	                    0 EDU_AMT,
		                0 EDU_DED, 
	                    0 GOV1_AMT,  		                
	                    0 GOV1_DED,		
	                    0 GOV2_AMT,  		                
	                    0 GOV2_DED,		                    
	                    0 LC1_AMT,  		                
	                    0 LC1_DED,		
	                    0 LC23_AMT,  		                
	                    0 LC23_DED,		
		                0 MRENT_DED,	                                                                        
	                    0 TDED_TOT,  
		                0 DGG_TAX,
		                0 DBW_TAX,
	                    0 DJM_TAX,
		                0 JAL_AMT,
		                0 JAC_AMT,
		                0 JAN_AMT,
		                JAL_AMT INCM_TAX,
		                JAN_AMT CITI_TAX,
	                    GREATEST(HIR_YMD,'20150101') HIR_YMD,
	                    LEAST(RET_YMD,'20151231') RET_YMD,
	                    0 STA_TOT, 
		                0 NPEN_DED, 
	                    0 SEA_FREE,  
		                0 GOV_DED, 
		                0 OTX_DED, 
	                    0 CASH_AMT, 
		                0 DRE_INTX, 
		                0 DRE_CTTX, 
		                0 DRE_DFTX, 
		                '2' HOL_YN,
				         '' REL_CD1,  '' NAM_KOR1, '' CET_NO1,
				         '' BAS_MAN1, '' TRB_MAN1, '' WCT_MAN1,  '' GOL_MAN1,   '' ONE_MAN1,
				         '' INV_NTS1, '' INV2_NTS1, '' MED_NTS1, '' EDU_NTS1, '' CARD_NTS1, '' DIR_CARD_NTS1,'' CASH_NTS1, '' MARKET_NTS1, '' PUBLIC_NTS1,'' LC3_AMT_NTS1,
				         '' INV_AMT1, '' INV2_AMT1, '' MED_AMT1, '' EDU_AMT1, '' CARD_AMT1, '' DIR_CARD_AMT1, '' MARKET_AMT1, '' PUBLIC_AMT1,'' LC3_AMT1,
				         '' REL_CD2,  '' NAM_KOR2, '' CET_NO2,
				         '' BAS_MAN2, '' TRB_MAN2,  '' WCT_MAN2,  '' GOL_MAN2,  '' ONE_MAN2,
				         '' INV_NTS2, '' INV2_NTS2, '' MED_NTS2, '' EDU_NTS2, '' CARD_NTS2, '' DIR_CARD_NTS2,'' CASH_NTS2, '' MARKET_NTS2, '' PUBLIC_NTS2,'' LC3_AMT_NTS2,
				         '' INV_AMT2, '' INV2_AMT2, '' MED_AMT2, '' EDU_AMT2, '' CARD_AMT2, '' DIR_CARD_AMT2, '' MARKET_AMT2, '' PUBLIC_AMT2,'' LC3_AMT2,
				         '' REL_CD3,  '' NAM_KOR3, '' CET_NO3,
				         '' BAS_MAN3, '' TRB_MAN3,  '' WCT_MAN3,  '' GOL_MAN3,  '' ONE_MAN3,
				         '' INV_NTS3, '' INV2_NTS3, '' MED_NTS3, '' EDU_NTS3, '' CARD_NTS3, '' DIR_CARD_NTS3,'' CASH_NTS3, '' MARKET_NTS3, '' PUBLIC_NTS3,'' LC3_AMT_NTS3,
				         '' INV_AMT3, '' INV2_AMT3, '' MED_AMT3, '' EDU_AMT3, '' CARD_AMT3, '' DIR_CARD_AMT3, '' MARKET_AMT3, '' PUBLIC_AMT3,'' LC3_AMT3,
				         '' REL_CD4,  '' NAM_KOR4, '' CET_NO4,
				         '' BAS_MAN4, '' TRB_MAN4,  '' WCT_MAN4,  '' GOL_MAN4,  '' ONE_MAN4,
				         '' INV_NTS4, '' INV2_NTS4, '' MED_NTS4, '' EDU_NTS4, '' CARD_NTS4, '' DIR_CARD_NTS4,'' CASH_NTS4, '' MARKET_NTS4, '' PUBLIC_NTS4,'' LC3_AMT_NTS4,
				         '' INV_AMT4, '' INV2_AMT4, '' MED_AMT4, '' EDU_AMT4, '' CARD_AMT4, '' DIR_CARD_AMT4, '' MARKET_AMT4, '' PUBLIC_AMT4,'' LC3_AMT4,
				         '' REL_CD5,  '' NAM_KOR5, '' CET_NO5,
				         '' BAS_MAN5, '' TRB_MAN5,  '' WCT_MAN5,  '' GOL_MAN5,  '' ONE_MAN5,
				         '' INV_NTS5, '' INV2_NTS5, '' MED_NTS5, '' EDU_NTS5, '' CARD_NTS5, '' DIR_CARD_NTS5,'' CASH_NTS5, '' MARKET_NTS5, '' PUBLIC_NTS5,'' LC3_AMT_NTS5,
				         '' INV_AMT5, '' INV2_AMT5, '' MED_AMT5, '' EDU_AMT5, '' CARD_AMT5, '' DIR_CARD_AMT5, '' MARKET_AMT5, '' PUBLIC_AMT5,'' LC3_AMT5,
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				   FROM ASNHR.T_AC_DUTYPLACE x,
				 (SELECT ENO_NO,ENO_NM AS NAM_KOR,
				         SUBSTR(CET_NO,1,6)||SUBSTR(CET_NO,8,7) CET_NO,
				         ZIP_NO,ADR_CT||ADDRESS JUSO
				    FROM ASNHR.T_CM_PERSON ) EMS
				   WHERE PIS_YY = '2015'
				     AND x.ENO_NO = EMS.ENO_NO
				     --AND EMS.ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')				          
				
				 UNION

				 SELECT a.ENO_NO||'E1'||B.PIS_YY||'12', 'E', '20227', '2218113834', '',
				        B.CET_NO,
		                '','',0,'','',0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,'0',0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,'','',0,0,0,0,0,0,0,0,0,'2',
				        B.REL_CD,  
		                B.NAM_KOR, 
		                B.CET_NO,  
		                B.BAS_MAN,  
		                B.TRB_MAN, 
		                B.WCT_MAN, 
		                B.GOL_MAN, 
		                B.ONE_MAN,
				        NVL(B.INV_NTS,'0'), 
				        NVL(B.INV2_NTS,'0'), 				        
		                NVL(B.MED_NTS,'0'), 
		                NVL(B.EDU_NTS,'0'),
				        NVL(B.CARD_NTS,'0'),
		                NVL(B.DIR_CARD_NTS,'0'), 
		                NVL(B.CASH_NTS,'0'),  
		                NVL(B.MARKET_NTS,'0'), 
		                NVL(B.PUBLIC_NTS,'0'), 
		                NVL(B.LC3_AMT_NTS,'0'),
				        NVL(B.INV_AMT,'0'), 
				        NVL(B.INV2_AMT,'0'), 				        
		                NVL(B.MED_AMT,'0'), 
		                NVL(B.EDU_AMT,'0'),
				        NVL(B.CARD_AMT,'0'),
		                NVL(B.DIR_CARD_AMT,'0'), 
		                NVL(B.MARKET_AMT,'0'), 
		                NVL(B.PUBLIC_AMT,'0'), 
		                NVL(B.LC3_AMT,'0'),
				        C.REL_CD,  
		                C.NAM_KOR, 
		                C.CET_NO,  
		                C.BAS_MAN,  
		                C.TRB_MAN, 
		                C.WCT_MAN, 
		                C.GOL_MAN, 
		                C.ONE_MAN,
				        NVL(C.INV_NTS,'0'), 
				        NVL(C.INV2_NTS,'0'), 				        
		                NVL(C.MED_NTS,'0'), 
		                NVL(C.EDU_NTS,'0'),
				        NVL(C.CARD_NTS,'0'),
		                NVL(C.DIR_CARD_NTS,'0'), 
		                NVL(C.CASH_NTS,'0'), 
		                NVL(C.MARKET_NTS,'0'), 
		                NVL(C.PUBLIC_NTS,'0'), 
		                NVL(C.LC3_AMT_NTS,'0'),
				        NVL(C.INV_AMT,'0'), 
				        NVL(C.INV2_AMT,'0'), 				        
		                NVL(C.MED_AMT,'0'), 
		                NVL(C.EDU_AMT,'0'),
				        NVL(C.CARD_AMT,'0'),
		                NVL(C.DIR_CARD_AMT,'0'), 
		                NVL(C.MARKET_AMT,'0'), 
		                NVL(C.PUBLIC_AMT,'0'), 
		                NVL(C.LC3_AMT,'0'),
				        D.REL_CD,  
		                D.NAM_KOR, 
		                D.CET_NO,  
		                D.BAS_MAN,  
		                D.TRB_MAN, 
		                D.WCT_MAN, 
		                D.GOL_MAN, 
		                D.ONE_MAN,
				        NVL(D.INV_NTS,'0'), 
				        NVL(D.INV2_NTS,'0'), 				        
		                NVL(D.MED_NTS,'0'), 
		                NVL(D.EDU_NTS,'0'),
				        NVL(D.CARD_NTS,'0'),
		                NVL(D.DIR_CARD_NTS,'0'), 
		                NVL(D.CASH_NTS,'0'), 
		                NVL(D.MARKET_NTS,'0'), 
		                NVL(D.PUBLIC_NTS,'0'), 
		                NVL(D.LC3_AMT_NTS,'0'),
				        NVL(D.INV_AMT,'0'), 
				        NVL(D.INV2_AMT,'0'), 				        
		                NVL(D.MED_AMT,'0'), 
		                NVL(D.EDU_AMT,'0'),
				        NVL(D.CARD_AMT,'0'),
		                NVL(D.DIR_CARD_AMT,'0'),  
		                NVL(D.MARKET_AMT,'0'), 
		                NVL(D.PUBLIC_AMT,'0'), 
		                NVL(D.LC3_AMT,'0'),
				        E.REL_CD,  
		                E.NAM_KOR, 
		                E.CET_NO,  
		                E.BAS_MAN,  
		                E.TRB_MAN,  
		                E.WCT_MAN, 
		                E.GOL_MAN, 
		                E.ONE_MAN,
				        NVL(E.INV_NTS,'0'), 
				        NVL(E.INV2_NTS,'0'), 				        
		                NVL(E.MED_NTS,'0'), 
		                NVL(E.EDU_NTS,'0'),
				        NVL(E.CARD_NTS,'0'),
		                NVL(E.DIR_CARD_NTS,'0'), 
		                NVL(E.CASH_NTS,'0'), 
		                NVL(E.MARKET_NTS,'0'), 
		                NVL(E.PUBLIC_NTS,'0'), 
		                NVL(E.LC3_AMT_NTS,'0'),
				        NVL(E.INV_AMT,'0'), 
				        NVL(E.INV2_AMT,'0'), 				        
		                NVL(E.MED_AMT,'0'), 
		                NVL(E.EDU_AMT,'0'),
				        NVL(E.CARD_AMT,'0'),
		                NVL(E.DIR_CARD_AMT,'0'),  
		                NVL(E.MARKET_AMT,'0'), 
		                NVL(E.PUBLIC_AMT,'0'), 
		                NVL(E.LC3_AMT,'0'),
				        F.REL_CD,  
		                F.NAM_KOR, 
		                F.CET_NO,  
		                F.BAS_MAN,  
		                F.TRB_MAN,  
		                F.WCT_MAN, 
		                F.GOL_MAN, 
		                F.ONE_MAN,
				        NVL(F.INV_NTS,'0'), 
				        NVL(F.INV2_NTS,'0'), 				        
		                NVL(F.MED_NTS,'0'), 
		                NVL(F.EDU_NTS,'0'),
				        NVL(F.CARD_NTS,'0'),
		                NVL(F.DIR_CARD_NTS,'0'), 
		                NVL(F.CASH_NTS,'0'), 
		                NVL(F.MARKET_NTS,'0'), 
		                NVL(F.PUBLIC_NTS,'0'), 
		                NVL(F.LC3_AMT_NTS,'0'),
				        NVL(F.INV_AMT,'0'), 
				        NVL(F.INV2_AMT,'0'), 				        
		                NVL(F.MED_AMT,'0'), 
		                NVL(F.EDU_AMT,'0'),
				        NVL(F.CARD_AMT,'0'),
		                NVL(F.DIR_CARD_AMT,'0'),  
		                NVL(F.MARKET_AMT,'0'), 
		                NVL(F.PUBLIC_AMT,'0'), 
		                NVL(F.LC3_AMT,'0'),
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				
				FROM (SELECT ENO_NO
				        FROM ASNHR.T_AC_FAMILY_15
				       WHERE PIS_YY = '2015'
				    GROUP BY ENO_NO) A,
				     (SELECT A.ENO_NO ENO_NO, A.REL_CD, REPLACE(A.NAM_KOR,' ','') NAM_KOR, A.CET_NO, A.PIS_YY PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,               
				             '0' INV_NTS,				             
				             TO_CHAR(NVL(A.LIN_AMT_NTS,0) + NVL(A.LIH_AMT_NTS,0)) INV2_NTS,
				             TO_CHAR(NVL(A.MED_AMT_NTS,0) + NVL(A.LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(A.EDU_AMT_NTS,0) + NVL(A.HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(A.CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(A.DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(A.CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(A.MARKET_AMT_NTS,0)) MARKET_NTS,  
				             TO_CHAR(NVL(A.PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                             
				             TO_CHAR(NVL(B.HINU_AMT,0) + NVL(B.HINS_AMT,0) + NVL(C.JAH_AMT,0) + NVL(C.JAP_AMT,0)) INV_AMT,
				             TO_CHAR(NVL(A.LIN_AMT,0) + NVL(A.LIH_AMT,0)) INV2_AMT,				             
				             TO_CHAR(NVL(A.MED_AMT,0) + NVL(A.LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(A.EDU_AMT,0) + NVL(A.HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(A.CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(A.DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(A.MARKET_AMT,0)) MARKET_AMT,    
				             TO_CHAR(NVL(A.PUBLIC_AMT,0)) PUBLIC_AMT,                        
				             TO_CHAR(A.LC1_AMT+A.LC2_AMT+A.LC3_AMT+GREATEST(B.GOV_AMT-100000,0)) LC3_AMT,
				             TO_CHAR(NVL(A.LC2_AMT_NTS,0)+NVL(A.LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_15 A, ASNHR.T_AC_RETACC_15 B,
				            (SELECT ENO_NO, SUM(JAH_AMT) JAH_AMT, SUM(JAP_AMT) JAP_AMT FROM ASNHR.T_AC_DUTYPLACE WHERE PIS_YY = '2014' GROUP BY ENO_NO) C
				      WHERE A.PIS_YY = '2015' AND A.REL_CD = '0'
				        AND A.PIS_YY = B.PIS_YY 
				        AND B.GBN_TAG = '8'
				        AND A.ENO_NO = B.ENO_NO
				        AND A.ENO_NO = C.ENO_NO(+)) B,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,         
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,               
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,				             
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,         
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                   
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_15
				      WHERE PIS_YY = '2015' AND SEQ_NO = '2') C,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,               
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,             
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,               
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_15
				      WHERE PIS_YY = '2015' AND SEQ_NO = '3') D,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,               
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,             
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_15
				      WHERE PIS_YY = '2015' AND SEQ_NO = '4') E,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,               
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                             
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_15
				      WHERE PIS_YY = '2015' AND SEQ_NO = '5') F,
				      (SELECT ENO_NO, CHI_CNT
				         FROM ASNHR.T_AC_RETACC_15
				        WHERE PIS_YY = '2015'
                ) G
				WHERE A.ENO_NO = B.ENO_NO(+)
				  AND A.ENO_NO = C.ENO_NO(+)
				  AND A.ENO_NO = D.ENO_NO(+)
				  AND A.ENO_NO = E.ENO_NO(+)
				  AND A.ENO_NO = F.ENO_NO(+)
				  AND A.ENO_NO = G.ENO_NO(+)
				  --AND A.ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')				          
				
				 UNION
				
				 SELECT a.ENO_NO||'E2'||B.PIS_YY||'12', 'E', '20227', '2218113834', '',
				        SUBSTR(G.CET_NO,1,6)||SUBSTR(G.CET_NO,8,7),
		                '','',0,'','',0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,'0',0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,'','',0,0,0,0,0,0,0,0,0,'2',
				        B.REL_CD,  
		                B.NAM_KOR, 
		                B.CET_NO,  
		                B.BAS_MAN,  
		                B.TRB_MAN, 
		                B.WCT_MAN, 
		                B.GOL_MAN, 
		                B.ONE_MAN,
				        NVL(B.INV_NTS,'0'), 
				        NVL(B.INV2_NTS,'0'), 				        
		                NVL(B.MED_NTS,'0'), 
		                NVL(B.EDU_NTS,'0'),
				        NVL(B.CARD_NTS,'0'), 
		                NVL(B.DIR_CARD_NTS,'0'), 
		                NVL(B.CASH_NTS,'0'), 
		                NVL(B.MARKET_NTS,'0'), 
		                NVL(B.PUBLIC_NTS,'0'), 
		                NVL(B.LC3_AMT_NTS,'0'),
				        NVL(B.INV_AMT,'0'), 
				        NVL(B.INV2_AMT,'0'), 				        
		                NVL(B.MED_AMT,'0'), 
		                NVL(B.EDU_AMT,'0'),
				        NVL(B.CARD_AMT,'0'), 
		                NVL(B.DIR_CARD_AMT,'0'),
		                NVL(B.MARKET_AMT,'0'), 
		                NVL(B.PUBLIC_AMT,'0'), 
		                NVL(B.LC3_AMT,'0'),
				        C.REL_CD,  
		                C.NAM_KOR, 
		                C.CET_NO,  
		                C.BAS_MAN,  
		                C.TRB_MAN,  
		                C.WCT_MAN, 
		                C.GOL_MAN, 
		                C.ONE_MAN,
				        NVL(C.INV_NTS,'0'), 
				        NVL(C.INV2_NTS,'0'), 				        
		                NVL(C.MED_NTS,'0'), 
		                NVL(C.EDU_NTS,'0'),
				        NVL(C.CARD_NTS,'0'), 
		                NVL(C.DIR_CARD_NTS,'0'), 
		                NVL(C.CASH_NTS,'0'), 
		                NVL(C.MARKET_NTS,'0'), 
		                NVL(C.PUBLIC_NTS,'0'), 
		                NVL(C.LC3_AMT_NTS,'0'),
				        NVL(C.INV_AMT,'0'), 
				        NVL(C.INV2_AMT,'0'), 				        
		                NVL(C.MED_AMT,'0'), 
		                NVL(C.EDU_AMT,'0'),
				        NVL(C.CARD_AMT,'0'), 
		                NVL(C.DIR_CARD_AMT,'0'), 
		                NVL(C.MARKET_AMT,'0'), 
		                NVL(C.PUBLIC_AMT,'0'), 
		                NVL(C.LC3_AMT,'0'),
				        D.REL_CD,  
		                D.NAM_KOR, 
		                D.CET_NO,  
		                D.BAS_MAN,  
		                D.TRB_MAN, 
		                D.WCT_MAN, 
		                D.GOL_MAN,  
		                D.ONE_MAN,
				        NVL(D.INV_NTS,'0'), 
				        NVL(D.INV2_NTS,'0'), 				        
		                NVL(D.MED_NTS,'0'), 
		                NVL(D.EDU_NTS,'0'),
				        NVL(D.CARD_NTS,'0'), 
		                NVL(D.DIR_CARD_NTS,'0'), 
		                NVL(D.CASH_NTS,'0'), 
		                NVL(D.MARKET_NTS,'0'), 
		                NVL(D.PUBLIC_NTS,'0'), 
		                NVL(D.LC3_AMT_NTS,'0'),
				        NVL(D.INV_AMT,'0'), 
				        NVL(D.INV2_AMT,'0'), 				        
		                NVL(D.MED_AMT,'0'), 
		                NVL(D.EDU_AMT,'0'),
				        NVL(D.CARD_AMT,'0'),  
		                NVL(D.DIR_CARD_AMT,'0'), 
		                NVL(D.MARKET_AMT,'0'), 
		                NVL(D.PUBLIC_AMT,'0'), 
		                NVL(D.LC3_AMT,'0'),
				        E.REL_CD,  
		                E.NAM_KOR, 
		                E.CET_NO,  
		                E.BAS_MAN,  
		                E.TRB_MAN, 
		                E.WCT_MAN, 
		                E.GOL_MAN, 
		                E.ONE_MAN,
				        NVL(E.INV_NTS,'0'), 
				        NVL(E.INV2_NTS,'0'), 				        
		                NVL(E.MED_NTS,'0'), 
		                NVL(E.EDU_NTS,'0'),
				        NVL(E.CARD_NTS,'0'), 
		                NVL(E.DIR_CARD_NTS,'0'), 
		                NVL(E.CASH_NTS,'0'), 
		                NVL(E.MARKET_NTS,'0'), 
		                NVL(E.PUBLIC_NTS,'0'), 
		                NVL(E.LC3_AMT_NTS,'0'),
				        NVL(E.INV_AMT,'0'), 
				        NVL(E.INV2_AMT,'0'), 				        
		                NVL(E.MED_AMT,'0'), 
		                NVL(E.EDU_AMT,'0'),
				        NVL(E.CARD_AMT,'0'), 
		                NVL(E.DIR_CARD_AMT,'0'), 
		                NVL(E.MARKET_AMT,'0'), 
		                NVL(E.PUBLIC_AMT,'0'), 
		                NVL(E.LC3_AMT,'0'),
				        F.REL_CD,  
		                F.NAM_KOR, 
		                F.CET_NO,  
		                F.BAS_MAN,  
		                F.TRB_MAN, 
		                F.WCT_MAN, 
		                F.GOL_MAN, 
		                F.ONE_MAN,
				        NVL(F.INV_NTS,'0'), 
				        NVL(F.INV2_NTS,'0'), 				        
		                NVL(F.MED_NTS,'0'), 
		                NVL(F.EDU_NTS,'0'),
				        NVL(F.CARD_NTS,'0'), 
		                NVL(F.DIR_CARD_NTS,'0'), 
		                NVL(F.CASH_NTS,'0'),  
		                NVL(F.MARKET_NTS,'0'), 
		                NVL(F.PUBLIC_NTS,'0'), 
		                NVL(F.LC3_AMT_NTS,'0'),
				        NVL(F.INV_AMT,'0'), 
				        NVL(F.INV2_AMT,'0'), 				        
		                NVL(F.MED_AMT,'0'), 
		                NVL(F.EDU_AMT,'0'),
				        NVL(F.CARD_AMT,'0'), 
		                NVL(F.DIR_CARD_AMT,'0'), 
		                NVL(F.MARKET_AMT,'0'), 
		                NVL(F.PUBLIC_AMT,'0'), 
		                NVL(F.LC3_AMT,'0'),
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				FROM (SELECT ENO_NO
				        FROM ASNHR.T_AC_FAMILY_15
				       WHERE PIS_YY = '2015'
				         AND SEQ_NO >= '6'
				    GROUP BY ENO_NO) A,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,             
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,             
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_15
				      WHERE PIS_YY = '2015' AND SEQ_NO = '6') B,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,             
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,    
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_15
				      WHERE PIS_YY = '2015' AND SEQ_NO = '7') C,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,              
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,                 
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_15
				      WHERE PIS_YY = '2015' AND SEQ_NO = '8') D,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,              
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,    
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                   
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_15
				      WHERE PIS_YY = '2015' AND SEQ_NO = '9') E,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN, 
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,              
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,   
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                   
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_15
				      WHERE PIS_YY = '2015' AND SEQ_NO = '10') F, ASNHR.T_CM_PERSON G,
				    (SELECT ENO_NO, CHI_CNT
				       FROM ASNHR.T_AC_RETACC_14
				      WHERE PIS_YY = '2014'
				        AND GBN_TAG = '8') H
				WHERE A.ENO_NO = B.ENO_NO(+)
				  AND A.ENO_NO = C.ENO_NO(+)
				  AND A.ENO_NO = D.ENO_NO(+)
				  AND A.ENO_NO = E.ENO_NO(+)
				  AND A.ENO_NO = F.ENO_NO(+)
				  AND A.ENO_NO = G.ENO_NO
				  AND A.ENO_NO = H.ENO_NO(+)
				  --AND A.ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')				          
				
				  UNION
				
				  SELECT EMS.ENO_NO||'F'||'2014'||'12', 'F', '20227', '2218113834', '',
				         EMS.CET_NO,
		                '','',0,'','',0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,'0',0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,'','',0,0,0,0,0,0,0,0,0,'2',
				         '' REL_CD1,  
		                 '' NAM_KOR1, 
		                 '' CET_NO1,
				         '' BAS_MAN1, 
		                 '' TRB_MAN1,  
		                 '' WCT_MAN1,  
		                 '' GOL_MAN1, 
		                 '' ONE_MAN1,
				         '' INV_NTS1, 
				         '' INV2_NTS1, 				         
		                 '' MED_NTS1, 
		                 '' EDU_NTS1, 
		                 '' CARD_NTS1, 
		                 '' DIR_CARD_NTS1,
		                 '' CASH_NTS1, 
		                 '' MARKET_NTS1,  
		                 '' MARKET_NTS1,
		                 '' LC3_AMT_NTS1,
				         '' INV_AMT1, 
				         '' INV2_AMT1, 				         
		                 '' MED_AMT1, 
		                 '' EDU_AMT1, 
		                 '' CARD_AMT1, 
		                 '' DIR_CARD_AMT1, 
		                 '' MARKET_AMT1,  
		                 '' MARKET_AMT1,
		                 '' LC3_AMT1,
				         '' REL_CD2,  
		                 '' NAM_KOR2, 
		                 '' CET_NO2,
				         '' BAS_MAN2, 
		                 '' TRB_MAN2,  
		                 '' WCT_MAN2,  
		                 '' GOL_MAN2,                
		                 '' ONE_MAN2,
				         '' INV_NTS2, 
				         '' INV2_NTS2, 				         
		                 '' MED_NTS2, 
		                 '' EDU_NTS2, 
		                 '' CARD_NTS2, 
		                 '' DIR_CARD_NTS2,
		                 '' CASH_NTS2, 
		                 '' MARKET_NTS2, 
		                 '' MARKET_NTS2, 
		                 '' LC3_AMT_NTS2,
				         '' INV_AMT2, 
				         '' INV2_AMT2, 				         
		                 '' MED_AMT2, 
		                 '' EDU_AMT2, 
		                 '' CARD_AMT2, 
		                 '' DIR_CARD_AMT2, 
		                 '' MARKET_AMT2, 
		                 '' MARKET_AMT2, 
		                 '' LC3_AMT2,
				         '' REL_CD3,  
		                 '' NAM_KOR3, 
		                 '' CET_NO3,
				         '' BAS_MAN3, 
		                 '' TRB_MAN3,  
		                 '' WCT_MAN3,  
		                 '' GOL_MAN3,             
		                 '' ONE_MAN3,
				         '' INV_NTS3,
				         '' INV2_NTS3,				         
		                 '' MED_NTS3, 
		                 '' EDU_NTS3, 
		                 '' CARD_NTS3, 
		                 '' DIR_CARD_NTS3,
		                 '' CASH_NTS3, 
		                 '' MARKET_NTS3, 
		                 '' MARKET_NTS3, 
		                 '' LC3_AMT_NTS3,
				         '' INV_AMT3, 
				         '' INV2_AMT3, 				         
		                 '' MED_AMT3, 
		                 '' EDU_AMT3, 
		                 '' CARD_AMT3, 
		                 '' DIR_CARD_AMT3, 
		                 '' MARKET_AMT3, 
		                 '' MARKET_AMT3, 
		                 '' LC3_AMT3,
				         '' REL_CD4,  
		                 '' NAM_KOR4, 
		                 '' CET_NO4,
				         '' BAS_MAN4, 
		                 '' TRB_MAN4,  
		                 '' WCT_MAN4,  
		                 '' GOL_MAN4,            
		                 '' ONE_MAN4,
				         '' INV_NTS4, 
				         '' INV2_NTS4, 				         
		                 '' MED_NTS4, 
		                 '' EDU_NTS4, 
		                 '' CARD_NTS4, 
		                 '' DIR_CARD_NTS4,
		                 '' CASH_NTS4, 
		                 '' MARKET_NTS4, 
		                 '' MARKET_NTS4, 
		                 '' LC3_AMT_NTS4,
				         '' INV_AMT4, 
				         '' INV2_AMT4, 				         
		                 '' MED_AMT4, 
		                 '' EDU_AMT4, 
		                 '' CARD_AMT4, 
		                 '' DIR_CARD_AMT4, 
		                 '' MARKET_AMT4, 
		                 '' MARKET_AMT4, 
		                 '' LC3_AMT4,
				         '' REL_CD5,  
		                 '' NAM_KOR5, 
		                 '' CET_NO5,
				         '' BAS_MAN5, 
		                 '' TRB_MAN5,  
		                 '' WCT_MAN5,  
		                 '' GOL_MAN5,           
		                 '' ONE_MAN5,
				         '' INV_NTS5, 
				         '' INV2_NTS5, 				         
		                 '' MED_NTS5, 
		                 '' EDU_NTS5, 
		                 '' CARD_NTS5, 
		                 '' DIR_CARD_NTS5,
		                 '' CASH_NTS5, 
		                 '' MARKET_NTS5, 
		                 '' MARKET_NTS5, 
		                 '' LC3_AMT_NTS5,
				         '' INV_AMT5, 
				         '' INV2_AMT5, 				         
		                 '' MED_AMT5, 
		                 '' EDU_AMT5, 
		                 '' CARD_AMT5, 
		                 '' DIR_CARD_AMT5, 
		                 '' MARKET_AMT5, 
		                 '' MARKET_AMT5, 
		                 '' LC3_AMT5,
				         PEN1.PEN_GUBUN_CD PEN_GUBUN_CD_1, PEN1.ABA_CD ABA_CD_1, SUBSTR(PEN1.ABA_NM,0,30) ABA_NM_1, 
				         PEN1.ACC_NO ACC_NO_1, PEN1.AMOUNT AMOUNT_1, NVL(PEN1.DED_AMT,0) DED_AMT_1,
				         PEN2.PEN_GUBUN_CD PEN_GUBUN_CD_2, PEN2.ABA_CD ABA_CD_2, SUBSTR(PEN2.ABA_NM,0,30) ABA_NM_2, 
				         PEN2.ACC_NO ACC_NO_2, PEN2.AMOUNT AMOUNT_2, NVL(PEN2.DED_AMT,0) DED_AMT_2,
				         PEN3.PEN_GUBUN_CD PEN_GUBUN_CD_3, PEN3.ABA_CD ABA_CD_3, SUBSTR(PEN3.ABA_NM,0,30) ABA_NM_3, 
				         PEN3.ACC_NO ACC_NO_3, PEN3.AMOUNT AMOUNT_3, NVL(PEN3.DED_AMT,0) DED_AMT_3,
				         PEN4.PEN_GUBUN_CD PEN_GUBUN_CD_4, PEN4.ABA_CD ABA_CD_4, SUBSTR(PEN4.ABA_NM,0,30) ABA_NM_4, 
				         PEN4.ACC_NO ACC_NO_4, PEN4.AMOUNT AMOUNT_4, NVL(PEN4.DED_AMT,0) DED_AMT_4,
				         PEN5.PEN_GUBUN_CD PEN_GUBUN_CD_5, PEN5.ABA_CD ABA_CD_5, SUBSTR(PEN5.ABA_NM,0,30) ABA_NM_5, 
				         PEN5.ACC_NO ACC_NO_5, PEN5.AMOUNT AMOUNT_5, NVL(PEN5.DED_AMT,0) DED_AMT_5,
				         PEN6.PEN_GUBUN_CD PEN_GUBUN_CD_6, PEN6.ABA_CD ABA_CD_6, SUBSTR(PEN6.ABA_NM,0,30) ABA_NM_6, 
				         PEN6.ACC_NO ACC_NO_6, PEN6.AMOUNT AMOUNT_6, NVL(PEN6.DED_AMT,0) DED_AMT_6,
				         PEN7.PEN_GUBUN_CD PEN_GUBUN_CD_7, PEN7.ABA_CD ABA_CD_7, SUBSTR(PEN7.ABA_NM,0,30) ABA_NM_7, 
				         PEN7.ACC_NO ACC_NO_7, PEN7.AMOUNT AMOUNT_7, NVL(PEN7.DED_AMT,0) DED_AMT_7,
				         PEN8.PEN_GUBUN_CD PEN_GUBUN_CD_8, PEN8.ABA_CD ABA_CD_8, SUBSTR(PEN8.ABA_NM,0,30) ABA_NM_8, 
				         PEN8.ACC_NO ACC_NO_8, PEN8.AMOUNT AMOUNT_8, NVL(PEN8.DED_AMT,0) DED_AMT_8,
				         PEN9.PEN_GUBUN_CD PEN_GUBUN_CD_9, PEN9.ABA_CD ABA_CD_9, SUBSTR(PEN9.ABA_NM,0,30) ABA_NM_9, 
				         PEN9.ACC_NO ACC_NO_9, PEN9.AMOUNT AMOUNT_9, NVL(PEN9.DED_AMT,0) DED_AMT_9,
				         PEN10.PEN_GUBUN_CD PEN_GUBUN_CD_10, PEN10.ABA_CD ABA_CD_10, SUBSTR(PEN10.ABA_NM,0,30) ABA_NM_10, 
				         PEN10.ACC_NO ACC_NO_10, PEN10.AMOUNT AMOUNT_10, NVL(PEN10.DED_AMT,0) DED_AMT_10,
				         PEN11.PEN_GUBUN_CD PEN_GUBUN_CD_11, PEN11.ABA_CD ABA_CD_11, SUBSTR(PEN11.ABA_NM,0,30) ABA_NM_11, 
				         PEN11.ACC_NO ACC_NO_11, PEN11.AMOUNT AMOUNT_11, NVL(PEN11.DED_AMT,0) DED_AMT_11,
				         PEN12.PEN_GUBUN_CD PEN_GUBUN_CD_12, PEN12.ABA_CD ABA_CD_12, SUBSTR(PEN12.ABA_NM,0,30) ABA_NM_12, 
				         PEN12.ACC_NO ACC_NO_12, PEN12.AMOUNT AMOUNT_12, NVL(PEN12.DED_AMT,0) DED_AMT_12,
				         PEN13.PEN_GUBUN_CD PEN_GUBUN_CD_13, PEN13.ABA_CD ABA_CD_13, SUBSTR(PEN13.ABA_NM,0,30) ABA_NM_13, 
				         PEN13.ACC_NO ACC_NO_13, PEN13.AMOUNT AMOUNT_13, NVL(PEN13.DED_AMT,0) DED_AMT_13,
				         PEN14.PEN_GUBUN_CD PEN_GUBUN_CD_14, PEN14.ABA_CD ABA_CD_14, SUBSTR(PEN14.ABA_NM,0,30) ABA_NM_14, 
				         PEN14.ACC_NO ACC_NO_14, PEN14.AMOUNT AMOUNT_14, NVL(PEN14.DED_AMT,0) DED_AMT_14,
				         PEN15.PEN_GUBUN_CD PEN_GUBUN_CD_15, PEN15.ABA_CD ABA_CD_15, SUBSTR(PEN15.ABA_NM,0,30) ABA_NM_15, 
				         PEN15.ACC_NO ACC_NO_15, PEN15.AMOUNT AMOUNT_15, NVL(PEN15.DED_AMT,0) DED_AMT_15
				    FROM
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '0') PEN1,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '1') PEN2,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '2') PEN3,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '3') PEN4,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '4') PEN5,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '5') PEN6,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '6') PEN7,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '7') PEN8,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '8') PEN9,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '9') PEN10,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '10') PEN11,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '11') PEN12,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '12') PEN13,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '13') PEN14,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY = '2014' AND ROW_NUM = '14') PEN15,
				         (SELECT ENO_NO,ENO_NM AS NAM_KOR,
				                 SUBSTR(CET_NO,1,6)||SUBSTR(CET_NO,8,7) CET_NO,
				                 ZIP_NO,ADR_CT||' '||ADDRESS JUSO,
				                 GREATEST(NVL(TO_CHAR(HIR_YMD,'YYYYMMDD'),' '),'20150101') HIR_YMD,
				                 LEAST(NVL(TO_CHAR(RET_YMD,'YYYYMMDD'),'20151231'),'20151231') RET_YMD
				          FROM ASNHR.T_CM_PERSON ) EMS,
				          ASNHR.T_AC_RETACC_15 YAC
					 WHERE PEN1.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN2.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN3.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN4.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN5.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN6.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN7.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN8.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN9.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN10.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN11.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN12.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN13.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN14.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN15.ENO_NO(+)  = EMS.ENO_NO
					   AND YAC.PIS_YY = '2015' 
					   AND YAC.GBN_TAG = '8'
					   AND YAC.ENO_NO = EMS.ENO_NO
					  -- AND EMS.ENO_NO NOT IN ('2070006','3120024','2030010','2120024','2120027','2130016','3110006','3110019','3130004','3130006','2030021','3120016','2050021','2130009','1990082','2100005','1990021','1990086','2030037','2010015','2040065','1990101','1990103','2030023','2040043','2040074','1990052','2030024','2030033','2040007','2040057','2110001','3140008','2060003','2120018','2120023','3130002','2120020','3140001','3140005','2100013','2050051','2040027','2120013','2120017','2130029','3140009','2120019','3140002','2110008','2130017','2100011','2140020','3140014','3120015','2040064','2080027','2100009','3140013','2030016','2040063','2050028','2010017','2030025','2140016','2020018','2060001','2070029','2120025','2090001','2120006','2130011','3140003','2140017','3120021','2130034','3120020','2120022','3040010','3120008','3130003','3140004','2120010','2130024','2140006','2110006','3130001','3140006','3140019','3140022','2140005','2140026','3120019','2110004','1990059','3130010','2130032','3140011','2030012','2130038','2130042','3140025','3100026')				          
					   
				 ) VIEW_1
				 ORDER BY VIEW_1.SEL_KEY
            ]]>
        </query>
    </sql>
    

    <!-- 연말정산 신고 파일출력 -->
    <sql name="YACA001_SHR_FILE_14_ETC_142">
        <description>연말정산신고 파일출력</description>
        <query>
            <![CDATA[
				SELECT VIEW_1.SEL_KEY as yac_sel_key,
				       VIEW_1.REC_TAG as yac_rec_tag,
				       VIEW_1.TAX_CD as yac_tax_cd,
				       VIEW_1.COMP_CD as yac_comp_cd,
				       VIEW_1.CNT as yac_cnt,
				       VIEW_1.NAM_KOR as yac_nam_kor,
				       VIEW_1.CET_NO as yac_cet_no,
				       VIEW_1.ZIP_NO as yac_zip_no,
				       VIEW_1.JUSO as yac_juso,
				       VIEW_1.JAS_NM as yac_jas_nm,
				       VIEW_1.JAO_NO as yac_jao_no,
				       (VIEW_1.SALT_AMTS - VIEW_1.OUTT_AMTS) as yac_salt_amts,
				       VIEW_1.SALT_AMTT as yac_salt_amtt,
				       (VIEW_1.FREE_INCOME - VIEW_1.OUTT_AMTS) as yac_free_income,
				       VIEW_1.TAX_INCOME as yac_tax_income,
				       VIEW_1.OUTT_AMTS as yac_outt_amts,       
				       VIEW_1.MGR_AMT as yac_mgr_amt,
				       VIEW_1.MNI_AMT as yac_mni_amt,
				       VIEW_1.BADD_AMT as yac_badd_amt,
				       NVL(VIEW_1.SOU_CNT,'0') as yac_sou_cnt,
				       VIEW_1.SPSB_AMT as yac_spsb_amt,
				       NVL(VIEW_1.DFM_CNT,'0') as yac_dfm_cnt,
				       VIEW_1.GDED_AMT as yac_gded_amt,
				       NVL(VIEW_1.GOL_CNT,'0') as yac_gol_cnt,
				       VIEW_1.GOL_AMT as yac_gol_amt,
				       NVL(VIEW_1.TRB_CNT,'0') as yac_trb_cnt,
				       VIEW_1.TBL_DED as yac_tbl_ded,
				       
				       VIEW_1.WDD_AMT as yac_wdd_amt,
				       NVL(VIEW_1.ONE_AMT,'0')  as yac_one_amt,       

				       NVL(VIEW_1.HINU_AMT,'0')  as YAC_HINU_AMT,
				       NVL(VIEW_1.HINS_AMT,'0')  as YAC_HINS_AMT,   					   

				       VIEW_1.LH1_AMT as YAC_LH1_AMT,
				       VIEW_1.LH2_AMT as YAC_LH2_AMT,       
				       VIEW_1.LH3_AMT as YAC_LH3_AMT,
				       VIEW_1.LH4_AMT as YAC_LH4_AMT,
				       VIEW_1.LH5_AMT as YAC_LH5_AMT,
				       VIEW_1.LH6_AMT as YAC_LH6_AMT,
				       VIEW_1.LH7_AMT as YAC_LH7_AMT,
				       VIEW_1.LH8_AMT as YAC_LH8_AMT,   
				       VIEW_1.DON_FWD as YAC_DON_FWD,	
				       VIEW_1.PER_DED as YAC_PER_DED,				       			        

				       VIEW_1.CPC_DED as yac_cpc_ded,
				       VIEW_1.NSE_TOT as yac_nse_tot,
				       GREATEST(VIEW_1.INDED_TOT,0) as yac_inded_tot,
				       VIEW_1.CARD_DED as yac_card_ded,
				       VIEW_1.SAVE_DED as yac_save_ded,
				       VIEW_1.SAVE1_DED as yac_save1_ded,
				       VIEW_1.SAVE2_DED as yac_save2_ded,
				       VIEW_1.SAVE3_DED as yac_save3_ded,
				       VIEW_1.SAJU_AMT as YAC_SAJU_AMT,
				       VIEW_1.LSS_DED as YAC_LSS_AMT,				       
				       VIEW_1.ETC_TOT as YAC_ETC_TOT,				       
				       VIEW_1.VEN_DED as yac_ven_ded,
				       GREATEST(VIEW_1.TTAX_STD,0) as yac_ttax_std,
				       VIEW_1.TAX_AMT as yac_tax_amt,
				       VIEW_1.HGR_DED as yac_hgr_ded,
				       VIEW_1.CHI_CNT as YAC_CHI_CNT,				       
				       VIEW_1.AGE_AMT as YAC_AGE_AMT,		
				       VIEW_1.CHI_RCH as YAC_CHI_RCH,				       
				       VIEW_1.AGE_RCH as YAC_AGE_RCH,
				       VIEW_1.CHI_INP as YAC_CHI_INP,				       
				       VIEW_1.AGE_INP as YAC_AGE_INP,	
				       			       				       
				       VIEW_1.ANN_AMT as YAC_ANN_AMT,					       
				       VIEW_1.ANN_DED as YAC_ANN_DED,					       
				       VIEW_1.LIN_AMT as YAC_LIN_AMT,					       
				       VIEW_1.MIN_DED as YAC_MIN_DED,					       
				       		              
				       VIEW_1.MMA_AMT as YAC_MMA_AMT,
				       VIEW_1.MMA_DED as YAC_MMA_DED,				       
				       VIEW_1.EDU_AMT as YAC_EDU_AMT,       
				       VIEW_1.EDU_DED as YAC_EDU_DED,				       		       
				       		       
				       VIEW_1.GOV1_AMT as YAC_GOV1_AMT,					       
				       VIEW_1.GOV1_DED as YAC_GOV1_DED,					       
				       VIEW_1.GOV2_AMT as YAC_GOV2_AMT,					       
				       VIEW_1.GOV2_DED as YAC_GOV2_DED,					       
				       		              
				       VIEW_1.LC1_AMT as YAC_LC1_AMT,
				       VIEW_1.LC1_DED as YAC_LC1_DED,				       
				       VIEW_1.LC23_AMT as YAC_LC23_AMT,       
				       VIEW_1.LC23_DED as YAC_LC23_DED,						       		       
				       		       
				       VIEW_1.MRENT_DED as YAC_MRENT_DED,					       		       
				       VIEW_1.TDED_TOT as yac_tded_tot,
				       GREATEST(VIEW_1.DGG_TAX,0) as yac_dgg_tax,
				       VIEW_1.DBW_TAX as yac_dbw_tax,
				       GREATEST(VIEW_1.DJM_TAX,0) as yac_djm_tax,
				       VIEW_1.JAL_AMT as yac_jal_amt,
				       VIEW_1.JAC_AMT as YAC_JAC_AMT,
				       VIEW_1.JAN_AMT as yac_jan_amt,
				       VIEW_1.INCM_TAX as yac_incm_tax,
				       VIEW_1.CITI_TAX as yac_citi_tax,
				       VIEW_1.HIR_YMD as ems_hir_ymd,
				       VIEW_1.RET_YMD as ems_ret_ymd,
				       VIEW_1.STA_TOT as yac_sta_tot,
				       VIEW_1.NPEN_DED as yac_npen_ded,

				       VIEW_1.SEA_FREE as yac_sea_free,
				       VIEW_1.GOV_DED as yac_gov_ded,
				       VIEW_1.OTX_DED as yac_otx_ded,
				       VIEW_1.CASH_AMT as yac_cash_amt,

				       VIEW_1.REA_TAX as YAC_REA_TAX,
				       VIEW_1.REB_TAX as YAC_REB_TAX,
				       VIEW_1.REC_TAX as YAC_REC_TAX,
				       --VIEW_1.DRE_INTX as yac_dre_intx,
				       --VIEW_1.DRE_CTTX as yac_dre_cttx,
				       --VIEW_1.DRE_DFTX as yac_dre_dftx,
				       VIEW_1.HOL_YN as yac_hol_yn,
				       
				       VIEW_1.REL_CD1 as REL_CD1,
				       VIEW_1.NAM_KOR1 as NAM_KOR1,
				       VIEW_1.CET_NO1 as CET_NO1,
				       VIEW_1.BAS_MAN1 as BAS_MAN1,
				       VIEW_1.TRB_MAN1 as TRB_MAN1,
				       VIEW_1.WCT_MAN1 as WCT_MAN1,
				       VIEW_1.GOL_MAN1 as GOL_MAN1,
				       VIEW_1.ONE_MAN1 as ONE_MAN1,  
				       VIEW_1.INP_MAN1 as INP_MAN1,		
				       VIEW_1.RCH_MAN1 as RCH_MAN1,					             
				       VIEW_1.INV_NTS1 as INV_NTS1,
				       VIEW_1.INV2_NTS1 as INV2_NTS1,				       
				       VIEW_1.MED_NTS1 as MED_NTS1,
				       VIEW_1.EDU_NTS1 as EDU_NTS1,
				       VIEW_1.CARD_NTS1 as CARD_NTS1,
				       VIEW_1.DIR_CARD_NTS1 as DIR_CARD_NTS1,
				       VIEW_1.CASH_NTS1 as CASH_NTS1,
				       VIEW_1.MARKET_NTS1 as MARKET_NTS1,       
				       VIEW_1.PUBLIC_NTS1 as PUBLIC_NTS1,       
				       VIEW_1.LC3_AMT_NTS1 as LC3_AMT_NTS1,
				       VIEW_1.INV_AMT1 as INV_AMT1,
				       VIEW_1.INV2_AMT1 as INV2_AMT1,				       
				       VIEW_1.MED_AMT1 as MED_AMT1,
				       VIEW_1.EDU_AMT1 as EDU_AMT1,
				       VIEW_1.CARD_AMT1 as CARD_AMT1,
				       VIEW_1.DIR_CARD_AMT1 as DIR_CARD_AMT1,
				       VIEW_1.MARKET_AMT1 as MARKET_AMT1,       
				       VIEW_1.PUBLIC_AMT1 as PUBLIC_AMT1,       
				       VIEW_1.LC3_AMT1 as LC3_AMT1,	   
				       
				       VIEW_1.REL_CD2 as REL_CD2,
				       VIEW_1.NAM_KOR2 as NAM_KOR2,
				       VIEW_1.CET_NO2 as CET_NO2,
				       VIEW_1.BAS_MAN2 as BAS_MAN2,
				       VIEW_1.TRB_MAN2 as TRB_MAN2,
				       VIEW_1.WCT_MAN2 as WCT_MAN2,
				       VIEW_1.GOL_MAN2 as GOL_MAN2,
				       VIEW_1.ONE_MAN2 as ONE_MAN2,    
				       VIEW_1.INP_MAN2 as INP_MAN2,		
				       VIEW_1.RCH_MAN2 as RCH_MAN2,					          
				       VIEW_1.INV_NTS2 as INV_NTS2,
				       VIEW_1.INV2_NTS2 as INV2_NTS2,				       
				       VIEW_1.MED_NTS2 as MED_NTS2,
				       VIEW_1.EDU_NTS2 as EDU_NTS2,
				       VIEW_1.CARD_NTS2 as CARD_NTS2,
				       VIEW_1.DIR_CARD_NTS2 as DIR_CARD_NTS2,
				       VIEW_1.CASH_NTS2 as CASH_NTS2,
				       VIEW_1.MARKET_NTS2 as MARKET_NTS2,        
				       VIEW_1.PUBLIC_NTS2 as PUBLIC_NTS2,      
				       VIEW_1.LC3_AMT_NTS2 as LC3_AMT_NTS2,
				       VIEW_1.INV_AMT2 as INV_AMT2,
				       VIEW_1.INV2_AMT2 as INV2_AMT2,				       
				       VIEW_1.MED_AMT2 as MED_AMT2,
				       VIEW_1.EDU_AMT2 as EDU_AMT2,
				       VIEW_1.CARD_AMT2 as CARD_AMT2,
				       VIEW_1.DIR_CARD_AMT2 as DIR_CARD_AMT2,
				       VIEW_1.MARKET_AMT2 as MARKET_AMT2,             
				       VIEW_1.PUBLIC_AMT2 as PUBLIC_AMT2,       
				       VIEW_1.LC3_AMT2 as LC3_AMT2,
				       
				       VIEW_1.REL_CD3 as REL_CD3,
				       VIEW_1.NAM_KOR3 as NAM_KOR3,
				       VIEW_1.CET_NO3 as CET_NO3,
				       VIEW_1.BAS_MAN3 as BAS_MAN3,
				       VIEW_1.TRB_MAN3 as TRB_MAN3,
				       VIEW_1.WCT_MAN3 as WCT_MAN3,
				       VIEW_1.GOL_MAN3 as GOL_MAN3,
				       VIEW_1.ONE_MAN3 as ONE_MAN3,
				       VIEW_1.INP_MAN3 as INP_MAN3,		
				       VIEW_1.RCH_MAN3 as RCH_MAN3,					               
				       VIEW_1.INV_NTS3 as INV_NTS3,
				       VIEW_1.INV2_NTS3 as INV2_NTS3,				       
				       VIEW_1.MED_NTS3 as MED_NTS3,
				       VIEW_1.EDU_NTS3 as EDU_NTS3,
				       VIEW_1.CARD_NTS3 as CARD_NTS3,
				       VIEW_1.DIR_CARD_NTS3 as DIR_CARD_NTS3,
				       VIEW_1.CASH_NTS3 as CASH_NTS3,
				       VIEW_1.MARKET_NTS3 as MARKET_NTS3,          
				       VIEW_1.PUBLIC_NTS3 as PUBLIC_NTS3,        
				       VIEW_1.LC3_AMT_NTS3 as LC3_AMT_NTS3,
				       VIEW_1.INV_AMT3 as INV_AMT3,
				       VIEW_1.INV2_AMT3 as INV2_AMT3,				       
				       VIEW_1.MED_AMT3 as MED_AMT3,
				       VIEW_1.EDU_AMT3 as EDU_AMT3,
				       VIEW_1.CARD_AMT3 as CARD_AMT3,
				       VIEW_1.DIR_CARD_AMT3 as DIR_CARD_AMT3,
				       VIEW_1.MARKET_AMT3 as MARKET_AMT3,             
				       VIEW_1.PUBLIC_AMT3 as PUBLIC_AMT3,        
				       VIEW_1.LC3_AMT3 as LC3_AMT3,
				       
				       VIEW_1.REL_CD4 as REL_CD4,
				       VIEW_1.NAM_KOR4 as NAM_KOR4,
				       VIEW_1.CET_NO4 as CET_NO4,
				       VIEW_1.BAS_MAN4 as BAS_MAN4,
				       VIEW_1.TRB_MAN4 as TRB_MAN4,
				       VIEW_1.WCT_MAN4 as WCT_MAN4,
				       VIEW_1.GOL_MAN4 as GOL_MAN4,
				       VIEW_1.ONE_MAN4 as ONE_MAN4,
				       VIEW_1.INP_MAN4 as INP_MAN4,		
				       VIEW_1.RCH_MAN4 as RCH_MAN4,					               
				       VIEW_1.INV_NTS4 as INV_NTS4,
				       VIEW_1.INV2_NTS4 as INV2_NTS4,				       
				       VIEW_1.MED_NTS4 as MED_NTS4,
				       VIEW_1.EDU_NTS4 as EDU_NTS4,
				       VIEW_1.CARD_NTS4 as CARD_NTS4,
				       VIEW_1.DIR_CARD_NTS4 as DIR_CARD_NTS4,
				       VIEW_1.CASH_NTS4 as CASH_NTS4,
				       VIEW_1.MARKET_NTS4 as MARKET_NTS4,        
				       VIEW_1.PUBLIC_NTS4 as PUBLIC_NTS4,         
				       VIEW_1.LC3_AMT_NTS4 as LC3_AMT_NTS4,
				       VIEW_1.INV_AMT4 as INV_AMT4,
				       VIEW_1.INV2_AMT4 as INV2_AMT4,				       
				       VIEW_1.MED_AMT4 as MED_AMT4,
				       VIEW_1.EDU_AMT4 as EDU_AMT4,
				       VIEW_1.CARD_AMT4 as CARD_AMT4,
				       VIEW_1.DIR_CARD_AMT4 as DIR_CARD_AMT4,
				       VIEW_1.MARKET_AMT4 as MARKET_AMT4,             
				       VIEW_1.PUBLIC_AMT4 as PUBLIC_AMT4,       
				       VIEW_1.LC3_AMT4 as LC3_AMT4,
				       
				       VIEW_1.REL_CD5 as REL_CD5,
				       VIEW_1.NAM_KOR5 as NAM_KOR5,
				       VIEW_1.CET_NO5 as CET_NO5,
				       VIEW_1.BAS_MAN5 as BAS_MAN5,
				       VIEW_1.TRB_MAN5 as TRB_MAN5,
				       VIEW_1.WCT_MAN5 as WCT_MAN5,
				       VIEW_1.GOL_MAN5 as GOL_MAN5,
				       VIEW_1.ONE_MAN5 as ONE_MAN5, 
				       VIEW_1.INP_MAN5 as INP_MAN5,		
				       VIEW_1.RCH_MAN5 as RCH_MAN5,					              
				       VIEW_1.INV_NTS5 as INV_NTS5,
				       VIEW_1.INV2_NTS5 as INV2_NTS5,				       
				       VIEW_1.MED_NTS5 as MED_NTS5,
				       VIEW_1.EDU_NTS5 as EDU_NTS5,
				       VIEW_1.CARD_NTS5 as CARD_NTS5,
				       VIEW_1.DIR_CARD_NTS5 as DIR_CARD_NTS5,
				       VIEW_1.CASH_NTS5 as CASH_NTS5,
				       VIEW_1.MARKET_NTS5 as MARKET_NTS5,        
				       VIEW_1.PUBLIC_NTS5 as PUBLIC_NTS5,       
				       VIEW_1.LC3_AMT_NTS5 as LC3_AMT_NTS5,
				       VIEW_1.INV_AMT5 as INV_AMT5,
				       VIEW_1.INV2_AMT5 as INV2_AMT5,				       
				       VIEW_1.MED_AMT5 as MED_AMT5,
				       VIEW_1.EDU_AMT5 as EDU_AMT5,
				       VIEW_1.CARD_AMT5 as CARD_AMT5,
				       VIEW_1.DIR_CARD_AMT5 as DIR_CARD_AMT5,
				       VIEW_1.MARKET_AMT5 as MARKET_AMT5,             
				       VIEW_1.PUBLIC_AMT5 as PUBLIC_AMT5,       
				       VIEW_1.LC3_AMT5 as LC3_AMT5,
				       
				       VIEW_1.PEN_GUBUN_CD_1 as PEN_GUBUN_CD_1,
				       VIEW_1.ABA_CD_1 as ABA_CD_1,
				       VIEW_1.ABA_NM_1 as ABA_NM_1,
				       VIEW_1.ACC_NO_1 as ACC_NO_1,
					   VIEW_1.AMOUNT_1 as AMOUNT_1,
					   VIEW_1.DED_AMT_1 as DED_AMT_1,
					   VIEW_1.PEN_GUBUN_CD_2 as PEN_GUBUN_CD_2,
				       VIEW_1.ABA_CD_2 as ABA_CD_2,
				       VIEW_1.ABA_NM_2 as ABA_NM_2,
				       VIEW_1.ACC_NO_2 as ACC_NO_2,
					   VIEW_1.AMOUNT_2 as AMOUNT_2,
					   VIEW_1.DED_AMT_2 as DED_AMT_2,
					   VIEW_1.PEN_GUBUN_CD_3 as PEN_GUBUN_CD_3,
				       VIEW_1.ABA_CD_3 as ABA_CD_3,
				       VIEW_1.ABA_NM_3 as ABA_NM_3,
				       VIEW_1.ACC_NO_3 as ACC_NO_3,
					   VIEW_1.AMOUNT_3 as AMOUNT_3,
					   VIEW_1.DED_AMT_3 as DED_AMT_3,
					   VIEW_1.PEN_GUBUN_CD_4 as PEN_GUBUN_CD_4,
				       VIEW_1.ABA_CD_4 as ABA_CD_4,
				       VIEW_1.ABA_NM_4 as ABA_NM_4,
				       VIEW_1.ACC_NO_4 as ACC_NO_4,
					   VIEW_1.AMOUNT_4 as AMOUNT_4,
					   VIEW_1.DED_AMT_4 as DED_AMT_4,
					   VIEW_1.PEN_GUBUN_CD_5 as PEN_GUBUN_CD_5,
				       VIEW_1.ABA_CD_5 as ABA_CD_5,
				       VIEW_1.ABA_NM_5 as ABA_NM_5,
				       VIEW_1.ACC_NO_5 as ACC_NO_5,
					   VIEW_1.AMOUNT_5 as AMOUNT_5,
					   VIEW_1.DED_AMT_5 as DED_AMT_5,
					   VIEW_1.PEN_GUBUN_CD_6 as PEN_GUBUN_CD_6,
				       VIEW_1.ABA_CD_6 as ABA_CD_6,
				       VIEW_1.ABA_NM_6 as ABA_NM_6,
				       VIEW_1.ACC_NO_6 as ACC_NO_6,
					   VIEW_1.AMOUNT_6 as AMOUNT_6,
					   VIEW_1.DED_AMT_6 as DED_AMT_6,
					   VIEW_1.PEN_GUBUN_CD_7 as PEN_GUBUN_CD_7,
				       VIEW_1.ABA_CD_7 as ABA_CD_7,
				       VIEW_1.ABA_NM_7 as ABA_NM_7,
				       VIEW_1.ACC_NO_7 as ACC_NO_7,
					   VIEW_1.AMOUNT_7 as AMOUNT_7,
					   VIEW_1.DED_AMT_7 as DED_AMT_7,
					   VIEW_1.PEN_GUBUN_CD_8 as PEN_GUBUN_CD_8,
				       VIEW_1.ABA_CD_8 as ABA_CD_8,
				       VIEW_1.ABA_NM_8 as ABA_NM_8,
				       VIEW_1.ACC_NO_8 as ACC_NO_8,
					   VIEW_1.AMOUNT_8 as AMOUNT_8,
					   VIEW_1.DED_AMT_8 as DED_AMT_8,
					   VIEW_1.PEN_GUBUN_CD_9 as PEN_GUBUN_CD_9,
				       VIEW_1.ABA_CD_9 as ABA_CD_9,
				       VIEW_1.ABA_NM_9 as ABA_NM_9,
				       VIEW_1.ACC_NO_9 as ACC_NO_9,
					   VIEW_1.AMOUNT_9 as AMOUNT_9,
					   VIEW_1.DED_AMT_9 as DED_AMT_9,
					   VIEW_1.PEN_GUBUN_CD_10 as PEN_GUBUN_CD_10,
				       VIEW_1.ABA_CD_10 as ABA_CD_10,
				       VIEW_1.ABA_NM_10 as ABA_NM_10,
				       VIEW_1.ACC_NO_10 as ACC_NO_10,
					   VIEW_1.AMOUNT_10 as AMOUNT_10,
					   VIEW_1.DED_AMT_10 as DED_AMT_10,
					   VIEW_1.PEN_GUBUN_CD_11 as PEN_GUBUN_CD_11,
				       VIEW_1.ABA_CD_11 as ABA_CD_11,
				       VIEW_1.ABA_NM_11 as ABA_NM_11,
				       VIEW_1.ACC_NO_11 as ACC_NO_11,
					   VIEW_1.AMOUNT_11 as AMOUNT_11,
					   VIEW_1.DED_AMT_11 as DED_AMT_11,
					   VIEW_1.PEN_GUBUN_CD_12 as PEN_GUBUN_CD_12,
				       VIEW_1.ABA_CD_12 as ABA_CD_12,
				       VIEW_1.ABA_NM_12 as ABA_NM_12,
				       VIEW_1.ACC_NO_12 as ACC_NO_12,
					   VIEW_1.AMOUNT_12 as AMOUNT_12,
					   VIEW_1.DED_AMT_12 as DED_AMT_12,
					   VIEW_1.PEN_GUBUN_CD_13 as PEN_GUBUN_CD_13,
				       VIEW_1.ABA_CD_13 as ABA_CD_13,
				       VIEW_1.ABA_NM_13 as ABA_NM_13,
				       VIEW_1.ACC_NO_13 as ACC_NO_13,
					   VIEW_1.AMOUNT_13 as AMOUNT_13,
					   VIEW_1.DED_AMT_13 as DED_AMT_13,
					   VIEW_1.PEN_GUBUN_CD_14 as PEN_GUBUN_CD_14,
				       VIEW_1.ABA_CD_14 as ABA_CD_14,
				       VIEW_1.ABA_NM_14 as ABA_NM_14,
				       VIEW_1.ACC_NO_14 as ACC_NO_14,
					   VIEW_1.AMOUNT_14 as AMOUNT_14,
					   VIEW_1.DED_AMT_14 as DED_AMT_14,
					   VIEW_1.PEN_GUBUN_CD_15 as PEN_GUBUN_CD_15,
				       VIEW_1.ABA_CD_15 as ABA_CD_15,
				       VIEW_1.ABA_NM_15 as ABA_NM_15,
				       VIEW_1.ACC_NO_15 as ACC_NO_15,
					   VIEW_1.AMOUNT_15 as AMOUNT_15,
					   VIEW_1.DED_AMT_15 as DED_AMT_15
				 FROM
				 (SELECT YAC.ENO_NO||'C'||YAC.PIS_YY||YAC.PIS_MM SEL_KEY,
				         'C' REC_TAG,
		                 '20227' TAX_CD,
		                 '2218113834' COMP_CD,
		                 EMS.NAM_KOR,
				         EMS.CET_NO,
		                 EMS.ZIP_NO,
		                 EMS.JUSO,
		                 NVL(YAB.CNT,0) CNT,
		                 '' JAS_NM,
				         '' JAO_NO,
				         YAC.TAX_INCOME SALT_AMTS,
				         YAC.TAX_INCOME SALT_AMTT,
				         YAC.FREE_INCOME + NVL(YAB.JAG_AMT,0) FREE_INCOME,
				         YAC.TAX_INCOME + YAC.YAB_INCOME TAX_INCOME,
				         YAC.INJUNG_AMT OUTT_AMTS,
				         YAC.MGR_AMT,
				         YAC.MNI_AMT,
		                 YAC.BADD_AMT,
				         YAC.SOU_CNT,
		                 YAC.SPSB_AMT,
		                 YAC.DFM_CNT,
		                 YAC.GDED_AMT,
		                 YAC.GOL_CNT,
		                 YAC.GOL_AMT,

				         YAC.TRB_CNT,
		                 YAC.TBL_DED,
		                 YAC.WDD_AMT,
				         YAC.ONE_AMT,
				         
				         --DECODE(NVL(YAC.NSE_TOT,0), 0, 0, YAC.HINU_AMT+NVL(YAB.JAH_AMT,0)) HINU_AMT,
				         --DECODE(NVL(YAC.NSE_TOT,0), 0, 0, YAC.HINS_AMT+NVL(YAB.JAP_AMT,0)) HINS_AMT,
				         
				         --YAC.HINU_DED+NVL(YAB.JAH_AMT,0) HINU_AMT,
				         --YAC.HINS_DED+NVL(YAB.JAP_AMT,0) HINS_AMT,				         

				         YAC.HINU_DED HINU_AMT,
				         YAC.HINS_DED HINS_AMT,	
				         				         
		                 --LEAST(YAC.LH1_AMT,3000000) LH1_AMT,
		                 --LEAST(YAC.LH2_AMT,3000000) LH2_AMT,
		                 --LEAST(YAC.LH3_AMT,7500000) LH3_AMT,
		                 --LEAST(YAC.LH4_AMT,6000000) LH4_AMT,		                 
		                 --LEAST(YAC.LH5_AMT,10000000) LH5_AMT,
		                 --LEAST(YAC.LH6_AMT,15000000) LH6_AMT,
		                 --LEAST(YAC.LH7_AMT,15000000) LH7_AMT,
		                 --LEAST(YAC.LH7_AMT,5000000) LH8_AMT,	
		                 
		                 NVL(YAC.LOAN_DED,0) AS LH1_AMT,
		                 NVL(YAC.PLOAN_DED,0) AS LH2_AMT,
		                 NVL(YAC.LH3_AMT,0) AS LH3_AMT,
		                 
				         NVL(LONG1.LONG_DED,0) AS LH4_AMT,         
				         NVL(LONG2.LONG_DED,0) AS LH5_AMT,
				         NVL(LONG3.LONG_DED,0) AS LH6_AMT,
				         NVL(LONG4.LONG_DED,0) AS LH7_AMT,
				         NVL(LONG5.LONG_DED,0) AS LH8_AMT,		                 
		                 
		                 YAC.DON_FWD,	
		                 YAC.PER_DED,		

				         YAC.CPC_DED,
				         YAC.NSE_TOT,
		                 YAC.INDED_TOT,
				         NVL(YAC.CARD_DED,0) CARD_DED, 
				         YAC.SAVE_DED, 
		                 YAC.SAVE1_DED, 
		                 YAC.SAVE2_DED, 
		                 YAC.SAVE3_DED, 
		                 YAC.SAJU_AMT, 
		                 YAC.LSS_DED, 		   
		                 NVL(YAC.PER_DED,0) + NVL(YAC.SAVE1_DED,0) + NVL(YAC.SAVE2_DED,0) + NVL(YAC.SAVE3_DED,0) + NVL(YAC.CARD_DED,0) + NVL(YAC.SAJU_AMT,0) + NVL(YAC.LSS_DED,0) ETC_TOT,		                               
				         NVL(YAC.VEN_DED,0) VEN_DED,
				         YAC.TTAX_STD ,
		                 YAC.TAX_AMT,
		                 YAC.HGR_DED,
		                 YAC.CHI_CNT,	
		                 YAC.AGE_AMT,
		                 YAC.CHI_RCH,	
		                 YAC.AGE_RCH,
		                 YAC.CHI_INP,	
		                 YAC.AGE_INP,		                 
               
		                 LEAST(YAC.ANN_AMT,4000000) ANN_AMT, 		                 
		                 NVL(YAC.ANN_DED,0) ANN_DED, 	    
		                 LEAST(YAC.LIN_AMT,1000000) LIN_AMT,			                 
		                 NVL(YAC.MIN_DED,0) MIN_DED,			
		                            
		                 NVL(YAC.MHEA_AMT,0) + NVL(YAC.OHEA_AMT,0) + NVL(YAC.HAN_AMT,0) MMA_AMT,	
		                 NVL(YAC.MMA_DED,0) MMA_DED,	
		                 NVL(YAC.GRA_AMT,0) + NVL(YAC.HED_AMT,0) + NVL(YAC.EDU_AMT1,0) + NVL(YAC.EDU_AMT2,0) + NVL(YAC.EDU_AMT3,0) + NVL(YAC.EDU_AMT4,0) + NVL(YAC.EDU_AMT5,0) EDU_AMT,			                 		          
		                 NVL(YAC.EDU_DED,0) EDU_DED,	
		                 		              
		                 0 GOV1_AMT,			                 		                 
		                 NVL(YAC.GOV_DED,0) GOV1_DED,
		                 GREATEST((NVL(YAC.GOV_NTS,0) + NVL(YAC.GOV_AMT,0) - 100000 ),0)  GOV2_AMT,			                 		                 
		                 NVL(YAC.GOV2_DED,0) GOV2_DED,				                 		              
		                 		              		                 
		                 NVL(YAC.LC1_NTS,0) + NVL(YAC.LC1_AMT,0) LC1_AMT,			                 		                 
		                 NVL(YAC.LC1_DED,0) LC1_DED,
		                 NVL(YAC.LC2_NTS,0) + NVL(YAC.LC2_AMT,0) + NVL(YAC.LC3_NTS,0) + NVL(YAC.LC3_AMT,0) LC23_AMT,			                 		                 
		                 NVL(YAC.LC23_DED,0) LC23_DED,		                 
 
		                 NVL(YAC.MRENT_DED,0) MRENT_DED,
		                                  		                 
				         YAC.TDED_TOT,
		                 YAC.DGG_TAX,
		                 YAC.DBW_TAX,
		                 YAC.DJM_TAX,
				         NVL(YAB.JAL_AMT,0) JAL_AMT,
				         NVL(YAB.JAC_AMT,0) JAC_AMT,				         
		                 NVL(YAB.JAN_AMT,0) JAN_AMT,
				         YAC.INCM_TAX,
		                 YAC.CITI_TAX,
				         EMS.HIR_YMD HIR_YMD, 
		                 EMS.RET_YMD RET_YMD,
		                 
		                 DECODE(NVL(YAC.VEN_DED,0) + NVL(YAC.NSE_TOT,0) + NVL(YAC.MRENT_DED,0), 0, NVL(YAC.STA_TOT,0)) STA_TOT,
		                 
				         --NVL(YAC.STA_TOT,0) STA_TOT, 
		                 
		                 
		                 
		                 NVL(YAC.NPEN_DED,0) NPEN_DED,
				         
				         YAC.SEA_FREE SEA_FREE,  
		                 YAC.GOV_DED GOV_DED, 
		                 YAC.OTX_DED, 
				         YAC.CASH_AMT CASH_AMT, 

				         --YAC.DRE_INTX, 
		                 --YAC.DRE_CTTX, 
		                 --YAC.DRE_DFTX, 
				         YAC.REA_TAX, 
		                 YAC.REB_TAX, 
		                 YAC.REC_TAX, 
		                 DECODE(YAC.HOL_YN,'Y','1','2') HOL_YN,
				         '' REL_CD1,  '' NAM_KOR1, '' CET_NO1,
				         '' BAS_MAN1, '' TRB_MAN1,  '' WCT_MAN1,  '' GOL_MAN1,   '' ONE_MAN1, '' INP_MAN1, '' RCH_MAN1,
				         '' INV_NTS1, '' INV2_NTS1, '' MED_NTS1, '' EDU_NTS1, '' CARD_NTS1, '' DIR_CARD_NTS1,'' CASH_NTS1, '' MARKET_NTS1, '' PUBLIC_NTS1,'' LC3_AMT_NTS1,
				         '' INV_AMT1, '' INV2_AMT1, '' MED_AMT1, '' EDU_AMT1, '' CARD_AMT1, '' DIR_CARD_AMT1, '' MARKET_AMT1, '' PUBLIC_AMT1,'' LC3_AMT1,
				         '' REL_CD2,  '' NAM_KOR2, '' CET_NO2,
				         '' BAS_MAN2, '' TRB_MAN2,  '' WCT_MAN2,  '' GOL_MAN2,  '' ONE_MAN2, '' INP_MAN2, '' RCH_MAN2,
				         '' INV_NTS2, '' INV2_NTS2, '' MED_NTS2, '' EDU_NTS2, '' CARD_NTS2, '' DIR_CARD_NTS2,'' CASH_NTS2, '' MARKET_NTS2, '' PUBLIC_NTS2,'' LC3_AMT_NTS2,
				         '' INV_AMT2, '' INV2_AMT2, '' MED_AMT2, '' EDU_AMT2, '' CARD_AMT2, '' DIR_CARD_AMT2, '' MARKET_AMT2, '' PUBLIC_AMT2,'' LC3_AMT2,
				         '' REL_CD3,  '' NAM_KOR3, '' CET_NO3,
				         '' BAS_MAN3, '' TRB_MAN3,  '' WCT_MAN3,  '' GOL_MAN3,   '' ONE_MAN3, '' INP_MAN3, '' RCH_MAN3,
				         '' INV_NTS3, '' INV2_NTS3, '' MED_NTS3, '' EDU_NTS3, '' CARD_NTS3, '' DIR_CARD_NTS3,'' CASH_NTS3, '' MARKET_NTS3, '' PUBLIC_NTS3,'' LC3_AMT_NTS3,
				         '' INV_AMT3, '' INV2_AMT3, '' MED_AMT3, '' EDU_AMT3, '' CARD_AMT3, '' DIR_CARD_AMT3, '' MARKET_AMT3, '' PUBLIC_AMT3,'' LC3_AMT3,
				         '' REL_CD4,  '' NAM_KOR4, '' CET_NO4,
				         '' BAS_MAN4, '' TRB_MAN4,  '' WCT_MAN4,  '' GOL_MAN4,   '' ONE_MAN4, '' INP_MAN4, '' RCH_MAN4,
				         '' INV_NTS4, '' INV2_NTS4, '' MED_NTS4, '' EDU_NTS4, '' CARD_NTS4, '' DIR_CARD_NTS4,'' CASH_NTS4, '' MARKET_NTS4, '' PUBLIC_NTS4,'' LC3_AMT_NTS4,
				         '' INV_AMT4, '' INV2_AMT4, '' MED_AMT4, '' EDU_AMT4, '' CARD_AMT4, '' DIR_CARD_AMT4, '' MARKET_AMT4, '' PUBLIC_AMT4,'' LC3_AMT4,
				         '' REL_CD5,  '' NAM_KOR5, '' CET_NO5,
				         '' BAS_MAN5, '' TRB_MAN5,  '' WCT_MAN5,  '' GOL_MAN5,  '' ONE_MAN5, '' INP_MAN5, '' RCH_MAN5,
				         '' INV_NTS5, '' INV2_NTS5, '' MED_NTS5, '' EDU_NTS5, '' CARD_NTS5, '' DIR_CARD_NTS5,'' CASH_NTS5, '' MARKET_NTS5, '' PUBLIC_NTS5,'' LC3_AMT_NTS5,
				         '' INV_AMT5, '' INV2_AMT5, '' MED_AMT5, '' EDU_AMT5, '' CARD_AMT5, '' DIR_CARD_AMT5, '' MARKET_AMT5, '' PUBLIC_AMT5,'' LC3_AMT5,
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				    FROM ASNHR.T_AC_RETACC_142 YAC,
				         (SELECT ENO_NO, ENO_NM AS NAM_KOR,
				                 SUBSTR(CET_NO,1,6)||SUBSTR(CET_NO,8,7) CET_NO,
				                 ZIP_NO,ADR_CT||' '||ADDRESS JUSO,
				                 GREATEST(NVL(TO_CHAR(HIR_YMD,'YYYYMMDD'),' '),'20140101') HIR_YMD,
				                 LEAST(NVL(TO_CHAR(RET_YMD,'YYYYMMDD'),'20141231'),'20141231') RET_YMD
				          FROM ASNHR.T_CM_PERSON ) EMS,
				         (SELECT ENO_NO,COUNT(*) CNT,
				            SUM(NVL(JAC_AMT,0)) JAC_AMT,				         
				            SUM(NVL(JAL_AMT,0)) JAL_AMT, 
                   			SUM(NVL(JAN_AMT,0)) JAN_AMT,
				            SUM(NVL(JAG_AMT,0)) JAG_AMT,
				            SUM(NVL(JAH_AMT,0)) JAH_AMT,
				            SUM(NVL(JAP_AMT,0)) JAP_AMT
				            FROM ASNHR.T_AC_DUTYPLACE
				           WHERE (PIS_YY = '2014')
				          GROUP BY ENO_NO) YAB,       
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_142 WHERE PIS_YY = '2014' AND LH4_AMT != '0')  LONG1,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_142 WHERE PIS_YY = '2014' AND LH5_AMT != '0')  LONG2,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_142 WHERE PIS_YY = '2014' AND LH6_AMT != '0')  LONG3,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_142 WHERE PIS_YY = '2014' AND LH7_AMT != '0')  LONG4,
						(SELECT ENO_NO,LONG_DED FROM ASNHR.T_AC_RETACC_142 WHERE PIS_YY = '2014' AND LH8_AMT != '0')  LONG5     				          
				 WHERE YAC.PIS_YY = '2014'
				   AND YAC.GBN_TAG = '8'
				   AND YAC.ENO_NO  = EMS.ENO_NO
				   AND YAC.ENO_NO  = YAB.ENO_NO (+)
				   AND YAC.ENO_NO  = LONG1.ENO_NO(+)   
				   AND YAC.ENO_NO  = LONG2.ENO_NO(+)
				   AND YAC.ENO_NO  = LONG3.ENO_NO(+)   
				   AND YAC.ENO_NO  = LONG4.ENO_NO(+)   
				   AND YAC.ENO_NO  = LONG5.ENO_NO(+)    
                   AND EMS.ENO_NO IN (
										'1990033','1990040','1990041','1990044','1990089','1990104','1990105',
										'2000023','2010005','2010012','2020005','2020008','2020009','2020011','2020013','2020016','2020025','2020030',
										'2030002','2030005','2030007','2030009',
										'2040001','2040006','2040012','2040013','2040020','2040023','2040024','2040025','2040038','2040042',
										'2040046','2040066','2040067','2040068','2040070','2040071','2040076','2040078','2040080','2040081',
										'2050004','2050009','2050010','2050012','2050013','2050014','2050015','2050017','2050019','2050022','2050023','2050026',
										'2050029','2050030','2050032','2050033','2050036','2050039','2050042','2050046','2050050','2050053','2050056','2050060','2050063',
										'2060004','2060005','2060007','2060009','2060017','2060024','2060026','2060027',
										'2070007','2070016','2070018','2070019','2070021','2070026','2070027','2070030','2070039','2070043',
										'2080003','2080007','2080009','2080012','2080018','2080019','2080021','2080025','2080028','2080031','2080033','2080046',
										'2090002','2090011','2100002','2100003','2100004','2100007','2100016',
										'2110003','2110005','2110007','2110013','2110014','2110016','2110017',
										'2120003','2120007','2120008','2120026','2120029','2120030','2120032','2120033',
										'2130003','2130004','2130005','2130006','2130008','2130010','2130012','2130013','2130015','2130019','2130020','2130021','2130025',
										'2130026','2130027','2130028','2130030','2130033','2130035','2130037','2130039','2130041','2130043','2130045',
										'2140001','2140003','2140004','2140007','2140008','2140009','2140010','2140011','2140012','2140013','2140014','2140015',
										'2140018','2140019','2140021','2140022','2140023','2140025','2140027','2140028','2140032','2140033','2140034',
										'3110012','3120014','3120023','3130008','3130009','3130013','3140010','3140017','3140026'      
										)				
				 UNION
				
				 SELECT x.ENO_NO||'D'||PIS_YY||PIS_MM SEL_KEY,
				        'D' REC_TAG,
                		'20227' TAX_CD,
                		'2218113834' COMP_CD,
                		'' NAM_KOR,
    				    EMS.CET_NO CET_NO,
                		'' ZIP_NO,
                		'' JUSO,
		                0 CNT,
		                JAS_NM,
		                JAO_NO,
    				    JAA_AMT + JAB_AMT SALT_AMTS, 
                		JAA_AMT + JAB_AMT + JAC_AMT + JAD_AMT + JAI_AMT SALT_AMTT,
	                    0 FREE_INCOME,
	                    0 TAX_INCOME,
		                0 OUTT_AMTS,				         
		                0 MGR_AMT,
		                0 MNI_AMT,
		                0 BADD_AMT,
		                '' SOU_CNT,
		                0 SPSB_AMT,
		                '' DFM_CNT,
	                    0 GDED_AMT, 
		                '' GOL_CNT, 
		                0 GOL_AMT, 
	                    '' TRB_CNT,
		                0 TBL_DED,
		                0 WDD_AMT,
                		0 ONE_AMT,                		
		                0 HINU_AMT,
		                0 HINS_AMT,
		                0 LH1_AMT, 
		                0 LH2_AMT,
		                0 LH3_AMT, 
	                    0 LH4_AMT, 
		                0 LH5_AMT, 
		                0 LH6_AMT, 
		                0 LH7_AMT, 
		                0 LH8_AMT,
		                0 DON_FWD,	
		                0 PER_DED,			                	                
	                    0 CPC_DED,
		                0 NSE_TOT,
		                0 INDED_TOT,
	                    0 CARD_DED, 
		                0 SAVE_DED, 
		                0 SAVE1_DED, 
		                0 SAVE2_DED, 
		                0 SAVE3_DED,  
		                0 SAJU_AMT, 
		                0 LSS_AMT,  
		                0 ETC_TOT, 		                		                
		                0 VEN_DED,
	                    0 TTAX_STD, 
		                0 TAX_AMT,  
		                0 HGR_DED,   
		                '0' CHI_CNT,  
		                0 AGE_AMT, 
		                '0' CHI_RCH, 
		                0 AGE_RCH, 
		                '0' CHI_INP, 
		                0 AGE_INP,               		                
	                    0 ANN_AMT, 
		                0 ANN_DED,  
		                0 LIN_AMT,   
		                0 MIN_DED,
	                    0 MMA_AMT,
		                0 MMA_DED,
	                    0 EDU_AMT,
		                0 EDU_DED, 
	                    0 GOV1_AMT,  		                
	                    0 GOV1_DED,		
	                    0 GOV2_AMT,  		                
	                    0 GOV2_DED,		                    
	                    0 LC1_AMT,  		                
	                    0 LC1_DED,		
	                    0 LC23_AMT,  		                
	                    0 LC23_DED,		
		                0 MRENT_DED,	                                                                        
	                    0 TDED_TOT,  
		                0 DGG_TAX,
		                0 DBW_TAX,
	                    0 DJM_TAX,
		                0 JAL_AMT,
		                0 JAC_AMT,
		                0 JAN_AMT,
		                JAL_AMT INCM_TAX,
		                JAN_AMT CITI_TAX,
	                    GREATEST(HIR_YMD,'20140101') HIR_YMD,
	                    LEAST(RET_YMD,'20141231') RET_YMD,
	                    0 STA_TOT, 
		                0 NPEN_DED, 
	                    0 SEA_FREE,  
		                0 GOV_DED, 
		                0 OTX_DED, 
	                    0 CASH_AMT, 
		                0 REA_TAX, 
		                0 REB_TAX, 
		                0 REC_TAX, 
		                '2' HOL_YN,
				         '' REL_CD1,  '' NAM_KOR1, '' CET_NO1,
				         '' BAS_MAN1, '' TRB_MAN1, '' WCT_MAN1,  '' GOL_MAN1,   '' ONE_MAN1, '' INP_MAN1, '' RCH_MAN1,
				         '' INV_NTS1, '' INV2_NTS1, '' MED_NTS1, '' EDU_NTS1, '' CARD_NTS1, '' DIR_CARD_NTS1,'' CASH_NTS1, '' MARKET_NTS1, '' PUBLIC_NTS1,'' LC3_AMT_NTS1,
				         '' INV_AMT1, '' INV2_AMT1, '' MED_AMT1, '' EDU_AMT1, '' CARD_AMT1, '' DIR_CARD_AMT1, '' MARKET_AMT1, '' PUBLIC_AMT1,'' LC3_AMT1,
				         '' REL_CD2,  '' NAM_KOR2, '' CET_NO2,
				         '' BAS_MAN2, '' TRB_MAN2,  '' WCT_MAN2,  '' GOL_MAN2,  '' ONE_MAN2, '' INP_MAN2, '' RCH_MAN2,
				         '' INV_NTS2, '' INV2_NTS2, '' MED_NTS2, '' EDU_NTS2, '' CARD_NTS2, '' DIR_CARD_NTS2,'' CASH_NTS2, '' MARKET_NTS2, '' PUBLIC_NTS2,'' LC3_AMT_NTS2,
				         '' INV_AMT2, '' INV2_AMT2, '' MED_AMT2, '' EDU_AMT2, '' CARD_AMT2, '' DIR_CARD_AMT2, '' MARKET_AMT2, '' PUBLIC_AMT2,'' LC3_AMT2,
				         '' REL_CD3,  '' NAM_KOR3, '' CET_NO3,
				         '' BAS_MAN3, '' TRB_MAN3,  '' WCT_MAN3,  '' GOL_MAN3,  '' ONE_MAN3, '' INP_MAN3, '' RCH_MAN3,
				         '' INV_NTS3, '' INV2_NTS3, '' MED_NTS3, '' EDU_NTS3, '' CARD_NTS3, '' DIR_CARD_NTS3,'' CASH_NTS3, '' MARKET_NTS3, '' PUBLIC_NTS3,'' LC3_AMT_NTS3,
				         '' INV_AMT3, '' INV2_AMT3, '' MED_AMT3, '' EDU_AMT3, '' CARD_AMT3, '' DIR_CARD_AMT3, '' MARKET_AMT3, '' PUBLIC_AMT3,'' LC3_AMT3,
				         '' REL_CD4,  '' NAM_KOR4, '' CET_NO4,
				         '' BAS_MAN4, '' TRB_MAN4,  '' WCT_MAN4,  '' GOL_MAN4,  '' ONE_MAN4, '' INP_MAN4, '' RCH_MAN4,
				         '' INV_NTS4, '' INV2_NTS4, '' MED_NTS4, '' EDU_NTS4, '' CARD_NTS4, '' DIR_CARD_NTS4,'' CASH_NTS4, '' MARKET_NTS4, '' PUBLIC_NTS4,'' LC3_AMT_NTS4,
				         '' INV_AMT4, '' INV2_AMT4, '' MED_AMT4, '' EDU_AMT4, '' CARD_AMT4, '' DIR_CARD_AMT4, '' MARKET_AMT4, '' PUBLIC_AMT4,'' LC3_AMT4,
				         '' REL_CD5,  '' NAM_KOR5, '' CET_NO5,
				         '' BAS_MAN5, '' TRB_MAN5,  '' WCT_MAN5,  '' GOL_MAN5,  '' ONE_MAN5, '' INP_MAN5, '' RCH_MAN5,
				         '' INV_NTS5, '' INV2_NTS5, '' MED_NTS5, '' EDU_NTS5, '' CARD_NTS5, '' DIR_CARD_NTS5,'' CASH_NTS5, '' MARKET_NTS5, '' PUBLIC_NTS5,'' LC3_AMT_NTS5,
				         '' INV_AMT5, '' INV2_AMT5, '' MED_AMT5, '' EDU_AMT5, '' CARD_AMT5, '' DIR_CARD_AMT5, '' MARKET_AMT5, '' PUBLIC_AMT5,'' LC3_AMT5,
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				   FROM ASNHR.T_AC_DUTYPLACE x,
				 (SELECT ENO_NO,ENO_NM AS NAM_KOR,
				         SUBSTR(CET_NO,1,6)||SUBSTR(CET_NO,8,7) CET_NO,
				         ZIP_NO,ADR_CT||ADDRESS JUSO
				    FROM ASNHR.T_CM_PERSON ) EMS
				   WHERE PIS_YY = '2014'
				     AND x.ENO_NO = EMS.ENO_NO
                     AND EMS.ENO_NO IN (
										'1990033','1990040','1990041','1990044','1990089','1990104','1990105',
										'2000023','2010005','2010012','2020005','2020008','2020009','2020011','2020013','2020016','2020025','2020030',
										'2030002','2030005','2030007','2030009',
										'2040001','2040006','2040012','2040013','2040020','2040023','2040024','2040025','2040038','2040042',
										'2040046','2040066','2040067','2040068','2040070','2040071','2040076','2040078','2040080','2040081',
										'2050004','2050009','2050010','2050012','2050013','2050014','2050015','2050017','2050019','2050022','2050023','2050026',
										'2050029','2050030','2050032','2050033','2050036','2050039','2050042','2050046','2050050','2050053','2050056','2050060','2050063',
										'2060004','2060005','2060007','2060009','2060017','2060024','2060026','2060027',
										'2070007','2070016','2070018','2070019','2070021','2070026','2070027','2070030','2070039','2070043',
										'2080003','2080007','2080009','2080012','2080018','2080019','2080021','2080025','2080028','2080031','2080033','2080046',
										'2090002','2090011','2100002','2100003','2100004','2100007','2100016',
										'2110003','2110005','2110007','2110013','2110014','2110016','2110017',
										'2120003','2120007','2120008','2120026','2120029','2120030','2120032','2120033',
										'2130003','2130004','2130005','2130006','2130008','2130010','2130012','2130013','2130015','2130019','2130020','2130021','2130025',
										'2130026','2130027','2130028','2130030','2130033','2130035','2130037','2130039','2130041','2130043','2130045',
										'2140001','2140003','2140004','2140007','2140008','2140009','2140010','2140011','2140012','2140013','2140014','2140015',
										'2140018','2140019','2140021','2140022','2140023','2140025','2140027','2140028','2140032','2140033','2140034',
										'3110012','3120014','3120023','3130008','3130009','3130013','3140010','3140017','3140026'      
										)					
				 UNION

				 SELECT a.ENO_NO||'E1'||B.PIS_YY||'12', 'E', '20227', '2218113834', '',
				        B.CET_NO,
		                '','',0,'','',0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,'0',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,0,0,0,0,0,0,0,0,0,0,0,0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,'','',0,0,0,0,0,0,0,0,0,'2',
				        B.REL_CD,  
		                B.NAM_KOR, 
		                B.CET_NO,  
		                B.BAS_MAN,  
		                B.TRB_MAN, 
		                B.WCT_MAN, 
		                B.GOL_MAN, 
		                B.ONE_MAN,
		                B.INP_MAN,		
		                B.RCH_MAN,		                                
				        NVL(B.INV_NTS,'0'), 
				        NVL(B.INV2_NTS,'0'), 				        
		                NVL(B.MED_NTS,'0'), 
		                NVL(B.EDU_NTS,'0'),
				        NVL(B.CARD_NTS,'0'),
		                NVL(B.DIR_CARD_NTS,'0'), 
		                NVL(B.CASH_NTS,'0'),  
		                NVL(B.MARKET_NTS,'0'), 
		                NVL(B.PUBLIC_NTS,'0'), 
		                NVL(B.LC3_AMT_NTS,'0'),
				        NVL(B.INV_AMT,'0'), 
				        NVL(B.INV2_AMT,'0'), 				        
		                NVL(B.MED_AMT,'0'), 
		                NVL(B.EDU_AMT,'0'),
				        NVL(B.CARD_AMT,'0'),
		                NVL(B.DIR_CARD_AMT,'0'), 
		                NVL(B.MARKET_AMT,'0'), 
		                NVL(B.PUBLIC_AMT,'0'), 
		                NVL(B.LC3_AMT,'0'),
				        C.REL_CD,  
		                C.NAM_KOR, 
		                C.CET_NO,  
		                C.BAS_MAN,  
		                C.TRB_MAN, 
		                C.WCT_MAN, 
		                C.GOL_MAN, 
		                C.ONE_MAN,
		                C.INP_MAN,		
		                C.RCH_MAN,		                
				        NVL(C.INV_NTS,'0'), 
				        NVL(C.INV2_NTS,'0'), 				        
		                NVL(C.MED_NTS,'0'), 
		                NVL(C.EDU_NTS,'0'),
				        NVL(C.CARD_NTS,'0'),
		                NVL(C.DIR_CARD_NTS,'0'), 
		                NVL(C.CASH_NTS,'0'), 
		                NVL(C.MARKET_NTS,'0'), 
		                NVL(C.PUBLIC_NTS,'0'), 
		                NVL(C.LC3_AMT_NTS,'0'),
				        NVL(C.INV_AMT,'0'), 
				        NVL(C.INV2_AMT,'0'), 				        
		                NVL(C.MED_AMT,'0'), 
		                NVL(C.EDU_AMT,'0'),
				        NVL(C.CARD_AMT,'0'),
		                NVL(C.DIR_CARD_AMT,'0'), 
		                NVL(C.MARKET_AMT,'0'), 
		                NVL(C.PUBLIC_AMT,'0'), 
		                NVL(C.LC3_AMT,'0'),
				        D.REL_CD,  
		                D.NAM_KOR, 
		                D.CET_NO,  
		                D.BAS_MAN,  
		                D.TRB_MAN, 
		                D.WCT_MAN, 
		                D.GOL_MAN, 
		                D.ONE_MAN,
		                D.INP_MAN,		
		                D.RCH_MAN,		                
				        NVL(D.INV_NTS,'0'), 
				        NVL(D.INV2_NTS,'0'), 				        
		                NVL(D.MED_NTS,'0'), 
		                NVL(D.EDU_NTS,'0'),
				        NVL(D.CARD_NTS,'0'),
		                NVL(D.DIR_CARD_NTS,'0'), 
		                NVL(D.CASH_NTS,'0'), 
		                NVL(D.MARKET_NTS,'0'), 
		                NVL(D.PUBLIC_NTS,'0'), 
		                NVL(D.LC3_AMT_NTS,'0'),
				        NVL(D.INV_AMT,'0'), 
				        NVL(D.INV2_AMT,'0'), 				        
		                NVL(D.MED_AMT,'0'), 
		                NVL(D.EDU_AMT,'0'),
				        NVL(D.CARD_AMT,'0'),
		                NVL(D.DIR_CARD_AMT,'0'),  
		                NVL(D.MARKET_AMT,'0'), 
		                NVL(D.PUBLIC_AMT,'0'), 
		                NVL(D.LC3_AMT,'0'),
				        E.REL_CD,  
		                E.NAM_KOR, 
		                E.CET_NO,  
		                E.BAS_MAN,  
		                E.TRB_MAN,  
		                E.WCT_MAN, 
		                E.GOL_MAN, 
		                E.ONE_MAN,
		                E.INP_MAN,		
		                E.RCH_MAN,		                
				        NVL(E.INV_NTS,'0'), 
				        NVL(E.INV2_NTS,'0'), 				        
		                NVL(E.MED_NTS,'0'), 
		                NVL(E.EDU_NTS,'0'),
				        NVL(E.CARD_NTS,'0'),
		                NVL(E.DIR_CARD_NTS,'0'), 
		                NVL(E.CASH_NTS,'0'), 
		                NVL(E.MARKET_NTS,'0'), 
		                NVL(E.PUBLIC_NTS,'0'), 
		                NVL(E.LC3_AMT_NTS,'0'),
				        NVL(E.INV_AMT,'0'), 
				        NVL(E.INV2_AMT,'0'), 				        
		                NVL(E.MED_AMT,'0'), 
		                NVL(E.EDU_AMT,'0'),
				        NVL(E.CARD_AMT,'0'),
		                NVL(E.DIR_CARD_AMT,'0'),  
		                NVL(E.MARKET_AMT,'0'), 
		                NVL(E.PUBLIC_AMT,'0'), 
		                NVL(E.LC3_AMT,'0'),
				        F.REL_CD,  
		                F.NAM_KOR, 
		                F.CET_NO,  
		                F.BAS_MAN,  
		                F.TRB_MAN,  
		                F.WCT_MAN, 
		                F.GOL_MAN, 
		                F.ONE_MAN,
		                F.INP_MAN,		
		                F.RCH_MAN,		                
				        NVL(F.INV_NTS,'0'), 
				        NVL(F.INV2_NTS,'0'), 				        
		                NVL(F.MED_NTS,'0'), 
		                NVL(F.EDU_NTS,'0'),
				        NVL(F.CARD_NTS,'0'),
		                NVL(F.DIR_CARD_NTS,'0'), 
		                NVL(F.CASH_NTS,'0'), 
		                NVL(F.MARKET_NTS,'0'), 
		                NVL(F.PUBLIC_NTS,'0'), 
		                NVL(F.LC3_AMT_NTS,'0'),
				        NVL(F.INV_AMT,'0'), 
				        NVL(F.INV2_AMT,'0'), 				        
		                NVL(F.MED_AMT,'0'), 
		                NVL(F.EDU_AMT,'0'),
				        NVL(F.CARD_AMT,'0'),
		                NVL(F.DIR_CARD_AMT,'0'),  
		                NVL(F.MARKET_AMT,'0'), 
		                NVL(F.PUBLIC_AMT,'0'), 
		                NVL(F.LC3_AMT,'0'),
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				
				FROM (SELECT ENO_NO
				        FROM ASNHR.T_AC_FAMILY_142
				       WHERE PIS_YY = '2014'
				    GROUP BY ENO_NO) A,
				     (SELECT A.ENO_NO ENO_NO, A.REL_CD, REPLACE(A.NAM_KOR,' ','') NAM_KOR, A.CET_NO, A.PIS_YY PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,   
				             DECODE(INP_MAN,'O','1','') INP_MAN, 
				             DECODE(RCH_MAN,'O','1','') RCH_MAN, 				             				                         
				             '0' INV_NTS,				             
				             TO_CHAR(NVL(A.LIN_AMT_NTS,0) + NVL(A.LIH_AMT_NTS,0)) INV2_NTS,
				             TO_CHAR(NVL(A.MED_AMT_NTS,0) + NVL(A.LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(A.EDU_AMT_NTS,0) + NVL(A.HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(A.CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(A.DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(A.CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(A.MARKET_AMT_NTS,0)) MARKET_NTS,  
				             TO_CHAR(NVL(A.PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                             
				             TO_CHAR(NVL(B.HINU_AMT,0) + NVL(B.HINS_AMT,0) + NVL(C.JAH_AMT,0) + NVL(C.JAP_AMT,0)) INV_AMT,
				             TO_CHAR(NVL(A.LIN_AMT,0) + NVL(A.LIH_AMT,0)) INV2_AMT,				             
				             TO_CHAR(NVL(A.MED_AMT,0) + NVL(A.LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(A.EDU_AMT,0) + NVL(A.HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(A.CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(A.DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(A.MARKET_AMT,0)) MARKET_AMT,    
				             TO_CHAR(NVL(A.PUBLIC_AMT,0)) PUBLIC_AMT,                        
				             TO_CHAR(A.LC1_AMT+A.LC2_AMT+A.LC3_AMT+GREATEST(B.GOV_AMT-100000,0)) LC3_AMT,
				             TO_CHAR(NVL(A.LC2_AMT_NTS,0)+NVL(A.LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_142 A, ASNHR.T_AC_RETACC_142 B,
				            (SELECT ENO_NO, SUM(JAH_AMT) JAH_AMT, SUM(JAP_AMT) JAP_AMT FROM ASNHR.T_AC_DUTYPLACE WHERE PIS_YY = '2014' GROUP BY ENO_NO) C
				      WHERE A.PIS_YY = '2014' AND A.REL_CD = '0'
				        AND A.PIS_YY = B.PIS_YY 
				        AND B.GBN_TAG = '8'
				        AND A.ENO_NO = B.ENO_NO
				        AND A.ENO_NO = C.ENO_NO(+)) B,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,         
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,    
				             DECODE(INP_MAN,'O','1','') INP_MAN, 
				             DECODE(RCH_MAN,'O','1','') RCH_MAN, 					                        
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,				             
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,         
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                   
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_142
				      WHERE PIS_YY = '2014' AND SEQ_NO = '2') C,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,
				             DECODE(INP_MAN,'O','1','') INP_MAN,
				             DECODE(RCH_MAN,'O','1','') RCH_MAN,               
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,             
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,               
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_142
				      WHERE PIS_YY = '2014' AND SEQ_NO = '3') D,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,
				             DECODE(INP_MAN,'O','1','') INP_MAN,
				             DECODE(RCH_MAN,'O','1','') RCH_MAN, 				                            
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,             
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_142
				      WHERE PIS_YY = '2014' AND SEQ_NO = '4') E,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,     
				             DECODE(INP_MAN,'O','1','') INP_MAN,
				             DECODE(RCH_MAN,'O','1','') RCH_MAN, 				                       
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                             
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_142
				      WHERE PIS_YY = '2014' AND SEQ_NO = '5') F,
				      (SELECT ENO_NO, CHI_CNT
				         FROM ASNHR.T_AC_RETACC_142
				        WHERE PIS_YY = '2014'
                ) G
				WHERE A.ENO_NO = B.ENO_NO(+)
				  AND A.ENO_NO = C.ENO_NO(+)
				  AND A.ENO_NO = D.ENO_NO(+)
				  AND A.ENO_NO = E.ENO_NO(+)
				  AND A.ENO_NO = F.ENO_NO(+)
				  AND A.ENO_NO = G.ENO_NO(+)
                  AND A.ENO_NO IN (
										'1990033','1990040','1990041','1990044','1990089','1990104','1990105',
										'2000023','2010005','2010012','2020005','2020008','2020009','2020011','2020013','2020016','2020025','2020030',
										'2030002','2030005','2030007','2030009',
										'2040001','2040006','2040012','2040013','2040020','2040023','2040024','2040025','2040038','2040042',
										'2040046','2040066','2040067','2040068','2040070','2040071','2040076','2040078','2040080','2040081',
										'2050004','2050009','2050010','2050012','2050013','2050014','2050015','2050017','2050019','2050022','2050023','2050026',
										'2050029','2050030','2050032','2050033','2050036','2050039','2050042','2050046','2050050','2050053','2050056','2050060','2050063',
										'2060004','2060005','2060007','2060009','2060017','2060024','2060026','2060027',
										'2070007','2070016','2070018','2070019','2070021','2070026','2070027','2070030','2070039','2070043',
										'2080003','2080007','2080009','2080012','2080018','2080019','2080021','2080025','2080028','2080031','2080033','2080046',
										'2090002','2090011','2100002','2100003','2100004','2100007','2100016',
										'2110003','2110005','2110007','2110013','2110014','2110016','2110017',
										'2120003','2120007','2120008','2120026','2120029','2120030','2120032','2120033',
										'2130003','2130004','2130005','2130006','2130008','2130010','2130012','2130013','2130015','2130019','2130020','2130021','2130025',
										'2130026','2130027','2130028','2130030','2130033','2130035','2130037','2130039','2130041','2130043','2130045',
										'2140001','2140003','2140004','2140007','2140008','2140009','2140010','2140011','2140012','2140013','2140014','2140015',
										'2140018','2140019','2140021','2140022','2140023','2140025','2140027','2140028','2140032','2140033','2140034',
										'3110012','3120014','3120023','3130008','3130009','3130013','3140010','3140017','3140026'      
										)					
				 UNION
				
				 SELECT a.ENO_NO||'E2'||B.PIS_YY||'12', 'E', '20227', '2218113834', '',
				        SUBSTR(G.CET_NO,1,6)||SUBSTR(G.CET_NO,8,7),
		                '','',0,'','',0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,'0',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,0,0,0,0,0,0,0,0,0,0,0,0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,'','',0,0,0,0,0,0,0,0,0,'2',
				        B.REL_CD,  
		                B.NAM_KOR, 
		                B.CET_NO,  
		                B.BAS_MAN,  
		                B.TRB_MAN, 
		                B.WCT_MAN, 
		                B.GOL_MAN, 
		                B.ONE_MAN,
				        B.INP_MAN, 
				        B.RCH_MAN, 			                
				        NVL(B.INV_NTS,'0'), 
				        NVL(B.INV2_NTS,'0'), 				        
		                NVL(B.MED_NTS,'0'), 
		                NVL(B.EDU_NTS,'0'),
				        NVL(B.CARD_NTS,'0'), 
		                NVL(B.DIR_CARD_NTS,'0'), 
		                NVL(B.CASH_NTS,'0'), 
		                NVL(B.MARKET_NTS,'0'), 
		                NVL(B.PUBLIC_NTS,'0'), 
		                NVL(B.LC3_AMT_NTS,'0'),
				        NVL(B.INV_AMT,'0'), 
				        NVL(B.INV2_AMT,'0'), 				        
		                NVL(B.MED_AMT,'0'), 
		                NVL(B.EDU_AMT,'0'),
				        NVL(B.CARD_AMT,'0'), 
		                NVL(B.DIR_CARD_AMT,'0'),
		                NVL(B.MARKET_AMT,'0'), 
		                NVL(B.PUBLIC_AMT,'0'), 
		                NVL(B.LC3_AMT,'0'),
				        C.REL_CD,  
		                C.NAM_KOR, 
		                C.CET_NO,  
		                C.BAS_MAN,  
		                C.TRB_MAN,  
		                C.WCT_MAN, 
		                C.GOL_MAN, 
		                C.ONE_MAN,
				        C.INP_MAN, 
				        C.RCH_MAN, 		                
				        NVL(C.INV_NTS,'0'), 
				        NVL(C.INV2_NTS,'0'), 				        
		                NVL(C.MED_NTS,'0'), 
		                NVL(C.EDU_NTS,'0'),
				        NVL(C.CARD_NTS,'0'), 
		                NVL(C.DIR_CARD_NTS,'0'), 
		                NVL(C.CASH_NTS,'0'), 
		                NVL(C.MARKET_NTS,'0'), 
		                NVL(C.PUBLIC_NTS,'0'), 
		                NVL(C.LC3_AMT_NTS,'0'),
				        NVL(C.INV_AMT,'0'), 
				        NVL(C.INV2_AMT,'0'), 				        
		                NVL(C.MED_AMT,'0'), 
		                NVL(C.EDU_AMT,'0'),
				        NVL(C.CARD_AMT,'0'), 
		                NVL(C.DIR_CARD_AMT,'0'), 
		                NVL(C.MARKET_AMT,'0'), 
		                NVL(C.PUBLIC_AMT,'0'), 
		                NVL(C.LC3_AMT,'0'),
				        D.REL_CD,  
		                D.NAM_KOR, 
		                D.CET_NO,  
		                D.BAS_MAN,  
		                D.TRB_MAN, 
		                D.WCT_MAN, 
		                D.GOL_MAN,  
		                D.ONE_MAN,
				        D.INP_MAN, 
				        D.RCH_MAN, 		                
				        NVL(D.INV_NTS,'0'), 
				        NVL(D.INV2_NTS,'0'), 				        
		                NVL(D.MED_NTS,'0'), 
		                NVL(D.EDU_NTS,'0'),
				        NVL(D.CARD_NTS,'0'), 
		                NVL(D.DIR_CARD_NTS,'0'), 
		                NVL(D.CASH_NTS,'0'), 
		                NVL(D.MARKET_NTS,'0'), 
		                NVL(D.PUBLIC_NTS,'0'), 
		                NVL(D.LC3_AMT_NTS,'0'),
				        NVL(D.INV_AMT,'0'), 
				        NVL(D.INV2_AMT,'0'), 				        
		                NVL(D.MED_AMT,'0'), 
		                NVL(D.EDU_AMT,'0'),
				        NVL(D.CARD_AMT,'0'),  
		                NVL(D.DIR_CARD_AMT,'0'), 
		                NVL(D.MARKET_AMT,'0'), 
		                NVL(D.PUBLIC_AMT,'0'), 
		                NVL(D.LC3_AMT,'0'),
				        E.REL_CD,  
		                E.NAM_KOR, 
		                E.CET_NO,  
		                E.BAS_MAN,  
		                E.TRB_MAN, 
		                E.WCT_MAN, 
		                E.GOL_MAN, 
		                E.ONE_MAN,
				        E.INP_MAN, 
				        E.RCH_MAN, 		                
				        NVL(E.INV_NTS,'0'), 
				        NVL(E.INV2_NTS,'0'), 				        
		                NVL(E.MED_NTS,'0'), 
		                NVL(E.EDU_NTS,'0'),
				        NVL(E.CARD_NTS,'0'), 
		                NVL(E.DIR_CARD_NTS,'0'), 
		                NVL(E.CASH_NTS,'0'), 
		                NVL(E.MARKET_NTS,'0'), 
		                NVL(E.PUBLIC_NTS,'0'), 
		                NVL(E.LC3_AMT_NTS,'0'),
				        NVL(E.INV_AMT,'0'), 
				        NVL(E.INV2_AMT,'0'), 				        
		                NVL(E.MED_AMT,'0'), 
		                NVL(E.EDU_AMT,'0'),
				        NVL(E.CARD_AMT,'0'), 
		                NVL(E.DIR_CARD_AMT,'0'), 
		                NVL(E.MARKET_AMT,'0'), 
		                NVL(E.PUBLIC_AMT,'0'), 
		                NVL(E.LC3_AMT,'0'),
				        F.REL_CD,  
		                F.NAM_KOR, 
		                F.CET_NO,  
		                F.BAS_MAN,  
		                F.TRB_MAN, 
		                F.WCT_MAN, 
		                F.GOL_MAN, 
		                F.ONE_MAN,
				        F.INP_MAN, 
				        F.RCH_MAN, 		                
				        NVL(F.INV_NTS,'0'), 
				        NVL(F.INV2_NTS,'0'), 				        
		                NVL(F.MED_NTS,'0'), 
		                NVL(F.EDU_NTS,'0'),
				        NVL(F.CARD_NTS,'0'), 
		                NVL(F.DIR_CARD_NTS,'0'), 
		                NVL(F.CASH_NTS,'0'),  
		                NVL(F.MARKET_NTS,'0'), 
		                NVL(F.PUBLIC_NTS,'0'), 
		                NVL(F.LC3_AMT_NTS,'0'),
				        NVL(F.INV_AMT,'0'), 
				        NVL(F.INV2_AMT,'0'), 				        
		                NVL(F.MED_AMT,'0'), 
		                NVL(F.EDU_AMT,'0'),
				        NVL(F.CARD_AMT,'0'), 
		                NVL(F.DIR_CARD_AMT,'0'), 
		                NVL(F.MARKET_AMT,'0'), 
		                NVL(F.PUBLIC_AMT,'0'), 
		                NVL(F.LC3_AMT,'0'),
				        '' PEN_GUBUN_CD_1,'' ABA_CD_1,'' ABA_NM_1,'' ACC_NO_1,0 AMOUNT_1,0 DED_AMT_1,
				        '' PEN_GUBUN_CD_2,'' ABA_CD_2,'' ABA_NM_2,'' ACC_NO_2,0 AMOUNT_2,0 DED_AMT_2,
				        '' PEN_GUBUN_CD_3,'' ABA_CD_3,'' ABA_NM_3,'' ACC_NO_3,0 AMOUNT_3,0 DED_AMT_3,
				        '' PEN_GUBUN_CD_4,'' ABA_CD_4,'' ABA_NM_4,'' ACC_NO_4,0 AMOUNT_4,0 DED_AMT_4,
				        '' PEN_GUBUN_CD_5,'' ABA_CD_5,'' ABA_NM_5,'' ACC_NO_5,0 AMOUNT_5,0 DED_AMT_5,
				        '' PEN_GUBUN_CD_6,'' ABA_CD_6,'' ABA_NM_6,'' ACC_NO_6,0 AMOUNT_6,0 DED_AMT_6,
				        '' PEN_GUBUN_CD_7,'' ABA_CD_7,'' ABA_NM_7,'' ACC_NO_7,0 AMOUNT_7,0 DED_AMT_7,
				        '' PEN_GUBUN_CD_8,'' ABA_CD_8,'' ABA_NM_8,'' ACC_NO_8,0 AMOUNT_8,0 DED_AMT_8,
				        '' PEN_GUBUN_CD_9,'' ABA_CD_9,'' ABA_NM_9,'' ACC_NO_9,0 AMOUNT_9,0 DED_AMT_9,
				        '' PEN_GUBUN_CD_10,'' ABA_CD_10,'' ABA_NM_10,'' ACC_NO_10,0 AMOUNT_10,0 DED_AMT_10,
				        '' PEN_GUBUN_CD_11,'' ABA_CD_11,'' ABA_NM_11,'' ACC_NO_11,0 AMOUNT_11,0 DED_AMT_11,
				        '' PEN_GUBUN_CD_12,'' ABA_CD_12,'' ABA_NM_12,'' ACC_NO_12,0 AMOUNT_12,0 DED_AMT_12,
				        '' PEN_GUBUN_CD_13,'' ABA_CD_13,'' ABA_NM_13,'' ACC_NO_13,0 AMOUNT_13,0 DED_AMT_13,
				        '' PEN_GUBUN_CD_14,'' ABA_CD_14,'' ABA_NM_14,'' ACC_NO_14,0 AMOUNT_14,0 DED_AMT_14,
				        '' PEN_GUBUN_CD_15,'' ABA_CD_15,'' ABA_NM_15,'' ACC_NO_15,0 AMOUNT_15,0 DED_AMT_15
				FROM (SELECT ENO_NO
				        FROM ASNHR.T_AC_FAMILY_142
				       WHERE PIS_YY = '2014'
				         AND SEQ_NO >= '6'
				    GROUP BY ENO_NO) A,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,  
				             DECODE(INP_MAN,'O','1','') INP_MAN,
				             DECODE(RCH_MAN,'O','1','') RCH_MAN, 				                        
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,             
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_142
				      WHERE PIS_YY = '2014' AND SEQ_NO = '6') B,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN, 
				             DECODE(INP_MAN,'O','1','') INP_MAN,
				             DECODE(RCH_MAN,'O','1','') RCH_MAN, 				                         
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,    
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_142
				      WHERE PIS_YY = '2014' AND SEQ_NO = '7') C,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,
				             DECODE(INP_MAN,'O','1','') INP_MAN,
				             DECODE(RCH_MAN,'O','1','') RCH_MAN, 				                           
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,                 
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,              
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_142
				      WHERE PIS_YY = '2014' AND SEQ_NO = '8') D,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN,
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,  
				             DECODE(INP_MAN,'O','1','') INP_MAN,
				             DECODE(RCH_MAN,'O','1','') RCH_MAN, 				                         
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,    
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                   
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_142
				      WHERE PIS_YY = '2014' AND SEQ_NO = '9') E,
				     (SELECT ENO_NO, REL_CD, REPLACE(NAM_KOR,' ','') NAM_KOR, CET_NO, PIS_YY,
				             DECODE(BAS_MAN,'O','1','') BAS_MAN, 
				             DECODE(INV_MAN,'1','1','2','2','3','3',' ') TRB_MAN,                        
				             DECODE(WCT_MAN,'O','1','') WCT_MAN,
				             CASE WHEN GOL_65 = 'O' OR GOL_70 = 'O' THEN '1'
				             ELSE ''
				             END GOL_MAN,
				             DECODE(ONE_MAN,'O','1','') ONE_MAN,   
				             DECODE(INP_MAN,'O','1','') INP_MAN,
				             DECODE(RCH_MAN,'O','1','') RCH_MAN, 				                        
				             '0' INV_NTS,
				             TO_CHAR(NVL(LIN_AMT_NTS,0) + NVL(LIH_AMT_NTS,0)) INV2_NTS,				             
				             TO_CHAR(NVL(MED_AMT_NTS,0) + NVL(LEN_AMT_NTS,0)) MED_NTS,
				             TO_CHAR(NVL(EDU_AMT_NTS,0) + NVL(HED_AMT_NTS,0)) EDU_NTS,
				             TO_CHAR(NVL(CARD_AMT_NTS,0)) CARD_NTS,
				             TO_CHAR(NVL(DIR_CARD_AMT_NTS,0)) DIR_CARD_NTS,
				             TO_CHAR(NVL(CASH_AMT_NTS,0)) CASH_NTS,
				             TO_CHAR(NVL(MARKET_AMT_NTS,0)) MARKET_NTS, 
				             TO_CHAR(NVL(PUBLIC_AMT_NTS,0)) PUBLIC_NTS,                              
				             '0' INV_AMT,
				             TO_CHAR(NVL(LIN_AMT,0) + NVL(LIH_AMT,0)) INV2_AMT,	
				             TO_CHAR(NVL(MED_AMT,0) + NVL(LEN_AMT,0)) MED_AMT,
				             TO_CHAR(NVL(EDU_AMT,0) + NVL(HED_AMT,0)) EDU_AMT,
				             TO_CHAR(NVL(CARD_AMT,0)) CARD_AMT,
				             TO_CHAR(NVL(DIR_CARD_AMT,0)) DIR_CARD_AMT,
				             TO_CHAR(NVL(MARKET_AMT,0)) MARKET_AMT,   
				             TO_CHAR(NVL(PUBLIC_AMT,0)) PUBLIC_AMT,                   
				             TO_CHAR(LC1_AMT+LC2_AMT+LC3_AMT) LC3_AMT,
				             TO_CHAR(NVL(LC2_AMT_NTS,0)+NVL(LC3_AMT_NTS,0)) LC3_AMT_NTS
				       FROM ASNHR.T_AC_FAMILY_142
				      WHERE PIS_YY = '2014' AND SEQ_NO = '10') F, ASNHR.T_CM_PERSON G,
				    (SELECT ENO_NO, CHI_CNT
				       FROM ASNHR.T_AC_RETACC_142
				      WHERE PIS_YY = '2014'
				        AND GBN_TAG = '8') H
				WHERE A.ENO_NO = B.ENO_NO(+)
				  AND A.ENO_NO = C.ENO_NO(+)
				  AND A.ENO_NO = D.ENO_NO(+)
				  AND A.ENO_NO = E.ENO_NO(+)
				  AND A.ENO_NO = F.ENO_NO(+)
				  AND A.ENO_NO = G.ENO_NO
				  AND A.ENO_NO = H.ENO_NO(+)
                  AND A.ENO_NO IN (
										'1990033','1990040','1990041','1990044','1990089','1990104','1990105',
										'2000023','2010005','2010012','2020005','2020008','2020009','2020011','2020013','2020016','2020025','2020030',
										'2030002','2030005','2030007','2030009',
										'2040001','2040006','2040012','2040013','2040020','2040023','2040024','2040025','2040038','2040042',
										'2040046','2040066','2040067','2040068','2040070','2040071','2040076','2040078','2040080','2040081',
										'2050004','2050009','2050010','2050012','2050013','2050014','2050015','2050017','2050019','2050022','2050023','2050026',
										'2050029','2050030','2050032','2050033','2050036','2050039','2050042','2050046','2050050','2050053','2050056','2050060','2050063',
										'2060004','2060005','2060007','2060009','2060017','2060024','2060026','2060027',
										'2070007','2070016','2070018','2070019','2070021','2070026','2070027','2070030','2070039','2070043',
										'2080003','2080007','2080009','2080012','2080018','2080019','2080021','2080025','2080028','2080031','2080033','2080046',
										'2090002','2090011','2100002','2100003','2100004','2100007','2100016',
										'2110003','2110005','2110007','2110013','2110014','2110016','2110017',
										'2120003','2120007','2120008','2120026','2120029','2120030','2120032','2120033',
										'2130003','2130004','2130005','2130006','2130008','2130010','2130012','2130013','2130015','2130019','2130020','2130021','2130025',
										'2130026','2130027','2130028','2130030','2130033','2130035','2130037','2130039','2130041','2130043','2130045',
										'2140001','2140003','2140004','2140007','2140008','2140009','2140010','2140011','2140012','2140013','2140014','2140015',
										'2140018','2140019','2140021','2140022','2140023','2140025','2140027','2140028','2140032','2140033','2140034',
										'3110012','3120014','3120023','3130008','3130009','3130013','3140010','3140017','3140026'      
										)					
				  UNION
				
				  SELECT EMS.ENO_NO||'F'||'2014'||'12', 'F', '20227', '2218113834', '',
				         EMS.CET_NO,
		                '','',0,'','',0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,'0',0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,'0',0,'0',0,'0',0,0,0,0,0,0,0,0,0,0,0,0,0,0,
		                0,0,0,0,0,0,0,0,0,0,0,0,0,'','',0,0,0,0,0,0,0,0,0,'2',

				         '' REL_CD1,  
		                 '' NAM_KOR1, 
		                 '' CET_NO1,
				         '' BAS_MAN1, 
		                 '' TRB_MAN1,  
		                 '' WCT_MAN1,  
		                 '' GOL_MAN1, 
		                 '' ONE_MAN1,
		                 '' INP_MAN1,
		                 '' RCH_MAN1,		                 		                 
				         '' INV_NTS1, 
				         '' INV2_NTS1, 				         
		                 '' MED_NTS1, 
		                 '' EDU_NTS1, 
		                 '' CARD_NTS1, 
		                 '' DIR_CARD_NTS1,
		                 '' CASH_NTS1, 
		                 '' MARKET_NTS1,  
		                 '' MARKET_NTS1,
		                 '' LC3_AMT_NTS1,
				         '' INV_AMT1, 
				         '' INV2_AMT1, 				         
		                 '' MED_AMT1, 
		                 '' EDU_AMT1, 
		                 '' CARD_AMT1, 
		                 '' DIR_CARD_AMT1, 
		                 '' MARKET_AMT1,  
		                 '' MARKET_AMT1,
		                 '' LC3_AMT1,
				         '' REL_CD2,  
		                 '' NAM_KOR2, 
		                 '' CET_NO2,
				         '' BAS_MAN2, 
		                 '' TRB_MAN2,  
		                 '' WCT_MAN2,  
		                 '' GOL_MAN2,                
		                 '' ONE_MAN2,
		                 '' INP_MAN2,
		                 '' RCH_MAN2,			                 
				         '' INV_NTS2, 
				         '' INV2_NTS2, 				         
		                 '' MED_NTS2, 
		                 '' EDU_NTS2, 
		                 '' CARD_NTS2, 
		                 '' DIR_CARD_NTS2,
		                 '' CASH_NTS2, 
		                 '' MARKET_NTS2, 
		                 '' MARKET_NTS2, 
		                 '' LC3_AMT_NTS2,
				         '' INV_AMT2, 
				         '' INV2_AMT2, 				         
		                 '' MED_AMT2, 
		                 '' EDU_AMT2, 
		                 '' CARD_AMT2, 
		                 '' DIR_CARD_AMT2, 
		                 '' MARKET_AMT2, 
		                 '' MARKET_AMT2, 
		                 '' LC3_AMT2,
				         '' REL_CD3,  
		                 '' NAM_KOR3, 
		                 '' CET_NO3,
				         '' BAS_MAN3, 
		                 '' TRB_MAN3,  
		                 '' WCT_MAN3,  
		                 '' GOL_MAN3,             
		                 '' ONE_MAN3,
		                 '' INP_MAN3,
		                 '' RCH_MAN3,			                 
				         '' INV_NTS3,
				         '' INV2_NTS3,				         
		                 '' MED_NTS3, 
		                 '' EDU_NTS3, 
		                 '' CARD_NTS3, 
		                 '' DIR_CARD_NTS3,
		                 '' CASH_NTS3, 
		                 '' MARKET_NTS3, 
		                 '' MARKET_NTS3, 
		                 '' LC3_AMT_NTS3,
				         '' INV_AMT3, 
				         '' INV2_AMT3, 				         
		                 '' MED_AMT3, 
		                 '' EDU_AMT3, 
		                 '' CARD_AMT3, 
		                 '' DIR_CARD_AMT3, 
		                 '' MARKET_AMT3, 
		                 '' MARKET_AMT3, 
		                 '' LC3_AMT3,
				         '' REL_CD4,  
		                 '' NAM_KOR4, 
		                 '' CET_NO4,
				         '' BAS_MAN4, 
		                 '' TRB_MAN4,  
		                 '' WCT_MAN4,  
		                 '' GOL_MAN4,            
		                 '' ONE_MAN4,
		                 '' INP_MAN4,
		                 '' RCH_MAN4,			                 
				         '' INV_NTS4, 
				         '' INV2_NTS4, 				         
		                 '' MED_NTS4, 
		                 '' EDU_NTS4, 
		                 '' CARD_NTS4, 
		                 '' DIR_CARD_NTS4,
		                 '' CASH_NTS4, 
		                 '' MARKET_NTS4, 
		                 '' MARKET_NTS4, 
		                 '' LC3_AMT_NTS4,
				         '' INV_AMT4, 
				         '' INV2_AMT4, 				         
		                 '' MED_AMT4, 
		                 '' EDU_AMT4, 
		                 '' CARD_AMT4, 
		                 '' DIR_CARD_AMT4, 
		                 '' MARKET_AMT4, 
		                 '' MARKET_AMT4, 
		                 '' LC3_AMT4,
				         '' REL_CD5,  
		                 '' NAM_KOR5, 
		                 '' CET_NO5,
				         '' BAS_MAN5, 
		                 '' TRB_MAN5,  
		                 '' WCT_MAN5,  
		                 '' GOL_MAN5,           
		                 '' ONE_MAN5,
		                 '' INP_MAN5,
		                 '' RCH_MAN5,			                 
				         '' INV_NTS5, 
				         '' INV2_NTS5, 				         
		                 '' MED_NTS5, 
		                 '' EDU_NTS5, 
		                 '' CARD_NTS5, 
		                 '' DIR_CARD_NTS5,
		                 '' CASH_NTS5, 
		                 '' MARKET_NTS5, 
		                 '' MARKET_NTS5, 
		                 '' LC3_AMT_NTS5,
				         '' INV_AMT5, 
				         '' INV2_AMT5, 				         
		                 '' MED_AMT5, 
		                 '' EDU_AMT5, 
		                 '' CARD_AMT5, 
		                 '' DIR_CARD_AMT5, 
		                 '' MARKET_AMT5, 
		                 '' MARKET_AMT5, 
		                 '' LC3_AMT5,
				         PEN1.PEN_GUBUN_CD PEN_GUBUN_CD_1, PEN1.ABA_CD ABA_CD_1, SUBSTR(PEN1.ABA_NM,0,50) ABA_NM_1, 
				         PEN1.ACC_NO ACC_NO_1, PEN1.AMOUNT AMOUNT_1, NVL(PEN1.DED_AMT,0) DED_AMT_1,
				         PEN2.PEN_GUBUN_CD PEN_GUBUN_CD_2, PEN2.ABA_CD ABA_CD_2, SUBSTR(PEN2.ABA_NM,0,50) ABA_NM_2, 
				         PEN2.ACC_NO ACC_NO_2, PEN2.AMOUNT AMOUNT_2, NVL(PEN2.DED_AMT,0) DED_AMT_2,
				         PEN3.PEN_GUBUN_CD PEN_GUBUN_CD_3, PEN3.ABA_CD ABA_CD_3, SUBSTR(PEN3.ABA_NM,0,50) ABA_NM_3, 
				         PEN3.ACC_NO ACC_NO_3, PEN3.AMOUNT AMOUNT_3, NVL(PEN3.DED_AMT,0) DED_AMT_3,
				         PEN4.PEN_GUBUN_CD PEN_GUBUN_CD_4, PEN4.ABA_CD ABA_CD_4, SUBSTR(PEN4.ABA_NM,0,50) ABA_NM_4, 
				         PEN4.ACC_NO ACC_NO_4, PEN4.AMOUNT AMOUNT_4, NVL(PEN4.DED_AMT,0) DED_AMT_4,
				         PEN5.PEN_GUBUN_CD PEN_GUBUN_CD_5, PEN5.ABA_CD ABA_CD_5, SUBSTR(PEN5.ABA_NM,0,50) ABA_NM_5, 
				         PEN5.ACC_NO ACC_NO_5, PEN5.AMOUNT AMOUNT_5, NVL(PEN5.DED_AMT,0) DED_AMT_5,
				         PEN6.PEN_GUBUN_CD PEN_GUBUN_CD_6, PEN6.ABA_CD ABA_CD_6, SUBSTR(PEN6.ABA_NM,0,50) ABA_NM_6, 
				         PEN6.ACC_NO ACC_NO_6, PEN6.AMOUNT AMOUNT_6, NVL(PEN6.DED_AMT,0) DED_AMT_6,
				         PEN7.PEN_GUBUN_CD PEN_GUBUN_CD_7, PEN7.ABA_CD ABA_CD_7, SUBSTR(PEN7.ABA_NM,0,50) ABA_NM_7, 
				         PEN7.ACC_NO ACC_NO_7, PEN7.AMOUNT AMOUNT_7, NVL(PEN7.DED_AMT,0) DED_AMT_7,
				         PEN8.PEN_GUBUN_CD PEN_GUBUN_CD_8, PEN8.ABA_CD ABA_CD_8, SUBSTR(PEN8.ABA_NM,0,50) ABA_NM_8, 
				         PEN8.ACC_NO ACC_NO_8, PEN8.AMOUNT AMOUNT_8, NVL(PEN8.DED_AMT,0) DED_AMT_8,
				         PEN9.PEN_GUBUN_CD PEN_GUBUN_CD_9, PEN9.ABA_CD ABA_CD_9, SUBSTR(PEN9.ABA_NM,0,50) ABA_NM_9, 
				         PEN9.ACC_NO ACC_NO_9, PEN9.AMOUNT AMOUNT_9, NVL(PEN9.DED_AMT,0) DED_AMT_9,
				         PEN10.PEN_GUBUN_CD PEN_GUBUN_CD_10, PEN10.ABA_CD ABA_CD_10, SUBSTR(PEN10.ABA_NM,0,50) ABA_NM_10, 
				         PEN10.ACC_NO ACC_NO_10, PEN10.AMOUNT AMOUNT_10, NVL(PEN10.DED_AMT,0) DED_AMT_10,
				         PEN11.PEN_GUBUN_CD PEN_GUBUN_CD_11, PEN11.ABA_CD ABA_CD_11, SUBSTR(PEN11.ABA_NM,0,50) ABA_NM_11, 
				         PEN11.ACC_NO ACC_NO_11, PEN11.AMOUNT AMOUNT_11, NVL(PEN11.DED_AMT,0) DED_AMT_11,
				         PEN12.PEN_GUBUN_CD PEN_GUBUN_CD_12, PEN12.ABA_CD ABA_CD_12, SUBSTR(PEN12.ABA_NM,0,50) ABA_NM_12, 
				         PEN12.ACC_NO ACC_NO_12, PEN12.AMOUNT AMOUNT_12, NVL(PEN12.DED_AMT,0) DED_AMT_12,
				         PEN13.PEN_GUBUN_CD PEN_GUBUN_CD_13, PEN13.ABA_CD ABA_CD_13, SUBSTR(PEN13.ABA_NM,0,50) ABA_NM_13, 
				         PEN13.ACC_NO ACC_NO_13, PEN13.AMOUNT AMOUNT_13, NVL(PEN13.DED_AMT,0) DED_AMT_13,
				         PEN14.PEN_GUBUN_CD PEN_GUBUN_CD_14, PEN14.ABA_CD ABA_CD_14, SUBSTR(PEN14.ABA_NM,0,50) ABA_NM_14, 
				         PEN14.ACC_NO ACC_NO_14, PEN14.AMOUNT AMOUNT_14, NVL(PEN14.DED_AMT,0) DED_AMT_14,
				         PEN15.PEN_GUBUN_CD PEN_GUBUN_CD_15, PEN15.ABA_CD ABA_CD_15, SUBSTR(PEN15.ABA_NM,0,50) ABA_NM_15, 
				         PEN15.ACC_NO ACC_NO_15, PEN15.AMOUNT AMOUNT_15, NVL(PEN15.DED_AMT,0) DED_AMT_15
				    FROM
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '0') PEN1,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '1') PEN2,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '2') PEN3,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '3') PEN4,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '4') PEN5,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '5') PEN6,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '6') PEN7,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '7') PEN8,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '8') PEN9,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '9') PEN10,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '10') PEN11,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '11') PEN12,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '12') PEN13,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '13') PEN14,
				         (SELECT PIS_YY, ENO_NO, DECODE(DED_AMT, 0, '', PEN_GUBUN_CD) PEN_GUBUN_CD, DECODE(DED_AMT, 0, '', ABA_CD) ABA_CD, DECODE(DED_AMT, 0, '', ABA_NM) ABA_NM, DECODE(DED_AMT, 0, '', ACC_NO) ACC_NO, DECODE(DED_AMT, 0, 0, AMOUNT) AMOUNT, DED_AMT FROM ASNHR.T_AC_PENSION_142 WHERE PIS_YY = '2014' AND ROW_NUM = '14') PEN15,
				         (SELECT ENO_NO,ENO_NM AS NAM_KOR,
				                 SUBSTR(CET_NO,1,6)||SUBSTR(CET_NO,8,7) CET_NO,
				                 ZIP_NO,ADR_CT||' '||ADDRESS JUSO,
				                 GREATEST(NVL(TO_CHAR(HIR_YMD,'YYYYMMDD'),' '),'20140101') HIR_YMD,
				                 LEAST(NVL(TO_CHAR(RET_YMD,'YYYYMMDD'),'20141231'),'20141231') RET_YMD
				          FROM ASNHR.T_CM_PERSON ) EMS,
				          ASNHR.T_AC_RETACC_142 YAC
					 WHERE PEN1.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN2.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN3.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN4.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN5.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN6.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN7.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN8.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN9.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN10.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN11.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN12.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN13.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN14.ENO_NO(+)  = EMS.ENO_NO
					   AND PEN15.ENO_NO(+)  = EMS.ENO_NO
					   AND YAC.PIS_YY = '2014' 
					   AND YAC.GBN_TAG = '8'
					   AND YAC.ENO_NO = EMS.ENO_NO
                       AND EMS.ENO_NO IN (
										'1990033','1990040','1990041','1990044','1990089','1990104','1990105',
										'2000023','2010005','2010012','2020005','2020008','2020009','2020011','2020013','2020016','2020025','2020030',
										'2030002','2030005','2030007','2030009',
										'2040001','2040006','2040012','2040013','2040020','2040023','2040024','2040025','2040038','2040042',
										'2040046','2040066','2040067','2040068','2040070','2040071','2040076','2040078','2040080','2040081',
										'2050004','2050009','2050010','2050012','2050013','2050014','2050015','2050017','2050019','2050022','2050023','2050026',
										'2050029','2050030','2050032','2050033','2050036','2050039','2050042','2050046','2050050','2050053','2050056','2050060','2050063',
										'2060004','2060005','2060007','2060009','2060017','2060024','2060026','2060027',
										'2070007','2070016','2070018','2070019','2070021','2070026','2070027','2070030','2070039','2070043',
										'2080003','2080007','2080009','2080012','2080018','2080019','2080021','2080025','2080028','2080031','2080033','2080046',
										'2090002','2090011','2100002','2100003','2100004','2100007','2100016',
										'2110003','2110005','2110007','2110013','2110014','2110016','2110017',
										'2120003','2120007','2120008','2120026','2120029','2120030','2120032','2120033',
										'2130003','2130004','2130005','2130006','2130008','2130010','2130012','2130013','2130015','2130019','2130020','2130021','2130025',
										'2130026','2130027','2130028','2130030','2130033','2130035','2130037','2130039','2130041','2130043','2130045',
										'2140001','2140003','2140004','2140007','2140008','2140009','2140010','2140011','2140012','2140013','2140014','2140015',
										'2140018','2140019','2140021','2140022','2140023','2140025','2140027','2140028','2140032','2140033','2140034',
										'3110012','3120014','3120023','3130008','3130009','3130013','3140010','3140017','3140026'      
										)						   
				 ) VIEW_1
				 ORDER BY VIEW_1.SEL_KEY
            ]]>
        </query>
    </sql>

    <!-- 의료비신고 -->
    <sql name="YACA001_SHR_MED_14">
        <description>의료비신고</description>
        <query>
            <![CDATA[
            SELECT A.DPT_CD AS DPT_CD,
                        A.DPT_NM AS DPT_NM,
                        A.JOB_CD AS JOB_CD,
                        A.JOB_NM AS JOB_NM,
                        A.ENO_NO AS ENO_NO,
                        A.ENO_NM AS ENO_NM,
                        REPLACE(A.CET_NO,'-','') AS CET_NO,
                        B.COM_NO AS COM_NO,
                        B.COM_NM AS COM_NM,
                        B.CASH_CNT AS TOT_CNT,
                        B.CASH_AMT AS SUM_AMT,
                        ASNHR.SF_GET_COMMNAME('01','FC',B.MED_CD) AS MED_CD,
                        B.REL_CD AS REL_CD,
                        ASNHR.SF_GET_COMMNAME('01', 'FA', B.REL_CD) AS REL_NM,
                        B.CET_NO AS TCET_NO,
                        DECODE(B.REL_CD,'0','1',DECODE(B.GBN_TAG,NULL,'2','1')) AS COMM_CD
            FROM  VI_T_CM_PERSON2 A, 
           	 		T_AC_MEDICAL_14 B, 
            		T_AC_RETACC_14 C
            WHERE A.ENO_NO = B.ENO_NO 
            AND      B.ENO_NO = C.ENO_NO
            AND      C.PIS_YY = ?
            AND      B.PIS_YY = ?
            AND      C.MMA_DED > 0             
            AND      C.GBN_TAG = '8'
            ORDER BY B.ENO_NO
            ]]>
        </query>
    </sql>

    <!-- 의료비신고 -->
    <sql name="YACA001_SHR_MED_142">
        <description>의료비신고</description>
        <query>
            <![CDATA[
            SELECT A.DPT_CD AS DPT_CD,
                        A.DPT_NM AS DPT_NM,
                        A.JOB_CD AS JOB_CD,
                        A.JOB_NM AS JOB_NM,
                        A.ENO_NO AS ENO_NO,
                        A.ENO_NM AS ENO_NM,
                        REPLACE(A.CET_NO,'-','') AS CET_NO,
                        B.COM_NO AS COM_NO,
                        B.COM_NM AS COM_NM,
                        B.CASH_CNT AS TOT_CNT,
                        B.CASH_AMT AS SUM_AMT,
                        ASNHR.SF_GET_COMMNAME('01','FC',B.MED_CD) AS MED_CD,
                        B.REL_CD AS REL_CD,
                        ASNHR.SF_GET_COMMNAME('01', 'FA', B.REL_CD) AS REL_NM,
                        B.CET_NO AS TCET_NO,
                        DECODE(B.REL_CD,'0','1',DECODE(B.GBN_TAG,NULL,'2','1')) AS COMM_CD
            FROM  VI_T_CM_PERSON2 A, 
           	 		T_AC_MEDICAL_142 B, 
            		T_AC_RETACC_142 C
            WHERE A.ENO_NO = B.ENO_NO 
            AND      B.ENO_NO = C.ENO_NO
            AND      C.PIS_YY = ?
            AND      B.PIS_YY = ?
            AND      C.MMA_DED > 0             
            AND      C.GBN_TAG = '8'
            ORDER BY B.ENO_NO
            ]]>
        </query>
    </sql>
    
     <sql name="YACA001_SHR_MED_14">
        <description>의료비신고</description>
        <query>
            <![CDATA[
            SELECT A.DPT_CD AS DPT_CD,
                        A.DPT_NM AS DPT_NM,
                        A.JOB_CD AS JOB_CD,
                        A.JOB_NM AS JOB_NM,
                        A.ENO_NO AS ENO_NO,
                        A.ENO_NM AS ENO_NM,
                        REPLACE(A.CET_NO,'-','') AS CET_NO,
                        B.COM_NO AS COM_NO,
                        B.COM_NM AS COM_NM,
                        B.CASH_CNT AS TOT_CNT,
                        B.CASH_AMT AS SUM_AMT,
                        ASNHR.SF_GET_COMMNAME('01','FC',B.MED_CD) AS MED_CD,
                        B.REL_CD AS REL_CD,
                        ASNHR.SF_GET_COMMNAME('01', 'FA', B.REL_CD) AS REL_NM,
                        B.CET_NO AS TCET_NO,
                        DECODE(B.REL_CD,'0','1',DECODE(B.GBN_TAG,NULL,'2','1')) AS COMM_CD
            FROM  VI_T_CM_PERSON2 A, 
           	 		T_AC_MEDICAL_14 B, 
            		T_AC_RETACC_14 C
            WHERE A.ENO_NO = B.ENO_NO 
            AND      B.ENO_NO = C.ENO_NO
            AND      C.PIS_YY = ?
            AND      B.PIS_YY = ?
            AND      C.MMA_DED > 0             
            AND      C.GBN_TAG = '8'
            ORDER BY B.ENO_NO
            ]]>
        </query>
    </sql>
    
      <sql name="YACA001_SHR_MED_15">
        <description>의료비신고</description>
        <query>
            <![CDATA[
            SELECT A.DPT_CD AS DPT_CD,
                        A.DPT_NM AS DPT_NM,
                        A.JOB_CD AS JOB_CD,
                        A.JOB_NM AS JOB_NM,
                        A.ENO_NO AS ENO_NO,
                        A.ENO_NM AS ENO_NM,
                        REPLACE(A.CET_NO,'-','') AS CET_NO,
                        B.COM_NO AS COM_NO,
                        B.COM_NM AS COM_NM,
                        B.CASH_CNT AS TOT_CNT,
                        B.CASH_AMT AS SUM_AMT,
                        ASNHR.SF_GET_COMMNAME('01','FC',B.MED_CD) AS MED_CD,
                        B.REL_CD AS REL_CD,
                        ASNHR.SF_GET_COMMNAME('01', 'FA', B.REL_CD) AS REL_NM,
                        B.CET_NO AS TCET_NO,
                        DECODE(B.REL_CD,'0','1',DECODE(B.GBN_TAG,NULL,'2','1')) AS COMM_CD
            FROM  VI_T_CM_PERSON2 A, 
           	 		T_AC_MEDICAL_15 B, 
            		T_AC_RETACC_15 C
            WHERE A.ENO_NO = B.ENO_NO 
            AND      B.ENO_NO = C.ENO_NO
            AND      C.PIS_YY = ?
            AND      B.PIS_YY = ?
            AND      C.MMA_DED > 0             
            AND      C.GBN_TAG = '8'
            ORDER BY B.ENO_NO
            ]]>
        </query>
    </sql>

    <!-- 의료비신고 -->
    <sql name="YACA001_SHR_MED_142">
        <description>의료비신고</description>
        <query>
            <![CDATA[
            SELECT A.DPT_CD AS DPT_CD,
                        A.DPT_NM AS DPT_NM,
                        A.JOB_CD AS JOB_CD,
                        A.JOB_NM AS JOB_NM,
                        A.ENO_NO AS ENO_NO,
                        A.ENO_NM AS ENO_NM,
                        REPLACE(A.CET_NO,'-','') AS CET_NO,
                        B.COM_NO AS COM_NO,
                        B.COM_NM AS COM_NM,
                        B.CASH_CNT AS TOT_CNT,
                        B.CASH_AMT AS SUM_AMT,
                        ASNHR.SF_GET_COMMNAME('01','FC',B.MED_CD) AS MED_CD,
                        B.REL_CD AS REL_CD,
                        ASNHR.SF_GET_COMMNAME('01', 'FA', B.REL_CD) AS REL_NM,
                        B.CET_NO AS TCET_NO,
                        DECODE(B.REL_CD,'0','1',DECODE(B.GBN_TAG,NULL,'2','1')) AS COMM_CD
            FROM  VI_T_CM_PERSON2 A, 
           	 		T_AC_MEDICAL_142 B, 
            		T_AC_RETACC_142 C
            WHERE A.ENO_NO = B.ENO_NO 
            AND      B.ENO_NO = C.ENO_NO
            AND      C.PIS_YY = ?
            AND      B.PIS_YY = ?
            AND      C.MMA_DED > 0             
            AND      C.GBN_TAG = '8'
            ORDER BY B.ENO_NO
            ]]>
        </query>
    </sql>

    <!-- 의료비신고 파일출력 -->
    <sql name="YACA001_SHR_FILE_02">
        <description>의료비신고 파일출력</description>
        <query>
            <![CDATA[
            SELECT ROW_NUMBER() OVER(ORDER BY A.ENO_NO) AS NUM,
                   ('A'||
                    '26'||
                    '227'||
                    TO_CHAR(ROW_NUMBER() OVER(ORDER BY A.ENO_NO),'FM000000')||
                    ?||
                    '2218113834'||
                    RPAD('asan99', 20, ' ')||
                    '9000'||
                    '2218113834'||
                    RPAD('현대아산주식회사', 40, ' ')||
                    RPAD(SUBSTR(A.CET_NO,1,6)||SUBSTR(A.CET_NO,8,7), 13, ' ')||
                    '1'||
                    RPAD(REPLACE(A.ENO_NM,' ',''), 30, ' ')||
                    RPAD(NVL(B.COM_NO,' '), 10, ' ')||
                    RPAD(NVL(B.COM_NM,' '), 40, ' ')||
                    RPAD(B.MED_CD, 1,  ' ')||
                    TO_CHAR(NVL(B.CASH_CNT,0),'FM00000')||
                    TO_CHAR(NVL(B.CASH_AMT,0),'FM00000000000')||
                    RPAD(B.CET_NO, 13, ' ')||
                    '1'||
                    RPAD(DECODE(B.REL_CD,'0','1',DECODE(B.GBN_TAG,NULL,'2','1')), 1, ' ')||
                    '1'||
                    RPAD(' ', 19, ' ')
                   ) AS NPN_NO
            FROM  VI_T_CM_PERSON2 A,
                  (SELECT ENO_NO, 
                  		 CET_NO, 
                  		 COM_NO,
                         SUM(CASH_AMT) CASH_AMT, 
                         SUM(CASH_CNT) CASH_CNT,
                         MIN(COM_NM) COM_NM, MIN(REL_CD) REL_CD, 
                         MIN(GBN_TAG) GBN_TAG, MIN(MED_CD) MED_CD
                    FROM ASNHR.T_AC_MEDICAL_14
                   WHERE PIS_YY = ?
                GROUP BY ENO_NO, CET_NO, COM_NO ) B, 
                ASNHR.T_AC_RETACC_14 C
            WHERE A.ENO_NO = B.ENO_NO
            AND      B.ENO_NO = C.ENO_NO         
            AND      C.PIS_YY = ?
            AND      C.MMA_DED > 0           
            AND      C.GBN_TAG = '8'
            ORDER BY A.ENO_NO
            ]]>
        </query>
    </sql>
    
    
    <!-- 의료비신고 파일출력 -->
    <sql name="YACA001_SHR_FILE_02_15">
        <description>의료비신고 파일출력</description>
        <query>
            <![CDATA[
            SELECT ROW_NUMBER() OVER(ORDER BY A.ENO_NO) AS NUM,
                   ('A'||
                    '26'||
                    '227'||
                    TO_CHAR(ROW_NUMBER() OVER(ORDER BY A.ENO_NO),'FM000000')||
                    ?||
                    '2218113834'||
                    RPAD('asan99', 20, ' ')||
                    '9000'||
                    '2218113834'||
                    RPAD('현대아산주식회사', 40, ' ')||
                    RPAD(SUBSTR(A.CET_NO,1,6)||SUBSTR(A.CET_NO,8,7), 13, ' ')||
                    '1'||
                    RPAD(REPLACE(A.ENO_NM,' ',''), 30, ' ')||
                    RPAD(NVL(B.COM_NO,' '), 10, ' ')||
                    RPAD(NVL(B.COM_NM,' '), 40, ' ')||
                    RPAD(B.MED_CD, 1,  ' ')||
                    TO_CHAR(NVL(B.CASH_CNT,0),'FM00000')||
                    TO_CHAR(NVL(B.CASH_AMT,0),'FM00000000000')||
                    RPAD(DECODE(B.GBN_TAG,'C','1',' '),1, ' ')||
                    RPAD(B.CET_NO, 13, ' ')||
                    '1'||
                    RPAD(DECODE(B.REL_CD,'0','1',DECODE(B.GBN_TAG,NULL,'2','1')), 1, ' ')||
                    '1'||
                    RPAD(' ', 19, ' ')
                   ) AS NPN_NO
            FROM  VI_T_CM_PERSON2 A,
                  (SELECT ENO_NO, 
                  		 CET_NO, 
                  		 COM_NO,
                         SUM(CASH_AMT) CASH_AMT, 
                         SUM(CASH_CNT) CASH_CNT,
                         MIN(COM_NM) COM_NM, MIN(REL_CD) REL_CD, 
                         MIN(GBN_TAG) GBN_TAG, MIN(MED_CD) MED_CD
                    FROM ASNHR.T_AC_MEDICAL_15
                   WHERE PIS_YY = ?
                GROUP BY ENO_NO, CET_NO, COM_NO ) B, 
                ASNHR.T_AC_RETACC_15 C
            WHERE A.ENO_NO = B.ENO_NO
            AND      B.ENO_NO = C.ENO_NO         
            AND      C.PIS_YY = ?
            AND      C.MMA_DED > 0           
            AND      C.GBN_TAG = '8'
            ORDER BY A.ENO_NO
            ]]>
        </query>
    </sql>
    


    <!-- 의료비신고 파일출력 -->
    <sql name="YACA001_SHR_FILE_02_142">
        <description>의료비신고 파일출력</description>
        <query>
            <![CDATA[
            SELECT ROW_NUMBER() OVER(ORDER BY A.ENO_NO) AS NUM,
                   ('A'||
                    '26'||
                    '227'||
                    TO_CHAR(ROW_NUMBER() OVER(ORDER BY A.ENO_NO),'FM000000')||
                    ?||
                    '2218113834'||
                    RPAD('asan99', 20, ' ')||
                    '9000'||
                    '2218113834'||
                    RPAD('현대아산주식회사', 40, ' ')||
                    RPAD(SUBSTR(A.CET_NO,1,6)||SUBSTR(A.CET_NO,8,7), 13, ' ')||
                    '1'||
                    RPAD(REPLACE(A.ENO_NM,' ',''), 30, ' ')||
                    RPAD(NVL(B.COM_NO,' '), 10, ' ')||
                    RPAD(NVL(B.COM_NM,' '), 40, ' ')||
                    RPAD(B.MED_CD, 1,  ' ')||
                    TO_CHAR(NVL(B.CASH_CNT,0),'FM00000')||
                    TO_CHAR(NVL(B.CASH_AMT,0),'FM00000000000')||
                    RPAD(B.CET_NO, 13, ' ')||
                    '1'||
                    RPAD(DECODE(B.REL_CD,'0','1',DECODE(B.GBN_TAG,NULL,'2','1')), 1, ' ')||
                    '1'||
                    RPAD(' ', 19, ' ')
                   ) AS NPN_NO
            FROM  VI_T_CM_PERSON2 A,
                  (SELECT ENO_NO, 
                  		 CET_NO, 
                  		 COM_NO,
                         SUM(CASH_AMT) CASH_AMT, 
                         SUM(CASH_CNT) CASH_CNT,
                         MIN(COM_NM) COM_NM, MIN(REL_CD) REL_CD, 
                         MIN(GBN_TAG) GBN_TAG, MIN(MED_CD) MED_CD
                    FROM ASNHR.T_AC_MEDICAL_142
                   WHERE PIS_YY = ?
                GROUP BY ENO_NO, CET_NO, COM_NO ) B, 
                ASNHR.T_AC_RETACC_142 C
            WHERE A.ENO_NO = B.ENO_NO
            AND      B.ENO_NO = C.ENO_NO         
            AND      C.PIS_YY = ?
            AND      C.MMA_DED > 0           
            AND      C.GBN_TAG = '8'
            ORDER BY A.ENO_NO
            ]]>
        </query>
    </sql>

    <!-- 기부금신고 -->
    <sql name="YACA001_SHR_DON_14">
        <description>기부금신고</description>
        <query>
            <![CDATA[
            SELECT B.DPT_CD AS DPT_CD,
                        B.DPT_NM AS DPT_NM,
                        B.JOB_CD AS JOB_CD,
                        B.JOB_NM AS JOB_NM,
                        B.ENO_NO AS ENO_NO,
                        B.ENO_NM AS ENO_NM,
                        B.CET_NO AS CET_NO,
                        A.COM_NO AS COM_NO,
                        A.COM_NM AS COM_NM,
                        A.REL_CD AS REL_CD,
                        ASNHR.SF_GET_COMMNAME('01', 'FB', A.REL_CD) AS REL_NM,
                        A.TOT_CNT AS TOT_CNT,
                        A.SUM_AMT AS SUM_AMT
            FROM  ASNHR.T_AC_DONATION_14 A, 
		            VI_T_CM_PERSON2 B, 
		            ASNHR.T_AC_RETACC_14 C
            WHERE A.ENO_NO = B.ENO_NO
            AND    A.PIS_YY = ?
            AND    C.PIS_YY = ?
            AND    C.GBN_TAG = '8'
            AND    A.ENO_NO(+) = C.ENO_NO
            ORDER BY A.ENO_NO
            ]]>
        </query>
    </sql>
    
    <!-- 기부금신고 -->
    <sql name="YACA001_SHR_DON_15">
        <description>기부금신고</description>
        <query>
            <![CDATA[
            SELECT B.DPT_CD AS DPT_CD,
                        B.DPT_NM AS DPT_NM,
                        B.JOB_CD AS JOB_CD,
                        B.JOB_NM AS JOB_NM,
                        B.ENO_NO AS ENO_NO,
                        B.ENO_NM AS ENO_NM,
                        B.CET_NO AS CET_NO,
                        A.COM_NO AS COM_NO,
                        A.COM_NM AS COM_NM,
                        A.REL_CD AS REL_CD,
                        ASNHR.SF_GET_COMMNAME('01', 'FB', A.REL_CD) AS REL_NM,
                        A.TOT_CNT AS TOT_CNT,
                        A.SUM_AMT AS SUM_AMT
            FROM  ASNHR.T_AC_DONATION_15 A, 
		            VI_T_CM_PERSON2 B, 
		            ASNHR.T_AC_RETACC_15 C
            WHERE A.ENO_NO = B.ENO_NO
            AND    A.PIS_YY = ?
            AND    C.PIS_YY = ?
            AND    C.GBN_TAG = '8'
            AND    A.ENO_NO(+) = C.ENO_NO
            ORDER BY A.ENO_NO
            ]]>
        </query>
    </sql>
    

    <!-- 기부금신고 -->
    <sql name="YACA001_SHR_DON_142">
        <description>기부금신고</description>
        <query>
            <![CDATA[
            SELECT B.DPT_CD AS DPT_CD,
                        B.DPT_NM AS DPT_NM,
                        B.JOB_CD AS JOB_CD,
                        B.JOB_NM AS JOB_NM,
                        B.ENO_NO AS ENO_NO,
                        B.ENO_NM AS ENO_NM,
                        B.CET_NO AS CET_NO,
                        A.COM_NO AS COM_NO,
                        A.COM_NM AS COM_NM,
                        A.REL_CD AS REL_CD,
                        ASNHR.SF_GET_COMMNAME('01', 'FB', A.REL_CD) AS REL_NM,
                        A.TOT_CNT AS TOT_CNT,
                        A.SUM_AMT AS SUM_AMT
            FROM  ASNHR.T_AC_DONATION_142 A, 
		            VI_T_CM_PERSON2 B, 
		            ASNHR.T_AC_RETACC_142 C
            WHERE A.ENO_NO = B.ENO_NO
            AND    A.PIS_YY = ?
            AND    C.PIS_YY = ?
            AND    C.GBN_TAG = '8'
            AND    A.ENO_NO(+) = C.ENO_NO
            ORDER BY A.ENO_NO
            ]]>
        </query>
    </sql>

    <!-- 기부금신고 파일출력 -->
    <sql name="YACA001_SHR_FILE_03">
        <description>기부금신고 파일출력</description>
        <query>
            <![CDATA[
            SELECT ROW_NUMBER() OVER(ORDER BY NPN_NO) AS NUM,
                   NPN_NO
            FROM (

                SELECT '1' ENO_NO,
                       '' REL_CD,
                       '' PIS_YY,
                       'A'||
                       '27'||
                       '227'||
                       RPAD(?,8)||
                       '2'||
                       RPAD(' ',6)||
                       RPAD('asan99',20)||
                       '9000'||
                       RPAD('2218113834',10)||
                       RPAD('현대아산주식회사',40)||
                       RPAD('인재지원',30)||
                       RPAD('임보이',30)||
                       RPAD('02-3669-3635',15)||
                       TO_CHAR('1','FM00000')||
                       '101'||
                       RPAD(' ',2) AS NPN_NO
                FROM   ASNHR.T_AC_DONATION_14

                UNION

                SELECT '1' ENO_NO,
                       '' REL_CD,
                       '' PIS_YY,
                       'B'||
                       '27'||
                       '227'||
                       TO_CHAR(1,'FM000000')||
                       RPAD('2218113834',10)||
                       RPAD('현대아산주식회사',40)||
                       TO_CHAR(NVL(ADJ.ADJ_CNT,0),'FM0000000')||
                       TO_CHAR(NVL(DON.DON_CNT,0),'FM0000000')||
                       TO_CHAR(NVL(ADJ.ACC_DON_AMT,0),'FM0000000000000')||
                       TO_CHAR(NVL(ADJ.ACC_DON_DIF,0),'FM0000000000000')||
                       '1'||
                       RPAD(' ',77) AS NPN_NO
                FROM  (SELECT COUNT(*) ADJ_CNT,
                        SUM(ACC_DON_AMT) ACC_DON_AMT,
                        SUM(ACC_DON_DIF) ACC_DON_DIF
                       FROM   ASNHR.T_AC_DONATION_ADJ
                       WHERE  DECODE(REL_CD, '10', ? - 5, '20', ?, '40', ? - 5, '41', ? - 5 ) <= PIS_YY
                       AND ACC_DON_AMT > 0   
                       --AND ENO_NO NOT IN ('2090005')               
                       ) ADJ,
                      (SELECT COUNT(*) DON_CNT
                       FROM   ASNHR.T_AC_DONATION_14
                       WHERE  PIS_YY = ?    
                       --AND ENO_NO NOT IN ('2090005')     
                       ) DON

                UNION
                
             SELECT ENO_NO, REL_CD, PIS_YY, NPN_NO
             FROM(
                  SELECT A.ENO_NO,
                         A.REL_CD,
                         A.PIS_YY,
                       'C'||
                       '27'||
                       '227'||
                        TO_CHAR(DENSE_RANK() OVER(ORDER BY A.ENO_NO ASC),'FM000000')||
                        RPAD('2218113834',10)||
                          RPAD(SUBSTR(B.CET_NO,1,6)||SUBSTR(B.CET_NO,8,7), 13, ' ')||
                          '1'||
                          RPAD(REPLACE(B.ENO_NM,' ',''), 30, ' ')||
                          RPAD(A.REL_CD, 2, ' ')||
                          RPAD(A.DON_YY, 4, ' ')||
                          TO_CHAR(NVL(A.ACC_DON_AMT,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.ACC_DON_DED,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.ACC_DON_DIF,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.DON_DED,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.EXH_AMT,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.VAL_AMT,0),'FM0000000000000')||
                          TO_CHAR(ROW_NUMBER() OVER(PARTITION BY A.ENO_NO ORDER BY A.ENO_NO),'FM00000')||
                          RPAD(' ',25) AS NPN_NO
                   FROM 
                   ASNHR.T_AC_DONATION_ADJ A, 
                   VI_T_CM_PERSON2 B
                   WHERE DECODE(A.REL_CD, '10', ? - 5, '20', ?, '40', ? - 5, '41', ? - 5 ) <= A.PIS_YY
                      AND A.ENO_NO = B.ENO_NO
                      --AND A.ENO_NO NOT IN ('2090005')
                   UNION ALL
                   
                   SELECT
                        A.ENO_NO,
                        A.REL_CD,
                         A.PIS_YY,
                        'D'||
                        '27'||
                        '227'||
                        TO_CHAR(DENSE_RANK() OVER(ORDER BY A.ENO_NO ASC),'FM000000')||
                        RPAD('2218113834',10)||
                        RPAD(SUBSTR(B.CET_NO,1,6)||SUBSTR(B.CET_NO,8,7), 13, ' ')||
                        RPAD(A.REL_CD, 2, ' ')||
                        RPAD(A.COM_NO, 13, ' ')||
                         RPAD(A.COM_NM, 30, ' ')||
                        RPAD(A.FAM_CD, 1, ' ')||
                        '1'||
                           RPAD(REPLACE(A.FAM_NM,' ',''), 20, ' ')||
                           RPAD(REPLACE(A.FAM_NO,'-',''), 13, ' ')||
                           TO_CHAR(NVL(A.TOT_CNT,0),'FM00000')||
                           TO_CHAR(NVL(A.SUM_AMT,0),'FM0000000000000')||
                           TO_CHAR(ROW_NUMBER() OVER(PARTITION BY A.ENO_NO ORDER BY A.ENO_NO),'FM00000')||
                           RPAD(' ',42) AS NPN_NO
                       FROM ASNHR.T_AC_DONATION_14 A, VI_T_CM_PERSON2 B
                       WHERE A.PIS_YY = ?
                         AND A.ENO_NO = B.ENO_NO
                         --AND A.ENO_NO NOT IN ('2090005')
                )
                ORDER BY ENO_NO, PIS_YY ASC, NPN_NO, REL_CD
      )
      ORDER BY ENO_NO, NPN_NO

            ]]>
        </query>
    </sql>

    <!-- 기부금신고 파일출력 -->
    <sql name="YACA001_SHR_FILE_03_142">
        <description>기부금신고 파일출력</description>
        <query>
            <![CDATA[
            SELECT ROW_NUMBER() OVER(ORDER BY NPN_NO) AS NUM,
                   NPN_NO
            FROM (

                SELECT '1' ENO_NO,
                       '' REL_CD,
                       '' PIS_YY,
                       'A'||
                       '27'||
                       '227'||
                       RPAD(?,8)||
                       '2'||
                       RPAD(' ',6)||
                       RPAD('asan99',20)||
                       '9000'||
                       RPAD('2218113834',10)||
                       RPAD('현대아산주식회사',40)||
                       RPAD('인재지원',30)||
                       RPAD('임보이',30)||
                       RPAD('02-3669-3635',15)||
                       TO_CHAR('1','FM00000')||
                       '101'||
                       RPAD(' ',2) AS NPN_NO
                FROM   ASNHR.T_AC_DONATION_142

                UNION

                SELECT '1' ENO_NO,
                       '' REL_CD,
                       '' PIS_YY,
                       'B'||
                       '27'||
                       '227'||
                       TO_CHAR(1,'FM000000')||
                       RPAD('2218113834',10)||
                       RPAD('현대아산주식회사',40)||
                       TO_CHAR(NVL(ADJ.ADJ_CNT,0),'FM0000000')||
                       TO_CHAR(NVL(DON.DON_CNT,0),'FM0000000')||
                       TO_CHAR(NVL(ADJ.ACC_DON_AMT,0),'FM0000000000000')||
                       TO_CHAR(NVL(ADJ.ACC_DON_DIF,0),'FM0000000000000')||
                       '1'||
                       RPAD(' ',77) AS NPN_NO
                FROM  (SELECT COUNT(*) ADJ_CNT,
                        SUM(ACC_DON_AMT) ACC_DON_AMT,
                        SUM(ACC_DON_DIF) ACC_DON_DIF
                       FROM   ASNHR.T_AC_DONATION_ADJ
                       WHERE  DECODE(REL_CD, '10', ? - 5, '20', ?, '40', ? - 5, '41', ? - 5 ) <= PIS_YY
                       AND ACC_DON_AMT > 0   
                       --AND ENO_NO NOT IN ('2090005')               
                       ) ADJ,
                      (SELECT COUNT(*) DON_CNT
                       FROM   ASNHR.T_AC_DONATION_142
                       WHERE  PIS_YY = ?    
                       --AND ENO_NO NOT IN ('2090005')     
                       ) DON

                UNION
                
             SELECT ENO_NO, REL_CD, PIS_YY, NPN_NO
             FROM(
                  SELECT A.ENO_NO,
                         A.REL_CD,
                         A.PIS_YY,
                       'C'||
                       '27'||
                       '227'||
                        TO_CHAR(DENSE_RANK() OVER(ORDER BY A.ENO_NO ASC),'FM000000')||
                        RPAD('2218113834',10)||
                          RPAD(SUBSTR(B.CET_NO,1,6)||SUBSTR(B.CET_NO,8,7), 13, ' ')||
                          '1'||
                          RPAD(REPLACE(B.ENO_NM,' ',''), 30, ' ')||
                          RPAD(A.REL_CD, 2, ' ')||
                          RPAD(A.DON_YY, 4, ' ')||
                          TO_CHAR(NVL(A.ACC_DON_AMT,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.ACC_DON_DED,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.ACC_DON_DIF,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.DON_DED,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.EXH_AMT,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.VAL_AMT,0),'FM0000000000000')||
                          TO_CHAR(ROW_NUMBER() OVER(PARTITION BY A.ENO_NO ORDER BY A.ENO_NO),'FM00000')||
                          RPAD(' ',25) AS NPN_NO
                   FROM 
                   ASNHR.T_AC_DONATION_ADJ A, 
                   VI_T_CM_PERSON2 B
                   WHERE DECODE(A.REL_CD, '10', ? - 5, '20', ?, '40', ? - 5, '41', ? - 5 ) <= A.PIS_YY
                      AND A.ENO_NO = B.ENO_NO
                      --AND A.ENO_NO NOT IN ('2090005')
                   UNION ALL
                   
                   SELECT
                        A.ENO_NO,
                        A.REL_CD,
                         A.PIS_YY,
                        'D'||
                        '27'||
                        '227'||
                        TO_CHAR(DENSE_RANK() OVER(ORDER BY A.ENO_NO ASC),'FM000000')||
                        RPAD('2218113834',10)||
                        RPAD(SUBSTR(B.CET_NO,1,6)||SUBSTR(B.CET_NO,8,7), 13, ' ')||
                        RPAD(A.REL_CD, 2, ' ')||
                        RPAD(A.COM_NO, 13, ' ')||
                         RPAD(A.COM_NM, 30, ' ')||
                        RPAD(A.FAM_CD, 1, ' ')||
                        '1'||
                           RPAD(REPLACE(A.FAM_NM,' ',''), 20, ' ')||
                           RPAD(REPLACE(A.FAM_NO,'-',''), 13, ' ')||
                           TO_CHAR(NVL(A.TOT_CNT,0),'FM00000')||
                           TO_CHAR(NVL(A.SUM_AMT,0),'FM0000000000000')||
                           TO_CHAR(ROW_NUMBER() OVER(PARTITION BY A.ENO_NO ORDER BY A.ENO_NO),'FM00000')||
                           RPAD(' ',42) AS NPN_NO
                       FROM ASNHR.T_AC_DONATION_142 A, VI_T_CM_PERSON2 B
                       WHERE A.PIS_YY = ?
                         AND A.ENO_NO = B.ENO_NO
                         --AND A.ENO_NO NOT IN ('2090005')
                )
                ORDER BY ENO_NO, PIS_YY ASC, NPN_NO, REL_CD
      )
      ORDER BY ENO_NO, NPN_NO

            ]]>
        </query>
    </sql>

 <!-- 기부금신고 파일출력 -->
    <sql name="YACA001_SHR_FILE_03_15">
        <description>기부금신고 파일출력</description>
        <query>
            <![CDATA[
            SELECT ROW_NUMBER() OVER(ORDER BY NPN_NO) AS NUM,
                   NPN_NO
            FROM (

                SELECT '1' ENO_NO,
                       '' REL_CD,
                       '' PIS_YY,
                       'A'||
                       '27'||
                       '227'||
                       RPAD(?,8)||
                       '2'||
                       RPAD(' ',6)||
                       RPAD('asan99',20)||
                       '9000'||
                       RPAD('2218113834',10)||
                       RPAD('현대아산주식회사',40)||
                       RPAD('인재지원',30)||
                       RPAD('임보이',30)||
                       RPAD('02-3669-3635',15)||
                       TO_CHAR('1','FM00000')||
                       '101'||
                       RPAD(' ',2) AS NPN_NO
                FROM   ASNHR.T_AC_DONATION_15

                UNION

                SELECT '1' ENO_NO,
                       '' REL_CD,
                       '' PIS_YY,
                       'B'||
                       '27'||
                       '227'||
                       TO_CHAR(1,'FM000000')||
                       RPAD('2218113834',10)||
                       RPAD('현대아산주식회사',40)||
                       TO_CHAR(NVL(ADJ.ADJ_CNT,0),'FM0000000')||
                       TO_CHAR(NVL(DON.DON_CNT,0),'FM0000000')||
                       TO_CHAR(NVL(ADJ.ACC_DON_AMT,0),'FM0000000000000')||
                       TO_CHAR(NVL(ADJ.ACC_DON_DIF,0),'FM0000000000000')||
                       '1'||
                       RPAD(' ',77) AS NPN_NO
                FROM  (SELECT COUNT(*) ADJ_CNT,
                        SUM(ACC_DON_AMT) ACC_DON_AMT,
                        SUM(ACC_DON_DIF) ACC_DON_DIF
                       FROM   ASNHR.T_AC_DONATION_ADJ
                       WHERE  DECODE(REL_CD, '10', ? - 5, '20', ?, '40', ? - 5, '41', ? - 5 ) <= PIS_YY
                       AND ACC_DON_AMT > 0   
                       --AND ENO_NO NOT IN ('2090005')               
                       ) ADJ,
                      (SELECT COUNT(*) DON_CNT
                       FROM   ASNHR.T_AC_DONATION_15
                       WHERE  PIS_YY = ?    
                       --AND ENO_NO NOT IN ('2090005')     
                       ) DON

                UNION
                
             SELECT ENO_NO, REL_CD, PIS_YY, NPN_NO
             FROM(
                  SELECT A.ENO_NO,
                         A.REL_CD,
                         A.PIS_YY,
                       'C'||
                       '27'||
                       '227'||
                        TO_CHAR(DENSE_RANK() OVER(ORDER BY A.ENO_NO ASC),'FM000000')||
                        RPAD('2218113834',10)||
                          RPAD(SUBSTR(B.CET_NO,1,6)||SUBSTR(B.CET_NO,8,7), 13, ' ')||
                          '1'||
                          RPAD(REPLACE(B.ENO_NM,' ',''), 30, ' ')||
                          RPAD(A.REL_CD, 2, ' ')||
                          RPAD(A.DON_YY, 4, ' ')||
                          TO_CHAR(NVL(A.ACC_DON_AMT,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.ACC_DON_DED,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.ACC_DON_DIF,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.DON_DED,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.EXH_AMT,0),'FM0000000000000')||
                          TO_CHAR(NVL(A.VAL_AMT,0),'FM0000000000000')||
                          TO_CHAR(ROW_NUMBER() OVER(PARTITION BY A.ENO_NO ORDER BY A.ENO_NO),'FM00000')||
                          RPAD(' ',25) AS NPN_NO
                   FROM 
                   ASNHR.T_AC_DONATION_ADJ A, 
                   VI_T_CM_PERSON2 B
                   WHERE DECODE(A.REL_CD, '10', ? - 5, '20', ?, '40', ? - 5, '41', ? - 5 ) <= A.PIS_YY
                      AND A.ENO_NO = B.ENO_NO
                      --AND A.ENO_NO NOT IN ('2090005')
                   UNION ALL
                   
                   SELECT
                        A.ENO_NO,
                        A.REL_CD,
                         A.PIS_YY,
                        'D'||
                        '27'||
                        '227'||
                        TO_CHAR(DENSE_RANK() OVER(ORDER BY A.ENO_NO ASC),'FM000000')||
                        RPAD('2218113834',10)||
                        RPAD(SUBSTR(B.CET_NO,1,6)||SUBSTR(B.CET_NO,8,7), 13, ' ')||
                        RPAD(A.REL_CD, 2, ' ')||
                        RPAD(A.COM_NO, 13, ' ')||
                         RPAD(A.COM_NM, 30, ' ')||
                        RPAD(A.FAM_CD, 1, ' ')||
                        '1'||
                           RPAD(REPLACE(A.FAM_NM,' ',''), 20, ' ')||
                           RPAD(REPLACE(A.FAM_NO,'-',''), 13, ' ')||
                           TO_CHAR(NVL(A.TOT_CNT,0),'FM00000')||
                           TO_CHAR(NVL(A.SUM_AMT,0),'FM0000000000000')||
                           TO_CHAR(ROW_NUMBER() OVER(PARTITION BY A.ENO_NO ORDER BY A.ENO_NO),'FM00000')||
                           RPAD(' ',42) AS NPN_NO
                       FROM ASNHR.T_AC_DONATION_15 A, VI_T_CM_PERSON2 B
                       WHERE A.PIS_YY = ?
                         AND A.ENO_NO = B.ENO_NO
                         --AND A.ENO_NO NOT IN ('2090005')
                )
                ORDER BY ENO_NO, PIS_YY ASC, NPN_NO, REL_CD
      )
      ORDER BY ENO_NO, NPN_NO

            ]]>
        </query>
    </sql>
<!--
***********************************************************************
* @UseCase     : YACA011
* @description : 연말정산제출관리
***********************************************************************
* 2013/01/22     이동훈        최초작성.
***********************************************************************
-->

    <!-- 연말정산제출정보 가져온다. -->
    <sql name="YACA011_SHR">
        <description>연말정산제출관리</description>
        <query>
            <![CDATA[
            SELECT 
            		A.ENO_NO, B.ENO_NM,
					B.DPT_CD, ASNHR.SF_GET_DPTNAME('01', 'A4',B.DPT_CD) AS DPT_NM,
					B.TEAM_CD, ASNHR.SF_GET_DPTNAME('01', 'A6',B.TEAM_CD) AS TEAM_NM,
                    B.JOB_CD, ASNHR.SF_GET_COMMNAME('01', 'A2', B.JOB_CD) AS JOB_NM,
				    A.FUN_CNT
            FROM   ASNHR.T_AC_RETACC A, ASNHR.T_CM_PERSON B
            WHERE  A.ENO_NO = B.ENO_NO
            AND A.PIS_YY = ?
            AND A.FUN_CNT LIKE '%'||?||'%'
            AND A.ENO_NO NOT IN ('1990072','2010020','2010021','2040008','2040014','2040028','2060011','2060023','2070002','2070022','2070032','2070035','2080029','2080038','2080039','2090010','2090012',
            '2100006','2100010','2120009','2120011','2120014','2130031','3070033','3110010','3110020','3110022','3120004','3120012','2040018','2050001','2130023','2130036','3080133','3130007')
			ORDER BY B.DPT_CD, B.JOB_CD
            ]]>
        </query>
    </sql>    
    
    <!-- 연말정산제출정보 가져온다. -->
    <sql name="YACA011_SHR_14">
        <description>연말정산제출관리</description>
        <query>
            <![CDATA[
            SELECT 
            		A.ENO_NO, B.ENO_NM,
					B.DPT_CD, ASNHR.SF_GET_DPTNAME('01', 'A4',B.DPT_CD) AS DPT_NM,
					B.TEAM_CD, ASNHR.SF_GET_DPTNAME('01', 'A6',B.TEAM_CD) AS TEAM_NM,
                    B.JOB_CD, ASNHR.SF_GET_COMMNAME('01', 'A2', B.JOB_CD) AS JOB_NM,
				    A.FUN_CNT
            FROM   ASNHR.T_AC_RETACC_14 A, ASNHR.T_CM_PERSON B
            WHERE  A.ENO_NO = B.ENO_NO
            AND A.PIS_YY = ?
            AND A.FUN_CNT LIKE '%'||?||'%' 
            AND (B.RET_YMD IS NULL OR B.ENO_NO IN ('2120029','2120033','2140027','2140030','3110012','3130008','3140016','3140017'))
			ORDER BY B.DPT_CD, B.JOB_CD
            ]]>
        </query>
    </sql>       
    
    <!-- 연말정산제출정보 가져온다. -->
    <sql name="YACA011_SHR_15">
        <description>연말정산제출관리</description>
        <query>
            <![CDATA[
            SELECT 
            		A.ENO_NO, B.ENO_NM,
					B.DPT_CD, ASNHR.SF_GET_DPTNAME('01', 'A4',B.DPT_CD) AS DPT_NM,
					B.TEAM_CD, ASNHR.SF_GET_DPTNAME('01', 'A6',B.TEAM_CD) AS TEAM_NM,
                    B.JOB_CD, ASNHR.SF_GET_COMMNAME('01', 'A2', B.JOB_CD) AS JOB_NM,
				    A.FUN_CNT
            FROM   ASNHR.T_AC_RETACC_15 A, ASNHR.T_CM_PERSON B
            WHERE  A.ENO_NO = B.ENO_NO
            AND A.PIS_YY = ?
            AND A.FUN_CNT LIKE '%'||?||'%' 
            --AND (B.RET_YMD IS NULL OR B.ENO_NO IN ('2120029','2120033','2140027','2140030','3110012','3130008','3140016','3140017'))
			ORDER BY B.DPT_CD, B.JOB_CD
            ]]>
        </query>
    </sql>       
    
    
    <!-- 연말정산제출정보 수정한다. -->
    <sql name="YACA011_UPT">
        <description>연말정산제출관리</description>
        <query>
            <![CDATA[
	            UPDATE ASNHR.T_AC_RETACC
	            SET    FUN_CNT    = ?
	            WHERE  GBN_TAG  = '8'
	            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>
    
    <!-- 연말정산제출정보 수정한다. -->
    <sql name="YACA011_UPT_14">
        <description>연말정산제출관리</description>
        <query>
            <![CDATA[
	            UPDATE ASNHR.T_AC_RETACC_14
	            SET    FUN_CNT    = ?
	            WHERE  GBN_TAG  = '8'
	            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>    
    
<!--
***********************************************************************
* @UseCase     : YACA020
* @description : 연말정산자료등록
***********************************************************************
* 2007/04/17     조정호        최초작성.
***********************************************************************
-->
    <!-- 선택 직원의 연말 정산 정보를 조회 한다. -->
    <sql name="YACA020_SHR">
        <description>선택 직원의 연말 정산 정보를 조회</description>
        <query>
            <![CDATA[
             SELECT DECODE(A.NPEN_AMT, 0, NVL(B.NPEN_AMT, 0), A.NPEN_AMT)   AS NPEN_AMT
                  , NVL(A.EPEN_AMT, 0) AS EPEN_AMT
                  , DECODE(A.HINU_AMT, 0, NVL(B.HINU_AMT, 0), A.HINU_AMT)   AS HINU_AMT
                  , DECODE(A.HINS_AMT, 0, NVL(B.HINS_AMT, 0), A.HINS_AMT)   AS HINS_AMT
                  , DECODE(A.OLD_AMT,  0, NVL(B.OLD_AMT,  0), A.OLD_AMT)    AS OLD_AMT
                  , A.SOU_CNT
                  , DECODE(A.SOU_CNT, 0, 'N', 'Y') AS SOU_YN
                  , A.DFM_CNT
                  , A.GOL_CNT70
                  , A.TRB_CNT
                  , A.WCT_CNT
                  , DECODE(A.WCT_CNT, 0, 'N', 'Y') AS WCT_YN
                  , A.RCH_CNT
                  , A.CHI_CNT

                  , A.LIN_AMT
                  , A.LIH_AMT
                  , A.MHEA_AMT
                  , A.OHEA_AMT
                  , A.LF2_AMT
                  , LEAST(A.LEN_AMT,500000) LEN_AMT
                  , A.LEN_AMT2
                  , A.LEN_AMT3
                  , A.LEN_AMT4
                  , A.LEN_AMT5
                  , A.GRA_AMT
                  , A.EDU_TAG1
                  , A.EDU_TAG2
                  , A.EDU_TAG3
                  , A.EDU_TAG4
                  , A.EDU_TAG5
                  , A.EDU_AMT1
                  , A.EDU_AMT2
                  , A.EDU_AMT3
                  , A.EDU_AMT4
                  , A.EDU_AMT5
                  , A.HED_AMT
                  , A.LHO_AMT
                  , A.LHP_AMT
                  , A.LHQ_AMT
                  , A.LHR_AMT
                  , A.LH1_AMT
                  , A.LH2_AMT
                  , A.LH3_AMT                  
                  , A.LH4_AMT
                  , A.LH5_AMT
                  , A.LH6_AMT
                  , A.LH7_AMT
                  , A.LH8_AMT                  



                  , A.GOV_AMT
                  , A.LC1_AMT
                  , A.LC2_AMT
                  , A.LC3_AMT
                                    

                  , A.GOV_NTS
                  , A.LC1_NTS
                  , A.LC2_NTS
                  , A.LC3_NTS
                                    
                  , A.GOV_DED
                  , A.WED_CNT
                  , A.MOV_CNT
                  , A.FUN_CNT

                  , A.ANN_AMT
                  , A.VEN2_AMT
                  , A.CARD_AMT
                  , A.DIR_CARD_AMT
                  , A.CASH_AMT
                  , A.GIRO_AMT
                  , A.MARKET_AMT                  
                  , A.LST_AMT
                  , 0 AS TMP1_AMT
                  , NVL(A.PAYO_AMTS,0) + NVL(A.PAYO_AMTB,0) AS PAYO_SUM
                  , A.LSQ_AMT
                  , A.STOCK_AMT3
                  , TO_CHAR(A.SALT_AMTT,'99,999,999,999')  AS SALT_AMT                              
                  , TO_CHAR(A.FREE_INCOME,'99,999,999,999')  AS FREE_INCOME
                  , TO_CHAR(A.TAX_INCOME,'99,999,999,999')  AS TAX_INCOME                   
                  , TO_CHAR( TRUNC(A.TAX_INCOME*0.03),'99,999,999,999') AS HOSPT_AMT
                  , TO_CHAR(TRUNC(TAX_INCOME*0.25),'99,999,999,999') AS MIN_CARD_AMT
                  , NVL(A.WEL_CARD,0)   AS WEL_CARD
                  , CLS_TAG                 
                  , HOL_YN
                  , (CASE WHEN A.TAX_INCOME < 50000000 THEN 'Y'
                                                      ELSE 'N' END) AS TAX_IC
                FROM ASNHR.T_AC_RETACC A
          LEFT JOIN (SELECT C.PIS_YY
                          , C.ENO_NO
                          , NVL(SUM(C.NPEN_AMT),0)        AS NPEN_AMT --국민연금보험료

                          , NVL(SUM(C.HINU_AMT),0) + (SELECT NVL(SUM(AMOUNT),0)
                                                      FROM   ASNHR.T_CP_CHANGE E
                                                      WHERE  C.PIS_YY = E.PIS_YY
                                                      AND    E.PIS_MM = '04'
                                                      AND    C.ENO_NO = E.ENO_NO
                                                      AND    E.SAL_CD IN ('JN','HD')) AS HINU_AMT --국민건강보험료
                          , NVL(SUM(C.HINS_AMT),0)        AS HINS_AMT --고용보험료
                          , NVL(SUM(C.OLD_AMT),0)                                     AS OLD_AMT  --노인장기요양보험료
                       FROM ASNHR.T_CP_PAYMASTER C
					WHERE C.PIS_YY = '2012'                       
                       GROUP BY C.PIS_YY
                              , C.ENO_NO
                     ) B
                 ON A.PIS_YY    = B.PIS_YY
                AND A.ENO_NO    = B.ENO_NO
              WHERE A.PIS_YY    = ?
                AND A.ENO_NO    = ?
                AND A.GBN_TAG   = '8'
            ]]>
        </query>
    </sql>

    <!-- 개인정보 가져온다. -->
    <sql name="YACA020_SHR_01">
        <description>개인정보 가져온다.</description>
        <query>
            <![CDATA[
            SELECT ENO_NO
                  ,ENO_NM
                  ,OCC_CD
                  ,OCC_NM
                  ,HEAD_CD
                  ,HEAD_NM
                  ,DPT_CD
                  ,DPT_NM
                  ,JOB_CD
                  ,JOB_NM
                  ,HOB_CD
                  ,HOB_NM
                  ,CET_NO
                  ,DECODE(ZIP_NO,NULL,'',SUBSTR(ZIP_NO,1,3)||'-'||SUBSTR(ZIP_NO,4,3)) AS ZIP_NO
                  ,ADDRESS
                  ,ADR_CT
            FROM   VI_T_CM_PERSON2
            WHERE  ENO_NO = ?

            ]]>
        </query>
    </sql>


    <!-- 개인정보 가져온다. -->
    <sql name="YACA020_SHR2_14">
        <description>개인정보 가져온다.</description>
        <query>
            <![CDATA[
            SELECT ENO_NO
                  ,ENO_NM
                  ,OCC_CD
                  ,OCC_NM
                  ,HEAD_CD
                  ,HEAD_NM
                  ,DPT_CD
                  ,DPT_NM
                  ,JOB_CD
                  ,JOB_NM
                  ,HOB_CD
                  ,HOB_NM
                  ,CET_NO
                  ,DECODE(ZIP_NO,NULL,'',SUBSTR(ZIP_NO,1,3)||'-'||SUBSTR(ZIP_NO,4,3)) AS ZIP_NO
                  ,ADDRESS
                  ,ADR_CT
            FROM   VI_T_CM_PERSON2
            WHERE  ENO_NO = ?

            ]]>
        </query>
    </sql>
    
    
    <!-- 개인정보 가져온다. -->
    <sql name="YACA020_SHR2_142">
        <description>개인정보 가져온다.</description>
        <query>
            <![CDATA[
            SELECT ENO_NO
                  ,ENO_NM
                  ,OCC_CD
                  ,OCC_NM
                  ,HEAD_CD
                  ,HEAD_NM
                  ,DPT_CD
                  ,DPT_NM
                  ,JOB_CD
                  ,JOB_NM
                  ,HOB_CD
                  ,HOB_NM
                  ,CET_NO
                  ,DECODE(ZIP_NO,NULL,'',SUBSTR(ZIP_NO,1,3)||'-'||SUBSTR(ZIP_NO,4,3)) AS ZIP_NO
                  ,ADDRESS
                  ,ADR_CT
            FROM   VI_T_CM_PERSON2
            WHERE  ENO_NO = ?

            ]]>
        </query>
    </sql>    
    
     <!-- 개인정보 가져온다. -->
    <sql name="YACA020_SHR2_15">
        <description>개인정보 가져온다.</description>
        <query>
            <![CDATA[
            SELECT ENO_NO
                  ,ENO_NM
                  ,OCC_CD
                  ,OCC_NM
                  ,HEAD_CD
                  ,HEAD_NM
                  ,DPT_CD
                  ,DPT_NM
                  ,JOB_CD
                  ,JOB_NM
                  ,HOB_CD
                  ,HOB_NM
                  ,CET_NO
                  ,DECODE(ZIP_NO,NULL,'',SUBSTR(ZIP_NO,1,3)||'-'||SUBSTR(ZIP_NO,4,3)) AS ZIP_NO
                  ,ADDRESS
                  ,ADR_CT
            FROM   VI_T_CM_PERSON2
            WHERE  ENO_NO = ?

            ]]>
        </query>
    </sql>    
    
    
    <!-- 출력정보 가져온다. -->
    <sql name="YACA020_SHR2_PRT_14">
        <description>개인정보 가져온다.</description>
        <query>
            <![CDATA[
            SELECT A.ENO_NO,A.ENO_NM,A.CET_NO, A.RADR_CT||' '||A.RADR AS ADDRESS,A.EM_PHN_NO AS TELNO,
            (CASE WHEN A.HIR_YMD < '20140101' THEN '2014.01.01 ~ 2014.12.31' ELSE HIR_YMD||' ~ 2014.12.31' END) AS WORKDAY,
            (CASE WHEN C.HOL_YN = 'Y' THEN  '세대주 ■,  세대원 □'  ELSE '세대주 □,  세대원 ■' END ) AS HOL_YN, 
            (CASE WHEN B.CLS_TAG = 'Y' THEN  '전년과동일 ■,  변동 □'  ELSE '전년과동일 □,  변동 ■' END ) AS CLS_TAG,
            NVL(D.CHILD,0) AS CNT
            FROM   ASNHR.T_CM_PERSON A, ASNHR.T_AC_RETACC_14 B, ASNHR.T_AC_FAMILY_14 C,
                  	  (SELECT  ENO_NO,  SUM(DECODE(REL_CD,'4',1,0)) AS CHILD     
      					FROM ASNHR.T_AC_FAMILY_14 WHERE ENO_NO = ? AND PIS_YY = '2014' GROUP BY ENO_NO) D
            WHERE  A.ENO_NO = B.ENO_NO 
            	AND A.ENO_NO = C.ENO_NO 
            	AND A.ENO_NO = D.ENO_NO
           	 	AND C.REL_CD = '0'
            	AND B.PIS_YY = '2014' 
            	AND A.ENO_NO = ?     
            

            ]]>
        </query>
    </sql>    
    
    <!-- 출력정보 가져온다. -->
    <sql name="YACA020_SHR2_PRT_142">
        <description>개인정보 가져온다.</description>
        <query>
            <![CDATA[
            SELECT A.ENO_NO,A.ENO_NM,A.CET_NO, A.RADR_CT||' '||A.RADR AS ADDRESS,A.EM_PHN_NO AS TELNO,
            (CASE WHEN A.HIR_YMD < '20140101' THEN '2014.01.01 ~ 2014.12.31' ELSE HIR_YMD||' ~ 2014.12.31' END) AS WORKDAY,
            (CASE WHEN C.HOL_YN = 'Y' THEN  '세대주 ■,  세대원 □'  ELSE '세대주 □,  세대원 ■' END ) AS HOL_YN, 
            (CASE WHEN B.CLS_TAG = 'Y' THEN  '전년과동일 ■,  변동 □'  ELSE '전년과동일 □,  변동 ■' END ) AS CLS_TAG,
            NVL(D.CHILD,0) AS CNT
            FROM   ASNHR.T_CM_PERSON A, ASNHR.T_AC_RETACC_142 B, ASNHR.T_AC_FAMILY_142 C,
                  	  (SELECT  ENO_NO,  SUM(DECODE(REL_CD,'4',1,0)) AS CHILD     
      					FROM ASNHR.T_AC_FAMILY_142 WHERE ENO_NO = ? AND PIS_YY = '2014' GROUP BY ENO_NO) D
            WHERE  A.ENO_NO = B.ENO_NO 
            	AND A.ENO_NO = C.ENO_NO 
            	AND A.ENO_NO = D.ENO_NO
           	 	AND C.REL_CD = '0'
            	AND B.PIS_YY = '2014' 
            	AND A.ENO_NO = ?     
            

            ]]>
        </query>
    </sql>      
    
     <!-- 출력정보 가져온다. -->
    <sql name="YACA020_SHR2_PRT_15">
        <description>개인정보 가져온다.</description>
        <query>
            <![CDATA[
            SELECT A.ENO_NO,A.ENO_NM,A.CET_NO, A.RADR_CT||' '||A.RADR AS ADDRESS,A.EM_PHN_NO AS TELNO,
            (CASE WHEN A.HIR_YMD < '20150101' THEN '2015.01.01 ~ 2015.12.31' ELSE HIR_YMD||' ~ 2015.12.31' END) AS WORKDAY,
            (CASE WHEN C.HOL_YN = 'Y' THEN  '세대주 ■,  세대원 □'  ELSE '세대주 □,  세대원 ■' END ) AS HOL_YN, 
            (CASE WHEN B.CLS_TAG = 'Y' THEN  '전년과동일 ■,  변동 □'  ELSE '전년과동일 □,  변동 ■' END ) AS CLS_TAG,
            NVL(D.CHILD,0) AS CNT,
            (CASE WHEN A.LUN_CHK = '1' THEN  '120% □,   100% □,  80% ■' 
              WHEN A.LUN_CHK = '2' THEN  '120% □,   100% ■,  80% □' 
              WHEN A.LUN_CHK = '3' THEN  '120% ■,   100% □,  80% □' 
              ELSE '120% □,   100% ■,  80% □'  END ) AS LUN_CHK,
            (CASE WHEN C.INS_TAG = 'Y' THEN  '신청 ■, 미신청 □'  ELSE '신청 □, 미신청 ■' END ) AS INS_TAG
            FROM   ASNHR.T_CM_PERSON A, ASNHR.T_AC_RETACC_15 B, ASNHR.T_AC_FAMILY_15 C,
                  	  (SELECT  ENO_NO,  SUM(DECODE(REL_CD,'4',1,0)) AS CHILD     
      					FROM ASNHR.T_AC_FAMILY_15 WHERE ENO_NO = ? AND PIS_YY = '2015' GROUP BY ENO_NO) D
            WHERE  A.ENO_NO = B.ENO_NO 
            	AND A.ENO_NO = C.ENO_NO 
            	AND A.ENO_NO = D.ENO_NO
           	 	AND C.REL_CD = '0'
            	AND B.PIS_YY = '2015' 
            	AND A.ENO_NO = ?     
            
            ]]>
        </query>
    </sql>      
    
    <!-- 출력 부양가족정보 가져온다. -->
    <sql name="YACA020_SHR3_PRT_14">
        <description>부양가족정보 출력</description>
        <query>
            <![CDATA[
            SELECT A.ENO_NO,B.REL_CD, B.NAM_KOR, B.CET_NO,
            		(CASE WHEN SUBSTR(B.CET_NO,7,1)='1' OR SUBSTR(B.CET_NO,7,1)='2' OR SUBSTR(B.CET_NO,7,1)='3' OR SUBSTR(B.CET_NO,7,1)='4'
			           THEN '1' ELSE '9' END ) AS REF1,
                 B.BAS_MAN AS REF2, B.WCT_MAN AS REF3,B.ONE_MAN AS REF4, B.GOL_70 AS REF5,B.TRB_MAN AS REF6,
                 (NVL(C.JAH_AMT,0) + NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0) + NVL(C.JAP_AMT,0) + NVL(A.HINS_AMT,0)) AS REF10,
                B.LIN_AMT_NTS AS REF11, 
                B.MED_AMT_NTS AS REF12, (B.EDU_AMT_NTS + B.HED_AMT_NTS) AS REF13,
                B.CARD_AMT_NTS AS REF14, B.DIR_CARD_AMT_NTS AS REF15, B.CASH_AMT_NTS AS REF16, B.MARKET_AMT_NTS AS REF17, B.PUBLIC_AMT_NTS AS REF18,     
                NVL(B.GOV_AMT_NTS, '0')+NVL(B.LC1_AMT_NTS, '0')+NVL(B.LC2_AMT_NTS, '0')+NVL(B.LC3_AMT_NTS, '0')  AS REF19,
                B.LIN_AMT AS REF21,
                B.MED_AMT AS REF22, (B.EDU_AMT + B.HED_AMT) AS REF23,                            
                B.CARD_AMT AS REF24, B.DIR_CARD_AMT AS REF25, B.MARKET_AMT AS REF27, B.PUBLIC_AMT AS REF28,
				NVL(B.GOV_AMT, '0')+NVL(B.LC1_AMT, '0')+NVL(B.LC2_AMT, '0')+NVL(B.LC3_AMT, '0')  AS REF29
            FROM   ASNHR.T_AC_RETACC_14 A, ASNHR.T_AC_FAMILY_14 B, 
            		(SELECT ENO_NO, SUM(JAH_AMT) JAH_AMT, SUM(JAP_AMT) JAP_AMT FROM ASNHR.T_AC_DUTYPLACE WHERE PIS_YY = '2014' GROUP BY ENO_NO ) C
            WHERE  A.ENO_NO = B.ENO_NO AND A.ENO_NO = C.ENO_NO(+) 
            	AND A.PIS_YY = '2014' AND B.PIS_YY = '2014' 
            	AND A.ENO_NO = ?     
            ORDER BY REL_CD
            ]]>
        </query>
    </sql>       
    
    <!-- 출력 부양가족정보 가져온다. -->
    <sql name="YACA020_SHR3_PRT_142">
        <description>부양가족정보 출력</description>
        <query>
            <![CDATA[
            SELECT A.ENO_NO,B.REL_CD, B.NAM_KOR, B.CET_NO,
            		(CASE WHEN SUBSTR(B.CET_NO,7,1)='1' OR SUBSTR(B.CET_NO,7,1)='2' OR SUBSTR(B.CET_NO,7,1)='3' OR SUBSTR(B.CET_NO,7,1)='4'
			           THEN '1' ELSE '9' END ) AS REF1,
                 B.BAS_MAN AS REF2, B.WCT_MAN AS REF3,B.ONE_MAN AS REF4, B.GOL_70 AS REF5,B.TRB_MAN AS REF6,
                 (NVL(C.JAH_AMT,0) + NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0) + NVL(C.JAP_AMT,0) + NVL(A.HINS_AMT,0)) AS REF10,
                B.LIN_AMT_NTS AS REF11, 
                B.MED_AMT_NTS AS REF12, (B.EDU_AMT_NTS + B.HED_AMT_NTS) AS REF13,
                B.CARD_AMT_NTS AS REF14, B.DIR_CARD_AMT_NTS AS REF15, B.CASH_AMT_NTS AS REF16, B.MARKET_AMT_NTS AS REF17, B.PUBLIC_AMT_NTS AS REF18,     
                NVL(B.GOV_AMT_NTS, '0')+NVL(B.LC1_AMT_NTS, '0')+NVL(B.LC2_AMT_NTS, '0')+NVL(B.LC3_AMT_NTS, '0')  AS REF19,
                B.LIN_AMT AS REF21,
                B.MED_AMT AS REF22, (B.EDU_AMT + B.HED_AMT) AS REF23,                            
                B.CARD_AMT AS REF24, B.DIR_CARD_AMT AS REF25, B.MARKET_AMT AS REF27, B.PUBLIC_AMT AS REF28,
				NVL(B.GOV_AMT, '0')+NVL(B.LC1_AMT, '0')+NVL(B.LC2_AMT, '0')+NVL(B.LC3_AMT, '0')  AS REF29
            FROM   ASNHR.T_AC_RETACC_142 A, ASNHR.T_AC_FAMILY_142 B, 
            		(SELECT ENO_NO, SUM(JAH_AMT) JAH_AMT, SUM(JAP_AMT) JAP_AMT FROM ASNHR.T_AC_DUTYPLACE WHERE PIS_YY = '2014' GROUP BY ENO_NO ) C
            WHERE  A.ENO_NO = B.ENO_NO AND A.ENO_NO = C.ENO_NO(+) 
            	AND A.PIS_YY = '2014' AND B.PIS_YY = '2014' 
            	AND A.ENO_NO = ?     
            ORDER BY REL_CD
            ]]>
        </query>
    </sql>        
    
     <!-- 출력 부양가족정보 가져온다. -->
    <sql name="YACA020_SHR3_PRT_15">
        <description>부양가족정보 출력</description>
        <query>
            <![CDATA[
            SELECT A.ENO_NO,B.REL_CD, B.NAM_KOR, B.CET_NO,
            		(CASE WHEN SUBSTR(B.CET_NO,7,1)='1' OR SUBSTR(B.CET_NO,7,1)='2' OR SUBSTR(B.CET_NO,7,1)='3' OR SUBSTR(B.CET_NO,7,1)='4'
			           THEN '1' ELSE '9' END ) AS REF1,
                 B.BAS_MAN AS REF2, B.WCT_MAN AS REF3,B.ONE_MAN AS REF4, B.GOL_70 AS REF5,B.TRB_MAN AS REF6,
                 B.INP_MAN AS REF7, B.RCH_MAN AS REF8,
                 (NVL(C.JAH_AMT,0) + NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0) + NVL(C.JAP_AMT,0) + NVL(A.HINS_AMT,0)) AS REF10,
                NVL(B.LIN_AMT_NTS,0)+ NVL(B.LIH_AMT_NTS,0) AS REF11, 
                B.MED_AMT_NTS AS REF12, (B.EDU_AMT_NTS + B.HED_AMT_NTS) AS REF13,
                B.CARD_AMT_NTS AS REF14, B.DIR_CARD_AMT_NTS AS REF15, B.CASH_AMT_NTS AS REF16, B.MARKET_AMT_NTS AS REF17, B.PUBLIC_AMT_NTS AS REF18,     
                NVL(B.GOV_AMT_NTS, '0')+NVL(B.LC1_AMT_NTS, '0')+NVL(B.LC2_AMT_NTS, '0')+NVL(B.LC3_AMT_NTS, '0')+NVL(B.LC4_AMT_NTS, '0')  AS REF19,
                NVL(B.LIN_AMT,0)+NVL(B.LIH_AMT,0) AS REF21,
                B.MED_AMT AS REF22, (B.EDU_AMT + B.HED_AMT) AS REF23,                            
                B.CARD_AMT AS REF24, B.DIR_CARD_AMT AS REF25, B.MARKET_AMT AS REF27, B.PUBLIC_AMT AS REF28,
				NVL(B.GOV_AMT, '0')+NVL(B.LC1_AMT, '0')+NVL(B.LC2_AMT, '0')+NVL(B.LC3_AMT, '0')+NVL(B.LC4_AMT, '0')  AS REF29
            FROM   ASNHR.T_AC_RETACC_15 A, ASNHR.T_AC_FAMILY_15 B, 
            		(SELECT ENO_NO, SUM(JAH_AMT) JAH_AMT, SUM(JAP_AMT) JAP_AMT FROM ASNHR.T_AC_DUTYPLACE WHERE PIS_YY = '2015' GROUP BY ENO_NO ) C
            WHERE  A.ENO_NO = B.ENO_NO AND A.ENO_NO = C.ENO_NO(+) 
            	AND A.PIS_YY = '2015' AND B.PIS_YY = '2015' 
            	AND A.ENO_NO = ?     
            ORDER BY REL_CD
            ]]>
        </query>
    </sql>        
    
    
    <!-- 2,3 페이지 정보 가져온다. -->
    <sql name="YACA020_SHR4_PRT_14">
        <description>2,3 페이지정보 출력</description>
        <query>
            <![CDATA[
            SELECT 
                   A.PIS_YY, TO_CHAR(SYSDATE,'YYYYMMDD') AS TODAY,
            	   A.ENO_NO, 
                   NVL(B.JAQ_AMT,0) JAQ_AMT,
                   NVL(B.JAR_AMT,0) JAR_AMT,
                   NVL(B.JAH_AMT,0) JAH_AMT,
                   NVL(B.JAP_AMT,0) JAP_AMT,            	   
                   NVL(A.NPEN_AMT,0) NPEN_AMT,
                   (NVL(B.JAQ_AMT,0) + NVL(B.JAR_AMT,0) + NVL(A.NPEN_AMT,0) ) AS PEN_SUM,
                   (NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0)) AS HEALTH_AMT,
                   NVL(A.HINS_AMT,0) HINS_AMT,
                   (NVL(B.JAH_AMT,0) + NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0) + NVL(B.JAP_AMT,0) + NVL(A.HINS_AMT,0)) AS HIN_SUM,
                   NVL(A.LH1_AMT,0) LH1_AMT,
                   NVL(A.LH2_AMT,0) LH2_AMT,
                   NVL(A.LH3_AMT,0) LH3_AMT,                   
                   NVL(A.LH4_AMT,0) LH4_AMT,                   
                   NVL(A.LH5_AMT,0) LH5_AMT,
                   NVL(A.LH6_AMT,0) LH6_AMT,
                   NVL(A.LH7_AMT,0) LH7_AMT,
                   NVL(A.LH8_AMT,0) LH8_AMT,
                   (NVL(A.LH1_AMT,0) + NVL(A.LH2_AMT,0) +  NVL(A.LH3_AMT,0) + NVL(A.LH4_AMT,0) + NVL(A.LH5_AMT,0) + NVL(A.LH6_AMT,0) + NVL(A.LH7_AMT,0) + NVL(A.LH8_AMT,0)) AS LH_SUM,                   
                   NVL(A.PER_AMT,0) PER_AMT,
                   NVL(A.LHO_AMT,0) LHO_AMT,
                   NVL(A.LHR_AMT,0) LHR_AMT,                   
                   NVL(A.LHP_AMT,0) LHP_AMT,  
                   (NVL(A.PER_AMT,0) + NVL(A.LHO_AMT,0) +  NVL(A.LHR_AMT,0) +  NVL(A.LHP_AMT,0)) AS LLL_SUM,                                      
                   NVL(A.VEN_AMT,0) VEN_AMT,
                   NVL(A.VEN2_AMT,0) VEN2_AMT,
                   NVL(A.VEN3_AMT,0) VEN3_AMT,
                   (NVL(A.VEN_AMT,0) + NVL(A.VEN2_AMT,0) +  NVL(A.VEN3_AMT,0)) AS VEN_SUM,  
                   NVL(A.CARD_AMT,0) CARD_AMT,
                   NVL(A.DIR_CARD_AMT,0) DIR_CARD_AMT,
                   NVL(A.CASH_AMT,0) CASH_AMT,                   
                   NVL(A.MARKET_AMT,0) MARKET_AMT,  
                   NVL(A.PUBLIC_AMT,0) PUBLIC_AMT,                    
                   (NVL(A.CARD_AMT,0) + NVL(A.DIR_CARD_AMT,0) +  NVL(A.CASH_AMT,0) +  NVL(A.MARKET_AMT,0) +  NVL(A.PUBLIC_AMT,0)) AS CARD_SUM, 
                   NVL(A.SAJU_AMT,0) SAJU_AMT,                   
                   NVL(A.LSS_AMT,0) LSS_AMT,
                   NVL(A.ANN_AMT,0) ANN_AMT, 
                   NVL(A.LIN_AMT,0) LIN_AMT, 
                   NVL(A.LIH_AMT,0) LIH_AMT, 
                   (NVL(A.LIN_AMT,0) + NVL(A.LIH_AMT,0)) AS LI_SUM,
                   (NVL(A.MHEA_AMT,0) + NVL(A.HAN_AMT,0)) AS HEA_AMT,
                   NVL(A.OHEA_AMT,0) OHEA_AMT,
                   (NVL(A.MHEA_AMT,0) + NVL(A.HAN_AMT,0) + NVL(A.OHEA_AMT,0)) AS HEA_SUM,
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_14 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '1' 
                  AND NVL(EDU_AMT_NTS,0)+NVL(EDU_AMT,0) != 0 GROUP BY ENO_NO, EDU_TAG) AS TAG1_CNT,
                  (SELECT '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_14 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '2' 
                  GROUP BY ENO_NO, EDU_TAG) AS TAG2_CNT,                  
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_14 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '3' 
                  AND REL_CD != '0' GROUP BY ENO_NO, EDU_TAG) AS TAG3_CNT,                    
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_14 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND HED_AMT + HED_AMT_NTS > 0 GROUP BY ENO_NO, EDU_TAG) AS TAG4_CNT,                      
                   NVL(A.GRA_AMT,0) GRA_AMT,
                  (SELECT  SUM(nvl(EDU_AMT_NTS,0)+nvl(EDU_AMT,0)) FROM ASNHR.T_AC_FAMILY_14 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '1' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT1,
                  (SELECT  SUM(nvl(EDU_AMT_NTS,0)+nvl(EDU_AMT,0)) FROM ASNHR.T_AC_FAMILY_14 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '2' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT2,
                  (SELECT  SUM(nvl(EDU_AMT_NTS,0)+nvl(EDU_AMT,0)) FROM ASNHR.T_AC_FAMILY_14 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '3' AND REL_CD != '0' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT3,         
                  (SELECT  SUM(HED_AMT_NTS+HED_AMT) FROM ASNHR.T_AC_FAMILY_14 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND HED_AMT_NTS > 0 GROUP BY ENO_NO, EDU_TAG) AS HED_AMT,
                   (NVL(A.GRA_AMT,0) + NVL(A.EDU_AMT1,0) + NVL(A.EDU_AMT2,0) + NVL(A.EDU_AMT3,0)  + NVL(A.HED_AMT,0)) AS EDU_SUM,
                  LEAST(NVL(A.GOV_AMT,0),100000) AS GOV1_AMT, 
                  GREATEST(NVL(A.GOV_AMT,0)-100000,0) AS GOV2_AMT, 
                  NVL(A.LC1_AMT,0) LC1_AMT,
                  (NVL(A.LC2_AMT,0) + NVL(A.LC3_AMT,0)) AS LC23_AMT, 
                  (NVL(A.GOV_AMT,0) + NVL(A.LC1_AMT,0) + NVL(A.LC2_AMT,0) + NVL(A.LC3_AMT,0)) AS LCC_SUM
            FROM   ASNHR.T_AC_RETACC_14 A
            LEFT JOIN (SELECT PIS_YY, ENO_NO
                            , NVL(SUM(JAQ_AMT),0) AS JAQ_AMT 
                            , NVL(SUM(JAR_AMT),0) AS JAR_AMT
                            , NVL(SUM(JAH_AMT),0) AS JAH_AMT 
                            , NVL(SUM(JAP_AMT),0) AS JAP_AMT                             
                         FROM ASNHR.T_AC_DUTYPLACE
                         WHERE ENO_NO = ? AND PIS_YY = '2014'
                         GROUP BY PIS_YY, ENO_NO
                       ) B       ON B.ENO_NO = A.ENO_NO               
            WHERE   A.PIS_YY = '2014'
            		AND     A.ENO_NO = ?
            ]]>
        </query>
    </sql>        
    
    <!-- 2,3 페이지 정보 가져온다. -->
    <sql name="YACA020_SHR4_PRT_142">
        <description>2,3 페이지정보 출력</description>
        <query>
            <![CDATA[
            SELECT 
                   A.PIS_YY, TO_CHAR(SYSDATE,'YYYYMMDD') AS TODAY,
            	   A.ENO_NO, 
                   NVL(B.JAQ_AMT,0) JAQ_AMT,
                   NVL(B.JAR_AMT,0) JAR_AMT,
                   NVL(B.JAH_AMT,0) JAH_AMT,
                   NVL(B.JAP_AMT,0) JAP_AMT,            	   
                   NVL(A.NPEN_AMT,0) NPEN_AMT,
                   (NVL(B.JAQ_AMT,0) + NVL(B.JAR_AMT,0) + NVL(A.NPEN_AMT,0) ) AS PEN_SUM,
                   (NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0)) AS HEALTH_AMT,
                   NVL(A.HINS_AMT,0) HINS_AMT,
                   (NVL(B.JAH_AMT,0) + NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0) + NVL(B.JAP_AMT,0) + NVL(A.HINS_AMT,0)) AS HIN_SUM,
                   NVL(A.LH1_AMT,0) LH1_AMT,
                   NVL(A.LH2_AMT,0) LH2_AMT,
                   NVL(A.LH3_AMT,0) LH3_AMT,                   
                   NVL(A.LH4_AMT,0) LH4_AMT,                   
                   NVL(A.LH5_AMT,0) LH5_AMT,
                   NVL(A.LH6_AMT,0) LH6_AMT,
                   NVL(A.LH7_AMT,0) LH7_AMT,
                   NVL(A.LH8_AMT,0) LH8_AMT,
                   (NVL(A.LH1_AMT,0) + NVL(A.LH2_AMT,0) +  NVL(A.LH3_AMT,0) + NVL(A.LH4_AMT,0) + NVL(A.LH5_AMT,0) + NVL(A.LH6_AMT,0) + NVL(A.LH7_AMT,0) + NVL(A.LH8_AMT,0)) AS LH_SUM,                   
                   NVL(A.PER_AMT,0) PER_AMT,
                   NVL(A.LHO_AMT,0) LHO_AMT,
                   NVL(A.LHR_AMT,0) LHR_AMT,                   
                   NVL(A.LHP_AMT,0) LHP_AMT,  
                   (NVL(A.PER_AMT,0) + NVL(A.LHO_AMT,0) +  NVL(A.LHR_AMT,0) +  NVL(A.LHP_AMT,0)) AS LLL_SUM,                                      
                   NVL(A.VEN_AMT,0) VEN_AMT,
                   NVL(A.VEN2_AMT,0) VEN2_AMT,
                   NVL(A.VEN3_AMT,0) VEN3_AMT,
                   (NVL(A.VEN_AMT,0) + NVL(A.VEN2_AMT,0) +  NVL(A.VEN3_AMT,0)) AS VEN_SUM,  
                   NVL(A.CARD_AMT,0) CARD_AMT,
                   NVL(A.DIR_CARD_AMT,0) DIR_CARD_AMT,
                   NVL(A.CASH_AMT,0) CASH_AMT,                   
                   NVL(A.MARKET_AMT,0) MARKET_AMT,  
                   NVL(A.PUBLIC_AMT,0) PUBLIC_AMT,                    
                   (NVL(A.CARD_AMT,0) + NVL(A.DIR_CARD_AMT,0) +  NVL(A.CASH_AMT,0) +  NVL(A.MARKET_AMT,0) +  NVL(A.PUBLIC_AMT,0)) AS CARD_SUM, 
                   NVL(A.SAJU_AMT,0) SAJU_AMT,                   
                   NVL(A.LSS_AMT,0) LSS_AMT,
                   NVL(A.ANN_AMT,0) ANN_AMT, 
                   NVL(A.LIN_AMT,0) LIN_AMT, 
                   NVL(A.LIH_AMT,0) LIH_AMT, 
                   (NVL(A.LIN_AMT,0) + NVL(A.LIH_AMT,0)) AS LI_SUM,
                   (NVL(A.MHEA_AMT,0) + NVL(A.HAN_AMT,0)) AS HEA_AMT,
                   NVL(A.OHEA_AMT,0) OHEA_AMT,
                   (NVL(A.MHEA_AMT,0) + NVL(A.HAN_AMT,0) + NVL(A.OHEA_AMT,0)) AS HEA_SUM,
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_142 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '1' 
                  AND NVL(EDU_AMT_NTS,0)+NVL(EDU_AMT,0) != 0 GROUP BY ENO_NO, EDU_TAG) AS TAG1_CNT,
                  (SELECT '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_142 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '2' 
                  GROUP BY ENO_NO, EDU_TAG) AS TAG2_CNT,                  
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_142 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '3' 
                  AND REL_CD != '0' GROUP BY ENO_NO, EDU_TAG) AS TAG3_CNT,                    
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_142 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND HED_AMT + HED_AMT_NTS > 0 GROUP BY ENO_NO, EDU_TAG) AS TAG4_CNT,                      
                   NVL(A.GRA_AMT,0) GRA_AMT,
                  (SELECT  SUM(nvl(EDU_AMT_NTS,0)+nvl(EDU_AMT,0)) FROM ASNHR.T_AC_FAMILY_142 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '1' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT1,
                  (SELECT  SUM(nvl(EDU_AMT_NTS,0)+nvl(EDU_AMT,0)) FROM ASNHR.T_AC_FAMILY_142 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '2' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT2,
                  (SELECT  SUM(nvl(EDU_AMT_NTS,0)+nvl(EDU_AMT,0)) FROM ASNHR.T_AC_FAMILY_142 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '3' AND REL_CD != '0' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT3,         
                  (SELECT  SUM(HED_AMT_NTS+HED_AMT) FROM ASNHR.T_AC_FAMILY_142 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND HED_AMT_NTS > 0 GROUP BY ENO_NO, EDU_TAG) AS HED_AMT,
                   (NVL(A.GRA_AMT,0) + NVL(A.EDU_AMT1,0) + NVL(A.EDU_AMT2,0) + NVL(A.EDU_AMT3,0)  + NVL(A.HED_AMT,0)) AS EDU_SUM,
                  LEAST(NVL(A.GOV_AMT,0),100000) AS GOV1_AMT, 
                  GREATEST(NVL(A.GOV_AMT,0)-100000,0) AS GOV2_AMT, 
                  NVL(A.LC1_AMT,0) LC1_AMT,
                  (NVL(A.LC2_AMT,0) + NVL(A.LC3_AMT,0)) AS LC23_AMT, 
                  (NVL(A.GOV_AMT,0) + NVL(A.LC1_AMT,0) + NVL(A.LC2_AMT,0) + NVL(A.LC3_AMT,0)) AS LCC_SUM
            FROM   ASNHR.T_AC_RETACC_142 A
            LEFT JOIN (SELECT PIS_YY, ENO_NO
                            , NVL(SUM(JAQ_AMT),0) AS JAQ_AMT 
                            , NVL(SUM(JAR_AMT),0) AS JAR_AMT
                            , NVL(SUM(JAH_AMT),0) AS JAH_AMT 
                            , NVL(SUM(JAP_AMT),0) AS JAP_AMT                             
                         FROM ASNHR.T_AC_DUTYPLACE
                         WHERE ENO_NO = ? AND PIS_YY = '2014'
                         GROUP BY PIS_YY, ENO_NO
                       ) B       ON B.ENO_NO = A.ENO_NO               
            WHERE   A.PIS_YY = '2014'
            		AND     A.ENO_NO = ?
            ]]>
        </query>
    </sql>            
    
     <!-- 2,3 페이지 정보 가져온다. -->
    <sql name="YACA020_SHR4_PRT_15">
        <description>2,3 페이지정보 출력</description>
        <query>
            <![CDATA[
            SELECT 
                   A.PIS_YY, TO_CHAR(SYSDATE,'YYYYMMDD') AS TODAY,
            	   A.ENO_NO, 
                   NVL(B.JAQ_AMT,0) JAQ_AMT,
                   NVL(B.JAR_AMT,0) JAR_AMT,
                   NVL(B.JAH_AMT,0) JAH_AMT,
                   NVL(B.JAP_AMT,0) JAP_AMT,            	   
                   NVL(A.NPEN_AMT,0) NPEN_AMT,
                   (NVL(B.JAQ_AMT,0) + NVL(B.JAR_AMT,0) + NVL(A.NPEN_AMT,0) ) AS PEN_SUM,
                   (NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0)) AS HEALTH_AMT,
                   NVL(A.HINS_AMT,0) HINS_AMT,
                   (NVL(B.JAH_AMT,0) + NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0) + NVL(B.JAP_AMT,0) + NVL(A.HINS_AMT,0)) AS HIN_SUM,
                   NVL(A.LH1_AMT,0) LH1_AMT,
                   NVL(A.LH2_AMT,0) LH2_AMT,
                   NVL(A.LH3_AMT,0) LH3_AMT,                   
                   NVL(A.LH4_AMT,0) LH4_AMT,                   
                   NVL(A.LH5_AMT,0) LH5_AMT,
                   NVL(A.LH6_AMT,0) LH6_AMT,
                   NVL(A.LH7_AMT,0) LH7_AMT,
                   NVL(A.LH8_AMT,0) LH8_AMT,
                   NVL(A.LH9_AMT,0) LH9_AMT,
                   NVL(A.LH10_AMT,0) LH10_AMT,
                   NVL(A.LH11_AMT,0) LH11_AMT,
                   NVL(A.LH12_AMT,0) LH12_AMT,
                   (NVL(A.LH1_AMT,0) + NVL(A.LH2_AMT,0) +  NVL(A.LH3_AMT,0) + NVL(A.LH4_AMT,0) + NVL(A.LH5_AMT,0) + NVL(A.LH6_AMT,0) + 
                    NVL(A.LH7_AMT,0) + NVL(A.LH8_AMT,0) +  NVL(A.LH9_AMT,0) + NVL(A.LH10_AMT,0)+ NVL(A.LH11_AMT,0)+ NVL(A.LH12_AMT,0)) AS LH_SUM,                   
                   NVL(A.PER_AMT,0) PER_AMT,
                   NVL(A.LHO_AMT,0) LHO_AMT,
                   NVL(A.LHR_AMT,0) LHR_AMT,                   
                   NVL(A.LHP_AMT,0) LHP_AMT,  
                   (NVL(A.PER_AMT,0) + NVL(A.LHO_AMT,0) +  NVL(A.LHR_AMT,0) +  NVL(A.LHP_AMT,0)) AS LLL_SUM,                                      
                   NVL(A.VEN_AMT,0) VEN_AMT,
                   NVL(A.VEN2_AMT,0) VEN2_AMT,
                   NVL(A.VEN3_AMT,0) VEN3_AMT,
                   (NVL(A.VEN_AMT,0) + NVL(A.VEN2_AMT,0) +  NVL(A.VEN3_AMT,0)) AS VEN_SUM,  
                   NVL(A.CARD_AMT,0) CARD_AMT,
                   NVL(A.DIR_CARD_AMT,0) DIR_CARD_AMT,
                   NVL(A.CASH_AMT,0) CASH_AMT,                   
                   NVL(A.MARKET_AMT,0) MARKET_AMT,  
                   NVL(A.PUBLIC_AMT,0) PUBLIC_AMT,                    
                   (NVL(A.CARD_AMT,0) + NVL(A.DIR_CARD_AMT,0) +  NVL(A.CASH_AMT,0) +  NVL(A.MARKET_AMT,0) +  NVL(A.PUBLIC_AMT,0)) AS CARD_SUM, 
                   NVL(A.CARD_2013_AMT,0) CARD_2013_AMT,
                   NVL(A.CARD_2014_AMT,0) CARD_2014_AMT,
                   NVL(A.CARD_2013_OVER,0) CARD_2013_OVER,
                   NVL(A.CARD_2015_FH_OVER,0) CARD_2015_FH_OVER,
                   NVL(A.CARD_2015_AMT,0) CARD_2015_AMT,
                   NVL(A.CARD_2014_OVER,0) CARD_2014_OVER,
                   NVL(A.CARD_2015_SH_OVER,0) CARD_2015_SH_OVER,
                   
                   NVL(A.SAJU_AMT,0) SAJU_AMT,                   
                   NVL(A.LSS_AMT,0) LSS_AMT,
                   NVL(A.DCIRP_AMT,0) DCIRP_AMT,
                   NVL(A.ANN_AMT,0) ANN_AMT, 
                   (NVL(A.DCIRP_AMT,0) + NVL(A.ANN_AMT,0)) AS DCANN_SUM,
                   NVL(A.LIN_AMT,0) LIN_AMT, 
                   NVL(A.LIH_AMT,0) LIH_AMT, 
                   (NVL(A.LIN_AMT,0) + NVL(A.LIH_AMT,0)) AS LI_SUM,
                   (NVL(A.MHEA_AMT,0) + NVL(A.HAN_AMT,0)) AS HEA_AMT,
                   NVL(A.OHEA_AMT,0) OHEA_AMT,
                   (NVL(A.MHEA_AMT,0) + NVL(A.HAN_AMT,0) + NVL(A.OHEA_AMT,0)) AS HEA_SUM,
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_15 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '1' 
                  AND NVL(EDU_AMT_NTS,0)+NVL(EDU_AMT,0) != 0 GROUP BY ENO_NO, EDU_TAG) AS TAG1_CNT,
                  (SELECT '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_15 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '2' 
                  GROUP BY ENO_NO, EDU_TAG) AS TAG2_CNT,                  
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_15 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '3' 
                  AND REL_CD != '0' GROUP BY ENO_NO, EDU_TAG) AS TAG3_CNT,                    
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY_15 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND HED_AMT + HED_AMT_NTS > 0 GROUP BY ENO_NO, EDU_TAG) AS TAG4_CNT,                      
                   NVL(A.GRA_AMT,0) GRA_AMT,
                  (SELECT  SUM(nvl(EDU_AMT_NTS,0)+nvl(EDU_AMT,0)) FROM ASNHR.T_AC_FAMILY_15 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '1' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT1,
                  (SELECT  SUM(nvl(EDU_AMT_NTS,0)+nvl(EDU_AMT,0)) FROM ASNHR.T_AC_FAMILY_15 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '2' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT2,
                  (SELECT  SUM(nvl(EDU_AMT_NTS,0)+nvl(EDU_AMT,0)) FROM ASNHR.T_AC_FAMILY_15 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '3' AND REL_CD != '0' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT3,         
                  (SELECT  SUM(HED_AMT_NTS+HED_AMT) FROM ASNHR.T_AC_FAMILY_142 WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND HED_AMT_NTS > 0 GROUP BY ENO_NO, EDU_TAG) AS HED_AMT,
                   (NVL(A.GRA_AMT,0) + NVL(A.EDU_AMT1,0) + NVL(A.EDU_AMT2,0) + NVL(A.EDU_AMT3,0)  + NVL(A.HED_AMT,0)) AS EDU_SUM,
                  LEAST(NVL(A.GOV_AMT,0),100000) AS GOV1_AMT, 
                  GREATEST(NVL(A.GOV_AMT,0)-100000,0) AS GOV2_AMT, 
                  NVL(A.LC1_AMT,0) LC1_AMT,
                  NVL(A.LC2_AMT,0) LC2_AMT, 
                  NVL(A.LC3_AMT,0) LC3_AMT,
                  NVL(A.LC4_AMT,0) LC4_AMT,
                  (NVL(A.GOV_AMT,0) + NVL(A.LC1_AMT,0) + NVL(A.LC2_AMT,0) + NVL(A.LC3_AMT,0)+ NVL(A.LC4_AMT,0)) AS LCC_SUM,
                  NVL(A.IW_LC1,0) IW_LC1,NVL(A.IW_LC2,0) IW_LC2,NVL(A.IW_LC3,0) IW_LC3
            FROM   ASNHR.T_AC_RETACC_15 A
            LEFT JOIN (SELECT PIS_YY, ENO_NO
                            , NVL(SUM(JAQ_AMT),0) AS JAQ_AMT 
                            , NVL(SUM(JAR_AMT),0) AS JAR_AMT
                            , NVL(SUM(JAH_AMT),0) AS JAH_AMT 
                            , NVL(SUM(JAP_AMT),0) AS JAP_AMT                             
                         FROM ASNHR.T_AC_DUTYPLACE
                         WHERE ENO_NO = ? AND PIS_YY = '2015'
                         GROUP BY PIS_YY, ENO_NO
                       ) B       ON B.ENO_NO = A.ENO_NO               
            WHERE   A.PIS_YY = '2015'
            		AND     A.ENO_NO = ?
            ]]>
        </query>
    </sql>            
    
    <!-- 7 페이지 정보 가져온다. -->
    <sql name="YACA020_SHR5_PRT_14">
        <description>7페이지정보 출력</description>
        <query>
            <![CDATA[
			SELECT
				 A.PIS_YY, A.ENO_NO, A.PEN_GUBUN_CD AS  DUDGB, 
				 A.ABA_CD	AS FINACD, A.ABA_NM	AS FINANM, A.ACC_NO	AS ACCNO, A.AMOUNT AS  PAYAMT,A.DED_AMT AS  DEDAMT     
			FROM ASNHR.T_AC_PENSION_14 A
			WHERE A.PIS_YY = '2014'
				AND A.ENO_NO = ?
            ]]>
        </query>
    </sql>  
    
    <!-- 7 페이지 정보 가져온다. -->
    <sql name="YACA020_SHR5_PRT_142">
        <description>7페이지정보 출력</description>
        <query>
            <![CDATA[
			SELECT
				 A.PIS_YY, A.ENO_NO, A.PEN_GUBUN_CD AS  DUDGB, 
				 A.ABA_CD	AS FINACD, A.ABA_NM	AS FINANM, A.ACC_NO	AS ACCNO, A.AMOUNT AS  PAYAMT,A.DED_AMT AS  DEDAMT     
			FROM ASNHR.T_AC_PENSION_142 A
			WHERE A.PIS_YY = '2014'
				AND A.ENO_NO = ?
            ]]>
        </query>
    </sql>      
    
    <!-- 7 페이지 정보 가져온다. -->
    <sql name="YACA020_SHR5_PRT_15">
        <description>7페이지정보 출력</description>
        <query>
            <![CDATA[
			SELECT
				 A.PIS_YY, A.ENO_NO, A.PEN_GUBUN_CD AS  DUDGB, 
				 A.ABA_CD	AS FINACD, A.ABA_NM	AS FINANM, A.ACC_NO	AS ACCNO, A.AMOUNT AS  PAYAMT,A.DED_AMT AS  DEDAMT     
			FROM ASNHR.T_AC_PENSION_15 A
			WHERE A.PIS_YY = '2015'
				AND A.ENO_NO = ?
            ]]>
        </query>
    </sql>      
    
    <!-- 2013년도 선택 직원의 연말 정산 정보를 조회 한다. -->
    <sql name="YACA020_SHR_13">
        <description>선택 직원의 연말 정산 정보를 조회</description>
        <query>
            <![CDATA[
             SELECT DECODE(A.NPEN_AMT, 0, NVL(B.NPEN_AMT, 0), A.NPEN_AMT)   AS NPEN_AMT
                  , NVL(A.EPEN_AMT, 0) AS EPEN_AMT
                  , DECODE(A.HINU_AMT, 0, NVL(B.HINU_AMT, 0), A.HINU_AMT)   AS HINU_AMT
                  , DECODE(A.HINS_AMT, 0, NVL(B.HINS_AMT, 0), A.HINS_AMT)   AS HINS_AMT
                  , DECODE(A.OLD_AMT,  0, NVL(B.OLD_AMT,  0), A.OLD_AMT)    AS OLD_AMT
                  , A.SOU_CNT
                  , DECODE(A.SOU_CNT, 0, 'N', 'Y') AS SOU_YN
                  , A.DFM_CNT
                  , A.GOL_CNT70
                  , A.TRB_CNT
                  , A.WCT_CNT
                  , DECODE(A.WCT_CNT, 0, 'N', 'Y') AS WCT_YN
                  , A.RCH_CNT
                  , A.CHI_CNT

                  
                  , A.LIN_AMT
                  , A.LIH_AMT
                  , A.MHEA_AMT
                  , A.OHEA_AMT
                  , A.LF2_AMT
                  
                  , LEAST(A.LEN_AMT,500000) LEN_AMT
                  , A.LEN_AMT2
                  , A.LEN_AMT3
                  , A.LEN_AMT4
                  , A.LEN_AMT5
                  , A.GRA_AMT
                  , A.EDU_TAG1
                  , A.EDU_TAG2
                  , A.EDU_TAG3
                  , A.EDU_TAG4
                  , A.EDU_TAG5
                  , A.EDU_AMT1
                  , A.EDU_AMT2
                  , A.EDU_AMT3
                  , A.EDU_AMT4
                  , A.EDU_AMT5
                  , A.HED_AMT
                  
                  , A.LHO_AMT
                  , A.LHP_AMT
                  , A.LHQ_AMT
                  , A.LHR_AMT
                  
                  , A.LH1_AMT
                  , A.LH2_AMT
                  , A.LH2_AMT04                  
                  , A.LH4_AMT
                  , A.LH5_AMT
                  , A.LH6_AMT
                  , A.LH7_AMT
                  , A.LH8_AMT                  
                  , A.GOV_AMT
                  , A.LC1_AMT
                  , A.LC2_AMT
                  , A.LC3_AMT
                  , A.GOV_NTS
                  , A.LC1_NTS
                  , A.LC2_NTS
                  , A.LC3_NTS                  
                  , A.GOV_DED
                  , A.FUN_CNT
                  , A.LF1_AMT
                  , A.VEN2_AMT
                  , A.CARD_AMT
                  , A.DIR_CARD_AMT
                  , A.CASH_AMT
                  , A.MARKET_AMT   
                  , A.PUBLIC_AMT                 
                  , A.LST_AMT
                  , NVL(A.PAYO_AMTS,0) + NVL(A.PAYO_AMTB,0) AS PAYO_SUM
                  , A.LSQ_AMT
                  , NVL(A.WEL_CARD,0)   AS WEL_CARD
                  , CLS_TAG   
                                    
                  , TO_CHAR(A.SALT_AMTT,'99,999,999,999')  AS SALT_AMT                              
                  , TO_CHAR(A.FREE_INCOME,'99,999,999,999')  AS FREE_INCOME
                  , TO_CHAR(A.TAX_INCOME,'99,999,999,999')  AS TAX_INCOME                   
                  , TO_CHAR( TRUNC(A.TAX_INCOME*0.03),'99,999,999,999') AS HOSPT_AMT
                  , TO_CHAR(TRUNC(TAX_INCOME*0.25),'99,999,999,999') AS MIN_CARD_AMT
              
                  , HOL_YN
                  , (CASE WHEN A.TAX_INCOME < 50000000 THEN 'Y'
                                                      ELSE 'N' END) AS TAX_IC
                FROM ASNHR.T_AC_RETACC A
          LEFT JOIN (SELECT C.PIS_YY
                          , C.ENO_NO
                          , NVL(SUM(C.NPEN_AMT),0)        AS NPEN_AMT --국민연금보험료

                          , NVL(SUM(C.HINU_AMT),0) + (SELECT NVL(SUM(AMOUNT),0)
                                                      FROM   ASNHR.T_CP_CHANGE E
                                                      WHERE  C.PIS_YY = E.PIS_YY
                                                      AND    E.PIS_MM = '04'
                                                      AND    C.ENO_NO = E.ENO_NO
                                                      AND    E.SAL_CD IN ('JN','HD')) AS HINU_AMT --국민건강보험료
                          , NVL(SUM(C.HINS_AMT),0)        AS HINS_AMT --고용보험료
                          , NVL(SUM(C.OLD_AMT),0)                                     AS OLD_AMT  --노인장기요양보험료
                       FROM ASNHR.T_CP_PAYMASTER C
					WHERE C.PIS_YY = ?                       
                       GROUP BY C.PIS_YY
                              , C.ENO_NO
                     ) B
                 ON A.PIS_YY    = B.PIS_YY
                AND A.ENO_NO    = B.ENO_NO
              WHERE A.PIS_YY    = ?
                AND A.ENO_NO    = ?
                AND A.GBN_TAG   = '8'
            ]]>
        </query>
    </sql>    
    
    
    
    
    <!-- 2014년도 선택 직원의 연말 정산 정보를 조회 한다. -->
    <sql name="YACA020_SHR_14">
        <description>선택 직원의 연말 정산 정보를 조회</description>
        <query>
            <![CDATA[
             SELECT DECODE(A.NPEN_AMT, 0, NVL(B.NPEN_AMT, 0), A.NPEN_AMT)   AS NPEN_AMT

                  , DECODE(A.HINU_AMT, 0, NVL(B.HINU_AMT, 0), A.HINU_AMT)   AS HINU_AMT
                  , DECODE(A.HINS_AMT, 0, NVL(B.HINS_AMT, 0), A.HINS_AMT)   AS HINS_AMT
                  , DECODE(A.OLD_AMT,  0, NVL(B.OLD_AMT,  0), A.OLD_AMT)    AS OLD_AMT
                  , A.SOU_CNT
                  , DECODE(A.SOU_CNT, 0, 'N', 'Y') AS SOU_YN
                  , A.DFM_CNT
                  , A.GOL_CNT70
                  , A.TRB_CNT
                  , A.WCT_CNT
                  , DECODE(A.WCT_CNT, 0, 'N', 'Y') AS WCT_YN

                  
                  , A.LIN_AMT
                  , A.LIH_AMT
                  , A.MHEA_AMT
                  , A.OHEA_AMT

                  
                  , LEAST(A.LEN_AMT,500000) LEN_AMT
                  , A.LEN_AMT2
                  , A.LEN_AMT3
                  , A.LEN_AMT4
                  , A.LEN_AMT5
                  , A.GRA_AMT
                  , A.EDU_TAG1
                  , A.EDU_TAG2
                  , A.EDU_TAG3
                  , A.EDU_TAG4
                  , A.EDU_TAG5
                  , A.EDU_AMT1
                  , A.EDU_AMT2
                  , A.EDU_AMT3
                  , A.EDU_AMT4
                  , A.EDU_AMT5
                  , A.HED_AMT
                  
                  , A.LHO_AMT
                  , A.LHP_AMT
                  , A.LHR_AMT
                  
                  , A.LH1_AMT
                  , A.LH2_AMT
                  , A.LH3_AMT                 
                  , A.LH4_AMT
                  , A.LH5_AMT
                  , A.LH6_AMT
                  , A.LH7_AMT
                  , A.LH8_AMT                  


                  , A.GOV_AMT
                  , A.LC1_AMT
                  , A.LC2_AMT
                  , A.LC3_AMT
                  

                  , A.LC1_NTS
                  , A.LC2_NTS
                  , A.LC3_NTS                  
                  , A.GOV_DED
                  
                  , A.FUN_CNT

                  , A.VEN2_AMT
                  
                  , A.CARD_AMT
                  , A.DIR_CARD_AMT
                  , A.CASH_AMT
                  , A.MARKET_AMT   
                  , A.PUBLIC_AMT          
                                         
                  , NVL(A.PAYO_AMTS,0) AS PAYO_SUM

                  , CLS_TAG   
         
                  , TO_CHAR(A.SALT_AMTT,'99,999,999,999')  AS SALT_AMT                              
                  , TO_CHAR(A.FREE_INCOME,'99,999,999,999')  AS FREE_INCOME
                  , TO_CHAR(A.TAX_INCOME,'99,999,999,999')  AS TAX_INCOME   
                  , TO_CHAR(A.INCM_TAX,'99,999,999,999')  AS INCM_TAX
                  , TO_CHAR(A.CITI_TAX,'99,999,999,999')  AS CITI_TAX                                  

                  , HOL_YN
                  , (CASE WHEN A.TAX_INCOME < 50000000 THEN 'Y' ELSE 'N' END) AS TAX_IC
                FROM ASNHR.T_AC_RETACC_14 A
          			LEFT JOIN (SELECT C.PIS_YY, C.ENO_NO
                          					, NVL(SUM(C.NPEN_AMT),0)   AS NPEN_AMT --국민연금보험료
                          					, NVL(SUM(C.HINU_AMT),0) + (SELECT NVL(SUM(AMOUNT),0)
                                                      FROM   ASNHR.T_CP_CHANGE E
                                                      WHERE  C.PIS_YY = E.PIS_YY
                                                      AND    E.PIS_MM = '04'
                                                      AND    C.ENO_NO = E.ENO_NO
                                                      AND    E.SAL_CD IN ('JN','HD')) AS HINU_AMT --국민건강보험료
                          , NVL(SUM(C.HINS_AMT),0)        AS HINS_AMT --고용보험료
                          , NVL(SUM(C.OLD_AMT),0)                                     AS OLD_AMT  --노인장기요양보험료
                       FROM ASNHR.T_CP_PAYMASTER C
					WHERE C.PIS_YY = ?                       
                       GROUP BY C.PIS_YY
                              , C.ENO_NO
                     ) B
                 ON A.PIS_YY    = B.PIS_YY
                AND A.ENO_NO    = B.ENO_NO
              WHERE A.PIS_YY    = ?
                AND A.ENO_NO    = ?
                AND A.GBN_TAG   = '8'
            ]]>
        </query>
    </sql>    
        
    
        <!-- 2014년도 선택 직원의 연말 정산 정보를 조회 한다. -->
    <sql name="YACA020_SHR_142">
        <description>선택 직원의 연말 정산 정보를 조회</description>
        <query>
            <![CDATA[
             SELECT DECODE(A.NPEN_AMT, 0, NVL(B.NPEN_AMT, 0), A.NPEN_AMT)   AS NPEN_AMT

                  , DECODE(A.HINU_AMT, 0, NVL(B.HINU_AMT, 0), A.HINU_AMT)   AS HINU_AMT
                  , DECODE(A.HINS_AMT, 0, NVL(B.HINS_AMT, 0), A.HINS_AMT)   AS HINS_AMT
                  , DECODE(A.OLD_AMT,  0, NVL(B.OLD_AMT,  0), A.OLD_AMT)    AS OLD_AMT
                  , A.SOU_CNT
                  , DECODE(A.SOU_CNT, 0, 'N', 'Y') AS SOU_YN
                  , A.DFM_CNT
                  , A.GOL_CNT70
                  , A.TRB_CNT
                  , A.WCT_CNT
                  , DECODE(A.WCT_CNT, 0, 'N', 'Y') AS WCT_YN

                  
                  , A.LIN_AMT
                  , A.LIH_AMT
                  , A.MHEA_AMT
                  , A.OHEA_AMT

                  
                  , LEAST(A.LEN_AMT,500000) LEN_AMT
                  , A.LEN_AMT2
                  , A.LEN_AMT3
                  , A.LEN_AMT4
                  , A.LEN_AMT5
                  , A.GRA_AMT
                  , A.EDU_TAG1
                  , A.EDU_TAG2
                  , A.EDU_TAG3
                  , A.EDU_TAG4
                  , A.EDU_TAG5
                  , A.EDU_AMT1
                  , A.EDU_AMT2
                  , A.EDU_AMT3
                  , A.EDU_AMT4
                  , A.EDU_AMT5
                  , A.HED_AMT
                  
                  , A.LHO_AMT
                  , A.LHP_AMT
                  , A.LHR_AMT
                  
                  , A.LH1_AMT
                  , A.LH2_AMT
                  , A.LH3_AMT                 
                  , A.LH4_AMT
                  , A.LH5_AMT
                  , A.LH6_AMT
                  , A.LH7_AMT
                  , A.LH8_AMT                  


                  , A.GOV_AMT
                  , A.LC1_AMT
                  , A.LC2_AMT
                  , A.LC3_AMT
                  

                  , A.LC1_NTS
                  , A.LC2_NTS
                  , A.LC3_NTS                  
                  , A.GOV_DED
                  
                  , A.FUN_CNT

                  , A.VEN2_AMT
                  
                  , A.CARD_AMT
                  , A.DIR_CARD_AMT
                  , A.CASH_AMT
                  , A.MARKET_AMT   
                  , A.PUBLIC_AMT          
                                         
                  , NVL(A.PAYO_AMTS,0) AS PAYO_SUM

                  , CLS_TAG   
         
                  , TO_CHAR(A.SALT_AMTT,'99,999,999,999')  AS SALT_AMT                              
                  , TO_CHAR(A.FREE_INCOME,'99,999,999,999')  AS FREE_INCOME
                  , TO_CHAR(A.TAX_INCOME,'99,999,999,999')  AS TAX_INCOME   
                  , TO_CHAR(A.INCM_TAX,'99,999,999,999')  AS INCM_TAX
                  , TO_CHAR(A.CITI_TAX,'99,999,999,999')  AS CITI_TAX                                  

                  , HOL_YN
                  , (CASE WHEN A.TAX_INCOME < 50000000 THEN 'Y' ELSE 'N' END) AS TAX_IC
                FROM ASNHR.T_AC_RETACC_142 A
          			LEFT JOIN (SELECT C.PIS_YY, C.ENO_NO
                          					, NVL(SUM(C.NPEN_AMT),0)   AS NPEN_AMT --국민연금보험료
                          					, NVL(SUM(C.HINU_AMT),0) + (SELECT NVL(SUM(AMOUNT),0)
                                                      FROM   ASNHR.T_CP_CHANGE E
                                                      WHERE  C.PIS_YY = E.PIS_YY
                                                      AND    E.PIS_MM = '04'
                                                      AND    C.ENO_NO = E.ENO_NO
                                                      AND    E.SAL_CD IN ('JN','HD')) AS HINU_AMT --국민건강보험료
                          , NVL(SUM(C.HINS_AMT),0)        AS HINS_AMT --고용보험료
                          , NVL(SUM(C.OLD_AMT),0)                                     AS OLD_AMT  --노인장기요양보험료
                       FROM ASNHR.T_CP_PAYMASTER C
					WHERE C.PIS_YY = ?                       
                       GROUP BY C.PIS_YY
                              , C.ENO_NO
                     ) B
                 ON A.PIS_YY    = B.PIS_YY
                AND A.ENO_NO    = B.ENO_NO
              WHERE A.PIS_YY    = ?
                AND A.ENO_NO    = ?
                AND A.GBN_TAG   = '8'
            ]]>
        </query>
    </sql>   
    
    
 <!-- 2015년도 선택 직원의 연말 정산 정보를 조회 한다. -->
    <sql name="YACA020_SHR_15">
        <description>선택 직원의 연말 정산 정보를 조회</description>
        <query>
            <![CDATA[
             SELECT DECODE(A.NPEN_AMT, 0, NVL(B.NPEN_AMT, 0), A.NPEN_AMT)   AS NPEN_AMT

                  , DECODE(A.HINU_AMT, 0, NVL(B.HINU_AMT, 0), A.HINU_AMT)   AS HINU_AMT
                  , DECODE(A.HINS_AMT, 0, NVL(B.HINS_AMT, 0), A.HINS_AMT)   AS HINS_AMT
                  , DECODE(A.OLD_AMT,  0, NVL(B.OLD_AMT,  0), A.OLD_AMT)    AS OLD_AMT
                  , A.SOU_CNT
                  , DECODE(A.SOU_CNT, 0, 'N', 'Y') AS SOU_YN
                  , A.DFM_CNT
                  , A.GOL_CNT70
                  , A.TRB_CNT
                  , A.WCT_CNT
                  , DECODE(A.WCT_CNT, 0, 'N', 'Y') AS WCT_YN

                  
                  , A.LIN_AMT
                  , A.LIH_AMT
                  , A.MHEA_AMT
                  , A.OHEA_AMT

                  
                  , LEAST(A.LEN_AMT,500000) LEN_AMT
                  , A.LEN_AMT2
                  , A.LEN_AMT3
                  , A.LEN_AMT4
                  , A.LEN_AMT5
                  , A.GRA_AMT
                  , A.EDU_TAG1
                  , A.EDU_TAG2
                  , A.EDU_TAG3
                  , A.EDU_TAG4
                  , A.EDU_TAG5
                  , A.EDU_AMT1
                  , A.EDU_AMT2
                  , A.EDU_AMT3
                  , A.EDU_AMT4
                  , A.EDU_AMT5
                  , A.HED_AMT
                  
                  , A.LHO_AMT
                  , A.LHP_AMT
                  , A.LHR_AMT
                  
                  , A.LH1_AMT
                  , A.LH2_AMT
                  , A.LH3_AMT                 
                  , A.LH4_AMT
                  , A.LH5_AMT
                  , A.LH6_AMT
                  , A.LH7_AMT
                  , A.LH8_AMT                  


                  , A.GOV_AMT
                  , A.LC1_AMT
                  , A.LC2_AMT
                  , A.LC3_AMT
                  , A.LC4_AMT
                  

                  , A.LC1_NTS
                  , A.LC2_NTS
                  , A.LC3_NTS             
                  , A.GOV_DED
                  
                  , A.FUN_CNT

                  , A.VEN2_AMT
                  
                  , A.CARD_AMT
                  , A.DIR_CARD_AMT
                  , A.CASH_AMT
                  , A.MARKET_AMT   
                  , A.PUBLIC_AMT          
                                         
                  , NVL(A.PAYO_AMTS,0) AS PAYO_SUM

                  , CLS_TAG   
         
                  , TO_CHAR(A.SALT_AMTT,'99,999,999,999')  AS SALT_AMT                              
                  , TO_CHAR(A.FREE_INCOME,'99,999,999,999')  AS FREE_INCOME
                  , TO_CHAR(A.TAX_INCOME,'99,999,999,999')  AS TAX_INCOME   
                  , TO_CHAR(A.INCM_TAX,'99,999,999,999')  AS INCM_TAX
                  , TO_CHAR(A.CITI_TAX,'99,999,999,999')  AS CITI_TAX                                  

                  , HOL_YN
                  , (CASE WHEN A.TAX_INCOME < 50000000 THEN 'Y' ELSE 'N' END) AS TAX_IC
                  , INS_TAG
                  , A.TAX_INCOME AS TAX_INCOME2
                FROM ASNHR.T_AC_RETACC_15 A
          			LEFT JOIN (SELECT C.PIS_YY, C.ENO_NO
                          					, NVL(SUM(C.NPEN_AMT),0)   AS NPEN_AMT --국민연금보험료
                          					, NVL(SUM(C.HINU_AMT),0) + (SELECT NVL(SUM(AMOUNT),0)
                                                      FROM   ASNHR.T_CP_CHANGE E
                                                      WHERE  C.PIS_YY = E.PIS_YY
                                                      AND    E.PIS_MM = '04'
                                                      AND    C.ENO_NO = E.ENO_NO
                                                      AND    E.SAL_CD IN ('JN','HD')) AS HINU_AMT --국민건강보험료
                          , NVL(SUM(C.HINS_AMT),0)        AS HINS_AMT --고용보험료
                          , NVL(SUM(C.OLD_AMT),0)                                     AS OLD_AMT  --노인장기요양보험료
                       FROM ASNHR.T_CP_PAYMASTER C
					WHERE C.PIS_YY = ?                       
                       GROUP BY C.PIS_YY
                              , C.ENO_NO
                     ) B
                 ON A.PIS_YY    = B.PIS_YY
                AND A.ENO_NO    = B.ENO_NO
              WHERE A.PIS_YY    = ?
                AND A.ENO_NO    = ?
                AND A.GBN_TAG   = '8'
            ]]>
        </query>
    </sql>       
    
<!--
***********************************************************************
* @UseCase     : YACA020_PRT_2012
* @description : 부양가족
***********************************************************************
* 2012/12/07     이동훈        최초작성
***********************************************************************
-->
    <!-- 작업 현황 검색 -->    
    
    <!--  2012.12.6 이동훈 생성    열받아서 새로 만들고 있는 소득공제신고서 -->
    <sql name="YACA020_PRT_2012">
        <description>소득공제신고서</description>
        <query>
            <![CDATA[
            SELECT DISTINCT
            	A.PIS_YY, A.ENO_NO, ASNHR.SF_GET_ENONAME('01', A.ENO_NO) AS ENO_NM, C.CET_NO, 
            	(CASE WHEN HIR_YMD < '20120101' THEN '2012.01.01 ~ 2012.12.31' ELSE HIR_YMD||' ~ 2012.12.31' END) AS WORKDAY,
             	(CASE WHEN HOL_YN = 'Y' THEN  '세대주 ■,  세대원 □'  ELSE '세대주 □,  세대원 ■' END ) AS HOL_YN,
             	(CASE WHEN CLS_TAG = 'Y' THEN  '전년과동일 ■,  변동 □'  ELSE '전년과동일 □,  변동 ■' END ) AS CLS_TAG,             	
             	'인적공제 항목에 해당하는 인원수를 기재(다자녀 : '||NVL(D.CHILD,0)|| ' 명)' AS CHILD,
				B.LIN_AMT_NTS,
				B.LIN_AMT,
				B.MED_AMT_NTS,
				B.MED_AMT,
				B.EDU_AMT_NTS,
				B.EDU_AMT,
				B.CARD_AMT_NTS,
				B.CARD_AMT,
				B.DIR_CARD_AMT_NTS,
				B.DIR_CARD_AMT,  
				B.SCH_AMT_NTS,
				B.SCH_AMT, 
				B.CASH_AMT_NTS,
				B.CASH_AMT, 					        
				B.MARKET_AMT_NTS,
				B.MARKET_AMT,
				B.GIBU_AMT_NTS,
				B.GIBU_AMT			                                   
            FROM   ASNHR.T_AC_RETACC A
	        LEFT JOIN 
	        (SELECT  ENO_NO, 
	        SUM(LIN_AMT_NTS)+SUM(LIH_AMT_NTS) AS LIN_AMT_NTS, SUM(LIN_AMT)+SUM(LIH_AMT) AS LIN_AMT, 	    
	        SUM(MED_AMT_NTS) AS MED_AMT_NTS, SUM(MED_AMT) AS MED_AMT, 	            
	        SUM(EDU_AMT_NTS) AS EDU_AMT_NTS, SUM(EDU_AMT) AS EDU_AMT,  
	        SUM(CARD_AMT_NTS) AS CARD_AMT_NTS, SUM(CARD_AMT) AS CARD_AMT,
	        SUM(DIR_CARD_AMT_NTS) AS DIR_CARD_AMT_NTS, SUM(DIR_CARD_AMT) AS DIR_CARD_AMT,
	        SUM(SCH_AMT_NTS) AS SCH_AMT_NTS, SUM(SCH_AMT) AS SCH_AMT,	        
	        SUM(CASH_AMT_NTS) AS CASH_AMT_NTS, SUM(CASH_AMT) AS CASH_AMT,	        
	        SUM(MARKET_AMT_NTS) AS MARKET_AMT_NTS, SUM(MARKET_AMT) AS MARKET_AMT,	
	        SUM(NVL(LC1_AMT_NTS,0))+SUM(NVL(LC2_AMT_NTS,0))+SUM(NVL(LC3_AMT_NTS,0))) AS GIBU_AMT_NTS, 
	        SUM(NVL(LC1_AMT,0))+SUM(NVL(LC2_AMT,0))+SUM(NVL(LC3_AMT,0))) AS GIBU_AMT         
	        FROM ASNHR.T_AC_FAMILY
	        WHERE ENO_NO = ?
	        GROUP BY ENO_NO ) B ON      B.ENO_NO = A.ENO_NO
            LEFT OUTER JOIN ASNHR.T_CM_PERSON C            
            ON      C.ENO_NO = A.ENO_NO 
      		LEFT JOIN 
          	(SELECT  ENO_NO,  SUM(DECODE(CHI_MAN,'O',1,0)) AS CHILD     
      			FROM ASNHR.T_AC_FAMILY WHERE ENO_NO = ? AND PIS_YY = '2012' GROUP BY ENO_NO) D  
      		ON  D.ENO_NO = A.ENO_NO 
            WHERE   A.PIS_YY = ?
            AND     A.ENO_NO = ?
            AND A.GBN_TAG   = '8'
         ]]>
        </query>
    </sql>        
    
    
<!--
***********************************************************************
* @UseCase     : YACA020_PRT_2012_01
* @description : 부양가족
***********************************************************************
* 2012/12/07     이동훈        최초작성
***********************************************************************
-->
    <!-- 작업 현황 검색 -->
    <sql name="YACA020_PRT_2012_01">
        <description>소득공제명세</description>
        <query>
            <![CDATA[
					SELECT REL_CD,
					(CASE WHEN SUBSTR(cet_no,7,1)='1' OR SUBSTR(cet_no,7,1)='2' OR SUBSTR(cet_no,7,1)='3' OR SUBSTR(cet_no,7,1)='4'
			           THEN '1'
			           ELSE '9'
        			 END ) AS TYPE,
					       NAM_KOR AS FAM_NM,
					       CET_NO AS JUMINNO,
                           BAS_MAN,
                           GOL_70 AS HI_UP,
                           TRB_MAN,
                           WCT_MAN,
                           RCH_MAN,
                           DECODE((SELECT COUNT(*)
                                   FROM   ASNHR.T_AC_FAMILY B
                                   WHERE  B.PIS_YY = A.PIS_YY
                                   AND    B.ENO_NO = A.ENO_NO
                                   AND    B.CHI_MAN = 'O'
                                  ),1,'',CHI_MAN
                                 ) AS CHI_MAN, -- 2명이상일때만 보인다.
			               INP_MAN,
			               LIN_AMT_NTS,
			               MED_AMT_NTS,
			               EDU_AMT_NTS + HED_AMT_NTS AS EDU_AMT_NTS,
			               CARD_AMT_NTS,
			               DIR_CARD_AMT_NTS,
			               SCH_AMT_NTS,
			               CASH_AMT_NTS,
			               MARKET_AMT_NTS,
			               NVL(LC1_AMT_NTS,0) + NVL(LC2_AMT_NTS,0) + NVL(LC3_AMT_NTS,0)) AS GIBU_AMT_NTS,
			               LIN_AMT,               
			               MED_AMT AS MED_AMT,
			               EDU_AMT + HED_AMT AS EDU_AMT,
			               CARD_AMT,
			               DIR_CARD_AMT,
			               SCH_AMT,
			               CASH_AMT,
			               MARKET_AMT,
			               NVL(LC1_AMT,0) + NVL(LC2_AMT,0) + NVL(LC3_AMT,0) AS GIBU_AMT,			               
			               (SUBSTR(CET_NO,1,6) || '-' || SUBSTR(CET_NO,7,7)) AS CET_NO
                    FROM   ASNHR.T_AC_FAMILY A
                    WHERE  PIS_YY = ?
                    AND    ENO_NO = ?
                    ORDER BY REL_CD, CET_NO DESC
         ]]>
        </query>
    </sql>    
    
    
    
    
<!--
***********************************************************************
* @UseCase     : YACA020_PRT_2012_02
* @description : 연금보험&특별공제 2page
***********************************************************************
* 2013/01/07     이동훈        최초작성
***********************************************************************
-->
    <!-- 작업 현황 검색 -->
    <sql name="YACA020_PRT_2012_02">
        <description>연금보험특별공제</description>
        <query>
            <![CDATA[
            SELECT 
                   A.PIS_YY, 
            	   A.ENO_NO, 
                   D.JAQ_AMT,
                   D.JAR_AMT,
                   D.JAH_AMT,
                   D.JAP_AMT,            	   
                   A.NPEN_AMT,
                   (NVL(D.JAQ_AMT,0) + A.NPEN_AMT + NVL(D.JAR_AMT,0)) AS PEN_SUM_AMT,
                   (A.HINU_AMT + A.OLD_AMT) AS HEALTH_AMT,
                   A.HINS_AMT,
                   A.LIN_AMT,
                   A.LIH_AMT,
                   (NVL(D.JAH_AMT,0) + A.HINU_AMT + A.OLD_AMT + NVL(D.JAP_AMT,0) + A.HINS_AMT + A.LIN_AMT + A.LIH_AMT) AS INS_SUM_AMT,
                   NVL(A.MHEA_AMT,0) + NVL(A.LF2_AMT,0) AS MHEA_AMT,
                   NVL(A.OHEA_AMT,0) AS OHEA_AMT,
                   NVL(A.MHEA_AMT,0) + NVL(A.LF2_AMT,0) + NVL(A.OHEA_AMT,0) AS HEA_SUM_AMT,
                   A.GRA_AMT,                   
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '1' 
                  AND NVL(EDU_AMT_NTS,0)+NVL(EDU_AMT,0) <> 0 GROUP BY ENO_NO, EDU_TAG) AS TAG1_CNT,
                  (SELECT  SUM(EDU_AMT_NTS+EDU_AMT) FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '1' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT1,
                  (SELECT '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '2' 
                  GROUP BY ENO_NO, EDU_TAG) AS TAG2_CNT,                  
                  (SELECT  SUM(EDU_AMT_NTS+EDU_AMT) FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '2' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT2,
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '3' 
                  AND REL_CD <> '0' GROUP BY ENO_NO, EDU_TAG) AS TAG3_CNT,                  
                  (SELECT  SUM(EDU_AMT_NTS+EDU_AMT) FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '3'AND REL_CD <> '0' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT3,
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND HED_AMT + HED_AMT_NTS > 0 GROUP BY ENO_NO, EDU_TAG) AS TAG4_CNT,                  
                  (SELECT  SUM(HED_AMT_NTS+HED_AMT) FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND HED_AMT_NTS > 0 GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT4,
                   A.HED_AMT,
                   (A.GRA_AMT + EDU_AMT1 + EDU_AMT2 + EDU_AMT3 + EDU_AMT4 + A.HED_AMT)AS EDU_SUM_AMT,
                   A.LH1_AMT,
                   A.LH2_AMT,
                   A.LH2_AMT04,
                   A.LH3_AMT,                   
                   A.LH4_AMT,                   
                   A.LH5_AMT,
                   A.LH6_AMT,
                   A.LH7_AMT,
                   A.LH8_AMT,
                   (A.LH1_AMT + A.LH2_AMT + A.LH2_AMT04 + A.LH3_AMT + A.LH4_AMT + A.LH5_AMT + A.LH6_AMT + A.LH7_AMT + A.LH8_AMT) AS LH_SUM_AMT,                   
                   A.GOV_AMT - LEAST(A.GOV_AMT,100000) AS GOV_AMT,
                   A.LC3_AMT,
                   A.LC2_AMT,
                   (GREATEST(A.GOV_AMT-100000,0) + A.LC2_AMT + A.LC3_AMT) AS LC_SUM_AMT
            FROM   ASNHR.T_AC_RETACC_14 A
            LEFT OUTER JOIN ASNHR.T_CM_PERSON C ON C.ENO_NO = A.ENO_NO
            LEFT JOIN (SELECT PIS_YY, ENO_NO
                            , NVL(SUM(JAQ_AMT),0) AS JAQ_AMT 
                            , NVL(SUM(JAR_AMT),0) AS JAR_AMT
                            , NVL(SUM(JAH_AMT),0) AS JAH_AMT 
                            , NVL(SUM(JAP_AMT),0) AS JAP_AMT                             
                         FROM ASNHR.T_AC_DUTYPLACE
                         WHERE ENO_NO = ? 
                         GROUP BY PIS_YY, ENO_NO
                       ) D       ON D.ENO_NO = A.ENO_NO               
            WHERE   A.PIS_YY = ?
            AND     A.ENO_NO = ?
            AND A.GBN_TAG   = '8'
         ]]>
        </query>
    </sql>      
    
<!--
***********************************************************************
* @UseCase     : YACA020_PRT_2012_03
* @description :그밖의소득공제 3page
***********************************************************************
* 2013/01/07     이동훈        최초작성
***********************************************************************
-->
    <!-- 작업 현황 검색 -->
    <sql name="YACA020_PRT_2012_03">
        <description>그밖의소득공제</description>
        <query>
            <![CDATA[
            SELECT 
                   A.PIS_YY, 
            	   A.ENO_NO, 
                   A.LF1_AMT,
                   A.ANN_AMT,
                   (A.LF1_AMT + A.ANN_AMT) AS LFA_SUM_AMT,
                   A.LHO_AMT,
                   A.LHR_AMT,
                   A.LHP_AMT,
                   A.LHQ_AMT,
                   (A.LHO_AMT + A.LHR_AMT + A.LHP_AMT + A.LHQ_AMT) AS LLL_SUM_AMT,                   
                   A.VEN_AMT,                   
                   A.VEN2_AMT,
                   (A.VEN_AMT + A.VEN2_AMT) AS VEN_SUM_AMT,                                      
                   A.CARD_AMT,
                   A.CASH_AMT,
                   A.GIRO_AMT,
                   A.DIR_CARD_AMT,                   
                   A.MARKET_AMT,
                   (A.CARD_AMT + A.CASH_AMT + A.GIRO_AMT + A.DIR_CARD_AMT + A.MARKET_AMT) AS CCG_SUM_AMT,                    
                   A.STOCK_AMT3,
                   LEAST(A.GOV_AMT,100000) as GIBUGO,
                   C.ENO_NM,
                   E.JAS_NM, 
                   SUBSTR(E.JAO_NO,1,3)||'-'||SUBSTR(E.JAO_NO,4,2)||'-'||SUBSTR(E.JAO_NO,6,5) AS JAO_NO,                   
                   D.JAA_SUM_AMT,
                   D.JALN_SUM_AMT,
                   TO_CHAR(SYSDATE,'YYYY')||'년 '||TO_CHAR(SYSDATE,'MM')||'월 '||TO_CHAR(SYSDATE,'DD')||'일' AS TODAY
            FROM   ASNHR.T_AC_RETACC_14 A
            LEFT OUTER JOIN ASNHR.T_CM_PERSON C ON C.ENO_NO = A.ENO_NO
            LEFT JOIN (SELECT PIS_YY, ENO_NO
                            , NVL(SUM(JAA_AMT),0) AS JAA_SUM_AMT      
                            , (NVL(SUM(JAL_AMT),0) + NVL(SUM(JAN_AMT),0)) AS JALN_SUM_AMT                                                      
                         FROM ASNHR.T_AC_DUTYPLACE
                         WHERE ENO_NO = ? 
                         GROUP BY PIS_YY, ENO_NO
                       ) D       ON D.ENO_NO = A.ENO_NO
            LEFT OUTER JOIN ASNHR.T_AC_DUTYPLACE E ON E.ENO_NO = A.ENO_NO  AND E.SEQ_NO = '1'                                       
            WHERE   A.PIS_YY = ?
            AND       A.ENO_NO = ?
            AND 	    A.GBN_TAG   = '8'
         ]]>
        </query>
    </sql>     
    
    
<!--
***********************************************************************
* @UseCase     : YACA020_PRT_2012_04
* @description :인적사항  4page
***********************************************************************
* 2013/01/07     이동훈        최초작성
***********************************************************************
-->
    <!-- 작업 현황 검색 -->
    <sql name="YACA020_PRT_2012_04">
        <description>인적사항</description>
        <query>
            <![CDATA[
            SELECT 
            	   A.ENO_NO, A.ENO_NM, A.CET_NO, A.ADR_CT||A.ADDRESS AS ADDRESS
            FROM  ASNHR.T_CM_PERSON A
            WHERE   A.ENO_NO = ?
         ]]>
        </query>
    </sql>         
    
    
<!--
***********************************************************************
* @UseCase     : YACA020_PRT_2013
* @description : 부양가족
***********************************************************************
* 2014/01/07     이동훈        최초작성
***********************************************************************
-->
    <!-- 작업 현황 검색 -->    
    
    <!--  2014.01.07 이동훈 생성    열받아서 새로 만들고 있는 소득공제신고서 -->
    <sql name="YACA020_PRT_2013">
        <description>소득공제신고서</description>
        <query>
            <![CDATA[
            SELECT DISTINCT
            	A.PIS_YY, A.ENO_NO, ASNHR.SF_GET_ENONAME('01', A.ENO_NO) AS ENO_NM, C.CET_NO, 
            	(CASE WHEN HIR_YMD < '20130101' THEN '2013.01.01 ~ 2013.12.31' ELSE HIR_YMD||' ~ 2013.12.31' END) AS WORKDAY,
             	(CASE WHEN HOL_YN = 'Y' THEN  '세대주 ■,  세대원 □'  ELSE '세대주 □,  세대원 ■' END ) AS HOL_YN,
             	(CASE WHEN CLS_TAG = 'Y' THEN  '전년과동일 ■,  변동 □'  ELSE '전년과동일 □,  변동 ■' END ) AS CLS_TAG,             	
             	'인적공제 항목에 해당하는 인원수를 기재(다자녀 : '||NVL(D.CHILD,0)|| ' 명)' AS CHILD,
				B.LIN_AMT_NTS,
				B.LIN_AMT,
				B.MED_AMT_NTS,
				B.MED_AMT,
				B.EDU_AMT_NTS,
				B.EDU_AMT,
				B.CARD_AMT_NTS,
				B.CARD_AMT,
				B.DIR_CARD_AMT_NTS,
				B.DIR_CARD_AMT,  
				B.CASH_AMT_NTS,
				B.CASH_AMT, 					        
				B.MARKET_AMT_NTS,
				B.MARKET_AMT,
				B.PUBLIC_AMT_NTS,
				B.PUBLIC_AMT, 				
				B.GIBU_AMT_NTS,
				B.GIBU_AMT			                                   
            FROM   ASNHR.T_AC_RETACC A
	        LEFT JOIN 
	        (SELECT  ENO_NO, 
	        SUM(LIN_AMT_NTS)+SUM(LIH_AMT_NTS) AS LIN_AMT_NTS, SUM(LIN_AMT)+SUM(LIH_AMT) AS LIN_AMT, 	    
	        SUM(MED_AMT_NTS) AS MED_AMT_NTS, SUM(MED_AMT) AS MED_AMT, 	            
	        SUM(EDU_AMT_NTS+HED_AMT_NTS) AS EDU_AMT_NTS, SUM(EDU_AMT+HED_AMT) AS EDU_AMT,  
	        SUM(CARD_AMT_NTS) AS CARD_AMT_NTS, SUM(CARD_AMT) AS CARD_AMT,
	        SUM(DIR_CARD_AMT_NTS) AS DIR_CARD_AMT_NTS, SUM(DIR_CARD_AMT) AS DIR_CARD_AMT,       
	        SUM(CASH_AMT_NTS) AS CASH_AMT_NTS, SUM(CASH_AMT) AS CASH_AMT,	        
	        SUM(MARKET_AMT_NTS) AS MARKET_AMT_NTS, SUM(MARKET_AMT) AS MARKET_AMT,	
	        SUM(PUBLIC_AMT_NTS) AS PUBLIC_AMT_NTS, SUM(PUBLIC_AMT) AS PUBLIC_AMT,	 	        
	        SUM(NVL(LC1_AMT_NTS,0))+SUM(NVL(LC2_AMT_NTS,0))+SUM(NVL(LC3_AMT_NTS,0))) AS GIBU_AMT_NTS, 
	        SUM(NVL(LC1_AMT,0))+SUM(NVL(LC2_AMT,0))+SUM(NVL(LC3_AMT,0))) AS GIBU_AMT         
	        FROM ASNHR.T_AC_FAMILY
	        WHERE ENO_NO = ?
	        			AND PIS_YY = ?
	        GROUP BY ENO_NO ) B ON      B.ENO_NO = A.ENO_NO
            LEFT OUTER JOIN ASNHR.T_CM_PERSON C            
            ON      C.ENO_NO = A.ENO_NO 
      		LEFT JOIN 
          	(SELECT  ENO_NO,  SUM(DECODE(CHI_MAN,'O',1,0)) AS CHILD     
      			FROM ASNHR.T_AC_FAMILY WHERE ENO_NO = ? AND PIS_YY = '2013' GROUP BY ENO_NO) D  
      		ON  D.ENO_NO = A.ENO_NO 
            WHERE   A.PIS_YY = ?
            AND     A.ENO_NO = ?
            AND A.GBN_TAG   = '8'
         ]]>
        </query>
    </sql>        
    
    
<!--
***********************************************************************
* @UseCase     : YACA020_PRT_2013_01
* @description : 부양가족
***********************************************************************
* 2014/01/07     이동훈        최초작성
***********************************************************************
-->
    <!-- 작업 현황 검색 -->
    <sql name="YACA020_PRT_2013_01">
        <description>소득공제명세</description>
        <query>
            <![CDATA[
					SELECT REL_CD,
					(CASE WHEN SUBSTR(cet_no,7,1)='1' OR SUBSTR(cet_no,7,1)='2' OR SUBSTR(cet_no,7,1)='3' OR SUBSTR(cet_no,7,1)='4'
			           THEN '1'
			           ELSE '9'
        			 END ) AS TYPE,
					       NAM_KOR AS FAM_NM,
					       CET_NO AS JUMINNO,
                           BAS_MAN,
                           GOL_70 AS HI_UP,
                           TRB_MAN,
                           DECODE(INV_MAN,'0','','','','O') AS INV_MAN,
                           WCT_MAN,
                           RCH_MAN,
                           INP_MAN,
                           DECODE((SELECT COUNT(*)
                                   FROM   ASNHR.T_AC_FAMILY B
                                   WHERE  B.PIS_YY = A.PIS_YY
                                   AND    B.ENO_NO = A.ENO_NO
                                   AND    B.CHI_MAN = 'O'
                                  ),1,'',CHI_MAN
                                 ) AS CHI_MAN, -- 2명이상일때만 보인다.
			               ONE_PARENT,
			               NVL(LIN_AMT_NTS,0)+NVL(LIH_AMT_NTS,0) AS LIN_AMT_NTS, 
			               MED_AMT_NTS,
			               EDU_AMT_NTS + HED_AMT_NTS AS EDU_AMT_NTS,
			               CARD_AMT_NTS,
			               DIR_CARD_AMT_NTS,
			               CASH_AMT_NTS,
			               MARKET_AMT_NTS,
			               PUBLIC_AMT_NTS,			               
			               NVL(LC1_AMT_NTS,0) + NVL(LC2_AMT_NTS,0) + NVL(LC3_AMT_NTS,0)  AS GIBU_AMT_NTS,
			               NVL(LIN_AMT,0)+NVL(LIH_AMT,0) AS LIN_AMT,               
			               MED_AMT AS MED_AMT,
			               EDU_AMT + HED_AMT AS EDU_AMT,
			               CARD_AMT,
			               DIR_CARD_AMT,
			               CASH_AMT,
			               MARKET_AMT,
			               PUBLIC_AMT,			               
			               NVL(LC1_AMT,0) + NVL(LC2_AMT,0) + NVL(LC3_AMT,0)  AS GIBU_AMT,			               
			               (SUBSTR(CET_NO,1,6) || '-' || SUBSTR(CET_NO,7,7)) AS CET_NO
                    FROM   ASNHR.T_AC_FAMILY A
                    WHERE  PIS_YY = ?
                    AND    ENO_NO = ?
                    ORDER BY REL_CD, CET_NO DESC
         ]]>
        </query>
    </sql>    
 
    
    
<!--
***********************************************************************
* @UseCase     : YACA020_PRT_2013_02
* @description : 연금보험&특별공제 2page
***********************************************************************
* 2014/01/07     이동훈        최초작성
***********************************************************************
-->
    <!-- 작업 현황 검색 -->
    <sql name="YACA020_PRT_2013_02">
        <description>연금보험특별공제</description>
        <query>
            <![CDATA[
            SELECT 
                   A.PIS_YY, 
            	   A.ENO_NO, 
                   D.JAQ_AMT,
                   D.JAR_AMT,
                   D.JAH_AMT,
                   D.JAP_AMT,            	   
                   A.NPEN_AMT,
                   (NVL(A.ANN_AMT,0) + NVL(A.RET_AMT,0)) AS AR_AMT,
                   (NVL(D.JAQ_AMT,0) + A.NPEN_AMT + NVL(A.ANN_AMT,0) + NVL(A.RET_AMT,0) + NVL(D.JAR_AMT,0)) AS PEN_SUM_AMT,
                   (A.HINU_AMT + A.OLD_AMT) AS HEALTH_AMT,
                   A.HINS_AMT,
                   A.LIN_AMT,
                   A.LIH_AMT,
                   (NVL(D.JAH_AMT,0) + A.HINU_AMT + A.OLD_AMT + NVL(D.JAP_AMT,0) + A.HINS_AMT + A.LIN_AMT + A.LIH_AMT) AS INS_SUM_AMT,
                   NVL(A.MHEA_AMT,0) AS MHEA_AMT,
                   NVL(A.LF2_AMT,0) AS LF2_AMT,
                   NVL(A.OHEA_AMT,0) AS OHEA_AMT,
                   NVL(A.MHEA_AMT,0) + NVL(A.LF2_AMT,0) + NVL(A.OHEA_AMT,0) AS HEA_SUM_AMT,
                   A.GRA_AMT,                   
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '1' 
                  AND NVL(EDU_AMT_NTS,0)+NVL(EDU_AMT,0) <> 0 GROUP BY ENO_NO, EDU_TAG) AS TAG1_CNT,
                  (SELECT  SUM(EDU_AMT_NTS+EDU_AMT) FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '1' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT1,
                  (SELECT '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '2' 
                  GROUP BY ENO_NO, EDU_TAG) AS TAG2_CNT,                  
                  (SELECT  SUM(EDU_AMT_NTS+EDU_AMT) FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '2' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT2,
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND EDU_TAG = '3' 
                  AND REL_CD <> '0' GROUP BY ENO_NO, EDU_TAG) AS TAG3_CNT,                  
                  (SELECT  SUM(EDU_AMT_NTS+EDU_AMT) FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND EDU_TAG = '3'AND REL_CD <> '0' GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT3,
                  (SELECT  '('||COUNT(*)||' 명)'   FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND HED_AMT + HED_AMT_NTS > 0 GROUP BY ENO_NO, EDU_TAG) AS TAG4_CNT,                  
                  (SELECT  SUM(HED_AMT_NTS+HED_AMT) FROM ASNHR.T_AC_FAMILY WHERE  PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO 
                  AND HED_AMT_NTS > 0 GROUP BY ENO_NO, EDU_TAG) AS EDU_AMT4,
                   A.HED_AMT,
                   (A.GRA_AMT + EDU_AMT1 + EDU_AMT2 + EDU_AMT3 + EDU_AMT4 + A.HED_AMT)AS EDU_SUM_AMT,
                   A.LH1_AMT,
                   A.LH2_AMT,
                   A.LH2_AMT04,
                   A.LH3_AMT,                   
                   A.LH4_AMT,                   
                   A.LH5_AMT,
                   A.LH6_AMT,
                   A.LH7_AMT,
                   A.LH8_AMT,
                   (A.LH1_AMT + A.LH2_AMT + A.LH2_AMT04 + A.LH3_AMT + A.LH4_AMT + A.LH5_AMT + A.LH6_AMT + A.LH7_AMT + A.LH8_AMT) AS LH_SUM_AMT,                   
                   A.GOV_AMT - LEAST(A.GOV_AMT,100000) AS GOV_AMT,
                   A.LC3_AMT,
                   A.LC2_AMT AS LC2_AMT,
                   (GREATEST(A.GOV_AMT-100000,0) + A.LC2_AMT + A.LC3_AMT) AS LC_SUM_AMT
            FROM   ASNHR.T_AC_RETACC A
            LEFT OUTER JOIN ASNHR.T_CM_PERSON C ON C.ENO_NO = A.ENO_NO
            LEFT JOIN (SELECT PIS_YY, ENO_NO
                            , NVL(SUM(JAQ_AMT),0) AS JAQ_AMT 
                            , NVL(SUM(JAR_AMT),0) AS JAR_AMT
                            , NVL(SUM(JAH_AMT),0) AS JAH_AMT 
                            , NVL(SUM(JAP_AMT),0) AS JAP_AMT                             
                         FROM ASNHR.T_AC_DUTYPLACE
                         WHERE ENO_NO = ? 
                         				AND PIS_YY = '2013'
                         GROUP BY PIS_YY, ENO_NO
                       ) D       ON D.ENO_NO = A.ENO_NO               
            WHERE   A.PIS_YY = ?
            AND     A.ENO_NO = ?
            AND A.GBN_TAG   = '8'
         ]]>
        </query>
    </sql>      
    
<!--
***********************************************************************
* @UseCase     : YACA020_PRT_2013_03
* @description :그밖의소득공제 3page
***********************************************************************
* 2014/01/07     이동훈        최초작성
***********************************************************************
-->
    <!-- 작업 현황 검색 -->
    <sql name="YACA020_PRT_2013_03">
        <description>그밖의소득공제</description>
        <query>
            <![CDATA[
            SELECT 
                   A.PIS_YY, 
            	   A.ENO_NO, 
                   A.LF1_AMT,
                   A.ANN_AMT,
                   (A.LF1_AMT + A.ANN_AMT) AS LFA_SUM_AMT,
                   A.LHO_AMT,
                   A.LHR_AMT,
                   A.LHP_AMT,
                   A.LHQ_AMT,
                   (A.LHO_AMT + A.LHR_AMT + A.LHP_AMT + A.LHQ_AMT) AS LLL_SUM_AMT,                   
                   A.VEN_AMT,                   
                   A.VEN2_AMT,
                   (A.VEN_AMT + A.VEN2_AMT) AS VEN_SUM_AMT,                                      
                   A.CARD_AMT,
                   A.DIR_CARD_AMT,                     
                   A.CASH_AMT,
                   A.MARKET_AMT,
                   A.PUBLIC_AMT,                   
                   (A.CARD_AMT + A.DIR_CARD_AMT + A.CASH_AMT + A.MARKET_AMT + A.PUBLIC_AMT) AS CCG_SUM_AMT,                    
                   LEAST(A.GOV_AMT,100000) as GIBUGO,
                   C.ENO_NM,
                   E.JAS_NM, 
                   SUBSTR(E.JAO_NO,1,3)||'-'||SUBSTR(E.JAO_NO,4,2)||'-'||SUBSTR(E.JAO_NO,6,5) AS JAO_NO,                   
                   D.JAA_SUM_AMT,
                   D.JALN_SUM_AMT,
                   TO_CHAR(SYSDATE,'YYYY')||'년 '||TO_CHAR(SYSDATE,'MM')||'월 '||TO_CHAR(SYSDATE,'DD')||'일' AS TODAY
            FROM   ASNHR.T_AC_RETACC A
            LEFT OUTER JOIN ASNHR.T_CM_PERSON C ON C.ENO_NO = A.ENO_NO
            LEFT JOIN (SELECT PIS_YY, ENO_NO
                            , NVL(SUM(JAA_AMT),0) AS JAA_SUM_AMT      
                            , (NVL(SUM(JAL_AMT),0) + NVL(SUM(JAN_AMT),0)) AS JALN_SUM_AMT                                                      
                         FROM ASNHR.T_AC_DUTYPLACE
                         WHERE ENO_NO = ? 
                         		AND PIS_YY = ?
                         GROUP BY PIS_YY, ENO_NO
                       ) D       ON D.ENO_NO = A.ENO_NO
            LEFT OUTER JOIN ASNHR.T_AC_DUTYPLACE E ON E.ENO_NO = A.ENO_NO  AND E.SEQ_NO = '1'  AND E.PIS_YY = '2013'                                      
            WHERE   A.PIS_YY = ?
            AND       A.ENO_NO = ?
            AND 	    A.GBN_TAG   = '8'
         ]]>
        </query>
    </sql>     
    
    
<!--
***********************************************************************
* @UseCase     : YACA020_PRT_2013_04
* @description :인적사항  4page
***********************************************************************
* 2014/01/07     이동훈        최초작성
***********************************************************************
-->
    <!-- 작업 현황 검색 -->
    <sql name="YACA020_PRT_2013_04">
        <description>인적사항</description>
        <query>
            <![CDATA[
            SELECT 
            	   A.ENO_NO, A.ENO_NM, A.CET_NO, A.ADR_CT||A.ADDRESS AS ADDRESS
            FROM  ASNHR.T_CM_PERSON A
            WHERE   A.ENO_NO = ?
         ]]>
        </query>
    </sql>       
    
    
    
    
    <!-- 선택 직원의 연말 정산 정보를 수정 한다. -->
    <sql name="YACA020_UPT">
        <description>선택 직원의 연말 정산 정보를 수정 </description>
        <query>
            <![CDATA[
             UPDATE ASNHR.T_AC_RETACC
                SET SOU_CNT   = ?
                   ,DFM_CNT   = ?
                   ,TRB_CNT   = ?
                   ,GOL_CNT   = ?
                   ,GOL_CNT70 = ?
                   ,WCT_CNT   = ?
                   ,RCH_CNT   = ?
                   ,CHI_CNT   = ?
                   ,LIN_AMT   = ?
                   ,LIH_AMT   = ?
                   ,LMA_AMT   = ? + ?
                   ,MHEA_AMT  = ?
                   ,OHEA_AMT  = ?
                   ,LF2_AMT   = ?
                   ,LEN_AMT   = ?
                   ,LEN_AMT2  = ?
                   ,LEN_AMT3  = ?
                   ,LEN_AMT4  = ?
                   ,LEN_AMT5  = ?
                   ,GRA_AMT   = ?
                   ,EDU_AMT1  = ?
                   ,EDU_AMT2  = ?
                   ,EDU_AMT3  = ?
                   ,EDU_AMT4  = ?
                   ,EDU_AMT5  = ?
                   ,EDU_TAG1  = ?
                   ,EDU_TAG2  = ?
                   ,EDU_TAG3  = ?
                   ,EDU_TAG4  = ?
                   ,EDU_TAG5  = ?
                   ,HED_AMT   = ?
                   ,LHO_AMT   = ?
                   ,LHP_AMT   = ?
                   ,LHQ_AMT   = ?
                   ,LHR_AMT   = ?
                   ,LH1_AMT   = ?
                   ,LH2_AMT   = ?
                   ,LH2_AMT04 = ?
                   ,LH4_AMT   = ?
                   ,LH5_AMT   = ?
                   ,LH6_AMT   = ?
                   ,LH7_AMT   = ?
                   ,LH8_AMT   = ?                   
                   ,LC3_AMT   = ?
                   ,GOV_AMT   = ?
                   ,LC1_AMT   = ?
                   ,LC2_AMT   = ?
                   ,WED_CNT   = ?
                   ,LC3_NTS   = ?
                   ,GOV_NTS   = ?
                   ,LC1_NTS   = ?
                   ,LC2_NTS   = ?
                   ,MOV_CNT   = ?
                   ,FUN_CNT   = ?
                   ,LF1_AMT   = ?
                   ,ANN_AMT   = ?
                   ,VEN2_AMT  = ?
                   ,CARD_AMT  = ?
                   ,DIR_CARD_AMT  = ?
                   ,LST_AMT   = ?
                   ,GOV_DED   = ?
                   ,CASH_AMT  = ?
                   ,GIRO_AMT  = ?
                   ,STOCK_AMT3 = ?
                   ,HOL_YN = ?
                   ,UPT_MAN   = ?
                   ,UPT_YMD   = SYSDATE
              WHERE PIS_YY    = ?
                AND ENO_NO    = ?
                AND GBN_TAG   = '8'
            ]]>
        </query>
    </sql>

    <!-- 선택 직원의 연말 정산 정보를 수정 한다. -->
    <sql name="YACA020_UPT_13">
        <description>선택 직원의 연말 정산 정보를 수정 </description>
        <query>
            <![CDATA[
             UPDATE ASNHR.T_AC_RETACC
                SET SOU_CNT   = ?
                   ,DFM_CNT   = ?
                   ,TRB_CNT   = ?
                   ,GOL_CNT   = ?
                   ,GOL_CNT70 = ?
                   ,WCT_CNT   = ?
                   ,RCH_CNT   = ?
                   ,CHI_CNT   = ?
                   ,LIN_AMT   = ?
                   ,LIH_AMT   = ?
                   ,LMA_AMT   = ? + ?
                   ,MHEA_AMT  = ?
                   ,OHEA_AMT  = ?
                   ,LF2_AMT   = ?
                   
                   ,LEN_AMT   = ?
                   ,LEN_AMT2  = ?
                   ,LEN_AMT3  = ?
                   ,LEN_AMT4  = ?
                   ,LEN_AMT5  = ?
                   ,GRA_AMT   = ?
                   ,EDU_AMT1  = ?
                   ,EDU_AMT2  = ?
                   ,EDU_AMT3  = ?
                   ,EDU_AMT4  = ?
                   ,EDU_AMT5  = ?
                   ,EDU_TAG1  = ?
                   ,EDU_TAG2  = ?
                   ,EDU_TAG3  = ?
                   ,EDU_TAG4  = ?
                   ,EDU_TAG5  = ?
                   ,HED_AMT   = ?
                   
                   ,LHO_AMT   = ?
                   ,LHP_AMT   = ?
                   ,LHQ_AMT   = ?
                   ,LHR_AMT   = ?
                   ,LH1_AMT   = ?
                   ,LH2_AMT   = ?
                   ,LH2_AMT04 = ?
                   ,LH4_AMT   = ?
                   ,LH5_AMT   = ?
                   ,LH6_AMT   = ?
                   ,LH7_AMT   = ?
                   ,LH8_AMT   = ?   
                                   

                   ,GOV_AMT   = ?
                   ,LC1_AMT   = ?
                   ,LC2_AMT   = ?
                   ,LC3_AMT   = ?

                   ,GOV_NTS   = ?
                   ,LC1_NTS   = ?
                   ,LC2_NTS   = ?
                   ,LC3_NTS   = ?

                   ,FUN_CNT   = ?
                   ,LF1_AMT   = ?
                   
                   ,CARD_AMT  = ?
                   ,DIR_CARD_AMT  = ?
                   ,CASH_AMT  = ?           
                   ,MARKET_AMT  = ?
                   ,PUBLIC_AMT  = ?     

                   ,HOL_YN = ?
                   ,UPT_MAN   = ?
                   ,UPT_YMD   = SYSDATE
              WHERE PIS_YY    = ?
                AND ENO_NO    = ?
                AND GBN_TAG   = '8'
            ]]>
        </query>
    </sql>
    

    <!-- 종전 근무지를 조회 한다. -->
    <sql name="YACA020_SHR_PLA">
        <description>종전 근무지를 조회</description>
        <query>
            <![CDATA[
            SELECT ? AS PIS_YY
                 , ? AS ENO_NO

                 , MAX(    DECODE(B.NUM, 1, B.JAO_NO  ))      AS JAO_NO1
                 , MAX(    DECODE(B.NUM, 1, B.JAS_NM  ))      AS JAS_NM1
                 , MAX(    DECODE(B.NUM, 1, B.HIR_YMD ))      AS HIR_YMD1
                 , MAX(    DECODE(B.NUM, 1, B.RET_YMD ))      AS RET_YMD1
                 , MAX(    DECODE(B.NUM, 1, B.TYPE  ))        AS TYPE1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAA_AMT )), 0)  AS JAA_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAC_AMT )), 0)  AS JAC_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAG_AMT )), 0)  AS JAG_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAI_AMT )), 0)  AS JAI_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAQ_AMT )), 0)  AS JAQ_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAR_AMT )), 0)  AS JAR_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAH_AMT )), 0)  AS JAH_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAP_AMT )), 0)  AS JAP_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAL_AMT )), 0)  AS JAL_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAN_AMT )), 0)  AS JAN_AMT1

                 , MAX(    DECODE(B.NUM, 2, B.JAO_NO  ))      AS JAO_NO2
                 , MAX(    DECODE(B.NUM, 2, B.JAS_NM  ))      AS JAS_NM2
                 , MAX(    DECODE(B.NUM, 2, B.HIR_YMD ))      AS HIR_YMD2
                 , MAX(    DECODE(B.NUM, 2, B.RET_YMD ))      AS RET_YMD2
                 , MAX(    DECODE(B.NUM, 2, B.TYPE  ))        AS TYPE2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAA_AMT )), 0)  AS JAA_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAC_AMT )), 0)  AS JAC_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAG_AMT )), 0)  AS JAG_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAI_AMT )), 0)  AS JAI_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAQ_AMT )), 0)  AS JAQ_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAR_AMT )), 0)  AS JAR_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAH_AMT )), 0)  AS JAH_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAP_AMT )), 0)  AS JAP_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAL_AMT )), 0)  AS JAL_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAN_AMT )), 0)  AS JAN_AMT2

                 , MAX(    DECODE(B.NUM, 3, B.JAO_NO  ))      AS JAO_NO3
                 , MAX(    DECODE(B.NUM, 3, B.JAS_NM  ))      AS JAS_NM3
                 , MAX(    DECODE(B.NUM, 3, B.HIR_YMD ))      AS HIR_YMD3
                 , MAX(    DECODE(B.NUM, 3, B.RET_YMD ))      AS RET_YMD3
                 , MAX(    DECODE(B.NUM, 3, B.TYPE  ))        AS TYPE3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAA_AMT )), 0)  AS JAA_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAC_AMT )), 0)  AS JAC_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAG_AMT )), 0)  AS JAG_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAI_AMT )), 0)  AS JAI_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAQ_AMT )), 0)  AS JAQ_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAR_AMT )), 0)  AS JAR_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAH_AMT )), 0)  AS JAH_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAP_AMT )), 0)  AS JAP_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAL_AMT )), 0)  AS JAL_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAN_AMT )), 0)  AS JAN_AMT3

              FROM (SELECT LEVEL AS NUM
                      FROM DUAL
                CONNECT BY LEVEL <= 3
                    ) A
                 , (SELECT ROW_NUMBER() OVER(ORDER BY ENO_NO
                                                    , PIS_YY
                                                    , SEQ_NO
                                             ) AS NUM
                         , 'X' AS TYPE
                         , SEQ_NO
                         , JAO_NO
                         , JAS_NM
                         , JAA_AMT
                         , JAC_AMT
                         , JAG_AMT
                         , JAI_AMT
                         , JAQ_AMT
                         , JAR_AMT
                         , JAH_AMT
                         , JAP_AMT
                         , JAL_AMT
                         , JAN_AMT
                         , TO_CHAR(TO_DATE(HIR_YMD),'YYYY-MM-DD') AS HIR_YMD
                   		 , TO_CHAR(TO_DATE(RET_YMD),'YYYY-MM-DD') AS RET_YMD
                      FROM ASNHR.T_AC_DUTYPLACE
                     WHERE PIS_YY  = ?
                       AND ENO_NO  = ?
                    ) B
             WHERE A.NUM = B.NUM(+)
            ]]>
        </query>
    </sql>


    <!-- 종전 근무지 내역을 모두 삭제 -->
    <sql name="YACA020_DEL_PLA">
        <description>종전 근무지 내역을 모두 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_DUTYPLACE
             WHERE PIS_YY = ?
               AND ENO_NO = ?
            ]]>
        </query>
    </sql>

    <!-- 종전 근무지를 입력 한다. -->
    <sql name="YACA020_INS_PLA">
        <description>종전 근무지를 입력</description>
        <query>
            <![CDATA[
            INSERT
              INTO ASNHR.T_AC_DUTYPLACE
                   (PIS_YY
                   ,PIS_MM
                   ,ENO_NO
                   ,SEQ_NO
                   ,JAO_NO
                   ,JAS_NM
                   ,HIR_YMD
                   ,RET_YMD
                   ,JAA_AMT
                   ,JAC_AMT
                   ,JAG_AMT
                   ,JAI_AMT
                   ,JAQ_AMT
                   ,JAR_AMT
                   ,JAH_AMT
                   ,JAP_AMT
                   ,JAL_AMT
                   ,JAN_AMT
                   ,JAB_AMT
                   ,JAD_AMT
                   ,JAE_AMT
                   ,JAF_AMT
                   ,JAJ_AMT
                   ,JAK_AMT
                   ,JAM_AMT
                   ,IPT_MAN
                   ,IPT_YMD
                   ,UPT_MAN
                   ,UPT_YMD)
            VALUES (?
                   ,'12'
                   ,?
                   ,?
                   ,REPLACE(?,'-','')
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,0
                   ,0
                   ,?
                   ,0
                   ,0
                   ,0
                   ,0
                   ,?
                   ,SYSDATE
                   ,?
                   ,SYSDATE)
            ]]>
        </query>
    </sql>

    <!-- 주소 수정 -->
    <sql name="YACA020_UPT_01">
        <description>인사기본3 수정</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_CM_PERSON
            SET    ZIP_NO    = ?,
                   ADDRESS   = ?,
                   ADR_CT    = ?,
                   UPT_MAN   = ?,
                   UPT_YMD   = SYSDATE
            WHERE  GUBUN  = ?
            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>
    
    
    <!-- 인적공제항목전년도동일 수정 -->
    <sql name="YACA020_UPT_CLS">
        <description>인적공제항목전년도동일</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC
            SET    CLS_TAG    = ?,
                   UPT_YMD   = SYSDATE
            WHERE  GBN_TAG  = '8'
            AND    ENO_NO = ?
            AND PIS_YY = ?
            ]]>
        </query>
    </sql>    
    
    <!-- 인적공제항목전년도동일 수정 -->
    <sql name="YACA020_UPT_CLS_14">
        <description>인적공제항목전년도동일</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_14
            SET    CLS_TAG    = ?,
                   UPT_YMD   = SYSDATE
            WHERE ENO_NO = ?
            AND PIS_YY = ?
            ]]>
        </query>
    </sql>      
    
    <!-- 인적공제항목전년도동일 수정 -->
    <sql name="YACA020_UPT_CLS_142">
        <description>인적공제항목전년도동일</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_142
            SET    CLS_TAG   = ?,
                   UPT_YMD   = SYSDATE
            WHERE ENO_NO = ?
            AND PIS_YY = ?
            ]]>
        </query>
    </sql>      
    
    
    <!-- 인적공제항목전년도동일 수정 -->
    <sql name="YACA020_UPT_CLS_15">
        <description>인적공제항목전년도동일</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_15
            SET    CLS_TAG   = ?,
                   UPT_YMD   = SYSDATE
            WHERE ENO_NO = ?
            AND PIS_YY = ?
            ]]>
        </query>
    </sql>      
    
    
    
    <!-- 전산제출 수정 -->
    <sql name="YACA020_UPT_END">
        <description>전산제출</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC
            SET    	FUN_CNT = ?,
            			UPT_MAN   = ?,
                   		UPT_YMD   = SYSDATE
            WHERE  GBN_TAG  = '8'
            AND    ENO_NO = ?
            AND PIS_YY = ?            
            ]]>
        </query>
    </sql>   
    
        <!-- 전산제출 수정 -->
    <sql name="YACA020_UPT_END_14">
        <description>전산제출</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_14
            SET    	FUN_CNT = ?,
            			UPT_MAN   = ?,
                   		UPT_YMD   = SYSDATE
            WHERE  ENO_NO = ?
            AND PIS_YY = ?            
            ]]>
        </query>
    </sql>  
    
        <!-- 전산제출 수정 -->
    <sql name="YACA020_UPT_END_142">
        <description>전산제출</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_142
            SET    	FUN_CNT = ?,
            			UPT_MAN   = ?,
                   		UPT_YMD   = SYSDATE
            WHERE  ENO_NO = ?
            AND PIS_YY = ?            
            ]]>
        </query>
    </sql>      
    
        <!-- 전산제출 수정 -->
    <sql name="YACA020_UPT_END_15">
        <description>전산제출</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_15
            SET    	FUN_CNT = ?,
            			UPT_MAN   = ?,
                   		UPT_YMD   = SYSDATE
            WHERE  ENO_NO = ?
            AND PIS_YY = ?            
            ]]>
        </query>
    </sql>      
    
<!--
***********************************************************************
* @UseCase     : YACA021
* @description : 부양가족등록
***********************************************************************
* 2007/04/18     조정호        최초작성.
***********************************************************************
-->
    <!-- 부양가족내역 조회 -->
    <sql name="YACA021_SHR">
        <description>부양가족내역 조회</description>
        <query>
            <![CDATA[
               SELECT ROW_NUMBER() OVER (ORDER BY ASNHR.SF_GET_COMMSEQ('01', 'FA', REL_CD), CET_NO, 14) AS NO
                     ,REL_CD
                     ,PIS_YY
                     ,ENO_NO
                     ,ASNHR.SF_GET_COMMNAME('01', 'FA', REL_CD) AS REL_NM
                     ,NAM_KOR
                     ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                     ,NVL(BAS_MAN,' ') AS BAS_MAN
                     ,NVL(GOL_70, ' ') AS GOL_70
                     ,NVL(TRB_MAN,' ') AS TRB_MAN
                     ,NVL(WCT_MAN,' ') AS WCT_MAN
                     ,NVL(RCH_MAN,' ') AS RCH_MAN
                     ,NVL(INP_MAN,' ') AS INP_MAN
                     ,DECODE((SELECT COUNT(*)
                                   FROM   ASNHR.T_AC_FAMILY B
                                   WHERE  B.PIS_YY = A.PIS_YY
                                   AND    B.ENO_NO = A.ENO_NO
                                   AND    B.CHI_MAN = 'O'
                                  ),1,' ',NVL(CHI_MAN,' ')
                                 ) AS CHI_MAN -- 2명이상일때만 보인다.
                     ,'국세청 자료' AS GBN_NM
                     ,NVL(LIN_AMT_NTS, '0') + NVL(LIH_AMT_NTS, '0') AS LIN_AMT
                     ,NVL(MED_AMT_NTS, '0') + NVL(LEN_AMT_NTS, '0') AS MED_AMT
                     ,NVL(EDU_AMT_NTS, '0') + NVL(HED_AMT_NTS, '0') AS EDU_AMT
                     ,NVL(CARD_AMT_NTS,'0') AS CARD_AMT -- + NVL(CARD_WRK_AMT_NTS,'0') + NVL(CARD_MED_AMT_NTS,'0') + NVL(CARD_NBMED_AMT_NTS,'0') AS CARD_AMT
                     ,NVL(DIR_CARD_AMT_NTS,'0') AS DIR_CARD_AMT
                     ,NVL(CASH_AMT_NTS,'0') AS CASH_AMT -- + NVL(CASH_MED_AMT_NTS,'0') AS CASH_AMT
                     ,NVL(MARKET_AMT_NTS,'0')  AS  MARKET_AMT                  
                     ,NVL(SCH_AMT_NTS, '0') AS SCH_AMT
                     ,NVL(LC1_AMT_NTS, '0') AS LC1_AMT
                     ,NVL(LC2_AMT_NTS, '0') AS LC2_AMT
                     ,NVL(LC3_AMT_NTS, '0') AS LC3_AMT
                     ,NVL(LC4_AMT_NTS, '0') AS LC4_AMT
                     ,nvl(LH1_AMT_NTS,0)   as LH1_AMT
                     ,nvl(LH2_AMT04_NTS,0) as LH2_AMT04
                     ,nvl(LH2_AMT_NTS,0)   as LH2_AMT
                     ,nvl(LH4_AMT_NTS,0)   as LH4_AMT
                     ,nvl(LH5_AMT_NTS,0)   as LH5_AMT
                     ,nvl(LH6_AMT_NTS,0)   as LH6_AMT
                     ,nvl(LH7_AMT_NTS,0)   as LH7_AMT
                     ,nvl(LH8_AMT_NTS,0)   as LH8_AMT                     
                 FROM ASNHR.T_AC_FAMILY A
                WHERE PIS_YY = ?
                  AND ENO_NO = ?
                UNION
               SELECT ROW_NUMBER() OVER (ORDER BY ASNHR.SF_GET_COMMSEQ('01', 'FA', REL_CD), CET_NO, 14) AS NO
                     ,REL_CD                     
                     ,PIS_YY
                     ,ENO_NO
                     ,ASNHR.SF_GET_COMMNAME('01', 'FA', REL_CD) AS REL_NM
                     ,NAM_KOR
                     ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                     ,NVL(BAS_MAN,' ') AS BAS_MAN
                     ,NVL(GOL_70, ' ') AS GOL_70
                     ,NVL(TRB_MAN,' ') AS TRB_MAN
                     ,NVL(WCT_MAN,' ') AS WCT_MAN
                     ,NVL(RCH_MAN,' ') AS RCH_MAN
                     ,NVL(INP_MAN,' ') AS INP_MAN
                     ,DECODE((SELECT COUNT(*)
                                   FROM   ASNHR.T_AC_FAMILY B
                                   WHERE  B.PIS_YY = A.PIS_YY
                                   AND    B.ENO_NO = A.ENO_NO
                                   AND    B.CHI_MAN = 'O'
                                  ),1,' ',NVL(CHI_MAN,' ')
                                 ) AS CHI_MAN -- 2명이상일때만 보인다.
                     ,'그밖의 자료' AS GBN_NM
                     ,NVL(LIN_AMT, '0') + NVL(LIH_AMT, '0')
                     ,NVL(MED_AMT, '0') + NVL(LEN_AMT, '0')
                     ,NVL(EDU_AMT, '0') + NVL(HED_AMT, '0')
                     ,NVL(CARD_AMT,'0') -- + NVL(CARD_WRK_AMT,'0') + NVL(CARD_MED_AMT,'0') + NVL(CARD_NBMED_AMT,'0')
                     ,NVL(DIR_CARD_AMT,'0')
                     ,NVL(CASH_AMT,'0') 
                     ,NVL(MARKET_AMT,'0')                  
                     ,NVL(SCH_AMT, '0')
                     ,NVL(LC1_AMT,'0') AS LC1_AMT
                     ,NVL(LC2_AMT,'0') AS LC2_AMT
                     ,NVL(LC3_AMT,'0')
                     ,NVL(LC4_AMT,'0') AS LC4_AMT
                     ,nvl(LH1_AMT,0)   as LH1_AMT     -- 주택자금_대출기관
                     ,nvl(LH2_AMT04,0) as LH2_AMT04
                     ,nvl(LH2_AMT,0)   as LH2_AMT
                     ,nvl(LH4_AMT,0)   as LH4_AMT
                     ,nvl(LH5_AMT,0)   as LH5_AMT
                     ,nvl(LH6_AMT,0)   as LH6_AMT
                     ,nvl(LH7_AMT,0)   as LH7_AMT
                     ,nvl(LH8_AMT,0)   as LH8_AMT                     
                 FROM ASNHR.T_AC_FAMILY A
                WHERE PIS_YY = ?
                  AND ENO_NO = ?
             ORDER BY REL_CD, CET_NO, NAM_KOR
            ]]>
        </query>
    </sql>


    <!-- 2013년도 부양가족내역 조회 -->
    <sql name="YACA021_SHR_13">
        <description>부양가족내역 조회</description>
        <query>
            <![CDATA[
               SELECT ROW_NUMBER() OVER (ORDER BY ASNHR.SF_GET_COMMSEQ('01', 'FA', REL_CD), CET_NO, 14) AS NO
                     ,REL_CD
                     ,PIS_YY
                     ,ENO_NO
                     ,ASNHR.SF_GET_COMMNAME('01', 'FA', REL_CD) AS REL_NM
                     ,NAM_KOR
                     ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                     ,NVL(BAS_MAN,' ') AS BAS_MAN
                     ,NVL(GOL_70, ' ') AS GOL_70
                     ,NVL(TRB_MAN,' ') AS TRB_MAN
                     ,NVL(WCT_MAN,' ') AS WCT_MAN
                     ,NVL(RCH_MAN,' ') AS RCH_MAN
                     ,NVL(INP_MAN,' ') AS INP_MAN
                     ,NVL(ONE_PARENT,' ') AS ONE_PARENT                    
                     ,DECODE((SELECT COUNT(*)
                                   FROM   ASNHR.T_AC_FAMILY B
                                   WHERE  B.PIS_YY = A.PIS_YY
                                   AND    B.ENO_NO = A.ENO_NO
                                   AND    B.CHI_MAN = 'O'
                                  ),1,' ',NVL(CHI_MAN,' ')
                                 ) AS CHI_MAN -- 2명이상일때만 보인다.
                     ,'국세청 자료' AS GBN_NM
                     ,NVL(LIN_AMT_NTS, '0') + NVL(LIH_AMT_NTS, '0') AS LIN_AMT
                     ,NVL(MED_AMT_NTS, '0') + NVL(LEN_AMT_NTS, '0') AS MED_AMT
                     ,NVL(EDU_AMT_NTS, '0') + NVL(HED_AMT_NTS, '0') AS EDU_AMT
                     ,NVL(CARD_AMT_NTS,'0') AS CARD_AMT
                     ,NVL(DIR_CARD_AMT_NTS,'0') AS DIR_CARD_AMT
                     ,NVL(CASH_AMT_NTS,'0') AS CASH_AMT
                     ,NVL(MARKET_AMT_NTS,'0')  AS  MARKET_AMT                  
                     ,NVL(PUBLIC_AMT_NTS, '0') AS PUBLIC_AMT
                     ,NVL(LC1_AMT_NTS, '0')+NVL(LC2_AMT_NTS, '0')+NVL(LC3_AMT_NTS, '0')+NVL(LC4_AMT_NTS, '0') AS LC_AMT
                     ,nvl(LH1_AMT_NTS,0)   as LH1_AMT
                     ,nvl(LH2_AMT04_NTS,0) as LH2_AMT04
                     ,nvl(LH2_AMT_NTS,0)   as LH2_AMT
                     ,nvl(LH4_AMT_NTS,0)   as LH4_AMT
                     ,nvl(LH5_AMT_NTS,0)   as LH5_AMT
                     ,nvl(LH6_AMT_NTS,0)   as LH6_AMT
                     ,nvl(LH7_AMT_NTS,0)   as LH7_AMT
                     ,nvl(LH8_AMT_NTS,0)   as LH8_AMT                     
                 FROM ASNHR.T_AC_FAMILY A
                WHERE PIS_YY = ?
                  AND ENO_NO = ?
                UNION
               SELECT ROW_NUMBER() OVER (ORDER BY ASNHR.SF_GET_COMMSEQ('01', 'FA', REL_CD), CET_NO, 14) AS NO
                     ,REL_CD                     
                     ,PIS_YY
                     ,ENO_NO
                     ,ASNHR.SF_GET_COMMNAME('01', 'FA', REL_CD) AS REL_NM
                     ,NAM_KOR
                     ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                     ,NVL(BAS_MAN,' ') AS BAS_MAN
                     ,NVL(GOL_70, ' ') AS GOL_70
                     ,NVL(TRB_MAN,' ') AS TRB_MAN
                     ,NVL(WCT_MAN,' ') AS WCT_MAN
                     ,NVL(RCH_MAN,' ') AS RCH_MAN
                     ,NVL(INP_MAN,' ') AS INP_MAN
                     ,NVL(ONE_PARENT,' ') AS ONE_PARENT                     
                     ,DECODE((SELECT COUNT(*)
                                   FROM   ASNHR.T_AC_FAMILY B
                                   WHERE  B.PIS_YY = A.PIS_YY
                                   AND    B.ENO_NO = A.ENO_NO
                                   AND    B.CHI_MAN = 'O'
                                  ),1,' ',NVL(CHI_MAN,' ')
                                 ) AS CHI_MAN -- 2명이상일때만 보인다.
                     ,'그밖의 자료' AS GBN_NM
                     ,NVL(LIN_AMT, '0') + NVL(LIH_AMT, '0')
                     ,NVL(MED_AMT, '0') + NVL(LEN_AMT, '0')
                     ,NVL(EDU_AMT, '0') + NVL(HED_AMT, '0')
                     ,NVL(CARD_AMT,'0') 
                     ,NVL(DIR_CARD_AMT,'0')
                     ,NVL(CASH_AMT,'0') 
                     ,NVL(MARKET_AMT,'0')                  
                     ,NVL(PUBLIC_AMT, '0')
                     ,NVL(LC1_AMT, '0')+NVL(LC2_AMT, '0')+NVL(LC3_AMT, '0')+NVL(LC4_AMT, '0') AS LC_AMT
                     ,nvl(LH1_AMT,0)   as LH1_AMT     -- 주택자금_대출기관
                     ,nvl(LH2_AMT04,0) as LH2_AMT04
                     ,nvl(LH2_AMT,0)   as LH2_AMT
                     ,nvl(LH4_AMT,0)   as LH4_AMT
                     ,nvl(LH5_AMT,0)   as LH5_AMT
                     ,nvl(LH6_AMT,0)   as LH6_AMT
                     ,nvl(LH7_AMT,0)   as LH7_AMT
                     ,nvl(LH8_AMT,0)   as LH8_AMT                     
                 FROM ASNHR.T_AC_FAMILY A
                WHERE PIS_YY = ?
                  AND ENO_NO = ?
             ORDER BY REL_CD, CET_NO, NAM_KOR
            ]]>
        </query>
    </sql>


    <!-- 2014년도 부양가족내역 조회 -->
    <sql name="YACA021_SHR_14">
        <description>부양가족내역 조회</description>
        <query>
            <![CDATA[
               SELECT ROW_NUMBER() OVER (ORDER BY ASNHR.SF_GET_COMMSEQ('01', 'FA', REL_CD), CET_NO, 14) AS NO
                     ,REL_CD
                     ,PIS_YY
                     ,ENO_NO
                     ,ASNHR.SF_GET_COMMNAME('01', 'FA', REL_CD) AS REL_NM
                     ,NAM_KOR
                     ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                     ,NVL(BAS_MAN,' ') AS BAS_MAN
                     ,NVL(GOL_70, ' ') AS GOL_70
                     ,NVL(TRB_MAN,' ') AS TRB_MAN
                     ,NVL(WCT_MAN,' ') AS WCT_MAN
                     ,NVL(ONE_MAN,' ') AS ONE_MAN     
                                    
                     ,'국세청 자료' AS GBN_NM
                     ,(CASE WHEN REL_CD = 0 THEN (SELECT SUM(NVL(B.JAH_AMT,0) + NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0) + NVL(B.JAP_AMT,0) + NVL(A.HINS_AMT,0)) 
                       FROM ASNHR.T_AC_RETACC_14 A, 
                       (SELECT ENO_NO, SUM(JAH_AMT) JAH_AMT, SUM(JAP_AMT) JAP_AMT FROM ASNHR.T_AC_DUTYPLACE WHERE PIS_YY = '2014' GROUP BY ENO_NO ) B 
                       WHERE A.ENO_NO = B.ENO_NO(+) AND A.PIS_YY ='2014' AND A.ENO_NO = ?) ELSE 0 END)  AS HIN_SUM                     
                     ,NVL(LIN_AMT_NTS, '0') + NVL(LIH_AMT_NTS, '0') AS LIN_AMT
                     ,NVL(MED_AMT_NTS, '0') + NVL(LEN_AMT_NTS, '0') AS MED_AMT
                     ,NVL(EDU_AMT_NTS, '0') + NVL(HED_AMT_NTS, '0') AS EDU_AMT
                     ,NVL(CARD_AMT_NTS,'0') AS CARD_AMT
                     ,NVL(DIR_CARD_AMT_NTS,'0') AS DIR_CARD_AMT
                     ,NVL(CASH_AMT_NTS,'0') AS CASH_AMT
                     ,NVL(MARKET_AMT_NTS,'0')  AS  MARKET_AMT                  
                     ,NVL(PUBLIC_AMT_NTS, '0') AS PUBLIC_AMT
                     ,NVL(GOV_AMT_NTS, '0')+NVL(LC1_AMT_NTS, '0')+NVL(LC2_AMT_NTS, '0')+NVL(LC3_AMT_NTS, '0') AS LC_AMT

                 FROM ASNHR.T_AC_FAMILY_14 A
                WHERE PIS_YY = ?
                  AND ENO_NO = ?
                UNION
               SELECT ROW_NUMBER() OVER (ORDER BY ASNHR.SF_GET_COMMSEQ('01', 'FA', REL_CD), CET_NO, 14) AS NO
                     ,REL_CD                     
                     ,PIS_YY
                     ,ENO_NO
                     ,ASNHR.SF_GET_COMMNAME('01', 'FA', REL_CD) AS REL_NM
                     ,NAM_KOR
                     ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                     ,NVL(BAS_MAN,' ') AS BAS_MAN
                     ,NVL(GOL_70, ' ') AS GOL_70
                     ,NVL(TRB_MAN,' ') AS TRB_MAN
                     ,NVL(WCT_MAN,' ') AS WCT_MAN
                     ,NVL(ONE_MAN,' ') AS ONE_MAN           
                               
                     ,'그밖의 자료' AS GBN_NM
                     ,0 AS HIN_SUM
                     ,NVL(LIN_AMT, '0') + NVL(LIH_AMT, '0')
                     ,NVL(MED_AMT, '0') + NVL(LEN_AMT, '0')
                     ,NVL(EDU_AMT, '0') + NVL(HED_AMT, '0')
                     ,NVL(CARD_AMT,'0') 
                     ,NVL(DIR_CARD_AMT,'0')
                     ,NVL(CASH_AMT,'0') 
                     ,NVL(MARKET_AMT,'0')                  
                     ,NVL(PUBLIC_AMT, '0')
                     ,NVL(GOV_AMT, '0')+NVL(LC1_AMT, '0')+NVL(LC2_AMT, '0')+NVL(LC3_AMT, '0')  AS LC_AMT
                                        
                 FROM ASNHR.T_AC_FAMILY_14 A
                WHERE PIS_YY = ?
                  AND ENO_NO = ?
             ORDER BY REL_CD, CET_NO, NAM_KOR
            ]]>
        </query>
    </sql>

    <!-- 2014년도 부양가족내역 조회 -->
    <sql name="YACA021_SHR_142">
        <description>부양가족내역 조회</description>
        <query>
            <![CDATA[
               SELECT ROW_NUMBER() OVER (ORDER BY ASNHR.SF_GET_COMMSEQ('01', 'FA', REL_CD), CET_NO, 14) AS NO
                     ,REL_CD
                     ,PIS_YY
                     ,ENO_NO
                     ,ASNHR.SF_GET_COMMNAME('01', 'FA', REL_CD) AS REL_NM
                     ,NAM_KOR
                     ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                     ,NVL(BAS_MAN,' ') AS BAS_MAN
                     ,NVL(GOL_70, ' ') AS GOL_70
                     ,NVL(TRB_MAN,' ') AS TRB_MAN
                     ,NVL(WCT_MAN,' ') AS WCT_MAN
                     ,NVL(ONE_MAN,' ') AS ONE_MAN     
                     ,NVL(INP_MAN,' ') AS INP_MAN
                     ,NVL(RCH_MAN,' ') AS RCH_MAN                                      
                     ,'국세' AS GBN_NM
                     ,(CASE WHEN REL_CD = 0 THEN (SELECT SUM(NVL(B.JAH_AMT,0) + NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0) + NVL(B.JAP_AMT,0) + NVL(A.HINS_AMT,0)) 
                       FROM ASNHR.T_AC_RETACC_142 A, 
                       (SELECT ENO_NO, SUM(JAH_AMT) JAH_AMT, SUM(JAP_AMT) JAP_AMT FROM ASNHR.T_AC_DUTYPLACE WHERE PIS_YY = '2014' GROUP BY ENO_NO ) B 
                       WHERE A.ENO_NO = B.ENO_NO(+) AND A.PIS_YY ='2014' AND A.ENO_NO = ?) ELSE 0 END)  AS HIN_SUM                     
                     ,NVL(LIN_AMT_NTS, '0') + NVL(LIH_AMT_NTS, '0') AS LIN_AMT
                     ,NVL(MED_AMT_NTS, '0') + NVL(LEN_AMT_NTS, '0') AS MED_AMT
                     ,NVL(EDU_AMT_NTS, '0') + NVL(HED_AMT_NTS, '0') AS EDU_AMT
                     ,NVL(CARD_AMT_NTS,'0') AS CARD_AMT
                     ,NVL(DIR_CARD_AMT_NTS,'0') AS DIR_CARD_AMT
                     ,NVL(CASH_AMT_NTS,'0') AS CASH_AMT
                     ,NVL(MARKET_AMT_NTS,'0')  AS  MARKET_AMT                  
                     ,NVL(PUBLIC_AMT_NTS, '0') AS PUBLIC_AMT
                     ,NVL(GOV_AMT_NTS, '0')+NVL(LC1_AMT_NTS, '0')+NVL(LC2_AMT_NTS, '0')+NVL(LC3_AMT_NTS, '0') AS LC_AMT

                 FROM ASNHR.T_AC_FAMILY_142 A
                WHERE PIS_YY = ?
                  AND ENO_NO = ?
                UNION
               SELECT ROW_NUMBER() OVER (ORDER BY ASNHR.SF_GET_COMMSEQ('01', 'FA', REL_CD), CET_NO, 14) AS NO
                     ,REL_CD                     
                     ,PIS_YY
                     ,ENO_NO
                     ,ASNHR.SF_GET_COMMNAME('01', 'FA', REL_CD) AS REL_NM
                     ,NAM_KOR
                     ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                     ,NVL(BAS_MAN,' ') AS BAS_MAN
                     ,NVL(GOL_70, ' ') AS GOL_70
                     ,NVL(TRB_MAN,' ') AS TRB_MAN
                     ,NVL(WCT_MAN,' ') AS WCT_MAN
                     ,NVL(ONE_MAN,' ') AS ONE_MAN           
                     ,NVL(INP_MAN,' ') AS INP_MAN
                     ,NVL(RCH_MAN,' ') AS RCH_MAN
                     ,'그외' AS GBN_NM
                     ,0 AS HIN_SUM
                     ,NVL(LIN_AMT, '0') + NVL(LIH_AMT, '0')
                     ,NVL(MED_AMT, '0') + NVL(LEN_AMT, '0')
                     ,NVL(EDU_AMT, '0') + NVL(HED_AMT, '0')
                     ,NVL(CARD_AMT,'0') 
                     ,NVL(DIR_CARD_AMT,'0')
                     ,NVL(CASH_AMT,'0') 
                     ,NVL(MARKET_AMT,'0')                  
                     ,NVL(PUBLIC_AMT, '0')
                     ,NVL(GOV_AMT, '0')+NVL(LC1_AMT, '0')+NVL(LC2_AMT, '0')+NVL(LC3_AMT, '0')  AS LC_AMT
                                        
                 FROM ASNHR.T_AC_FAMILY_142 A
                WHERE PIS_YY = ?
                  AND ENO_NO = ?
             ORDER BY REL_CD, CET_NO, NAM_KOR
            ]]>
        </query>
    </sql>
    
     <!-- 2015년도 부양가족내역 조회 -->
    <sql name="YACA021_SHR_15">
        <description>부양가족내역 조회</description>
        <query>
            <![CDATA[
               SELECT ROW_NUMBER() OVER (ORDER BY ASNHR.SF_GET_COMMSEQ('01', 'FA', REL_CD), CET_NO, 14) AS NO
                     ,REL_CD
                     ,PIS_YY
                     ,ENO_NO
                     ,ASNHR.SF_GET_COMMNAME('01', 'FA', REL_CD) AS REL_NM
                     ,NAM_KOR
                     ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                     ,NVL(BAS_MAN,' ') AS BAS_MAN
                     ,NVL(GOL_70, ' ') AS GOL_70
                     ,NVL(TRB_MAN,' ') AS TRB_MAN
                     ,NVL(WCT_MAN,' ') AS WCT_MAN
                     ,NVL(ONE_MAN,' ') AS ONE_MAN     
                     ,NVL(INP_MAN,' ') AS INP_MAN
                     ,NVL(RCH_MAN,' ') AS RCH_MAN                                      
                     ,'국세' AS GBN_NM
                     ,(CASE WHEN REL_CD = 0 THEN (SELECT SUM(NVL(B.JAH_AMT,0) + NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0) + NVL(B.JAP_AMT,0) + NVL(A.HINS_AMT,0)) 
                       FROM ASNHR.T_AC_RETACC_15 A, 
                       (SELECT ENO_NO, SUM(JAH_AMT) JAH_AMT, SUM(JAP_AMT) JAP_AMT FROM ASNHR.T_AC_DUTYPLACE WHERE PIS_YY = '2015' GROUP BY ENO_NO ) B 
                       WHERE A.ENO_NO = B.ENO_NO(+) AND A.PIS_YY ='2015' AND A.ENO_NO = ?) ELSE 0 END)  AS HIN_SUM                     
                     ,NVL(LIN_AMT_NTS, '0') + NVL(LIH_AMT_NTS, '0') AS LIN_AMT
                     ,NVL(MED_AMT_NTS, '0') + NVL(LEN_AMT_NTS, '0') AS MED_AMT
                     ,NVL(EDU_AMT_NTS, '0') + NVL(HED_AMT_NTS, '0') AS EDU_AMT
                     ,NVL(CARD_AMT_NTS,'0') AS CARD_AMT
                     ,NVL(DIR_CARD_AMT_NTS,'0') AS DIR_CARD_AMT
                     ,NVL(CASH_AMT_NTS,'0') AS CASH_AMT
                     ,NVL(MARKET_AMT_NTS,'0')  AS  MARKET_AMT                  
                     ,NVL(PUBLIC_AMT_NTS, '0') AS PUBLIC_AMT
                     ,NVL(GOV_AMT_NTS, '0')+NVL(LC1_AMT_NTS, '0')+NVL(LC2_AMT_NTS, '0')+NVL(LC3_AMT_NTS, '0')+NVL(LC4_AMT_NTS, '0') AS LC_AMT

                 FROM ASNHR.T_AC_FAMILY_15 A
                WHERE PIS_YY = ?
                  AND ENO_NO = ?
                UNION
               SELECT ROW_NUMBER() OVER (ORDER BY ASNHR.SF_GET_COMMSEQ('01', 'FA', REL_CD), CET_NO, 14) AS NO
                     ,REL_CD                     
                     ,PIS_YY
                     ,ENO_NO
                     ,ASNHR.SF_GET_COMMNAME('01', 'FA', REL_CD) AS REL_NM
                     ,NAM_KOR
                     ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                     ,NVL(BAS_MAN,' ') AS BAS_MAN
                     ,NVL(GOL_70, ' ') AS GOL_70
                     ,NVL(TRB_MAN,' ') AS TRB_MAN
                     ,NVL(WCT_MAN,' ') AS WCT_MAN
                     ,NVL(ONE_MAN,' ') AS ONE_MAN           
                     ,NVL(INP_MAN,' ') AS INP_MAN
                     ,NVL(RCH_MAN,' ') AS RCH_MAN
                     ,'그외' AS GBN_NM
                     ,0 AS HIN_SUM
                     ,NVL(LIN_AMT, '0') + NVL(LIH_AMT, '0')
                     ,NVL(MED_AMT, '0') + NVL(LEN_AMT, '0')
                     ,NVL(EDU_AMT, '0') + NVL(HED_AMT, '0')
                     ,NVL(CARD_AMT,'0') 
                     ,NVL(DIR_CARD_AMT,'0')
                     ,NVL(CASH_AMT,'0') 
                     ,NVL(MARKET_AMT,'0')                  
                     ,NVL(PUBLIC_AMT, '0')
                     ,NVL(GOV_AMT, '0')+NVL(LC1_AMT, '0')+NVL(LC2_AMT, '0')+NVL(LC3_AMT, '0')+NVL(LC4_AMT, '0')  AS LC_AMT
                                        
                 FROM ASNHR.T_AC_FAMILY_15 A
                WHERE PIS_YY = ?
                  AND ENO_NO = ?
             ORDER BY REL_CD, CET_NO, NAM_KOR
            ]]>
        </query>
    </sql>

    <sql name="YACA021_SHR_INFO">
        <description>부양가족 상세내역 조회</description>
        <query>
            <![CDATA[
                 SELECT SEQ_NO
                       ,PIS_YY
                       ,ENO_NO
                       ,REL_CD
                       ,NAM_KOR
                       ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                       ,BAS_MAN
                       ,GOL_70
                       ,TRB_MAN
                       ,INV_MAN
                       ,WCT_MAN
                       ,RCH_MAN
                       ,CHI_MAN
                       ,INP_MAN
                       ,ONE_PARENT
                       
                       ,LIN_AMT_NTS
                       ,LIH_AMT_NTS
                       ,MED_AMT_NTS
                       ,LEN_AMT_NTS
                       ,EDU_AMT_NTS
                       ,HED_AMT_NTS
                       ,CARD_AMT_NTS
                       ,DIR_CARD_AMT_NTS
                       ,MARKET_AMT_NTS                       
                       ,CASH_AMT_NTS
                       ,PUBLIC_AMT_NTS
                         
                       ,LIN_AMT
                       ,LIH_AMT
                       ,MED_AMT
                       ,LEN_AMT
                       ,EDU_TAG
                       ,EDU_AMT
                       ,HED_AMT
                       ,CARD_AMT
                       ,DIR_CARD_AMT
                       ,MARKET_AMT                       
                       ,CASH_AMT
                       ,PUBLIC_AMT
                                        
                       ,LH1_AMT     -- 주택자금_대출기관
                       ,LH2_AMT04
                       ,LH2_AMT
                       ,LH4_AMT
                       ,LH5_AMT
                       ,LH6_AMT
                       ,LH7_AMT
                       ,LH8_AMT               
                               
                       ,LH1_AMT_NTS
                       ,LH2_AMT04_NTS
                       ,LH2_AMT_NTS
                       ,LH4_AMT_NTS
                       ,LH5_AMT_NTS
                       ,LH6_AMT_NTS
                       ,LH7_AMT_NTS
                       ,LH8_AMT_NTS           
                                   
                       ,HOL_YN
                   FROM ASNHR.T_AC_FAMILY
                 WHERE PIS_YY = ?
                   AND ENO_NO = ?
                   AND CET_NO = ?
              ORDER BY NAM_KOR
            ]]>
        </query>
    </sql>

    <!-- 2014 부양가족 상세내역 조회 -->
    <sql name="YACA021_SHR_INFO_14">
        <description>부양가족 상세내역 조회</description>
        <query>
            <![CDATA[
                 SELECT SEQ_NO
                       ,PIS_YY
                       ,ENO_NO
                       ,REL_CD
                       ,NAM_KOR
                       ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                       ,BAS_MAN
                       ,GOL_70
                       ,TRB_MAN
                       ,INV_MAN
                       ,WCT_MAN
                       ,ONE_MAN                       
                       ,LIN_AMT_NTS
                       ,LIH_AMT_NTS
                       ,MED_AMT_NTS
                       ,LEN_AMT_NTS
                       ,EDU_AMT_NTS
                       ,HED_AMT_NTS
                       ,CARD_AMT_NTS
                       ,DIR_CARD_AMT_NTS
                       ,MARKET_AMT_NTS                       
                       ,CASH_AMT_NTS
                       ,PUBLIC_AMT_NTS
                         
                       ,LIN_AMT
                       ,LIH_AMT
                       ,MED_AMT
                       ,LEN_AMT
                       ,EDU_TAG
                       ,EDU_AMT
                       ,HED_AMT
                       ,CARD_AMT
                       ,DIR_CARD_AMT
                       ,MARKET_AMT                       
                       ,CASH_AMT
                       ,PUBLIC_AMT

                       ,CARD_2013_AMT
                       ,CARD_2014_AMT
                       ,CARD_2013_OVER
                       ,CARD_2014_OVER                       

                       ,LH1_AMT     -- 주택자금_대출기관
                       ,LH2_AMT
                       ,LH3_AMT
                       ,LH4_AMT
                       ,LH5_AMT
                       ,LH6_AMT
                       ,LH7_AMT
                       ,LH8_AMT               
                       ,LH1_AMT_NTS
                       ,LH2_AMT_NTS
                       ,LH3_AMT_NTS
                       ,LH4_AMT_NTS
                       ,LH5_AMT_NTS
                       ,LH6_AMT_NTS
                       ,LH7_AMT_NTS
                       ,LH8_AMT_NTS           
                       
                       ,SAJU_AMT_NTS
                       ,SAJU_AMT           
                                              
                       ,HOL_YN
                   FROM ASNHR.T_AC_FAMILY_14
                 WHERE PIS_YY = ?
                   AND ENO_NO = ?
                   AND CET_NO = ?
              ORDER BY NAM_KOR
            ]]>
        </query>
    </sql>


    <!-- 2014 부양가족 상세내역 조회 -->
    <sql name="YACA021_SHR_INFO_142">
        <description>부양가족 상세내역 조회</description>
        <query>
            <![CDATA[
                 SELECT SEQ_NO
                       ,PIS_YY
                       ,ENO_NO
                       ,REL_CD
                       ,NAM_KOR
                       ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                       ,BAS_MAN
                       ,GOL_70
                       ,TRB_MAN
                       ,INV_MAN
                       ,WCT_MAN
                       ,ONE_MAN   
                       ,INP_MAN
                       ,RCH_MAN                                              
                       ,LIN_AMT_NTS
                       ,LIH_AMT_NTS
                       ,MED_AMT_NTS
                       ,LEN_AMT_NTS
                       ,EDU_AMT_NTS
                       ,HED_AMT_NTS
                       ,CARD_AMT_NTS
                       ,DIR_CARD_AMT_NTS
                       ,MARKET_AMT_NTS                       
                       ,CASH_AMT_NTS
                       ,PUBLIC_AMT_NTS
                         
                       ,LIN_AMT
                       ,LIH_AMT
                       ,MED_AMT
                       ,LEN_AMT
                       ,EDU_TAG
                       ,EDU_AMT
                       ,HED_AMT
                       ,CARD_AMT
                       ,DIR_CARD_AMT
                       ,MARKET_AMT                       
                       ,CASH_AMT
                       ,PUBLIC_AMT

                       ,CARD_2013_AMT
                       ,CARD_2014_AMT
                       ,CARD_2013_OVER
                       ,CARD_2014_OVER                       

                       ,LH1_AMT     -- 주택자금_대출기관
                       ,LH2_AMT
                       ,LH3_AMT
                       ,LH4_AMT
                       ,LH5_AMT
                       ,LH6_AMT
                       ,LH7_AMT
                       ,LH8_AMT               
                       ,LH1_AMT_NTS
                       ,LH2_AMT_NTS
                       ,LH3_AMT_NTS
                       ,LH4_AMT_NTS
                       ,LH5_AMT_NTS
                       ,LH6_AMT_NTS
                       ,LH7_AMT_NTS
                       ,LH8_AMT_NTS           
                       
                       ,SAJU_AMT_NTS
                       ,SAJU_AMT           
                                              
                       ,HOL_YN
                   FROM ASNHR.T_AC_FAMILY_142
                 WHERE PIS_YY = ?
                   AND ENO_NO = ?
                   AND CET_NO = ?
              ORDER BY NAM_KOR
            ]]>
        </query>
    </sql>
    
      <!-- 2015 부양가족 상세내역 조회 -->
    <sql name="YACA021_SHR_INFO_15">
        <description>부양가족 상세내역 조회</description>
        <query>
            <![CDATA[
                 SELECT SEQ_NO
                       ,PIS_YY
                       ,ENO_NO
                       ,REL_CD
                       ,NAM_KOR
                       ,SUBSTR(CET_NO,1,6)||'-'||SUBSTR(CET_NO,7,7) AS CET_NO
                       ,BAS_MAN
                       ,GOL_70
                       ,TRB_MAN
                       ,INV_MAN
                       ,WCT_MAN
                       ,ONE_MAN   
                       ,INP_MAN
                       ,RCH_MAN                                              
                       ,LIN_AMT_NTS
                       ,LIH_AMT_NTS
                       ,MED_AMT_NTS
                       ,LEN_AMT_NTS
                       ,EDU_AMT_NTS
                       ,HED_AMT_NTS
                       ,CARD_AMT_NTS
                       ,DIR_CARD_AMT_NTS
                       ,MARKET_AMT_NTS                       
                       ,CASH_AMT_NTS
                       ,PUBLIC_AMT_NTS
                         
                       ,LIN_AMT
                       ,LIH_AMT
                       ,MED_AMT
                       ,LEN_AMT
                       ,EDU_TAG
                       ,EDU_AMT
                       ,HED_AMT
                       ,CARD_AMT
                       ,DIR_CARD_AMT
                       ,MARKET_AMT                       
                       ,CASH_AMT
                       ,PUBLIC_AMT

                       ,CARD_2013_AMT
                       ,CARD_2014_AMT
                       ,CARD_2013_OVER
                       ,CARD_2014_OVER   
                       
                       ,CARD_2015_AMT
                       ,CARD_2015_FH_OVER
                       ,CARD_2015_SH_OVER                       

                       ,LH1_AMT     -- 주택자금_대출기관
                       ,LH2_AMT
                       ,LH3_AMT
                       ,LH4_AMT
                       ,LH5_AMT
                       ,LH6_AMT
                       ,LH7_AMT
                       ,LH8_AMT
                       ,LH9_AMT
                       ,LH10_AMT
                       ,LH11_AMT
                       ,LH12_AMT               
                       ,LH1_AMT_NTS
                       ,LH2_AMT_NTS
                       ,LH3_AMT_NTS
                       ,LH4_AMT_NTS
                       ,LH5_AMT_NTS
                       ,LH6_AMT_NTS
                       ,LH7_AMT_NTS
                       ,LH8_AMT_NTS
                       ,LH9_AMT_NTS
                       ,LH10_AMT_NTS
                       ,LH11_AMT_NTS
                       ,LH12_AMT_NTS           
                       
                       ,SAJU_AMT_NTS
                       ,SAJU_AMT           
                                              
                       ,HOL_YN
                       ,INS_TAG
                       
                   FROM ASNHR.T_AC_FAMILY_15
                 WHERE PIS_YY = ?
                   AND ENO_NO = ?
                   AND CET_NO = ?
              ORDER BY NAM_KOR
            ]]>
        </query>
    </sql>
    

    <!-- 신규내역 등록 -->
    <sql name="YACA021_INS">
        <description>신규내역 등록</description>
        <query>
            <![CDATA[
                INSERT INTO ASNHR.T_AC_FAMILY
                       (SEQ_NO
                       ,PIS_YY
                       ,ENO_NO
                       ,REL_CD
                       ,NAM_KOR
                       ,CET_NO
                       ,BAS_MAN
                       ,GOL_70
                       ,TRB_MAN
                       ,INV_MAN
                       ,WCT_MAN
                       ,ONE_PARENT                                           
                                              
                       ,LIN_AMT_NTS
                       ,LIH_AMT_NTS
                       ,MED_AMT_NTS
                       ,LEN_AMT_NTS
                       ,EDU_AMT_NTS
                       ,HED_AMT_NTS
                       ,CARD_AMT_NTS
                       ,DIR_CARD_AMT_NTS
                       ,CASH_AMT_NTS
                       ,MARKET_AMT_NTS                       
                       ,PUBLIC_AMT_NTS
       
                       ,LIN_AMT
                       ,LIH_AMT
                       ,MED_AMT
                       ,LEN_AMT
                       ,EDU_TAG
                       ,EDU_AMT
                       ,HED_AMT
                       ,CARD_AMT
                       ,DIR_CARD_AMT
                       ,CASH_AMT
                       ,MARKET_AMT
                       ,PUBLIC_AMT
                                              
                       ,LH1_AMT     -- 주택자금_대출기관
                       ,LH2_AMT04
                       ,LH2_AMT
                       ,LH4_AMT
                       ,LH5_AMT
                       ,LH6_AMT
                       ,LH7_AMT
                       ,LH8_AMT            
                                  
                       ,LH1_AMT_NTS
                       ,LH2_AMT04_NTS
                       ,LH2_AMT_NTS
                       ,LH4_AMT_NTS
                       ,LH5_AMT_NTS
                       ,LH6_AMT_NTS
                       ,LH7_AMT_NTS
                       ,LH8_AMT_NTS            
                                  
                       ,IPT_MAN
                       ,IPT_YMD
                       ,UPT_MAN
                       ,UPT_YMD)
                VALUES ((SELECT MAX(SEQ_NO) + 1
                           FROM ASNHR.T_AC_FAMILY
                          WHERE PIS_YY = ?
                            AND ENO_NO = ?)
                       ,?,?,?,?,?,?,?,?,?,?,?

                       ,?,?,?,?,?,?,?,?,?,?,?
                       
                       ,?,?,?,?,?,?,?,?,?,?,?,?
                       
                       ,?,?,?,?,?,?,?,?
                       
                       ,?,?,?,?,?,?,?,?                       
                      
                       ,?,SYSDATE,?,SYSDATE)
            ]]>
        </query>
    </sql>


    <!-- 신규내역 등록 -->
    <sql name="YACA021_INS_14">
        <description>신규내역 등록</description>
        <query>
            <![CDATA[
                INSERT INTO ASNHR.T_AC_FAMILY_14
                       (SEQ_NO
                       ,PIS_YY
                       ,ENO_NO
                       ,REL_CD
                       ,NAM_KOR
                       ,CET_NO
                       ,BAS_MAN
                       ,GOL_70
                       ,TRB_MAN
                       ,INV_MAN
                       ,WCT_MAN
                       ,ONE_MAN                                           
                                              
                       ,LIN_AMT_NTS
                       ,LIH_AMT_NTS
                       ,MED_AMT_NTS
                       ,LEN_AMT_NTS
                       ,EDU_AMT_NTS
                       ,HED_AMT_NTS
                       
                       ,CARD_AMT_NTS
                       ,DIR_CARD_AMT_NTS
                       ,CASH_AMT_NTS
                       ,MARKET_AMT_NTS                       
                       ,PUBLIC_AMT_NTS
       
                       ,LIN_AMT
                       ,LIH_AMT
                       ,MED_AMT
                       ,LEN_AMT
                       ,EDU_TAG
                       ,EDU_AMT
                       ,HED_AMT
                       
                       ,CARD_AMT
                       ,DIR_CARD_AMT
                       ,CASH_AMT
                       ,MARKET_AMT
                       ,PUBLIC_AMT
                                       
                       ,CARD_2013_AMT
                       ,CARD_2014_AMT
                       ,CARD_2013_OVER
                       ,CARD_2014_OVER                                              
                                              
                       ,LH1_AMT     -- 주택자금_대출기관
                       ,LH2_AMT
                       ,LH3_AMT
                       ,LH4_AMT
                       ,LH5_AMT
                       ,LH6_AMT
                       ,LH7_AMT
                       ,LH8_AMT            
                                  
                       ,LH1_AMT_NTS
                       ,LH2_AMT_NTS
                       ,LH3_AMT_NTS
                       ,LH4_AMT_NTS
                       ,LH5_AMT_NTS
                       ,LH6_AMT_NTS
                       ,LH7_AMT_NTS
                       ,LH8_AMT_NTS            
                                  
                	   ,SAJU_AMT_NTS
                	   ,SAJU_AMT                                   
                                  
                       ,IPT_MAN
                       ,IPT_YMD
                       ,UPT_MAN
                       ,UPT_YMD)
                VALUES ((SELECT MAX(SEQ_NO) + 1
                           FROM ASNHR.T_AC_FAMILY_14
                          WHERE PIS_YY = ?
                            AND ENO_NO = ?)
                       ,?,?,?,?,?,?,?,?,?,?,?

                       ,?,?,?,?,?,?,?,?,?,?,?
                       
                       ,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?
                       
                       ,?,?,?,?,?,?,?,?
                       
                       ,?,?,?,?,?,?,?,?,?,?                       
                      
                       ,?,SYSDATE,?,SYSDATE)
            ]]>
        </query>
    </sql>

    
     <!-- 신규내역 등록 -->
    <sql name="YACA021_INS_15">
        <description>신규내역 등록</description>
        <query>
            <![CDATA[
                INSERT INTO ASNHR.T_AC_FAMILY_15
                       (SEQ_NO
                       ,PIS_YY
                       ,ENO_NO
                       ,REL_CD
                       ,NAM_KOR
                       ,CET_NO
                       ,BAS_MAN
                       ,GOL_70
                       ,TRB_MAN
                       ,INV_MAN
                       ,WCT_MAN
                       ,ONE_MAN       
                       ,INP_MAN       
                       ,RCH_MAN                                           
                                              
                       ,LIN_AMT_NTS
                       ,LIH_AMT_NTS
                       ,MED_AMT_NTS
                       ,LEN_AMT_NTS
                       ,EDU_AMT_NTS
                       ,HED_AMT_NTS
                       
                       ,CARD_AMT_NTS
                       ,DIR_CARD_AMT_NTS
                       ,CASH_AMT_NTS
                       ,MARKET_AMT_NTS                       
                       ,PUBLIC_AMT_NTS
       
                       ,LIN_AMT
                       ,LIH_AMT
                       ,MED_AMT
                       ,LEN_AMT
                       ,EDU_TAG
                       ,EDU_AMT
                       ,HED_AMT
                       
                       ,CARD_AMT
                       ,DIR_CARD_AMT
                       ,CASH_AMT
                       ,MARKET_AMT
                       ,PUBLIC_AMT
                                       
                       ,CARD_2013_AMT
                       ,CARD_2014_AMT
                       ,CARD_2013_OVER
                       ,CARD_2014_OVER    
                       ,CARD_2015_AMT    
                       ,CARD_2015_FH_OVER    
                       ,CARD_2015_SH_OVER                                              
                                              
                       ,LH1_AMT     -- 주택자금_대출기관
                       ,LH2_AMT
                       ,LH3_AMT
                       ,LH4_AMT
                       ,LH5_AMT
                       ,LH6_AMT
                       ,LH7_AMT
                       ,LH8_AMT   
                       ,LH9_AMT   
                       ,LH10_AMT   
                       ,LH11_AMT   
                       ,LH12_AMT            
                                  
                       ,LH1_AMT_NTS
                       ,LH2_AMT_NTS
                       ,LH3_AMT_NTS
                       ,LH4_AMT_NTS
                       ,LH5_AMT_NTS
                       ,LH6_AMT_NTS
                       ,LH7_AMT_NTS
                       ,LH8_AMT_NTS   
                       ,LH9_AMT_NTS   
                       ,LH10_AMT_NTS   
                       ,LH11_AMT_NTS   
                       ,LH12_AMT_NTS            
                                  
                	   ,SAJU_AMT_NTS
                	   ,SAJU_AMT                                   
                                  
                       ,IPT_MAN
                       ,IPT_YMD
                       ,UPT_MAN
                       ,UPT_YMD)
                VALUES ((SELECT MAX(SEQ_NO) + 1
                           FROM ASNHR.T_AC_FAMILY_15
                          WHERE PIS_YY = ?
                            AND ENO_NO = ?)
                       ,?,?,?,?,?,?,?,?,?,?,?,?,?
                       ,?,?,?,?,?,?                     
                       ,?,?,?,?,?
                       ,?,?,?,?,?,?,?
                       ,?,?,?,?,?
                       ,?,?,?,?,?,?,?
                       ,?,?,?,?,?,?,?,?,?,?,?,?
                       ,?,?,?,?,?,?,?,?,?,?,?,?
                       ,?,?                       
                       ,?,SYSDATE,?,SYSDATE)
            ]]>
        </query>
    </sql>
    


    <!-- 부양 가족 내역 수정 -->
    <sql name="YACA021_UPT">
        <description>부양 가족 내역 수정</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_FAMILY
               SET BAS_MAN      = ?
                  ,GOL_70       = ?
                  ,TRB_MAN      = ?
                  ,INV_MAN      = ?            
                  ,WCT_MAN      = ?
                  ,ONE_PARENT = ?
                  
                  ,LIN_AMT_NTS  = ?
                  ,LIH_AMT_NTS  = ?
                  ,MED_AMT_NTS  = ?
                  ,LEN_AMT_NTS  = ?
                  ,EDU_AMT_NTS  = ?
                  ,HED_AMT_NTS  = ?
                  ,CARD_AMT_NTS = ?
                  ,DIR_CARD_AMT_NTS = ?
                  ,CASH_AMT_NTS = ?
                  ,MARKET_AMT_NTS = ?                  
                  ,PUBLIC_AMT_NTS  = ?
                      
                  ,LIN_AMT      = ?
                  ,LIH_AMT      = ?
                  ,MED_AMT      = ?
                  ,LEN_AMT      = ?
                  ,EDU_TAG      = ?
                  ,EDU_AMT      = ?
                  ,HED_AMT      = ?
                  ,CARD_AMT     = ?
                  ,DIR_CARD_AMT     = ?
                  ,CASH_AMT     = ?
                  ,MARKET_AMT = ?                  
                  ,PUBLIC_AMT      = ?

                  ,LH1_AMT      = ?
                  ,LH2_AMT04    = ?
                  ,LH2_AMT      = ?
                  ,LH4_AMT      = ?
                  ,LH5_AMT      = ?
                  ,LH6_AMT      = ?
                  ,LH7_AMT      = ?
                  ,LH8_AMT      = ?           
                         
                  ,LH1_AMT_NTS  = ?
                  ,LH2_AMT04_NTS =?
                  ,LH2_AMT_NTS   =?
                  ,LH4_AMT_NTS   =?
                  ,LH5_AMT_NTS   =?
                  ,LH6_AMT_NTS   =?
                  ,LH7_AMT_NTS   =?
                  ,LH8_AMT_NTS   =?           
                         
                  ,HOL_YN       = ?
                  ,UPT_MAN      = ?
                  ,UPT_YMD      = SYSDATE
             WHERE PIS_YY       = ?
               AND ENO_NO       = ?
               AND CET_NO       = ?
            ]]>
        </query>
    </sql>



    <!-- 부양 가족 내역 수정 -->
    <sql name="YACA021_UPT_14">
        <description>부양 가족 내역 수정</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_FAMILY_14
               SET BAS_MAN      = ?
                  ,GOL_70       = ?
                  ,TRB_MAN      = ?
                  ,INV_MAN      = ?            
                  ,WCT_MAN      = ?
                  ,ONE_MAN = ?
                  
                  ,LIN_AMT_NTS  = ?
                  ,LIH_AMT_NTS  = ?
                  ,MED_AMT_NTS  = ?
                  ,LEN_AMT_NTS  = ?
                  ,EDU_AMT_NTS  = ?
                  ,HED_AMT_NTS  = ?
                  ,CARD_AMT_NTS = ?
                  ,DIR_CARD_AMT_NTS = ?
                  ,CASH_AMT_NTS = ?
                  ,MARKET_AMT_NTS = ?                  
                  ,PUBLIC_AMT_NTS  = ?
                      
                  ,LIN_AMT      = ?
                  ,LIH_AMT      = ?
                  ,MED_AMT      = ?
                  ,LEN_AMT      = ?
                  ,EDU_TAG      = ?
                  ,EDU_AMT      = ?
                  ,HED_AMT      = ?
                  
                  ,CARD_AMT     = ?
                  ,DIR_CARD_AMT     = ?
                  ,CASH_AMT     = ?
                  ,MARKET_AMT = ?                  
                  ,PUBLIC_AMT      = ?

                  ,CARD_2013_AMT     = ?
                  ,CARD_2014_AMT     = ?
                  ,CARD_2013_OVER 	  = ?                  
                  ,CARD_2014_OVER   = ?

                  ,LH1_AMT      = ?
                  ,LH2_AMT    = ?
                  ,LH3_AMT      = ?
                  ,LH4_AMT      = ?
                  ,LH5_AMT      = ?
                  ,LH6_AMT      = ?
                  ,LH7_AMT      = ?
                  ,LH8_AMT      = ?           
                         
                  ,LH1_AMT_NTS  = ?
                  ,LH2_AMT_NTS =?
                  ,LH3_AMT_NTS   =?
                  ,LH4_AMT_NTS   =?
                  ,LH5_AMT_NTS   =?
                  ,LH6_AMT_NTS   =?
                  ,LH7_AMT_NTS   =?
                  ,LH8_AMT_NTS   =?           
                         
                  ,SAJU_AMT_NTS   =?
                  ,SAJU_AMT   =?                          
                         
                  ,HOL_YN       = ?
                  ,UPT_MAN      = ?
                  ,UPT_YMD      = SYSDATE
             WHERE PIS_YY       = ?
               AND ENO_NO       = ?
               AND CET_NO       = ?
            ]]>
        </query>
    </sql>
    
    <!-- 부양 가족 내역 수정 -->
    <sql name="YACA021_UPT_142">
        <description>부양 가족 내역 수정</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_FAMILY_142
               SET BAS_MAN      = ?
                  ,GOL_70       = ?
                  ,TRB_MAN      = ?
                  ,INV_MAN      = ?            
                  ,WCT_MAN      = ?
                  ,ONE_MAN = ?
                  
                  ,LIN_AMT_NTS  = ?
                  ,LIH_AMT_NTS  = ?
                  ,MED_AMT_NTS  = ?
                  ,LEN_AMT_NTS  = ?
                  ,EDU_AMT_NTS  = ?
                  ,HED_AMT_NTS  = ?
                  ,CARD_AMT_NTS = ?
                  ,DIR_CARD_AMT_NTS = ?
                  ,CASH_AMT_NTS = ?
                  ,MARKET_AMT_NTS = ?                  
                  ,PUBLIC_AMT_NTS  = ?
                      
                  ,LIN_AMT      = ?
                  ,LIH_AMT      = ?
                  ,MED_AMT      = ?
                  ,LEN_AMT      = ?
                  ,EDU_TAG      = ?
                  ,EDU_AMT      = ?
                  ,HED_AMT      = ?
                  
                  ,CARD_AMT     = ?
                  ,DIR_CARD_AMT     = ?
                  ,CASH_AMT     = ?
                  ,MARKET_AMT = ?                  
                  ,PUBLIC_AMT      = ?

                  ,CARD_2013_AMT     = ?
                  ,CARD_2014_AMT     = ?
                  ,CARD_2013_OVER 	  = ?                  
                  ,CARD_2014_OVER   = ?

                  ,LH1_AMT      = ?
                  ,LH2_AMT    = ?
                  ,LH3_AMT      = ?
                  ,LH4_AMT      = ?
                  ,LH5_AMT      = ?
                  ,LH6_AMT      = ?
                  ,LH7_AMT      = ?
                  ,LH8_AMT      = ?           
                         
                  ,LH1_AMT_NTS  = ?
                  ,LH2_AMT_NTS =?
                  ,LH3_AMT_NTS   =?
                  ,LH4_AMT_NTS   =?
                  ,LH5_AMT_NTS   =?
                  ,LH6_AMT_NTS   =?
                  ,LH7_AMT_NTS   =?
                  ,LH8_AMT_NTS   =?           
                         
                  ,SAJU_AMT_NTS   =?
                  ,SAJU_AMT   =?                          
                         
                  ,HOL_YN       = ?
                  ,UPT_MAN      = ?
                  ,UPT_YMD      = SYSDATE
             WHERE PIS_YY       = ?
               AND ENO_NO       = ?
               AND CET_NO       = ?
            ]]>
        </query>
    </sql>
    
     <!-- 부양 가족 내역 수정 -->
    <sql name="YACA021_UPT_15">
        <description>부양 가족 내역 수정</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_FAMILY_15
               SET BAS_MAN      = ?
                  ,GOL_70       = ?
                  ,TRB_MAN      = ?
                  ,INV_MAN      = ?            
                  ,WCT_MAN      = ?
                  ,ONE_MAN      = ?
                  ,INP_MAN      = ?
                  ,RCH_MAN      = ?
                  
                  ,LIN_AMT_NTS  = ?
                  ,LIH_AMT_NTS  = ?
                  ,MED_AMT_NTS  = ?
                  ,LEN_AMT_NTS  = ?
                  ,EDU_AMT_NTS  = ?
                  ,HED_AMT_NTS  = ?
                  ,CARD_AMT_NTS = ?
                  ,DIR_CARD_AMT_NTS = ?
                  ,CASH_AMT_NTS = ?
                  ,MARKET_AMT_NTS = ?                  
                  ,PUBLIC_AMT_NTS  = ?
                      
                  ,LIN_AMT      = ?
                  ,LIH_AMT      = ?
                  ,MED_AMT      = ?
                  ,LEN_AMT      = ?
                  ,EDU_TAG      = ?
                  ,EDU_AMT      = ?
                  ,HED_AMT      = ?
                  
                  ,CARD_AMT     = ?
                  ,DIR_CARD_AMT     = ?
                  ,CASH_AMT     = ?
                  ,MARKET_AMT = ?                  
                  ,PUBLIC_AMT      = ?

                  ,CARD_2013_AMT    = ?
                  ,CARD_2014_AMT    = ?
                  ,CARD_2013_OVER 	= ?                  
                  ,CARD_2014_OVER   = ?
                  ,CARD_2015_AMT    = ?
                  ,CARD_2015_FH_OVER   = ?
                  ,CARD_2015_SH_OVER   = ?

                  ,LH1_AMT      = ?
                  ,LH2_AMT    = ?
                  ,LH3_AMT      = ?
                  ,LH4_AMT      = ?
                  ,LH5_AMT      = ?
                  ,LH6_AMT      = ?
                  ,LH7_AMT      = ?
                  ,LH8_AMT      = ?  
                  ,LH9_AMT      = ? 
                  ,LH10_AMT      = ? 
                  ,LH11_AMT      = ? 
                  ,LH12_AMT      = ? 
                                                    
                  ,LH1_AMT_NTS  = ?
                  ,LH2_AMT_NTS =?
                  ,LH3_AMT_NTS   =?
                  ,LH4_AMT_NTS   =?
                  ,LH5_AMT_NTS   =?
                  ,LH6_AMT_NTS   =?
                  ,LH7_AMT_NTS   =?
                  ,LH8_AMT_NTS   =?     
                  ,LH9_AMT_NTS   =?     
                  ,LH10_AMT_NTS   =?     
                  ,LH11_AMT_NTS   =?     
                  ,LH12_AMT_NTS   =?           
                         
                  ,SAJU_AMT_NTS   =?
                  ,SAJU_AMT   =?                          
                         
                  ,HOL_YN       = ?
                  ,INS_TAG       = ?
                  ,UPT_MAN      = ?
                  ,UPT_YMD      = SYSDATE
             WHERE PIS_YY       = ?
               AND ENO_NO       = ?
               AND CET_NO       = ?
            ]]>
        </query>
    </sql>


    <!-- 부양 가족 내역 삭제 -->
    <sql name="YACA021_DEL">
        <description>부양 가족 내역 삭제</description>
        <query>
            <![CDATA[
            DELETE
              FROM ASNHR.T_AC_FAMILY
             WHERE PIS_YY       = ?
               AND ENO_NO       = ?
               AND CET_NO       = ?
            ]]>
        </query>
    </sql>


    <!-- 부양 가족 내역 삭제 -->
    <sql name="YACA021_DEL_14">
        <description>부양 가족 내역 삭제</description>
        <query>
            <![CDATA[
            DELETE
              FROM ASNHR.T_AC_FAMILY_14
             WHERE PIS_YY       = ?
               AND ENO_NO       = ?
               AND CET_NO       = ?
            ]]>
        </query>
    </sql>
    
    <!-- 부양 가족 내역 삭제 -->
    <sql name="YACA021_DEL_15">
        <description>부양 가족 내역 삭제</description>
        <query>
            <![CDATA[
            DELETE
              FROM ASNHR.T_AC_FAMILY_15
             WHERE PIS_YY       = ?
               AND ENO_NO       = ?
               AND CET_NO       = ?
            ]]>
        </query>
    </sql>


    <!-- 가족 사항 조회 -->
    <sql name="YACA021_SHR_CNT">
        <description>가족 사항 조회</description>
        <query>
            <![CDATA[
             SELECT A.SOU_CNT
                   ,B.DFM_CNT
                   ,C.GOL_CNT70
                   ,C.TRB_CNT
                   ,C.WCT_CNT
                   ,C.RCH_CNT
                   ,C.CHI_CNT
                   ,C.INP_CNT
                   ,C.LC1_AMT
                   ,C.LC2_AMT
                   ,C.LC3_AMT
                   ,C.LC4_AMT
               FROM (SELECT LEAST(COUNT(*),1) SOU_CNT
                       FROM ASNHR.T_AC_FAMILY
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?
                        AND REL_CD = '3'
                        AND BAS_MAN = 'O') A
                   ,(SELECT COUNT(*) DFM_CNT
                       FROM ASNHR.T_AC_FAMILY
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?
                        AND REL_CD NOT IN ('0','3')
                        AND BAS_MAN  = 'O') B
                   ,(SELECT NVL(SUM(DECODE(GOL_70,'O',1,0)),0) GOL_CNT70
                           ,NVL(SUM(DECODE(TRB_MAN,'O',1,0)),0) TRB_CNT
                           ,LEAST(NVL(SUM(DECODE(WCT_MAN,'O',1,0)),0),1) WCT_CNT
                           ,NVL(SUM(DECODE(CHI_MAN,'O',1,0)),0) CHI_CNT
                           ,SUM(LC1_AMT) AS LC1_AMT
                           ,SUM(LC2_AMT) AS LC2_AMT
                           ,SUM(LC3_AMT)+SUM(LC3_AMT_NTS) AS LC3_AMT
                       FROM ASNHR.T_AC_FAMILY_14
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?) C
            ]]>
        </query>
    </sql>


    <!-- 가족 사항 조회 -->
    <sql name="YACA021_SHR_CNT_14">
        <description>가족 사항 조회</description>
        <query>
            <![CDATA[
             SELECT A.SOU_CNT
                   ,B.DFM_CNT
                   ,C.GOL_CNT70
                   ,C.TRB_CNT
                   ,C.WCT_CNT

                   ,C.LC1_AMT
                   ,C.LC2_AMT
                   ,C.LC3_AMT

               FROM (SELECT LEAST(COUNT(*),1) SOU_CNT
                       FROM ASNHR.T_AC_FAMILY_14
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?
                        AND REL_CD = '3'
                        AND BAS_MAN = 'O') A
                   ,(SELECT COUNT(*) DFM_CNT
                       FROM ASNHR.T_AC_FAMILY_14
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?
                        AND REL_CD NOT IN ('0','3')
                        AND BAS_MAN  = 'O') B
                   ,(SELECT NVL(SUM(DECODE(GOL_65,'O',1,0)),0) GOL_CNT65
                           ,NVL(SUM(DECODE(GOL_70,'O',1,0)),0) GOL_CNT70
                           ,NVL(SUM(DECODE(TRB_MAN,'O',1,0)),0) TRB_CNT
                           ,LEAST(NVL(SUM(DECODE(WCT_MAN,'O',1,0)),0),1) WCT_CNT
                           ,SUM(LC1_AMT) AS LC1_AMT
                           ,SUM(LC2_AMT) AS LC2_AMT
                           ,SUM(LC3_AMT) AS LC3_AMT

                       FROM ASNHR.T_AC_FAMILY_14
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?) C
            ]]>
        </query>
    </sql>

    <!-- 가족 사항 조회 -->
    <sql name="YACA021_SHR_CNT_142">
        <description>가족 사항 조회</description>
        <query>
            <![CDATA[
             SELECT A.SOU_CNT
                   ,B.DFM_CNT
                   ,C.GOL_CNT70
                   ,C.TRB_CNT
                   ,C.WCT_CNT

                   ,C.LC1_AMT
                   ,C.LC2_AMT
                   ,C.LC3_AMT

               FROM (SELECT LEAST(COUNT(*),1) SOU_CNT
                       FROM ASNHR.T_AC_FAMILY_142
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?
                        AND REL_CD = '3'
                        AND BAS_MAN = 'O') A
                   ,(SELECT COUNT(*) DFM_CNT
                       FROM ASNHR.T_AC_FAMILY_142
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?
                        AND REL_CD NOT IN ('0','3')
                        AND BAS_MAN  = 'O') B
                   ,(SELECT NVL(SUM(DECODE(GOL_65,'O',1,0)),0) GOL_CNT65
                           ,NVL(SUM(DECODE(GOL_70,'O',1,0)),0) GOL_CNT70
                           ,NVL(SUM(DECODE(TRB_MAN,'O',1,0)),0) TRB_CNT
                           ,LEAST(NVL(SUM(DECODE(WCT_MAN,'O',1,0)),0),1) WCT_CNT
                           ,SUM(LC1_AMT) AS LC1_AMT
                           ,SUM(LC2_AMT) AS LC2_AMT
                           ,SUM(LC3_AMT) AS LC3_AMT

                       FROM ASNHR.T_AC_FAMILY_142
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?) C
            ]]>
        </query>
    </sql>
    
    <!-- 가족 사항 조회 -->
    <sql name="YACA021_SHR_CNT_15">
        <description>가족 사항 조회</description>
        <query>
            <![CDATA[
             SELECT A.SOU_CNT
                   ,B.DFM_CNT
                   ,C.GOL_CNT70
                   ,C.TRB_CNT
                   ,C.WCT_CNT
                   ,C.INP_CNT
                   ,C.RCH_CNT

                   ,C.LC1_AMT
                   ,C.LC2_AMT
                   ,C.LC3_AMT

               FROM (SELECT LEAST(COUNT(*),1) SOU_CNT
                       FROM ASNHR.T_AC_FAMILY_15
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?
                        AND REL_CD = '3'
                        AND BAS_MAN = 'O') A
                   ,(SELECT COUNT(*) DFM_CNT
                       FROM ASNHR.T_AC_FAMILY_15
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?
                        AND REL_CD NOT IN ('0','3')
                        AND BAS_MAN  = 'O') B
                   ,(SELECT NVL(SUM(DECODE(GOL_65,'O',1,0)),0) GOL_CNT65
                           ,NVL(SUM(DECODE(GOL_70,'O',1,0)),0) GOL_CNT70
                           ,NVL(SUM(DECODE(TRB_MAN,'O',1,0)),0) TRB_CNT
                           ,LEAST(NVL(SUM(DECODE(WCT_MAN,'O',1,0)),0),1) WCT_CNT
                           ,SUM(LC1_AMT) AS LC1_AMT
                           ,SUM(LC2_AMT) AS LC2_AMT
                           ,SUM(LC3_AMT) AS LC3_AMT
                           ,NVL(SUM(DECODE(INP_MAN,'O',1,0)),0) INP_CNT
                           ,NVL(SUM(DECODE(RCH_MAN,'O',1,0)),0) RCH_CNT

                       FROM ASNHR.T_AC_FAMILY_15
                      WHERE PIS_YY = ?
                        AND ENO_NO = ?) C
            ]]>
        </query>
    </sql>

    <!-- 가족 사항 전체 조회 -->
    <sql name="YACA021_SHR_ALL">
        <description>가족 사항 전체 조회</description>
        <query>
            <![CDATA[
                 SELECT PIS_YY ,ENO_NO ,REL_CD ,NAM_KOR ,CET_NO
                       ,BAS_MAN
                       ,DECODE(BAS_MAN,'O',
                               CASE WHEN (SUBSTR(CET_NO,7,1) IN ('1','2')) AND (TO_NUMBER(?) - TO_NUMBER('19'||SUBSTR(CET_NO,1,2)) >= 65) THEN 'O'
                                    ELSE ''
                               END,'') GOL_65
                       ,GOL_70 ,TRB_MAN ,WCT_MAN ,RCH_MAN ,INV_MAN ,MED_MAN ,EDU_MAN ,CHI_MAN, INP_MAN
                       ,CARD_MAN ,ADDRESS1 ,ADDRESS2 ,SEQ_NO
                       ,nvl(LIN_AMT_NTS,0) as LIN_AMT_NTS
                       ,nvl(LIH_AMT_NTS,0) as LIH_AMT_NTS
                       ,nvl(MED_AMT_NTS,0) as MED_AMT_NTS
                       ,nvl(LEN_AMT_NTS,0) as LEN_AMT_NTS
                       ,EDU_TAG_NTS
                       ,nvl(EDU_AMT_NTS,0) as EDU_AMT_NTS
                       ,nvl(HED_AMT_NTS,0) as HED_AMT_NTS
                       
                       ,nvl(CARD_AMT_NTS,0) as CARD_AMT_NTS
                       ,nvl(DIR_CARD_AMT_NTS,0) as DIR_CARD_AMT_NTS
                       ,nvl(CASH_AMT_NTS,0) as CASH_AMT_NTS
                       ,nvl(MARKET_AMT_NTS,0) as MARKET_AMT_NTS                       
                       ,nvl(PUBLIC_AMT_NTS,0) as PUBLIC_AMT_NTS

                       ,nvl(LIN_AMT,0) as LIN_AMT
                       ,nvl(LIH_AMT,0) as LIH_AMT
                       ,nvl(MED_AMT,0) as MED_AMT
                       ,nvl(LEN_AMT,0) as LEN_AMT
                       ,EDU_TAG
                       ,nvl(EDU_AMT,0) as EDU_AMT
                       ,nvl(HED_AMT,0) as HED_AMT
                       
                       ,nvl(CARD_AMT,0) as CARD_AMT
                       ,nvl(DIR_CARD_AMT,0) as DIR_CARD_AMT
                       ,nvl(CASH_AMT,0) as CASH_AMT
                       ,nvl(MARKET_AMT,0) as MARKET_AMT                       
                       ,nvl(PUBLIC_AMT,0) as PUBLIC_AMT

                       ,nvl(LC1_AMT,0) as LC1_AMT
                       ,nvl(LC2_AMT,0) as LC2_AMT
                       ,nvl(LC3_AMT,0) as LC3_AMT
                       ,nvl(LC3_AMT_NTS,0) as LC3_AMT_NTS
                       ,nvl(LC4_AMT,0) as LC4_AMT
                       
                       ,nvl(LH2_AMT04,0) as LH2_AMT04     -- 주택자금
                       ,nvl(LH2_AMT,0) as LH2_AMT
                       ,nvl(LH4_AMT,0) as LH4_AMT
                       ,nvl(LH5_AMT,0) as LH5_AMT
                       ,nvl(LH6_AMT,0) as LH6_AMT
                       ,nvl(LH7_AMT,0) as LH7_AMT
                       ,nvl(LH8_AMT,0) as LH8_AMT                       
                       ,nvl(LH1_AMT,0) as LH1_AMT
                       ,nvl(LH2_AMT04_NTS,0) as LH2_AMT04_NTS
                       ,nvl(LH2_AMT_NTS,0) as LH2_AMT_NTS
                       ,nvl(LH4_AMT_NTS,0) as LH4_AMT_NTS
                       ,nvl(LH5_AMT_NTS,0) as LH5_AMT_NTS
                       ,nvl(LH6_AMT_NTS,0) as LH6_AMT_NTS
                       ,nvl(LH7_AMT_NTS,0) as LH7_AMT_NTS       
                       ,nvl(LH8_AMT_NTS,0) as LH8_AMT_NTS                                             
                       ,nvl(LH1_AMT_NTS,0) as LH1_AMT_NTS
                       
                       ,HOL_YN
                       ,INS_TAG
                       ,IPT_MAN
                       ,IPT_YMD
                       ,UPT_MAN
                       ,UPT_YMD
                   FROM ASNHR.T_AC_FAMILY
                  WHERE PIS_YY = ?
                    AND ENO_NO = ?
               ORDER BY REL_CD
            ]]>
        </query>
    </sql>


    <!-- 가족 사항 전체 조회 -->
    <sql name="YACA021_SHR_ALL_14">
        <description>가족 사항 전체 조회</description>
        <query>
            <![CDATA[
                 SELECT PIS_YY ,ENO_NO ,REL_CD ,NAM_KOR ,CET_NO
                       ,BAS_MAN
                       ,DECODE(BAS_MAN,'O',
                               CASE WHEN (SUBSTR(CET_NO,7,1) IN ('1','2')) AND (TO_NUMBER(?) - TO_NUMBER('19'||SUBSTR(CET_NO,1,2)) >= 65) THEN 'O'
                                    ELSE '' END,'') GOL_65
                       ,GOL_70 ,TRB_MAN ,WCT_MAN ,ONE_MAN  
                       ,INV_MAN 
                       ,ADDRESS1 ,ADDRESS2 ,SEQ_NO
                       ,nvl(LIN_AMT_NTS,0) as LIN_AMT_NTS
                       ,nvl(LIH_AMT_NTS,0) as LIH_AMT_NTS
                       ,nvl(MED_AMT_NTS,0) as MED_AMT_NTS
                       ,nvl(LEN_AMT_NTS,0) as LEN_AMT_NTS
                       ,EDU_TAG_NTS
                       ,nvl(EDU_AMT_NTS,0) as EDU_AMT_NTS
                       ,nvl(HED_AMT_NTS,0) as HED_AMT_NTS
                       
                       ,nvl(CARD_AMT_NTS,0) as CARD_AMT_NTS
                       ,nvl(DIR_CARD_AMT_NTS,0) as DIR_CARD_AMT_NTS
                       ,nvl(CASH_AMT_NTS,0) as CASH_AMT_NTS
                       ,nvl(MARKET_AMT_NTS,0) as MARKET_AMT_NTS                       
                       ,nvl(PUBLIC_AMT_NTS,0) as PUBLIC_AMT_NTS

                       ,nvl(LIN_AMT,0) as LIN_AMT
                       ,nvl(LIH_AMT,0) as LIH_AMT
                       ,nvl(MED_AMT,0) as MED_AMT
                       ,nvl(LEN_AMT,0) as LEN_AMT
                       ,EDU_TAG
                       ,nvl(EDU_AMT,0) as EDU_AMT
                       ,nvl(HED_AMT,0) as HED_AMT
                       
                       ,nvl(CARD_AMT,0) as CARD_AMT
                       ,nvl(DIR_CARD_AMT,0) as DIR_CARD_AMT
                       ,nvl(CASH_AMT,0) as CASH_AMT
                       ,nvl(MARKET_AMT,0) as MARKET_AMT                       
                       ,nvl(PUBLIC_AMT,0) as PUBLIC_AMT

                       ,nvl(CARD_2013_AMT,0) as CARD_2013_AMT
                       ,nvl(CARD_2014_AMT,0) as CARD_2014_AMT
                       ,nvl(CARD_2013_OVER,0) as CARD_2013_OVER
                       ,nvl(CARD_2014_OVER,0) as CARD_2014_OVER     

                       ,nvl(LC1_AMT,0) as LC1_AMT
                       ,nvl(LC2_AMT,0) as LC2_AMT
                       ,nvl(LC3_AMT,0) as LC3_AMT

                       ,nvl(LH1_AMT,0) as LH1_AMT            -- 주택자금           
                       ,nvl(LH2_AMT,0) as LH2_AMT     
                       ,nvl(LH3_AMT,0) as LH3_AMT
                       ,nvl(LH4_AMT,0) as LH4_AMT
                       ,nvl(LH5_AMT,0) as LH5_AMT
                       ,nvl(LH6_AMT,0) as LH6_AMT
                       ,nvl(LH7_AMT,0) as LH7_AMT
                       ,nvl(LH8_AMT,0) as LH8_AMT                       

                       ,nvl(LH1_AMT_NTS,0) as LH1_AMT_NTS
                       ,nvl(LH2_AMT_NTS,0) as LH2_AMT_NTS
                       ,nvl(LH3_AMT_NTS,0) as LH3_AMT_NTS
                       ,nvl(LH4_AMT_NTS,0) as LH4_AMT_NTS
                       ,nvl(LH5_AMT_NTS,0) as LH5_AMT_NTS
                       ,nvl(LH6_AMT_NTS,0) as LH6_AMT_NTS
                       ,nvl(LH7_AMT_NTS,0) as LH7_AMT_NTS       
                       ,nvl(LH8_AMT_NTS,0) as LH8_AMT_NTS        
                       
                       ,nvl(SAJU_AMT_NTS,0) as SAJU_AMT_NTS       
                       ,nvl(SAJU_AMT,0) as SAJU_AMT 
                                                                                   
                       ,HOL_YN
                       ,IPT_MAN
                       ,IPT_YMD
                       ,UPT_MAN
                       ,UPT_YMD
                   FROM ASNHR.T_AC_FAMILY_14
                  WHERE PIS_YY = ?
                    AND ENO_NO = ?
               ORDER BY REL_CD
            ]]>
        </query>
    </sql>


    <!-- 가족 사항 전체 조회 -->
    <sql name="YACA021_SHR_ALL_142">
        <description>가족 사항 전체 조회</description>
        <query>
            <![CDATA[
                 SELECT PIS_YY ,ENO_NO ,REL_CD ,NAM_KOR ,CET_NO
                       ,BAS_MAN
                       ,DECODE(BAS_MAN,'O',
                               CASE WHEN (SUBSTR(CET_NO,7,1) IN ('1','2')) AND (TO_NUMBER(?) - TO_NUMBER('19'||SUBSTR(CET_NO,1,2)) >= 65) THEN 'O'
                                    ELSE '' END,'') GOL_65
                       ,GOL_70 ,TRB_MAN ,WCT_MAN ,ONE_MAN  
                       ,INV_MAN 
                       ,ADDRESS1 ,ADDRESS2 ,SEQ_NO
                       ,nvl(LIN_AMT_NTS,0) as LIN_AMT_NTS
                       ,nvl(LIH_AMT_NTS,0) as LIH_AMT_NTS
                       ,nvl(MED_AMT_NTS,0) as MED_AMT_NTS
                       ,nvl(LEN_AMT_NTS,0) as LEN_AMT_NTS
                       ,EDU_TAG_NTS
                       ,nvl(EDU_AMT_NTS,0) as EDU_AMT_NTS
                       ,nvl(HED_AMT_NTS,0) as HED_AMT_NTS
                       
                       ,nvl(CARD_AMT_NTS,0) as CARD_AMT_NTS
                       ,nvl(DIR_CARD_AMT_NTS,0) as DIR_CARD_AMT_NTS
                       ,nvl(CASH_AMT_NTS,0) as CASH_AMT_NTS
                       ,nvl(MARKET_AMT_NTS,0) as MARKET_AMT_NTS                       
                       ,nvl(PUBLIC_AMT_NTS,0) as PUBLIC_AMT_NTS

                       ,nvl(LIN_AMT,0) as LIN_AMT
                       ,nvl(LIH_AMT,0) as LIH_AMT
                       ,nvl(MED_AMT,0) as MED_AMT
                       ,nvl(LEN_AMT,0) as LEN_AMT
                       ,EDU_TAG
                       ,nvl(EDU_AMT,0) as EDU_AMT
                       ,nvl(HED_AMT,0) as HED_AMT
                       
                       ,nvl(CARD_AMT,0) as CARD_AMT
                       ,nvl(DIR_CARD_AMT,0) as DIR_CARD_AMT
                       ,nvl(CASH_AMT,0) as CASH_AMT
                       ,nvl(MARKET_AMT,0) as MARKET_AMT                       
                       ,nvl(PUBLIC_AMT,0) as PUBLIC_AMT

                       ,nvl(CARD_2013_AMT,0) as CARD_2013_AMT
                       ,nvl(CARD_2014_AMT,0) as CARD_2014_AMT
                       ,nvl(CARD_2013_OVER,0) as CARD_2013_OVER
                       ,nvl(CARD_2014_OVER,0) as CARD_2014_OVER     

                       ,nvl(LC1_AMT,0) as LC1_AMT
                       ,nvl(LC2_AMT,0) as LC2_AMT
                       ,nvl(LC3_AMT,0) as LC3_AMT

                       ,nvl(LH1_AMT,0) as LH1_AMT            -- 주택자금           
                       ,nvl(LH2_AMT,0) as LH2_AMT     
                       ,nvl(LH3_AMT,0) as LH3_AMT
                       ,nvl(LH4_AMT,0) as LH4_AMT
                       ,nvl(LH5_AMT,0) as LH5_AMT
                       ,nvl(LH6_AMT,0) as LH6_AMT
                       ,nvl(LH7_AMT,0) as LH7_AMT
                       ,nvl(LH8_AMT,0) as LH8_AMT                       

                       ,nvl(LH1_AMT_NTS,0) as LH1_AMT_NTS
                       ,nvl(LH2_AMT_NTS,0) as LH2_AMT_NTS
                       ,nvl(LH3_AMT_NTS,0) as LH3_AMT_NTS
                       ,nvl(LH4_AMT_NTS,0) as LH4_AMT_NTS
                       ,nvl(LH5_AMT_NTS,0) as LH5_AMT_NTS
                       ,nvl(LH6_AMT_NTS,0) as LH6_AMT_NTS
                       ,nvl(LH7_AMT_NTS,0) as LH7_AMT_NTS       
                       ,nvl(LH8_AMT_NTS,0) as LH8_AMT_NTS        
                       
                       ,nvl(SAJU_AMT_NTS,0) as SAJU_AMT_NTS       
                       ,nvl(SAJU_AMT,0) as SAJU_AMT 
                                                                                   
                       ,HOL_YN
                       ,IPT_MAN
                       ,IPT_YMD
                       ,UPT_MAN
                       ,UPT_YMD
                   FROM ASNHR.T_AC_FAMILY_142
                  WHERE PIS_YY = ?
                    AND ENO_NO = ?
               ORDER BY REL_CD
            ]]>
        </query>
    </sql>
    
    
    <!-- 가족 사항 전체 조회 -->
    <sql name="YACA021_SHR_ALL_15">
        <description>가족 사항 전체 조회</description>
        <query>
            <![CDATA[
                 SELECT PIS_YY ,ENO_NO ,REL_CD ,NAM_KOR ,CET_NO
                       ,BAS_MAN
                       ,DECODE(BAS_MAN,'O',
                               CASE WHEN (SUBSTR(CET_NO,7,1) IN ('1','2')) AND (TO_NUMBER(?) - TO_NUMBER('19'||SUBSTR(CET_NO,1,2)) >= 65) THEN 'O'
                                    ELSE '' END,'') GOL_65
                       ,GOL_70 ,TRB_MAN ,WCT_MAN ,ONE_MAN  
                       ,INV_MAN,INP_MAN,RCH_MAN 
                       ,ADDRESS1 ,ADDRESS2 ,SEQ_NO
                       ,nvl(LIN_AMT_NTS,0) as LIN_AMT_NTS
                       ,nvl(LIH_AMT_NTS,0) as LIH_AMT_NTS
                       ,nvl(MED_AMT_NTS,0) as MED_AMT_NTS
                       ,nvl(LEN_AMT_NTS,0) as LEN_AMT_NTS
                       ,EDU_TAG_NTS
                       ,nvl(EDU_AMT_NTS,0) as EDU_AMT_NTS
                       ,nvl(HED_AMT_NTS,0) as HED_AMT_NTS
                       
                       ,nvl(CARD_AMT_NTS,0) as CARD_AMT_NTS
                       ,nvl(DIR_CARD_AMT_NTS,0) as DIR_CARD_AMT_NTS
                       ,nvl(CASH_AMT_NTS,0) as CASH_AMT_NTS
                       ,nvl(MARKET_AMT_NTS,0) as MARKET_AMT_NTS                       
                       ,nvl(PUBLIC_AMT_NTS,0) as PUBLIC_AMT_NTS

                       ,nvl(LIN_AMT,0) as LIN_AMT
                       ,nvl(LIH_AMT,0) as LIH_AMT
                       ,nvl(MED_AMT,0) as MED_AMT
                       ,nvl(LEN_AMT,0) as LEN_AMT
                       ,EDU_TAG
                       ,nvl(EDU_AMT,0) as EDU_AMT
                       ,nvl(HED_AMT,0) as HED_AMT
                       
                       ,nvl(CARD_AMT,0) as CARD_AMT
                       ,nvl(DIR_CARD_AMT,0) as DIR_CARD_AMT
                       ,nvl(CASH_AMT,0) as CASH_AMT
                       ,nvl(MARKET_AMT,0) as MARKET_AMT                       
                       ,nvl(PUBLIC_AMT,0) as PUBLIC_AMT

                       ,nvl(CARD_2013_AMT,0) as CARD_2013_AMT
                       ,nvl(CARD_2014_AMT,0) as CARD_2014_AMT
                       ,nvl(CARD_2013_OVER,0) as CARD_2013_OVER
                       ,nvl(CARD_2014_OVER,0) as CARD_2014_OVER     
                       ,nvl(CARD_2015_AMT,0) as CARD_2015_AMT    
                       ,nvl(CARD_2015_FH_OVER,0) as CARD_2015_FH_OVER     
                       ,nvl(CARD_2015_SH_OVER,0) as CARD_2015_SH_OVER     

                       ,nvl(LC1_AMT,0) as LC1_AMT
                       ,nvl(LC2_AMT,0) as LC2_AMT
                       ,nvl(LC3_AMT,0) as LC3_AMT

                       ,nvl(LH1_AMT,0) as LH1_AMT            -- 주택자금           
                       ,nvl(LH2_AMT,0) as LH2_AMT     
                       ,nvl(LH3_AMT,0) as LH3_AMT
                       ,nvl(LH4_AMT,0) as LH4_AMT
                       ,nvl(LH5_AMT,0) as LH5_AMT
                       ,nvl(LH6_AMT,0) as LH6_AMT
                       ,nvl(LH7_AMT,0) as LH7_AMT
                       ,nvl(LH8_AMT,0) as LH8_AMT      
                       ,nvl(LH9_AMT,0) as LH9_AMT 
                       ,nvl(LH10_AMT,0)as LH10_AMT 
                       ,nvl(LH11_AMT,0)as LH11_AMT 
                       ,nvl(LH12_AMT,0)as LH12_AMT                  

                       ,nvl(LH1_AMT_NTS,0) as LH1_AMT_NTS
                       ,nvl(LH2_AMT_NTS,0) as LH2_AMT_NTS
                       ,nvl(LH3_AMT_NTS,0) as LH3_AMT_NTS
                       ,nvl(LH4_AMT_NTS,0) as LH4_AMT_NTS
                       ,nvl(LH5_AMT_NTS,0) as LH5_AMT_NTS
                       ,nvl(LH6_AMT_NTS,0) as LH6_AMT_NTS
                       ,nvl(LH7_AMT_NTS,0) as LH7_AMT_NTS       
                       ,nvl(LH8_AMT_NTS,0) as LH8_AMT_NTS        
                       ,nvl(LH9_AMT_NTS,0) as LH9_AMT_NTS
                       ,nvl(LH10_AMT_NTS,0)as LH10_AMT_NTS
                       ,nvl(LH11_AMT_NTS,0)as LH11_AMT_NTS
                       ,nvl(LH12_AMT_NTS,0)as LH12_AMT_NTS
                       
                       ,nvl(SAJU_AMT_NTS,0) as SAJU_AMT_NTS       
                       ,nvl(SAJU_AMT,0) as SAJU_AMT 
                                                                                   
                       ,HOL_YN
                       ,INS_TAG
                       ,IPT_MAN
                       ,IPT_YMD
                       ,UPT_MAN
                       ,UPT_YMD
                   FROM ASNHR.T_AC_FAMILY_15
                  WHERE PIS_YY = ?
                    AND ENO_NO = ?
               ORDER BY REL_CD
            ]]>
        </query>
    </sql>
    
    
    

    <!-- 변경 내역 저장 -->
    <sql name="YACA021_UPT_ACC">
        <description>변경 내역 저장</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_RETACC
                   SET SOU_CNT  = ?
                      ,DFM_CNT  = ?
                      ,GOL_CNT  = ?
                      ,GOL_CNT70= ?
                      ,TRB_CNT  = ?
                      ,WCT_CNT  = ?

                      
                      
                      ,LIN_AMT  = ?
                      ,LIH_AMT  = ?
                      ,LMA_AMT  = ? + ?
                      ,MHEA_AMT = ?
                      ,OHEA_AMT = ?
                      ,LF2_AMT  = ?
                      
                      ,LEN_AMT  = ?
                      ,LEN_AMT2 = ?
                      ,LEN_AMT3 = ?
                      ,LEN_AMT4 = ?
                      ,LEN_AMT5 = ?
                      ,EDU_TAG1 = ?
                      ,EDU_AMT1 = ?
                      ,EDU_TAG2 = ?
                      ,EDU_AMT2 = ?
                      ,EDU_TAG3 = ?
                      ,EDU_AMT3 = ?
                      ,EDU_TAG4 = ?
                      ,EDU_AMT4 = ?
                      ,EDU_TAG5 = ?
                      ,EDU_AMT5 = ?
                      
                      ,GRA_AMT  = ?
                      ,HED_AMT  = ?
                      
                      ,CARD_AMT = ?
                      ,DIR_CARD_AMT = ?
                      ,CASH_AMT = ?
                      ,MARKET_AMT = ?              
                      ,PUBLIC_AMT = ?
                                                    
                      ,LC1_AMT  = ?
                      ,LC2_AMT  = ?
                      ,LC3_AMT  = ?
                      ,LC4_AMT  = ?
                      
                      ,LH1_AMT  = ?
                      ,LH2_AMT04  = ?
                      ,LH2_AMT  = ?
                      ,LH4_AMT  = ?
                      ,LH5_AMT  = ?
                      ,LH6_AMT  = ?
                      ,LH7_AMT  = ?
                      ,LH8_AMT  = ?                      
                      ,HOL_YN   = ?
                 WHERE PIS_YY   = ?
                   AND ENO_NO   = ?
                   AND GBN_TAG  = '8'
            ]]>
        </query>
    </sql>


    <!-- 변경 내역 저장 -->
    <sql name="YACA021_UPT_ACC_14">
        <description>변경 내역 저장</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_RETACC_14
                   SET SOU_CNT  = ?
                      ,DFM_CNT  = ?
                      ,GOL_CNT  = ?
                      ,GOL_CNT70= ?
                      ,TRB_CNT  = ?
                      ,WCT_CNT  = ?

                      ,LIN_AMT  = ?
                      ,LIH_AMT  = ?
                      ,LMA_AMT  = ? + ?
                      ,MHEA_AMT = ?
                      ,OHEA_AMT = ?

                      ,LEN_AMT  = ?
                      ,LEN_AMT2 = ?
                      ,LEN_AMT3 = ?
                      ,LEN_AMT4 = ?
                      ,LEN_AMT5 = ?
                      ,EDU_TAG1 = ?
                      ,EDU_AMT1 = ?
                      ,EDU_TAG2 = ?
                      ,EDU_AMT2 = ?
                      ,EDU_TAG3 = ?
                      ,EDU_AMT3 = ?
                      ,EDU_TAG4 = ?
                      ,EDU_AMT4 = ?
                      ,EDU_TAG5 = ?
                      ,EDU_AMT5 = ?
                      
                      ,GRA_AMT  = ?
                      ,HED_AMT  = ?
                      
                      ,CARD_AMT = ?
                      ,DIR_CARD_AMT = ?
                      ,CASH_AMT = ?
                      ,MARKET_AMT = ?              
                      ,PUBLIC_AMT = ?
                      
                      ,CARD_2013_AMT = ?
                      ,CARD_2014_AMT = ?
                      ,CARD_2013_OVER = ?
                      ,CARD_2014_OVER = ?                          
                     
                      ,LC1_AMT  = ?
                      ,LC2_AMT  = ?
                      ,LC3_AMT  = ?
                      
                      ,LH1_AMT  = ?
                      ,LH2_AMT  = ?
                      ,LH3_AMT  = ?
                      ,LH4_AMT  = ?
                      ,LH5_AMT  = ?
                      ,LH6_AMT  = ?
                      ,LH7_AMT  = ?
                      ,LH8_AMT  = ?           
                      ,SAJU_AMT  = ?                       
                                 
                      ,HOL_YN   = ?
                 WHERE PIS_YY   = ?
                   AND ENO_NO   = ?
                   AND GBN_TAG  = '8'
            ]]>
        </query>
    </sql>

    <!-- 변경 내역 저장 -->
    <sql name="YACA021_UPT_ACC_142">
        <description>변경 내역 저장</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_RETACC_142
                   SET SOU_CNT  = ?
                      ,DFM_CNT  = ?
                      ,GOL_CNT  = ?
                      ,GOL_CNT70= ?
                      ,TRB_CNT  = ?
                      ,WCT_CNT  = ?

                      ,LIN_AMT  = ?
                      ,LIH_AMT  = ?
                      ,LMA_AMT  = ? + ?
                      ,MHEA_AMT = ?
                      ,OHEA_AMT = ?`

                      ,LEN_AMT  = ?
                      ,LEN_AMT2 = ?
                      ,LEN_AMT3 = ?
                      ,LEN_AMT4 = ?
                      ,LEN_AMT5 = ?
                      ,EDU_TAG1 = ?
                      ,EDU_AMT1 = ?
                      ,EDU_TAG2 = ?
                      ,EDU_AMT2 = ?
                      ,EDU_TAG3 = ?
                      ,EDU_AMT3 = ?
                      ,EDU_TAG4 = ?
                      ,EDU_AMT4 = ?
                      ,EDU_TAG5 = ?
                      ,EDU_AMT5 = ?
                      
                      ,GRA_AMT  = ?
                      ,HED_AMT  = ?
                      
                      ,CARD_AMT = ?
                      ,DIR_CARD_AMT = ?
                      ,CASH_AMT = ?
                      ,MARKET_AMT = ?              
                      ,PUBLIC_AMT = ?
                      
                      ,CARD_2013_AMT = ?
                      ,CARD_2014_AMT = ?
                      ,CARD_2013_OVER = ?
                      ,CARD_2014_OVER = ?                          
                     
                      ,LC1_AMT  = ?
                      ,LC2_AMT  = ?
                      ,LC3_AMT  = ?
                      
                      ,LH1_AMT  = ?
                      ,LH2_AMT  = ?
                      ,LH3_AMT  = ?
                      ,LH4_AMT  = ?
                      ,LH5_AMT  = ?
                      ,LH6_AMT  = ?
                      ,LH7_AMT  = ?
                      ,LH8_AMT  = ?           
                      ,SAJU_AMT  = ?                       
                                 
                      ,HOL_YN   = ?
                 WHERE PIS_YY   = ?
                   AND ENO_NO   = ?
                   AND GBN_TAG  = '8'
            ]]>
        </query>
    </sql>
    
    <!-- 변경 내역 저장 -->
    <sql name="YACA021_UPT_ACC_15">
        <description>변경 내역 저장</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_RETACC_15
                   SET SOU_CNT  = ?
                      ,DFM_CNT  = ?
                      ,GOL_CNT  = ?
                      ,GOL_CNT70= ?
                      ,TRB_CNT  = ?
                      ,WCT_CNT  = ?
                      ,CHI_INP  = ?  
                      ,CHI_RCH  = ?

                      ,LIN_AMT  = ?
                      ,LIH_AMT  = ?
                      ,LMA_AMT  = ? + ?
                      ,MHEA_AMT = ?
                      ,OHEA_AMT = ?

                      ,LEN_AMT  = ?
                      ,LEN_AMT2 = ?
                      ,LEN_AMT3 = ?
                      ,LEN_AMT4 = ?
                      ,LEN_AMT5 = ?
                      ,EDU_TAG1 = ?
                      ,EDU_AMT1 = ?
                      ,EDU_TAG2 = ?
                      ,EDU_AMT2 = ?
                      ,EDU_TAG3 = ?
                      ,EDU_AMT3 = ?
                      ,EDU_TAG4 = ?
                      ,EDU_AMT4 = ?
                      ,EDU_TAG5 = ?
                      ,EDU_AMT5 = ?
                      
                      ,GRA_AMT  = ?
                      ,HED_AMT  = ?
                      
                      ,CARD_AMT = ?
                      ,DIR_CARD_AMT = ?
                      ,CASH_AMT = ?
                      ,MARKET_AMT = ?              
                      ,PUBLIC_AMT = ?
                      
                      ,CARD_2013_AMT = ?
                      ,CARD_2014_AMT = ?
                      ,CARD_2013_OVER = ?
                      ,CARD_2014_OVER = ?  
                      ,CARD_2015_AMT = ?  
                      ,CARD_2015_FH_OVER = ?  
                      ,CARD_2015_SH_OVER = ?                          
                     
                      ,LC1_AMT  = ?
                      ,LC2_AMT  = ?
                      ,LC3_AMT  = ?
                      
                      ,LH1_AMT  = ?
                      ,LH2_AMT  = ?
                      ,LH3_AMT  = ?
                      ,LH4_AMT  = ?
                      ,LH5_AMT  = ?
                      ,LH6_AMT  = ?
                      ,LH7_AMT  = ?
                      ,LH8_AMT  = ?
                      ,LH9_AMT  = ?
                      ,LH10_AMT  = ?
                      ,LH11_AMT  = ?
                      ,LH12_AMT  = ?    
                             
                      ,SAJU_AMT  = ?                       
                                 
                      ,HOL_YN   = ?
                      ,INS_TAG   = ?
                 WHERE PIS_YY   = ?
                   AND ENO_NO   = ?
                   AND GBN_TAG  = '8'
            ]]>
        </query>
    </sql>

    <!-- 개인 변경 내역 저장 -->
    <sql name="YACA021_UPT_PERSON">
        <description>개인 변경 내역 저장</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_CM_PERSON
                   SET SOU_CNT  = ?
                      ,DFM_CNT  = ?
                      ,GOL_CNT  = ?
                      ,GOL_CNT70= ?
                      ,TRB_CNT  = ?
                      ,WCT_CNT  = ?
                      ,CHI_CNT  = ?
                 WHERE ENO_NO   = ?
            ]]>
        </query>
    </sql>




    <sql name="YACA021_SHR_RENT">
        <description>월세액 상세내역 조회</description>
        <query>
            <![CDATA[
                 SELECT PIS_YY
                       ,ENO_NO
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT
                       ,CON_YMD
                       ,DUE_YMD                  
                   FROM ASNHR.T_AC_RENT
                 WHERE PIS_YY = ?
                   AND ENO_NO = ?
                   AND GBN = '1'
            ]]>
        </query>
    </sql>


    <sql name="YACA021_SHR_RENT_14">
        <description>월세액 상세내역 조회</description>
        <query>
            <![CDATA[
                 SELECT PIS_YY
                       ,ENO_NO
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT
                       ,CON_YMD
                       ,DUE_YMD                  
                   FROM ASNHR.T_AC_RENT
                 WHERE PIS_YY = ?
                   AND ENO_NO = ?
                   AND GBN = '1'
            ]]>
        </query>
    </sql>
    
    
    <sql name="YACA021_SHR_RENT_15">
        <description>월세액 상세내역 조회</description>
        <query>
            <![CDATA[
                 SELECT PIS_YY
                       ,ENO_NO
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT
                       ,CON_YMD
                       ,DUE_YMD    
                       ,HOUSE_TYPE
                       ,HOUSE_AREA              
                   FROM ASNHR.T_AC_RENT_15
                 WHERE PIS_YY = ?
                   AND ENO_NO = ?
                   AND GBN = '1'
            ]]>
        </query>
    </sql>
    
    

    <!-- 월세액  신규내역 등록 -->
    <sql name="YACA021_SAV_RENT">
        <description>월세액 신규내역 등록</description>
        <query>
            <![CDATA[
                INSERT INTO ASNHR.T_AC_RENT
                       (PIS_YY
                       ,ENO_NO
                       ,GBN
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT 
                       ,CON_YMD
                       ,DUE_YMD                                             
	                   ,IPT_MAN
	                   ,IPT_YMD
	                   ,UPT_MAN
	                   ,UPT_YMD)
                VALUES (
                       ?
                       ,?
                       ,'1'
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?    
                       ,?                                            
                       ,?
                       ,SYSDATE
                       ,?
                       ,SYSDATE)
            ]]>
        </query>
    </sql>

    <!-- 월세액  신규내역 등록 -->
    <sql name="YACA021_SAV_RENT_14">
        <description>월세액 신규내역 등록</description>
        <query>
            <![CDATA[
                INSERT INTO ASNHR.T_AC_RENT
                       (PIS_YY
                       ,ENO_NO
                       ,GBN
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT 
                       ,CON_YMD
                       ,DUE_YMD                                             
	                   ,IPT_MAN
	                   ,IPT_YMD
	                   ,UPT_MAN
	                   ,UPT_YMD)
                VALUES (
                       ?
                       ,?
                       ,'1'
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?    
                       ,?                                            
                       ,?
                       ,SYSDATE
                       ,?
                       ,SYSDATE)
            ]]>
        </query>
    </sql>
    
    <!-- 월세액  신규내역 등록 -->
    <sql name="YACA021_SAV_RENT_15">
        <description>월세액 신규내역 등록</description>
        <query>
            <![CDATA[
                INSERT INTO ASNHR.T_AC_RENT_15
                       (PIS_YY
                       ,ENO_NO
                       ,GBN
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT 
                       ,CON_YMD
                       ,DUE_YMD 
                       ,HOUSE_TYPE
                       ,HOUSE_AREA                                            
	                   ,IPT_MAN
	                   ,IPT_YMD
	                   ,UPT_MAN
	                   ,UPT_YMD)
                VALUES (
                       ?
                       ,?
                       ,'1'
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?    
                       ,?                                            
                       ,?
                       ,?                                            
                       ,?
                       ,SYSDATE
                       ,?
                       ,SYSDATE)
            ]]>
        </query>
    </sql>


    <!-- 월세액  내역 수정 -->
    <sql name="YACA021_UPT_RENT">
        <description>월세액  내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_RENT
                   SET  HOST_NM = ?
                       ,CET_NO = ?
                       ,ADDRESS = ?
                       ,AMOUNT = ?
                       ,CON_YMD = ?
                       ,DUE_YMD = ?
                      ,UPT_MAN  = ?
                  	  ,UPT_YMD  = SYSDATE                      
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?
	                 AND GBN = '1'                       
            ]]>
        </query>
    </sql>

    <!-- 월세액  내역 수정 -->
    <sql name="YACA021_UPT_RENT_14">
        <description>월세액  내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_RENT
                   SET  HOST_NM = ?
                       ,CET_NO = ?
                       ,ADDRESS = ?
                       ,AMOUNT = ?
                       ,CON_YMD = ?
                       ,DUE_YMD = ?
                      ,UPT_MAN  = ?
                  	  ,UPT_YMD  = SYSDATE                      
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?
	                 AND GBN = '1'                       
            ]]>
        </query>
    </sql>
    
      <!-- 월세액  내역 수정 -->
    <sql name="YACA021_UPT_RENT_15">
        <description>월세액  내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_RENT_15
                   SET  HOST_NM = ?
                       ,CET_NO = ?
                       ,ADDRESS = ?
                       ,AMOUNT = ?
                       ,CON_YMD = ?
                       ,DUE_YMD = ?
                       ,HOUSE_TYPE = ?
                       ,HOUSE_AREA = ?
                      ,UPT_MAN  = ?
                  	  ,UPT_YMD  = SYSDATE                      
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?
	                 AND GBN = '1'                       
            ]]>
        </query>
    </sql>


    <!-- 월세액 상세내역 패밀리 테이블에 수정 -->
    <sql name="YACA021_UPT_FAM2">
        <description>월세액 상세내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_FAMILY
                   SET  LH6_AMT = ?   
                   ,UPT_MAN = ?
                   ,UPT_YMD = SYSDATE              
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?   
	                 AND REL_CD = '0' --본인만 가능                
            ]]>
        </query>
    </sql>
    
    <!-- 월세액 상세내역 패밀리 테이블에 수정 -->
    <sql name="YACA021_UPT_FAM2_14">
        <description>월세액 상세내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_FAMILY_14
                   SET  LH3_AMT = ?   
                   ,UPT_MAN = ?
                   ,UPT_YMD = SYSDATE              
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?   
	                 AND REL_CD = '0' --본인만 가능                
            ]]>
        </query>
    </sql>    
    
     <!-- 월세액 상세내역 패밀리 테이블에 수정 -->
    <sql name="YACA021_UPT_FAM2_15">
        <description>월세액 상세내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_FAMILY_15
                   SET  LH3_AMT = ?   
                   ,UPT_MAN = ?
                   ,UPT_YMD = SYSDATE              
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?   
	                 AND REL_CD = '0' --본인만 가능                
            ]]>
        </query>
    </sql>    
    

    <sql name="YACA021_SHR_PER">
        <description>개인간 주택임차차입금 상세내역 조회</description>
        <query>
            <![CDATA[
                 SELECT PIS_YY
                       ,ENO_NO
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT
                       ,CON_YMD
                       ,DUE_YMD
                       ,HOST_NM2
                       ,CET_NO2
                       ,AMOUNT2
                       ,INT_AMT
                       ,INT_PER                      
                       ,CON2_YMD
                       ,DUE2_YMD                       
                   FROM ASNHR.T_AC_RENT
                 WHERE PIS_YY = ?
                   AND ENO_NO = ?
                   AND GBN = '2'

            ]]>
        </query>
    </sql>
    
    <sql name="YACA021_SHR_PER_14">
        <description>개인간 주택임차차입금 상세내역 조회</description>
        <query>
            <![CDATA[
                 SELECT PIS_YY
                       ,ENO_NO
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT
                       ,CON_YMD
                       ,DUE_YMD
                       ,HOST_NM2
                       ,CET_NO2
                       ,AMOUNT2
                       ,INT_AMT
                       ,INT_PER                      
                       ,CON2_YMD
                       ,DUE2_YMD                       
                   FROM ASNHR.T_AC_RENT
                 WHERE PIS_YY = ?
                   AND ENO_NO = ?
                   AND GBN = '2'

            ]]>
        </query>
    </sql>    
    
    <sql name="YACA021_SHR_PER_15">
        <description>개인간 주택임차차입금 상세내역 조회</description>
        <query>
            <![CDATA[
                 SELECT PIS_YY
                       ,ENO_NO
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT
                       ,CON_YMD
                       ,DUE_YMD
                       ,HOUSE_TYPE
                       ,HOUSE_AREA
                       ,HOST_NM2
                       ,CET_NO2
                       ,AMOUNT2
                       ,INT_AMT
                       ,INT_PER                      
                       ,CON2_YMD
                       ,DUE2_YMD                       
                   FROM ASNHR.T_AC_RENT_15
                 WHERE PIS_YY = ?
                   AND ENO_NO = ?
                   AND GBN = '2'

            ]]>
        </query>
    </sql>    
    

    <!-- 개인간 주택임차차입금 상세내역  신규 등록 -->
    <sql name="YACA021_SAV_PER">
        <description>개인간 주택임차차입금 상세내역 신규 등록</description>
        <query>
            <![CDATA[
                INSERT INTO ASNHR.T_AC_RENT
                       (PIS_YY
                       ,ENO_NO
                       ,GBN
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT 
                       ,CON_YMD
                       ,DUE_YMD    
                       ,HOST_NM2
                       ,CET_NO2
                       ,AMOUNT2
                       ,INT_AMT
                       ,INT_PER                                               
                       ,CON2_YMD
                       ,DUE2_YMD                                                             
	                   ,IPT_MAN
	                   ,IPT_YMD
	                   ,UPT_MAN
	                   ,UPT_YMD)
                VALUES (
                       ?
                       ,?
                       ,'2'
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?    
                       ,?                                            
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?    
                       ,?                                            
                       ,?                       
                       ,SYSDATE
                       ,?
                       ,SYSDATE)
            ]]>
        </query>
    </sql>


    <!-- 개인간 주택임차차입금 상세내역  신규 등록 -->
    <sql name="YACA021_SAV_PER_14">
        <description>개인간 주택임차차입금 상세내역 신규 등록</description>
        <query>
            <![CDATA[
                INSERT INTO ASNHR.T_AC_RENT
                       (PIS_YY
                       ,ENO_NO
                       ,GBN
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT 
                       ,CON_YMD
                       ,DUE_YMD    
                       ,HOST_NM2
                       ,CET_NO2
                       ,AMOUNT2
                       ,INT_AMT
                       ,INT_PER                                               
                       ,CON2_YMD
                       ,DUE2_YMD                                                             
	                   ,IPT_MAN
	                   ,IPT_YMD
	                   ,UPT_MAN
	                   ,UPT_YMD)
                VALUES (
                       ?
                       ,?
                       ,'2'
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?    
                       ,?                                            
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?    
                       ,?                                            
                       ,?                       
                       ,SYSDATE
                       ,?
                       ,SYSDATE)
            ]]>
        </query>
    </sql>
    
    <!-- 개인간 주택임차차입금 상세내역  신규 등록 -->
    <sql name="YACA021_SAV_PER_15">
        <description>개인간 주택임차차입금 상세내역 신규 등록</description>
        <query>
            <![CDATA[
                INSERT INTO ASNHR.T_AC_RENT_15
                       (PIS_YY
                       ,ENO_NO
                       ,GBN
                       ,HOST_NM
                       ,CET_NO
                       ,ADDRESS
                       ,AMOUNT 
                       ,CON_YMD
                       ,DUE_YMD  
                       ,HOUSE_TYPE
                       ,HOUSE_AREA  
                       ,HOST_NM2
                       ,CET_NO2
                       ,AMOUNT2
                       ,INT_AMT
                       ,INT_PER                                               
                       ,CON2_YMD
                       ,DUE2_YMD                                                             
	                   ,IPT_MAN
	                   ,IPT_YMD
	                   ,UPT_MAN
	                   ,UPT_YMD)
                VALUES (
                       ?
                       ,?
                       ,'2'
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?    
                       ,? 
                       ,?    
                       ,?                                           
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?
                       ,?    
                       ,?                                            
                       ,?                       
                       ,SYSDATE
                       ,?
                       ,SYSDATE)
            ]]>
        </query>
    </sql>


    <!-- 개인간 주택임차차입금 상세내역 수정 -->
    <sql name="YACA021_UPT_PER">
        <description>개인간 주택임차차입금 상세내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_RENT
                   SET  HOST_NM = ?
                       ,CET_NO = ?
                       ,ADDRESS = ?
                       ,AMOUNT = ?
                       ,CON_YMD = ?
                       ,DUE_YMD = ?
                       ,HOST_NM2 = ?                       
                       ,CET_NO2 = ?
                       ,AMOUNT2 = ?
                       ,INT_AMT = ?  
                       ,INT_PER = ?                                            
                       ,CON2_YMD = ?
                       ,DUE2_YMD = ?                       
                       ,UPT_MAN  = ?
                  	   ,UPT_YMD  = SYSDATE                      
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?
	                 AND GBN = '2'                       
            ]]>
        </query>
    </sql>

    <!-- 개인간 주택임차차입금 상세내역 수정 -->
    <sql name="YACA021_UPT_PER_14">
        <description>개인간 주택임차차입금 상세내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_RENT
                   SET  HOST_NM = ?
                       ,CET_NO = ?
                       ,ADDRESS = ?
                       ,AMOUNT = ?
                       ,CON_YMD = ?
                       ,DUE_YMD = ?
                       ,HOST_NM2 = ?                       
                       ,CET_NO2 = ?
                       ,AMOUNT2 = ?
                       ,INT_AMT = ?  
                       ,INT_PER = ?                                            
                       ,CON2_YMD = ?
                       ,DUE2_YMD = ?                       
                       ,UPT_MAN  = ?
                  	   ,UPT_YMD  = SYSDATE                      
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?
	                 AND GBN = '2'                       
            ]]>
        </query>
    </sql>
    
    <!-- 개인간 주택임차차입금 상세내역 수정 -->
    <sql name="YACA021_UPT_PER_15">
        <description>개인간 주택임차차입금 상세내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_RENT_15
                   SET  HOST_NM = ?
                       ,CET_NO = ?
                       ,ADDRESS = ?
                       ,AMOUNT = ?
                       ,CON_YMD = ?
                       ,DUE_YMD = ?
                       ,HOUSE_TYPE = ?
                       ,HOUSE_AREA = ?
                       ,HOST_NM2 = ?                       
                       ,CET_NO2 = ?
                       ,AMOUNT2 = ?
                       ,INT_AMT = ?  
                       ,INT_PER = ?                                            
                       ,CON2_YMD = ?
                       ,DUE2_YMD = ?                       
                       ,UPT_MAN  = ?
                  	   ,UPT_YMD  = SYSDATE                      
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?
	                 AND GBN = '2'                       
            ]]>
        </query>
    </sql>


    <!-- 개인간 주택임차차입금 상세내역 패밀리 테이블에 수정 -->
    <sql name="YACA021_UPT_FAM">
        <description>개인간 주택임차차입금 상세내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_FAMILY
                   SET  LH5_AMT = ?   
                   ,UPT_MAN = ?
                   ,UPT_YMD = SYSDATE              
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?   
	                 AND REL_CD = '0' --본인만 가능                
            ]]>
        </query>
    </sql>

    <!-- 개인간 주택임차차입금 상세내역 패밀리 테이블에 수정 -->
    <sql name="YACA021_UPT_FAM_14">
        <description>개인간 주택임차차입금 상세내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_FAMILY_14
                   SET  LH2_AMT = ?   
                   ,UPT_MAN = ?
                   ,UPT_YMD = SYSDATE              
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?   
	                 AND REL_CD = '0' --본인만 가능                
            ]]>
        </query>
    </sql>
    
    
     <!-- 개인간 주택임차차입금 상세내역 패밀리 테이블에 수정 -->
    <sql name="YACA021_UPT_FAM_15">
        <description>개인간 주택임차차입금 상세내역 수정</description>
        <query>
            <![CDATA[
                UPDATE ASNHR.T_AC_FAMILY_15
                   SET  LH2_AMT = ?   
                   ,UPT_MAN = ?
                   ,UPT_YMD = SYSDATE              
                 WHERE PIS_YY = ?
	                 AND ENO_NO   = ?   
	                 AND REL_CD = '0' --본인만 가능                
            ]]>
        </query>
    </sql>



<!-- 연말정산 -->
<!--
***********************************************************************
* @UseCase     : YACA023
* @description :  2013년도 연말정산 종전근무지 정보
***********************************************************************
* 2012/12/23     이동훈        최초작성.
***********************************************************************
-->

    <!-- 종전 근무지를 조회 한다. -->
    <sql name="YACA023_SHR_PLA">
        <description>종전 근무지를 조회</description>
        <query>
            <![CDATA[
            SELECT ? AS PIS_YY
                 , ? AS ENO_NO

                 , MAX(    DECODE(B.NUM, 1, B.JAO_NO  ))      AS JAO_NO1
                 , MAX(    DECODE(B.NUM, 1, B.JAS_NM  ))      AS JAS_NM1
                 , MAX(    DECODE(B.NUM, 1, B.HIR_YMD ))      AS HIR_YMD1
                 , MAX(    DECODE(B.NUM, 1, B.RET_YMD ))      AS RET_YMD1
                 , MAX(    DECODE(B.NUM, 1, B.TYPE  ))        AS TYPE1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAA_AMT )), 0)  AS JAA_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAC_AMT )), 0)  AS JAC_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAG_AMT )), 0)  AS JAG_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAG_CD )), 0)  AS JAG_CD1                 
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAI_AMT )), 0)  AS JAI_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAQ_AMT )), 0)  AS JAQ_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAR_AMT )), 0)  AS JAR_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAH_AMT )), 0)  AS JAH_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAP_AMT )), 0)  AS JAP_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAL_AMT )), 0)  AS JAL_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAN_AMT )), 0)  AS JAN_AMT1

                 , MAX(    DECODE(B.NUM, 2, B.JAO_NO  ))      AS JAO_NO2
                 , MAX(    DECODE(B.NUM, 2, B.JAS_NM  ))      AS JAS_NM2
                 , MAX(    DECODE(B.NUM, 2, B.HIR_YMD ))      AS HIR_YMD2
                 , MAX(    DECODE(B.NUM, 2, B.RET_YMD ))      AS RET_YMD2
                 , MAX(    DECODE(B.NUM, 2, B.TYPE  ))        AS TYPE2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAA_AMT )), 0)  AS JAA_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAC_AMT )), 0)  AS JAC_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAG_AMT )), 0)  AS JAG_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAG_CD )), 0)  AS JAG_CD2                     
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAI_AMT )), 0)  AS JAI_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAQ_AMT )), 0)  AS JAQ_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAR_AMT )), 0)  AS JAR_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAH_AMT )), 0)  AS JAH_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAP_AMT )), 0)  AS JAP_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAL_AMT )), 0)  AS JAL_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAN_AMT )), 0)  AS JAN_AMT2

                 , MAX(    DECODE(B.NUM, 3, B.JAO_NO  ))      AS JAO_NO3
                 , MAX(    DECODE(B.NUM, 3, B.JAS_NM  ))      AS JAS_NM3
                 , MAX(    DECODE(B.NUM, 3, B.HIR_YMD ))      AS HIR_YMD3
                 , MAX(    DECODE(B.NUM, 3, B.RET_YMD ))      AS RET_YMD3
                 , MAX(    DECODE(B.NUM, 3, B.TYPE  ))        AS TYPE3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAA_AMT )), 0)  AS JAA_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAC_AMT )), 0)  AS JAC_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAG_AMT )), 0)  AS JAG_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAG_CD )), 0)  AS JAG_CD3                     
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAI_AMT )), 0)  AS JAI_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAQ_AMT )), 0)  AS JAQ_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAR_AMT )), 0)  AS JAR_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAH_AMT )), 0)  AS JAH_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAP_AMT )), 0)  AS JAP_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAL_AMT )), 0)  AS JAL_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAN_AMT )), 0)  AS JAN_AMT3

              FROM (SELECT LEVEL AS NUM
                      FROM DUAL
                CONNECT BY LEVEL <= 3
                    ) A
                 , (SELECT ROW_NUMBER() OVER(ORDER BY ENO_NO
                                                    , PIS_YY
                                                    , SEQ_NO
                                             ) AS NUM
                         , 'X' AS TYPE
                         , SEQ_NO
                         , JAO_NO
                         , JAS_NM
                         , JAA_AMT
                         , JAC_AMT
                         , JAG_AMT
                         , JAG_CD
                         , JAI_AMT
                         , JAQ_AMT
                         , JAR_AMT
                         , JAH_AMT
                         , JAP_AMT
                         , JAL_AMT
                         , JAN_AMT
                         , TO_CHAR(TO_DATE(HIR_YMD),'YYYY-MM-DD') AS HIR_YMD
                   		 , TO_CHAR(TO_DATE(RET_YMD),'YYYY-MM-DD') AS RET_YMD
                      FROM ASNHR.T_AC_DUTYPLACE
                     WHERE PIS_YY  = ?
                       AND ENO_NO  = ?
                    ) B
             WHERE A.NUM = B.NUM(+)
            ]]>
        </query>
    </sql>


    <!-- 종전 근무지를 조회 한다. -->
    <sql name="YACA023_SHR_PLA_14">
        <description>종전 근무지를 조회</description>
        <query>
            <![CDATA[
            SELECT ? AS PIS_YY
                 , ? AS ENO_NO
                 , MAX(    DECODE(B.NUM, 1, B.JAO_NO  ))      AS JAO_NO1
                 , MAX(    DECODE(B.NUM, 1, B.JAS_NM  ))      AS JAS_NM1
                 , MAX(    DECODE(B.NUM, 1, B.HIR_YMD ))      AS HIR_YMD1
                 , MAX(    DECODE(B.NUM, 1, B.RET_YMD ))      AS RET_YMD1
                 , MAX(    DECODE(B.NUM, 1, B.TYPE  ))        AS TYPE1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAA_AMT )), 0)  AS JAA_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAC_AMT )), 0)  AS JAC_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAG_AMT )), 0)  AS JAG_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAG_CD )), 0)  AS JAG_CD1                 
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAI_AMT )), 0)  AS JAI_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAQ_AMT )), 0)  AS JAQ_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAR_AMT )), 0)  AS JAR_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAH_AMT )), 0)  AS JAH_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAP_AMT )), 0)  AS JAP_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAL_AMT )), 0)  AS JAL_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAN_AMT )), 0)  AS JAN_AMT1

                 , MAX(    DECODE(B.NUM, 2, B.JAO_NO  ))      AS JAO_NO2
                 , MAX(    DECODE(B.NUM, 2, B.JAS_NM  ))      AS JAS_NM2
                 , MAX(    DECODE(B.NUM, 2, B.HIR_YMD ))      AS HIR_YMD2
                 , MAX(    DECODE(B.NUM, 2, B.RET_YMD ))      AS RET_YMD2
                 , MAX(    DECODE(B.NUM, 2, B.TYPE  ))        AS TYPE2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAA_AMT )), 0)  AS JAA_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAC_AMT )), 0)  AS JAC_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAG_AMT )), 0)  AS JAG_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAG_CD )), 0)  AS JAG_CD2                     
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAI_AMT )), 0)  AS JAI_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAQ_AMT )), 0)  AS JAQ_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAR_AMT )), 0)  AS JAR_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAH_AMT )), 0)  AS JAH_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAP_AMT )), 0)  AS JAP_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAL_AMT )), 0)  AS JAL_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAN_AMT )), 0)  AS JAN_AMT2

                 , MAX(    DECODE(B.NUM, 3, B.JAO_NO  ))      AS JAO_NO3
                 , MAX(    DECODE(B.NUM, 3, B.JAS_NM  ))      AS JAS_NM3
                 , MAX(    DECODE(B.NUM, 3, B.HIR_YMD ))      AS HIR_YMD3
                 , MAX(    DECODE(B.NUM, 3, B.RET_YMD ))      AS RET_YMD3
                 , MAX(    DECODE(B.NUM, 3, B.TYPE  ))        AS TYPE3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAA_AMT )), 0)  AS JAA_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAC_AMT )), 0)  AS JAC_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAG_AMT )), 0)  AS JAG_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAG_CD )), 0)  AS JAG_CD3                     
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAI_AMT )), 0)  AS JAI_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAQ_AMT )), 0)  AS JAQ_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAR_AMT )), 0)  AS JAR_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAH_AMT )), 0)  AS JAH_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAP_AMT )), 0)  AS JAP_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAL_AMT )), 0)  AS JAL_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAN_AMT )), 0)  AS JAN_AMT3

              FROM (SELECT LEVEL AS NUM
                      FROM DUAL
                CONNECT BY LEVEL <= 3
                    ) A
                 , (SELECT ROW_NUMBER() OVER(ORDER BY ENO_NO
                                                    , PIS_YY
                                                    , SEQ_NO
                                             ) AS NUM
                         , 'X' AS TYPE
                         , SEQ_NO
                         , JAO_NO
                         , JAS_NM
                         , JAA_AMT
                         , JAC_AMT
                         , JAG_AMT
                         , JAG_CD
                         , JAI_AMT
                         , JAQ_AMT
                         , JAR_AMT
                         , JAH_AMT
                         , JAP_AMT
                         , JAL_AMT
                         , JAN_AMT
                         , TO_CHAR(TO_DATE(HIR_YMD),'YYYY-MM-DD') AS HIR_YMD
                   		 , TO_CHAR(TO_DATE(RET_YMD),'YYYY-MM-DD') AS RET_YMD
                      FROM ASNHR.T_AC_DUTYPLACE
                     WHERE PIS_YY  = ?
                       AND ENO_NO  = ?
                    ) B
             WHERE A.NUM = B.NUM(+)
            ]]>
        </query>
    </sql>
    
       <!-- 종전 근무지를 조회 한다. -->
    <sql name="YACA023_SHR_PLA_15">
        <description>종전 근무지를 조회</description>
        <query>
            <![CDATA[
            SELECT ? AS PIS_YY
                 , ? AS ENO_NO
                 , MAX(    DECODE(B.NUM, 1, B.JAO_NO  ))      AS JAO_NO1
                 , MAX(    DECODE(B.NUM, 1, B.JAS_NM  ))      AS JAS_NM1
                 , MAX(    DECODE(B.NUM, 1, B.HIR_YMD ))      AS HIR_YMD1
                 , MAX(    DECODE(B.NUM, 1, B.RET_YMD ))      AS RET_YMD1
                 , MAX(    DECODE(B.NUM, 1, B.TYPE  ))        AS TYPE1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAA_AMT )), 0)  AS JAA_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAC_AMT )), 0)  AS JAC_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAG_AMT )), 0)  AS JAG_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAG_CD )), 0)  AS JAG_CD1                 
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAI_AMT )), 0)  AS JAI_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAQ_AMT )), 0)  AS JAQ_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAR_AMT )), 0)  AS JAR_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAH_AMT )), 0)  AS JAH_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAP_AMT )), 0)  AS JAP_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAL_AMT )), 0)  AS JAL_AMT1
                 , NVL(MAX(DECODE(B.NUM, 1, B.JAN_AMT )), 0)  AS JAN_AMT1

                 , MAX(    DECODE(B.NUM, 2, B.JAO_NO  ))      AS JAO_NO2
                 , MAX(    DECODE(B.NUM, 2, B.JAS_NM  ))      AS JAS_NM2
                 , MAX(    DECODE(B.NUM, 2, B.HIR_YMD ))      AS HIR_YMD2
                 , MAX(    DECODE(B.NUM, 2, B.RET_YMD ))      AS RET_YMD2
                 , MAX(    DECODE(B.NUM, 2, B.TYPE  ))        AS TYPE2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAA_AMT )), 0)  AS JAA_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAC_AMT )), 0)  AS JAC_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAG_AMT )), 0)  AS JAG_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAG_CD )), 0)  AS JAG_CD2                     
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAI_AMT )), 0)  AS JAI_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAQ_AMT )), 0)  AS JAQ_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAR_AMT )), 0)  AS JAR_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAH_AMT )), 0)  AS JAH_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAP_AMT )), 0)  AS JAP_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAL_AMT )), 0)  AS JAL_AMT2
                 , NVL(MAX(DECODE(B.NUM, 2, B.JAN_AMT )), 0)  AS JAN_AMT2

                 , MAX(    DECODE(B.NUM, 3, B.JAO_NO  ))      AS JAO_NO3
                 , MAX(    DECODE(B.NUM, 3, B.JAS_NM  ))      AS JAS_NM3
                 , MAX(    DECODE(B.NUM, 3, B.HIR_YMD ))      AS HIR_YMD3
                 , MAX(    DECODE(B.NUM, 3, B.RET_YMD ))      AS RET_YMD3
                 , MAX(    DECODE(B.NUM, 3, B.TYPE  ))        AS TYPE3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAA_AMT )), 0)  AS JAA_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAC_AMT )), 0)  AS JAC_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAG_AMT )), 0)  AS JAG_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAG_CD )), 0)  AS JAG_CD3                     
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAI_AMT )), 0)  AS JAI_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAQ_AMT )), 0)  AS JAQ_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAR_AMT )), 0)  AS JAR_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAH_AMT )), 0)  AS JAH_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAP_AMT )), 0)  AS JAP_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAL_AMT )), 0)  AS JAL_AMT3
                 , NVL(MAX(DECODE(B.NUM, 3, B.JAN_AMT )), 0)  AS JAN_AMT3

              FROM (SELECT LEVEL AS NUM
                      FROM DUAL
                CONNECT BY LEVEL <= 3
                    ) A
                 , (SELECT ROW_NUMBER() OVER(ORDER BY ENO_NO
                                                    , PIS_YY
                                                    , SEQ_NO
                                             ) AS NUM
                         , 'X' AS TYPE
                         , SEQ_NO
                         , JAO_NO
                         , JAS_NM
                         , JAA_AMT
                         , JAC_AMT
                         , JAG_AMT
                         , JAG_CD
                         , JAI_AMT
                         , JAQ_AMT
                         , JAR_AMT
                         , JAH_AMT
                         , JAP_AMT
                         , JAL_AMT
                         , JAN_AMT
                         , TO_CHAR(TO_DATE(HIR_YMD),'YYYY-MM-DD') AS HIR_YMD
                   		 , TO_CHAR(TO_DATE(RET_YMD),'YYYY-MM-DD') AS RET_YMD
                      FROM ASNHR.T_AC_DUTYPLACE
                     WHERE PIS_YY  = ?
                       AND ENO_NO  = ?
                    ) B
             WHERE A.NUM = B.NUM(+)
            ]]>
        </query>
    </sql>

    <!-- 종전 근무지 내역을 모두 삭제 -->
    <sql name="YACA023_DEL_PLA">
        <description>종전 근무지 내역을 모두 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_DUTYPLACE
             WHERE PIS_YY = ?
               AND ENO_NO = ?
            ]]>
        </query>
    </sql>

    <!-- 종전 근무지 내역을 모두 삭제 -->
    <sql name="YACA023_DEL_PLA_14">
        <description>종전 근무지 내역을 모두 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_DUTYPLACE
             WHERE PIS_YY = ?
               AND ENO_NO = ?
            ]]>
        </query>
    </sql>
    
    <!-- 종전 근무지 내역을 모두 삭제 -->
    <sql name="YACA023_DEL_PLA_15">
        <description>종전 근무지 내역을 모두 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_DUTYPLACE
             WHERE PIS_YY = ?
               AND ENO_NO = ?
            ]]>
        </query>
    </sql>

    <!-- 종전 근무지를 입력 한다. -->
    <sql name="YACA023_INS_PLA">
        <description>종전 근무지를 입력</description>
        <query>
            <![CDATA[
            INSERT
              INTO ASNHR.T_AC_DUTYPLACE
                   (PIS_YY
                   ,PIS_MM
                   ,ENO_NO
                   ,SEQ_NO
                   ,JAO_NO
                   ,JAS_NM
                   ,HIR_YMD
                   ,RET_YMD
                   ,JAA_AMT
                   ,JAC_AMT
                   ,JAG_AMT
                   ,JAG_CD
                   ,JAI_AMT
                   ,JAQ_AMT
                   ,JAR_AMT
                   ,JAH_AMT
                   ,JAP_AMT
                   ,JAL_AMT
                   ,JAN_AMT
                   ,JAB_AMT
                   ,JAD_AMT
                   ,JAE_AMT
                   ,JAF_AMT
                   ,JAJ_AMT
                   ,JAK_AMT
                   ,JAM_AMT
                   ,IPT_MAN
                   ,IPT_YMD
                   ,UPT_MAN
                   ,UPT_YMD)
            VALUES (?
                   ,'12'
                   ,?
                   ,?
                   ,REPLACE(?,'-','')
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?                   
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,0
                   ,0
                   ,?
                   ,0
                   ,0
                   ,0
                   ,0
                   ,?
                   ,SYSDATE
                   ,?
                   ,SYSDATE)
            ]]>
        </query>
    </sql>

    <!-- 종전 근무지를 입력 한다. -->
    <sql name="YACA023_INS_PLA_14">
        <description>종전 근무지를 입력</description>
        <query>
            <![CDATA[
            INSERT
              INTO ASNHR.T_AC_DUTYPLACE
                   (PIS_YY
                   ,PIS_MM
                   ,ENO_NO
                   ,SEQ_NO
                   ,JAO_NO
                   ,JAS_NM
                   ,HIR_YMD
                   ,RET_YMD
                   ,JAA_AMT
                   ,JAC_AMT
                   ,JAG_AMT
                   ,JAG_CD
                   ,JAI_AMT
                   ,JAQ_AMT
                   ,JAR_AMT
                   ,JAH_AMT
                   ,JAP_AMT
                   ,JAL_AMT
                   ,JAN_AMT
                   ,JAB_AMT
                   ,JAD_AMT
                   ,JAE_AMT
                   ,JAF_AMT
                   ,JAJ_AMT
                   ,JAK_AMT
                   ,JAM_AMT
                   ,IPT_MAN
                   ,IPT_YMD
                   ,UPT_MAN
                   ,UPT_YMD)
            VALUES (?
                   ,'12'
                   ,?
                   ,?
                   ,REPLACE(?,'-','')
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?                   
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,0
                   ,0
                   ,?
                   ,0
                   ,0
                   ,0
                   ,0
                   ,?
                   ,SYSDATE
                   ,?
                   ,SYSDATE)
            ]]>
        </query>
    </sql>
    
     <!-- 종전 근무지를 입력 한다. -->
    <sql name="YACA023_INS_PLA_15">
        <description>종전 근무지를 입력</description>
        <query>
            <![CDATA[
            INSERT
              INTO ASNHR.T_AC_DUTYPLACE
                   (PIS_YY
                   ,PIS_MM
                   ,ENO_NO
                   ,SEQ_NO
                   ,JAO_NO
                   ,JAS_NM
                   ,HIR_YMD
                   ,RET_YMD
                   ,JAA_AMT
                   ,JAC_AMT
                   ,JAG_AMT
                   ,JAG_CD
                   ,JAI_AMT
                   ,JAQ_AMT
                   ,JAR_AMT
                   ,JAH_AMT
                   ,JAP_AMT
                   ,JAL_AMT
                   ,JAN_AMT
                   ,JAB_AMT
                   ,JAD_AMT
                   ,JAE_AMT
                   ,JAF_AMT
                   ,JAJ_AMT
                   ,JAK_AMT
                   ,JAM_AMT
                   ,IPT_MAN
                   ,IPT_YMD
                   ,UPT_MAN
                   ,UPT_YMD)
            VALUES (?
                   ,'12'
                   ,?
                   ,?
                   ,REPLACE(?,'-','')
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?                   
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,?
                   ,0
                   ,0
                   ,?
                   ,0
                   ,0
                   ,0
                   ,0
                   ,?
                   ,SYSDATE
                   ,?
                   ,SYSDATE)
            ]]>
        </query>
    </sql>

<!-- 연말정산 -->
<!--
***********************************************************************
* @UseCase     : YACA030
* @description : 의료비공제내역입력
***********************************************************************
* 2007/04/03     오대성        최초작성.
***********************************************************************
-->
    <!-- 의료비공제내역 조회 -->
    <sql name="YACA030_SHR">
        <description>의료비공제내역 조회</description>
        <query>
            <![CDATA[
            SELECT DISTINCT A.PIS_YY, A.ENO_NO, A.CARD_AMT, A.CARD_CNT, A.CASH_AMT, A.CASH_CNT, A.SUM_AMT,
                   SUBSTR(A.COM_NO,0,3)||'-'||SUBSTR(A.COM_NO,4,2)||'-'||SUBSTR(A.COM_NO,6,5) AS COM_NO,
                   A.COM_NM, A.REL_CD,
                   SUBSTR(A.CET_NO,0,6)||'-'||SUBSTR(A.CET_NO,7,7) AS CET_NO, B.NAM_KOR FAM_NM, A.GBN_TAG, A.MED_CD
            FROM   ASNHR.T_AC_MEDICAL A, ASNHR.T_AC_FAMILY B
            WHERE A.ENO_NO = B.ENO_NO 
            AND A.CET_NO = B.CET_NO
            AND A.PIS_YY = B.PIS_YY
            AND A.PIS_YY = ?
            AND A.ENO_NO = ?
            ORDER BY A.REL_CD, A.MED_CD
            ]]>
        </query>
    </sql>
    
    
    <!-- 의료비공제내역 조회 -->
    <sql name="YACA030_SHR_14">
        <description>의료비공제내역 조회</description>
        <query>
            <![CDATA[
            SELECT DISTINCT A.PIS_YY, A.ENO_NO, 
                   SUBSTR(A.COM_NO,0,3)||'-'||SUBSTR(A.COM_NO,4,2)||'-'||SUBSTR(A.COM_NO,6,5) AS COM_NO,
                   A.COM_NM, A.REL_CD,
                   SUBSTR(A.CET_NO,0,6)||'-'||SUBSTR(A.CET_NO,7,7) AS CET_NO, 
                   B.NAM_KOR FAM_NM, A.GBN_TAG, A.CASH_AMT, A.CASH_CNT, A.MED_CD
            FROM   ASNHR.T_AC_MEDICAL_14 A, ASNHR.T_AC_FAMILY_14 B
            WHERE A.ENO_NO = B.ENO_NO 
            AND A.CET_NO = B.CET_NO
            AND A.PIS_YY = B.PIS_YY
            AND A.PIS_YY = ?
            AND A.ENO_NO = ?
            ORDER BY A.REL_CD, A.MED_CD
            ]]>
        </query>
    </sql>    
    
     <!-- 의료비공제내역 조회 -->
    <sql name="YACA030_SHR_15">
        <description>의료비공제내역 조회</description>
        <query>
            <![CDATA[
            SELECT DISTINCT A.PIS_YY, A.ENO_NO, 
                   SUBSTR(A.COM_NO,0,3)||'-'||SUBSTR(A.COM_NO,4,2)||'-'||SUBSTR(A.COM_NO,6,5) AS COM_NO,
                   A.COM_NM, A.REL_CD,
                   SUBSTR(A.CET_NO,0,6)||'-'||SUBSTR(A.CET_NO,7,7) AS CET_NO, 
                   B.NAM_KOR FAM_NM, A.GBN_TAG, A.CASH_AMT, A.CASH_CNT, A.MED_CD
            FROM   ASNHR.T_AC_MEDICAL_15 A, ASNHR.T_AC_FAMILY_15 B
            WHERE A.ENO_NO = B.ENO_NO 
            AND A.CET_NO = B.CET_NO
            AND A.PIS_YY = B.PIS_YY
            AND A.PIS_YY = ?
            AND A.ENO_NO = ?
            ORDER BY A.REL_CD, A.MED_CD
            ]]>
        </query>
    </sql>    

    <!-- 의료비공제내역 전체리스트 조회 -->
    <sql name="YACA030_SHR_01">
        <description>의료비공제내역 전체리스트 조회</description>
        <query>
            <![CDATA[
		    SELECT 'T' AS IS_CHK
				      , PIS_YY
				      , 'M' AS GUBUN
				      , B.DPT_NM
				      , B.JOB_NM
				      , B.ENO_NM
				      , A.ENO_NO
				      , SUM(CARD_AMT) AS SUM_AMT
			FROM   ASNHR.T_AC_MEDICAL A JOIN VI_T_CM_PERSON2 B ON A.ENO_NO=B.ENO_NO
			WHERE  PIS_YY = ?
			GROUP BY PIS_YY, B.DPT_NM, B.JOB_NM, B.ENO_NM, A.ENO_NO
			ORDER BY A.ENO_NO
            ]]>
        </query>
    </sql>


    <!-- 의료비공제 대상자 조회-->
    <sql name="YACA030_SHR_FAM">
        <description>의료비공제 가능 대상자 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY
                 , ENO_NO
                 , REL_CD
                 , TRB_MAN
                 , NAM_KOR    FAM_NM
                 ,  SUBSTR(CET_NO,0,6)||'-'||SUBSTR(CET_NO,7,7)	FAM_NO
            FROM   ASNHR.T_AC_FAMILY
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ORDER BY REL_CD, FAM_NO, FAM_NM
            ]]>
        </query>
    </sql>



    <!-- 의료비공제 대상자 조회-->
    <sql name="YACA030_SHR_FAM_14">
        <description>의료비공제 가능 대상자 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY
                 , ENO_NO
                 , REL_CD
                 , TRB_MAN
                 , NAM_KOR    FAM_NM
                 ,  SUBSTR(CET_NO,0,6)||'-'||SUBSTR(CET_NO,7,7)	FAM_NO
            FROM   ASNHR.T_AC_FAMILY_14
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ORDER BY REL_CD, FAM_NO, FAM_NM
            ]]>
        </query>
    </sql>
    
     <!-- 의료비공제 대상자 조회-->
    <sql name="YACA030_SHR_FAM_15">
        <description>의료비공제 가능 대상자 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY
                 , ENO_NO
                 , REL_CD
                 , TRB_MAN
                 , NAM_KOR    FAM_NM
                 ,  SUBSTR(CET_NO,0,6)||'-'||SUBSTR(CET_NO,7,7)	FAM_NO
            FROM   ASNHR.T_AC_FAMILY_15
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ORDER BY REL_CD, FAM_NO, FAM_NM
            ]]>
        </query>
    </sql>


    <!-- 의료비공제내역 저장. -->
    <sql name="YACA030_INS">
        <description>의료비공제내역 저장</description>
        <query>
            <![CDATA[
            INSERT INTO ASNHR.T_AC_MEDICAL
            ( PIS_YY, ENO_NO, CARD_AMT, CARD_CNT, CASH_AMT, CASH_CNT, SUM_AMT, COM_NO,
              COM_NM, REL_CD, CET_NO, GBN_TAG, MED_CD,
              IPT_MAN, IPT_YMD, UPT_MAN, UPT_YMD )
            VALUES
            ( ?     , ?     , ?       , ?       , ?       , ?       , ?      , ?     ,
              ?     , ?     , ?     , ?       ,    ?,
              ?      , SYSDATE, ?      , SYSDATE )
            ]]>
        </query>
    </sql>

    <!-- 의료비공제내역 저장. -->
    <sql name="YACA030_INS_14">
        <description>의료비공제내역 저장</description>
        <query>
            <![CDATA[
            INSERT INTO ASNHR.T_AC_MEDICAL_14
            ( PIS_YY, ENO_NO, COM_NO,
              COM_NM, REL_CD, CET_NO, GBN_TAG, CASH_AMT, CASH_CNT, MED_CD,
              IPT_MAN, IPT_YMD, UPT_MAN, UPT_YMD )
            VALUES
            ( ?, ?, ?,
              ?, ?, ?,  ?,  ?,   ? ,  ? , 
              ?, SYSDATE, ?, SYSDATE )
            ]]>
        </query>
    </sql>
    
      <!-- 의료비공제내역 저장. -->
    <sql name="YACA030_INS_15">
        <description>의료비공제내역 저장</description>
        <query>
            <![CDATA[
            INSERT INTO ASNHR.T_AC_MEDICAL_15
            ( PIS_YY, ENO_NO, COM_NO,
              COM_NM, REL_CD, CET_NO, GBN_TAG, CASH_AMT, CASH_CNT, MED_CD,
              IPT_MAN, IPT_YMD, UPT_MAN, UPT_YMD )
            VALUES
            ( ?, ?, ?,
              ?, ?, ?,  ?,  ?,   ? ,  ? , 
              ?, SYSDATE, ?, SYSDATE )
            ]]>
        </query>
    </sql>

    
    <!-- 의료비내역 적용 -->
    <sql name="YACA030_UPT_FAM">
        <description>의료비내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_FAMILY A 
            SET (MED_AMT_NTS, MED_AMT) =
			(SELECT
			      (SELECT SUM(NVL(CARD_AMT,0))
			      FROM ASNHR.T_AC_MEDICAL
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND CET_NO = A.CET_NO AND MED_CD = '1') MED_AMT_NTS,
			      (SELECT SUM(NVL(CARD_AMT,0))			      
			      FROM ASNHR.T_AC_MEDICAL
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND CET_NO = A.CET_NO AND MED_CD != '1') MED_AMT
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
            ]]>
        </query>
    </sql>    

    <!-- 의료비내역 적용 -->
    <sql name="YACA030_UPT_FAM_14">
        <description>의료비내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_FAMILY_14 A 
            SET (MED_AMT_NTS, MED_AMT) =
			(SELECT
			      (SELECT SUM(NVL(CASH_AMT,0))
			      FROM ASNHR.T_AC_MEDICAL_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND CET_NO = A.CET_NO AND MED_CD = '1') MED_AMT_NTS,
			      (SELECT SUM(NVL(CASH_AMT,0))			      
			      FROM ASNHR.T_AC_MEDICAL_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND CET_NO = A.CET_NO AND MED_CD != '1') MED_AMT
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
            ]]>
        </query>
    </sql>    
    
    
     <!-- 의료비내역 적용 -->
    <sql name="YACA030_UPT_FAM_15">
        <description>의료비내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_FAMILY_15 A 
            SET (MED_AMT_NTS, MED_AMT) =
			(SELECT
			      (SELECT SUM(NVL(CASH_AMT,0))
			      FROM ASNHR.T_AC_MEDICAL_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND CET_NO = A.CET_NO AND MED_CD = '1') MED_AMT_NTS,
			      (SELECT SUM(NVL(CASH_AMT,0))			      
			      FROM ASNHR.T_AC_MEDICAL_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND CET_NO = A.CET_NO AND MED_CD != '1') MED_AMT
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
            ]]>
        </query>
    </sql>    
    
    <!-- 의료비내역 적용 -->
    <sql name="YACA030_UPT_ACC">
        <description>의료비내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC A 
            SET (LF2_AMT, MHEA_AMT, OHEA_AMT) =
			(SELECT
			      (SELECT SUM(NVL(CARD_AMT,0))
			      FROM ASNHR.T_AC_MEDICAL
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD != '0' AND GBN_TAG IN ('A')) LF2_AMT,			
			      (SELECT SUM(NVL(CARD_AMT,0))
			      FROM ASNHR.T_AC_MEDICAL
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND (REL_CD = '0' OR (REL_CD != '0' AND GBN_TAG IN ('B')))) MHEA_AMT,
			      (SELECT SUM(NVL(CARD_AMT,0))			      
			      FROM ASNHR.T_AC_MEDICAL
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD != '0'  AND GBN_TAG IS NULL) OHEA_AMT
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
			  AND A.GBN_TAG = '8'			  
            ]]>
        </query>
    </sql>        
    
    
    <!-- 의료비내역 적용 -->
    <sql name="YACA030_UPT_ACC_14">
        <description>의료비내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_14 A 
            SET (HAN_AMT, MHEA_AMT, OHEA_AMT) =
			(SELECT
			      (SELECT SUM(NVL(CASH_AMT,0))
			      FROM ASNHR.T_AC_MEDICAL_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD != '0' AND GBN_TAG IN ('A')) LF2_AMT,			
			      (SELECT SUM(NVL(CASH_AMT,0))
			      FROM ASNHR.T_AC_MEDICAL_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND (REL_CD = '0' OR (REL_CD != '0' AND GBN_TAG IN ('B')))) MHEA_AMT,
			      (SELECT SUM(NVL(CASH_AMT,0))			      
			      FROM ASNHR.T_AC_MEDICAL_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD != '0'  AND GBN_TAG IS NULL) OHEA_AMT
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
			  AND A.GBN_TAG = '8'			  
            ]]>
        </query>
    </sql>           
    
      <!-- 의료비내역 적용 -->
    <sql name="YACA030_UPT_ACC_15">
        <description>의료비내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_15 A 
            SET (HAN_AMT, MHEA_AMT, OHEA_AMT) =
			(SELECT
			      (SELECT NVL(SUM(NVL(CASH_AMT,0)),0)
			      FROM ASNHR.T_AC_MEDICAL_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD != '0' AND GBN_TAG IN ('A','B','C')) LF2_AMT, --본인외 장애,65세,난임		
			      (SELECT NVL(SUM(NVL(CASH_AMT,0)),0)
			      FROM ASNHR.T_AC_MEDICAL_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND (REL_CD = '0')) MHEA_AMT,  --본인
			      (SELECT NVL(SUM(NVL(CASH_AMT,0)),0)			      			      
			      FROM ASNHR.T_AC_MEDICAL_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD != '0'  AND GBN_TAG IS NULL) OHEA_AMT  -- 본인외
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
			  AND A.GBN_TAG = '8'			  
            ]]>
        </query>
    </sql>           
    
    <!-- 의료비공제내역 삭제 -->
    <sql name="YACA030_DEL_14">
        <description>의료비공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_MEDICAL_14
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    COM_NO = ?
            AND    CET_NO = ?
            AND    MED_CD = ?            
            ]]>
        </query>
    </sql>
    
    <!-- 의료비공제내역 삭제 -->
    <sql name="YACA030_DEL_15">
        <description>의료비공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_MEDICAL_15
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    COM_NO = ?
            AND    CET_NO = ?
            AND    MED_CD = ?            
            ]]>
        </query>
    </sql>

    <!-- 의료비공제내역 전체삭제 -->
    <sql name="YACA030_DEL2_14">
        <description>의료비공제내역 전체삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_MEDICAL_14
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>    
    
     <!-- 의료비공제내역 전체삭제 -->
    <sql name="YACA030_DEL2_15">
        <description>의료비공제내역 전체삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_MEDICAL_15
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>    
    
    
    <!-- 의료비공제내역 삭제(국세청장이 제공하는 의료비의 자료경우) -->
    <sql name="YACA030_DEL3_14">
        <description>의료비공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_MEDICAL_14
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    MED_CD = ?
            AND    CET_NO = ?
            ]]>
        </query>
    </sql>    
    
     <!-- 의료비공제내역 삭제(국세청장이 제공하는 의료비의 자료경우) -->
    <sql name="YACA030_DEL3_15">
        <description>의료비공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_MEDICAL_15
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    MED_CD = ?
            AND    CET_NO = ?
            ]]>
        </query>
    </sql>    
    
    
    <!-- 의료비공제내역 삭제 -->
    <sql name="YACA030_DEL">
        <description>의료비공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_MEDICAL
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    COM_NO = ?
            AND    CET_NO = ?
            AND    MED_CD = ?            
            ]]>
        </query>
    </sql>

    <!-- 의료비공제내역 전체삭제 -->
    <sql name="YACA030_DEL_01">
        <description>의료비공제내역 전체삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_MEDICAL
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>

    <!-- 의료비공제내역 삭제(국세청장이 제공하는 의료비의 자료경우) -->
    <sql name="YACA030_DEL_02">
        <description>의료비공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_MEDICAL
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    MED_CD = ?
            AND    CET_NO = ?
            ]]>
        </query>
    </sql>

    <!-- 사원정보(주민번호,주소) 조회 -->
    <sql name="YACA030_SHR_02">
        <description>사원정보(주민번호,주소) 조회</description>
        <query>
            <![CDATA[
			SELECT ENO_NM
			     , CET_NO
			     , ADR_CT||' '||ADDRESS      addr
			  FROM ASNHR.T_CM_PERSON
			 WHERE ENO_NO = ?
            ]]>
        </query>
    </sql>

<!--
***********************************************************************
* @UseCase     : YACA040
* @description : 기부금공제내역입력
***********************************************************************
* 2007/04/03     오대성        최초작성.
***********************************************************************
-->
    <!-- 기부금공제내역 조회 -->
    <sql name="YACA040_SHR">
        <description>기부금공제내역 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY, 
            	   ENO_NO, 
            	   REL_CD,
                   PIS_YM,
                   REMARK,
                   SUBSTR(COM_NO,0,3)||'-'||SUBSTR(COM_NO,4,2)||'-'||SUBSTR(COM_NO,6,5) AS COM_NO,
                   COM_NM, 
                   TOT_CNT, 
                   SUM_AMT, 
                   SEQ_NO,
                   FAM_CD, 
                   FAM_NM, 
                   FAM_NO, 
                   NTS_YN
            FROM   ASNHR.T_AC_DONATION
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ORDER BY REL_CD
            ]]>
        </query>
    </sql>


    <sql name="YACA040_SHR_14">
        <description>기부금공제내역 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY, 
            	   ENO_NO, 
            	   REL_CD,
                   REMARK,
                   SUBSTR(COM_NO,0,3)||'-'||SUBSTR(COM_NO,4,2)||'-'||SUBSTR(COM_NO,6,5) AS COM_NO,
                   COM_NM, 
                   TOT_CNT, 
                   SUM_AMT, 
                   FAM_CD, 
                   FAM_NM, 
                   FAM_NO, 
                   NTS_YN
            FROM   ASNHR.T_AC_DONATION_14
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ORDER BY REL_CD
            ]]>
        </query>
    </sql>
    
    
     <sql name="YACA040_SHR_15">
        <description>기부금공제내역 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY, 
            	   ENO_NO, 
            	   REL_CD,
                   REMARK,
                   SUBSTR(COM_NO,0,3)||'-'||SUBSTR(COM_NO,4,2)||'-'||SUBSTR(COM_NO,6,5) AS COM_NO,
                   COM_NM, 
                   TOT_CNT, 
                   SUM_AMT, 
                   FAM_CD, 
                   FAM_NM, 
                   FAM_NO, 
                   NTS_YN
            FROM   ASNHR.T_AC_DONATION_15
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ORDER BY REL_CD
            ]]>
        </query>
    </sql>
    



    <!-- 기부금공제내역 조회(보고서용) -->
    <sql name="YACA040_SHR_01">
        <description>기부금공제내역 조회(보고서용)</description>
        <query>
            <![CDATA[
            SELECT MAX(PIS_YY)                                          PIS_YY
                 , MAX(ENO_NO)                                          ENO_NO
                 , REL_CD                                               REL_CD
                 , ASNHR.SF_GET_COMMNAME('01','FB',REL_CD)                    REL_NM
                 , REMARK
                 , MAX(SUBSTR(PIS_YM,0,4)||'-'||SUBSTR(PIS_YM,5,2))  AS PIS_YM
                 , SEQ_NO
                 , MAX(SUBSTR(COM_NO,0,3)||'-'||SUBSTR(COM_NO,4,2)||'-'||SUBSTR(COM_NO,6,5)) AS COM_NO
                 , MAX(COM_NM)                                          COM_NM
                 , MAX(TOT_CNT)                                         TOT_CNT
                 , CASE WHEN REL_CD ='20' AND SUM(SUM_AMT) >100000
                        THEN  SUM(SUM_AMT)-100000
                        WHEN REL_CD ='20' AND SUM(SUM_AMT) <= 100000
                        THEN LEAST(SUM(SUM_AMT),0)
                   ELSE  SUM(SUM_AMT)
                   END AS                      SUM_AMT
                 , MAX(INT)                                             GUBUN
                 , DECODE(INT,1,'계',ROWNUM)                            ROW_NUM
                 , FAM_CD
                 , FAM_NM
                 , FAM_NO
            FROM   ASNHR.T_AC_DONATION,
                  (SELECT ROWNUM INT
                   FROM   DICT
                   WHERE  ROWNUM <= 2) COPYT
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            GROUP BY REL_CD,
                     ASNHR.SF_GET_COMMNAME('01','FB',REL_CD),
                     SEQ_NO,
                     REMARK,
                     DECODE(INT,1,'계',ROWNUM)
                   , FAM_CD
                   , FAM_NM
                   , FAM_NO
            ORDER BY MAX(INT),
                     REL_CD
            ]]>
        </query>
    </sql>

    <!-- 기부금공제 대상자 조회-->
    <!--  0 - 1, 3 - 2, 4/5 - 3, 1/2 - 4, 6 - 5, 7/8 - 6 -->
    <sql name="YACA040_SHR_05">
        <description>기부금공제 가능 대상자 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY                                          PIS_YY
                 , ENO_NO                                          ENO_NO
                 , DECODE(REL_CD,'0','1','3','2','4','3','5','3','1','4','2','4','6','5','7','6','8','6')  FAM_CD
                 , NAM_KOR                    					   FAM_NM
                 ,  SUBSTR(CET_NO,0,6)||'-'||SUBSTR(CET_NO,7,7)										   FAM_NO
            FROM   ASNHR.T_AC_FAMILY
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    BAS_MAN = 'O'
            ORDER BY REL_CD, FAM_NO, FAM_NM
            ]]>
        </query>
    </sql>


    <!-- 기부금공제 대상자 조회-->
    <!--  0 - 1, 3 - 2, 4/5 - 3, 1/2 - 4, 6 - 5, 7/8 - 6 -->
    <sql name="YACA040_SHR2_14">
        <description>기부금공제 가능 대상자 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY                                          PIS_YY
                 , ENO_NO                                          ENO_NO
                 , DECODE(REL_CD,'0','1','3','2','4','3','5','3','1','4','2','4','6','5','7','6','8','6')  FAM_CD
                 , NAM_KOR                    					   FAM_NM
                 ,  SUBSTR(CET_NO,0,6)||'-'||SUBSTR(CET_NO,7,7)										   FAM_NO
            FROM   ASNHR.T_AC_FAMILY_14
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    BAS_MAN = 'O'
            ORDER BY REL_CD, FAM_NO, FAM_NM
            ]]>
        </query>
    </sql>
    
    <!-- 기부금공제 대상자 조회-->
    <!--  0 - 1, 3 - 2, 4/5 - 3, 1/2 - 4, 6 - 5, 7/8 - 6 -->
    <sql name="YACA040_SHR2_15">
        <description>기부금공제 가능 대상자 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY                                          PIS_YY
                 , ENO_NO                                          ENO_NO
                 , DECODE(REL_CD,'0','1','3','2','4','3','5','3','1','4','2','4','6','5','7','6','8','6')  FAM_CD
                 , NAM_KOR                    					   FAM_NM
                 ,  SUBSTR(CET_NO,0,6)||'-'||SUBSTR(CET_NO,7,7)										   FAM_NO
            FROM   ASNHR.T_AC_FAMILY_15
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    BAS_MAN = 'O'
            ORDER BY REL_CD, FAM_NO, FAM_NM
            ]]>
        </query>
    </sql>


    <!-- 기부금공제내역 전체리스트 조회 -->
    <sql name="YACA040_SHR_06">
        <description>기부금공제내역 전체리스트 조회</description>
        <query>
            <![CDATA[
		    SELECT 'T' AS IS_CHK
				      , PIS_YY
				      , 'D' AS GUBUN
				      , B.DPT_NM
				      , B.JOB_NM
				      , B.ENO_NM
				      , A.ENO_NO
				      , SUM(SUM_AMT) AS SUM_AMT
			FROM   ASNHR.T_AC_DONATION A JOIN VI_T_CM_PERSON2 B ON A.ENO_NO=B.ENO_NO
			WHERE  PIS_YY = ?
			GROUP BY PIS_YY, B.DPT_NM, B.JOB_NM, B.ENO_NM, A.ENO_NO
			ORDER BY A.ENO_NO
            ]]>
        </query>
    </sql>

    <!-- 기부금공제내역 저장. -->
    <sql name="YACA040_INS">
        <description>기부금공제내역 저장</description>
        <query>
            <![CDATA[
            INSERT INTO ASNHR.T_AC_DONATION
            ( PIS_YY, ENO_NO, REL_CD, PIS_YM, REMARK,
              COM_NO, COM_NM, TOT_CNT, SUM_AMT,
              FAM_CD, FAM_NM, FAM_NO, NTS_YN,
              IPT_MAN, IPT_YMD, UPT_MAN, UPT_YMD )
            VALUES
            ( ?     , ?     , ?      , ''     , ?     ,
              ?     , ?     , ?      , ?      ,
              ?     , ?     , ?      , ?      ,
              ?      , SYSDATE, ?      , SYSDATE )
            ]]>
        </query>
    </sql>
    
    <!-- 기부금공제내역 저장. -->
    <sql name="YACA040_INS_14">
        <description>기부금공제내역 저장</description>
        <query>
            <![CDATA[
            INSERT INTO ASNHR.T_AC_DONATION_14
            ( PIS_YY, ENO_NO, REL_CD,  REMARK,
              COM_NO, COM_NM, TOT_CNT, SUM_AMT,
              FAM_CD, FAM_NM, FAM_NO, NTS_YN,
              IPT_MAN, IPT_YMD, UPT_MAN, UPT_YMD )
            VALUES
            ( ?     , ?     , ?      , ?     ,
              ?     , ?     , ?      , ?      ,
              ?     , ?     , ?      , ?      ,
              ?      , SYSDATE, ?      , SYSDATE )
            ]]>
        </query>
    </sql>    
    
    <!-- 기부금공제내역 저장. -->
    <sql name="YACA040_INS_15">
        <description>기부금공제내역 저장</description>
        <query>
            <![CDATA[
            INSERT INTO ASNHR.T_AC_DONATION_15
            ( PIS_YY, ENO_NO, REL_CD,  REMARK,
              COM_NO, COM_NM, TOT_CNT, SUM_AMT,
              FAM_CD, FAM_NM, FAM_NO, NTS_YN,
              IPT_MAN, IPT_YMD, UPT_MAN, UPT_YMD )
            VALUES
            ( ?     , ?     , ?      , ?     ,
              ?     , ?     , ?      , ?      ,
              ?     , ?     , ?      , ?      ,
              ?      , SYSDATE, ?      , SYSDATE )
            ]]>
        </query>
    </sql>    
    

    <!-- 기부금공제내역 삭제 -->
    <sql name="YACA040_DEL">
        <description>기부금공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_DONATION
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    DECODE(?,'20','XX',COM_NO) = DECODE(?,'20','XX',?)
            AND    REL_CD = ?
            AND    FAM_NO = ?
            ]]>
        </query>
    </sql>

    <!-- 기부금공제내역 삭제 -->
    <sql name="YACA040_DEL_14">
        <description>기부금공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_DONATION_14
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    DECODE(?,'20','XX',COM_NO) = DECODE(?,'20','XX',?)
            AND    REL_CD = ?
            AND    FAM_NO = ?
            ]]>
        </query>
    </sql>
    
    <!-- 기부금공제내역 삭제 -->
    <sql name="YACA040_DEL_15">
        <description>기부금공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_DONATION_15
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    DECODE(?,'20','XX',COM_NO) = DECODE(?,'20','XX',?)
            AND    REL_CD = ?
            AND    FAM_NO = ?
            ]]>
        </query>
    </sql>


    <!-- 기부금공제내역 삭제 -->
    <sql name="YACA040_DEL_01">
        <description>기부금공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_DONATION
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>    
    
    <!-- 기부금공제내역 삭제 -->
    <sql name="YACA040_DEL_ALL_14">
        <description>기부금공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_DONATION_14
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>        
    
    <!-- 기부금공제내역 삭제 -->
    <sql name="YACA040_DEL_ALL_15">
        <description>기부금공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_DONATION_15
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>        
    
    
    <!-- 사원정보(주민번호,주소) 조회 -->
    <sql name="YACA040_SHR_02">
        <description>사원정보(주민번호,주소) 조회</description>
        <query>
            <![CDATA[
			SELECT ENO_NM
			     , CET_NO
			     , ADR_CT||' '||ADDRESS     addr
				 , PHN_NO
			  FROM ASNHR.T_CM_PERSON
			 WHERE ENO_NO = ?
            ]]>
        </query>
    </sql>

    <!-- 회사정보 조회 -->
    <sql name="YACA040_SHR_03">
        <description>회사정보 조회</description>
        <query>
            <![CDATA[
			SELECT COMP_NM
			     , SUBSTR(TAX_NO,0,3) ||'-'|| SUBSTR(TAX_NO,4,2) ||'-'|| SUBSTR(TAX_NO,6,5)     TAX_NO
				 , ADDRESS_HD||' '||ADDRESS_DT   ADDR
				 , TEL_NO
			  FROM ASNHR.T_CM_COMPANY
            ]]>
        </query>
    </sql>

    <!-- 기부금조정내역 조회 -->
    <sql name="YACA040_SHR_04">
        <description>기부금조정내역조회</description>
        <query>
            <![CDATA[
            SELECT *
            FROM
			(	SELECT REL_CD
			     , DON_YY
				 , CASE
				   WHEN PIS_YY = ? THEN
				 		DECODE(ACC_DON_AMT, 0, (SELECT SUM(SUM_AMT) FROM ASNHR.T_AC_DONATION WHERE PIS_YY = ? AND ENO_NO = ADJ.ENO_NO AND REL_CD = ADJ.REL_CD), ACC_DON_AMT)
				   ELSE
				   	    ACC_DON_AMT
				   END ACC_DON_AMT
				 , ACC_DON_DED
				 , CASE
				   WHEN PIS_YY = ? THEN
				 		DECODE(ACC_DON_DIF, 0, (SELECT SUM(SUM_AMT) FROM ASNHR.T_AC_DONATION WHERE PIS_YY = ? AND ENO_NO = ADJ.ENO_NO AND REL_CD = ADJ.REL_CD), ACC_DON_DIF)
				   ELSE
				   	    ACC_DON_DIF
				   END ACC_DON_DIF
				 , DON_DED
				 , EXH_AMT
				 , VAL_AMT
			  FROM ASNHR.T_AC_DONATION_ADJ ADJ
			  WHERE PIS_YY = ?
			    AND ENO_NO = ?
			 )
			 WHERE ACC_DON_AMT > 0
			 ORDER BY REL_CD ASC, DON_YY DESC
            ]]>
        </query>
    </sql>

    <!-- 기부금공제내역 적용 -->
    <sql name="YACA040_UPT_FAM">
        <description>기부금공제내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_FAMILY A SET (LC3_AMT_NTS, LC3_AMT, LC1_AMT_NTS,LC1_AMT, LC2_AMT_NTS, LC2_AMT, LC4_AMT_NTS, LC4_AMT) =
			(SELECT
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '10' AND NTS_YN = '1') LC3_AMT_NTS,
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '10' AND NTS_YN = '2') LC3_AMT,
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '20' AND NTS_YN = '1') LC1_AMT_NTS,
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '20' AND NTS_YN = '2') LC1_AMT,
			      (SELECT SUM(NVL(SUM_AMT,0))
                  FROM ASNHR.T_AC_DONATION
                  WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '40' AND NTS_YN = '1') LC2_AMT_NTS, -- 지정기부금 국세청자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '40' AND NTS_YN = '2') LC2_AMT, -- 지정기부금 그밖의 자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '41' AND NTS_YN = '1') LC4_AMT_NTS, -- 종교단체기부금 국세청자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '41' AND NTS_YN = '2') LC4_AMT
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
            ]]>
        </query>
    </sql>
    

    <!-- 기부금공제내역 적용 -->
    <sql name="YACA040_UPT_FAM_14">
        <description>기부금공제내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_FAMILY_14 A SET (LC1_AMT_NTS,LC1_AMT, GOV_AMT_NTS, GOV_AMT, LC2_AMT_NTS, LC2_AMT, LC3_AMT_NTS, LC3_AMT) =
			(SELECT
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '10' AND NTS_YN = '1') LC1_AMT_NTS,--법정기부금 국세청자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '10' AND NTS_YN = '2') LC1_AMT,--법정기부금 그밖의 자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '20' AND NTS_YN = '1') GOV_AMT_NTS,--정치자금기부금 국세청자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '20' AND NTS_YN = '2') GOV_AMT,--정치자금기부금 그밖의 자료			      
			      (SELECT SUM(NVL(SUM_AMT,0))
                  FROM ASNHR.T_AC_DONATION_14
                  WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '40' AND NTS_YN = '1') LC2_AMT_NTS, -- 종교단체외 기부금 국세청자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '40' AND NTS_YN = '2') LC2_AMT, -- 종교단체외 기부금 그밖의 자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '41' AND NTS_YN = '1') LC3_AMT_NTS,-- 종교단체 기부금 국세청자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '41' AND NTS_YN = '2') LC3_AMT			-- 종교단체 기부금 그밖의 자료      
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
            ]]>
        </query>
    </sql>
    
     <!-- 기부금공제내역 적용 -->
    <sql name="YACA040_UPT_FAM_15">
        <description>기부금공제내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_FAMILY_15 A SET (LC1_AMT_NTS,LC1_AMT, GOV_AMT_NTS, GOV_AMT, LC2_AMT_NTS, LC2_AMT, LC3_AMT_NTS, LC3_AMT,LC4_AMT_NTS, LC4_AMT ) =
			(SELECT
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '10' AND NTS_YN = '1') LC1_AMT_NTS,--법정기부금 국세청자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '10' AND NTS_YN = '2') LC1_AMT,--법정기부금 그밖의 자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '20' AND NTS_YN = '1') GOV_AMT_NTS,--정치자금기부금 국세청자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '20' AND NTS_YN = '2') GOV_AMT,--정치자금기부금 그밖의 자료			      
			      (SELECT SUM(NVL(SUM_AMT,0))
                  FROM ASNHR.T_AC_DONATION_15
                  WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '40' AND NTS_YN = '1') LC2_AMT_NTS, -- 종교단체외 기부금 국세청자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '40' AND NTS_YN = '2') LC2_AMT, -- 종교단체외 기부금 그밖의 자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '41' AND NTS_YN = '1') LC3_AMT_NTS,-- 종교단체 기부금 국세청자료
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '41' AND NTS_YN = '2') LC3_AMT,			-- 종교단체 기부금 그밖의 자료     
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '42' AND NTS_YN = '1') LC4_AMT_NTS,     -- 우리사주조합기부금
			      (SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND FAM_NM = A.NAM_KOR AND REL_CD = '42' AND NTS_YN = '2') LC4_AMT			-- 우리사주조합기부금 그밖의 자료  
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
            ]]>
        </query>
    </sql>
    
    
    

    <!-- 기부금공제내역 적용 -->
    <sql name="YACA040_UPT_ACC">
        <description>기부금공제내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC A SET (LC3_AMT, GOV_AMT, LC1_AMT, LC2_AMT, LC4_AMT) =
			(SELECT
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '10'),0) LC3_AMT,
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '20'),0) GOV_AMT,
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '30'),0) LC1_AMT,
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '40'),0) LC2_AMT,
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '41'),0) LC4_AMT
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
			  AND A.GBN_TAG = '8'
            ]]>
        </query>
    </sql>


    <!-- 기부금공제내역 적용 -->
    <sql name="YACA040_UPT_ACC_14">
        <description>기부금공제내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_14 A SET (GOV_AMT, LC1_AMT, LC2_AMT, LC3_AMT) =
			(SELECT
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '20'),0) GOV_AMT,		--정치자금기부금
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '10'),0) LC1_AMT,		--법정기부금
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '40'),0) LC2_AMT,		-- 종교단체외 기부금
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '41'),0) LC3_AMT		-- 종교단체 기부금	      
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
			  AND A.GBN_TAG = '8'
            ]]>
        </query>
    </sql>
    
    
     <!-- 기부금공제내역 적용 -->
    <sql name="YACA040_UPT_ACC_15">
        <description>기부금공제내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_15 A SET (GOV_AMT, LC1_AMT, LC2_AMT, LC3_AMT, LC4_AMT) =
			(SELECT
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '20'),0) GOV_AMT,		--정치자금기부금
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '10'),0) LC1_AMT,		--법정기부금
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '40'),0) LC2_AMT,		-- 종교단체외 기부금
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '41'),0) LC3_AMT,		-- 종교단체 기부금	
			      NVL((SELECT SUM(NVL(SUM_AMT,0))
			      FROM ASNHR.T_AC_DONATION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND REL_CD = '42'),0) LC4_AMT		-- 우리사주조합기부금      
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
			  AND A.GBN_TAG = '8'
            ]]>
        </query>
    </sql>
    
    
    

<!--
***********************************************************************
* @UseCase     : YACA050
* @description : 연말정산결과조회
***********************************************************************
* 2007/04/23     조정호        최초작성.
***********************************************************************
-->
    <!-- 연말정산결과조회 -->
    <sql name="YACA050_SHR">
        <description>연말정산결과조회</description>
        <query>
            <![CDATA[
            SELECT TAX_INCOME + YAB_INCOME AS TAX_INCOME
                  ,MGR_AMT
                  ,MNI_AMT
                  ,BADD_AMT
                  ,SPSB_AMT
                  ,GDED_AMT
                  ,GOL_AMT65
                  ,GOL_AMT70
                  ,TBL_DED
                  ,WDD_AMT
                  ,RCH_AMT
                  ,SMD_AMT
                  ,INP_AMT
                  ,ONE_AMT
                  ,NPEN_DED
                  ,LIN_DED                  
                  ,MIN_DED
                  ,LIH_DED
                  ,HAN_AMT
                  ,MMA_DED
                  ,GRA_AMT
                  ,CHI_DED
                  ,HIG_DED
                  ,UNI_DED
                  ,HED_AMT
                  ,HOS_DED
                  ,CPC_DED
                  ,WFM_DED
                  ,DECODE(NSE_TOT, 0, STA_TOT, NSE_TOT) AS NSE_TOT
                  ,GREATEST(MNI_AMT - INDED_TOT, 0) AS MNI_TOT
                  ,PER_SAV
                  ,ANN_DED
                  ,VEN_DED
                  ,CARD_DED
                  ,TTAX_STD
                  ,TAX_AMT
                  ,HGR_DED
                  ,HTX_DED
                  ,OTX_DED
                  ,GOV_DED
                  ,LOAN_DED + PLOAN_DED LOAN_DED
                  ,MRENT_DED
                  ,LONG_DED
                  ,SAVE_DED
                  ,TDED_TOT
                  ,DGG_TAX
                  ,DJM_TAX
                  ,(DGG_TAX + DJM_TAX) AS DGG_DJM
                  ,AGG_TAX
                  ,AJM_TAX
                  ,(AGG_TAX + AJM_TAX) AS AGG_AJM
                  ,DRE_INTX
                  ,DRE_CTTX
                  ,(DRE_INTX + DRE_CTTX) AS INTX_CTTX
              FROM ASNHR.T_AC_RETACC
             WHERE PIS_YY  = ?
               AND ENO_NO  = ?
               AND GBN_TAG = '8'
            ]]>
        </query>
    </sql>



<!--
***********************************************************************
* @UseCase     : YACA050_SHR_14
* @description : 연말정산결과조회 14
***********************************************************************
* 2015/01/29     조정호        최초작성.
***********************************************************************
-->
    <!-- 연말정산결과조회 -->
    <sql name="YACA050_SHR_14">
        <description>연말정산결과조회</description>
        <query>
            <![CDATA[
            SELECT nvl(TAX_INCOME,0) + nvl(YAB_INCOME,0) AS TAX_INCOME
                  ,nvl(MGR_AMT,0) MGR_AMT
                  ,nvl(MNI_AMT,0) MNI_AMT
                  ,nvl(BADD_AMT,0) BADD_AMT
                  ,nvl(SPSB_AMT,0) SPSB_AMT
                  ,nvl(GDED_AMT,0) GDED_AMT
                  ,nvl(GOL_AMT70,0) GOL_AMT70
                  ,nvl(TBL_DED,0) TBL_DED
                  ,nvl(WDD_AMT,0) WDD_AMT
                  ,nvl(OTX_DED,0) OTX_DED
                  ,nvl(NPEN_DED,0) NPEN_DED
                  ,0 ETC_DED
                  ,nvl(HINS_DED,0) + nvl(OLD_DED,0) + nvl(HINU_DED,0) HIN_DED                                    
                  ,nvl(LOAN_DED,0) + nvl(PLOAN_DED,0) LOAN_DED                 
                  ,nvl(LONG_DED,0) LONG_DED
                  ,nvl(DON_FWD,0)  DON_FWD                                    
                  ,nvl(VEN_DED,0) VEN_DED                
                  ,nvl(INDED_TOT,0)  INDED_TOT                 
                  ,nvl(PER_DED,0) PER_DED                
                  ,nvl(SAVE_DED,0) SAVE_DED
                  ,nvl(CARD_DED,0) CARD_DED                 
                  ,nvl(SAJU_DED,0) SAJU_DED                 
                  ,nvl(LSS_DED,0) LSS_DED
                  ,nvl(INDED_EXC,0) INDED_EXC
                  ,nvl(TTAX_STD,0) TTAX_STD
                  ,nvl(TAX_AMT,0) TAX_AMT                  
                  ,nvl(HGR_DED,0) HGR_DED   
                  ,nvl(CHI_CNT,0) CHI_CNT                                  
                  ,nvl(AGE_AMT,0) AGE_AMT    
                  ,nvl(CHI_RCH,0) CHI_RCH                                  
                  ,nvl(AGE_RCH,0) AGE_RCH   
                  ,nvl(CHI_INP,0) CHI_INP                                  
                  ,nvl(AGE_INP,0) AGE_INP                                                  
                  ,nvl(ANN_DED,0) ANN_DED                  
                  ,nvl(MIN_DED,0) MIN_DED
                  ,nvl(MMA_DED,0) MMA_DED
                  ,nvl(EDU_DED,0) EDU_DED 
                  ,nvl(GOV_DED,0) GOV_DED
                  ,nvl(GOV2_DED,0) GOV2_DED
                  ,nvl(LC1_DED,0) LC1_DED
                  ,nvl(LC23_DED,0) LC23_DED                            
                  ,nvl(CPC_DED,0) CPC_DED
                  ,nvl(NSE_TOT,0) AS NSE_TOT 
                  ,nvl(STA_TOT,0) STA_TOT
                  ,nvl(MRENT_DED,0) MRENT_DED
                  ,nvl(TDED_TOT,0) TDED_TOT
                  ,nvl(DGG_TAX,0) DGG_TAX
                  ,nvl(DJM_TAX,0) DJM_TAX
                  ,nvl(DBW_TAX,0) DBW_TAX                  
                  ,(nvl(DGG_TAX,0) + nvl(DJM_TAX,0) + nvl(DBW_TAX,0)) AS DGG_SUM
                  ,nvl(AGG_TAX,0) AGG_TAX
                  ,nvl(AJM_TAX,0) AJM_TAX
                  ,nvl(CONT_TAX,0) CONT_TAX                  
                  ,(nvl(AGG_TAX,0) + nvl(AJM_TAX,0) + nvl(CONT_TAX,0)) AS AGG_SUM
                  ,nvl(DRE_INTX,0) DRE_INTX
                  ,nvl(DRE_CTTX,0) DRE_CTTX
                  ,nvl(DRE_DFTX,0) DRE_DFTX                  
                  ,(nvl(DRE_INTX,0) + nvl(DRE_CTTX,0) + nvl(DRE_DFTX,0)) AS RESULT
              FROM ASNHR.T_AC_RETACC_14
             WHERE PIS_YY  = ?
               AND ENO_NO  = ?
               AND GBN_TAG = '8'
            ]]>
        </query>
    </sql>


    <!-- 연말정산결과조회 -->
    <sql name="YACA050_SHR_142">
        <description>연말정산결과조회</description>
        <query>
            <![CDATA[
            SELECT nvl(TAX_INCOME,0) + nvl(YAB_INCOME,0) AS TAX_INCOME
                  ,nvl(MGR_AMT,0) MGR_AMT
                  ,nvl(MNI_AMT,0) MNI_AMT
                  ,nvl(BADD_AMT,0) BADD_AMT
                  ,nvl(SPSB_AMT,0) SPSB_AMT
                  ,nvl(GDED_AMT,0) GDED_AMT
                  ,nvl(GOL_AMT70,0) GOL_AMT70
                  ,nvl(TBL_DED,0) TBL_DED
                  ,nvl(WDD_AMT,0) WDD_AMT
                  ,nvl(OTX_DED,0) OTX_DED
                  ,nvl(NPEN_DED,0) NPEN_DED
                  ,0 ETC_DED
                  ,nvl(HINS_DED,0) + nvl(OLD_DED,0) + nvl(HINU_DED,0) HIN_DED                                    
                  ,nvl(LOAN_DED,0) + nvl(PLOAN_DED,0) LOAN_DED                 
                  ,nvl(LONG_DED,0) LONG_DED
                  ,nvl(DON_FWD,0)  DON_FWD                                    
                  ,nvl(VEN_DED,0) VEN_DED                
                  ,nvl(INDED_TOT,0)  INDED_TOT                 
                  ,nvl(PER_DED,0) PER_DED                
                  ,nvl(SAVE_DED,0) SAVE_DED
                  ,nvl(CARD_DED,0) CARD_DED                 
                  ,nvl(SAJU_DED,0) SAJU_DED                 
                  ,nvl(LSS_DED,0) LSS_DED
                  ,nvl(INDED_EXC,0) INDED_EXC
                  ,nvl(TTAX_STD,0) TTAX_STD
                  ,nvl(TAX_AMT,0) TAX_AMT                  
                  ,nvl(HGR_DED,0) HGR_DED                 
                  ,nvl(AGE_AMT,0) AGE_AMT    
                  ,nvl(AGE_RCH,0) AGE_RCH      
                  ,nvl(AGE_INP,0) AGE_INP                                               
                  ,nvl(ANN_DED,0) ANN_DED                  
                  ,nvl(MIN_DED,0) MIN_DED
                  ,nvl(MMA_DED,0) MMA_DED
                  ,nvl(EDU_DED,0) EDU_DED 
                  ,nvl(GOV_DED,0) GOV_DED
                  ,nvl(GOV2_DED,0) GOV2_DED
                  ,nvl(LC1_DED,0) LC1_DED
                  ,nvl(LC23_DED,0) LC23_DED                            
                  ,nvl(CPC_DED,0) CPC_DED
                  ,nvl(NSE_TOT,0) AS NSE_TOT 
                  ,nvl(STA_TOT,0) STA_TOT
                  ,nvl(MRENT_DED,0) MRENT_DED
                  ,nvl(TDED_TOT,0) TDED_TOT
                  ,nvl(DGG_TAX,0) DGG_TAX
                  ,nvl(DJM_TAX,0) DJM_TAX
                  ,nvl(DBW_TAX,0) DBW_TAX                  
                  ,(nvl(DGG_TAX,0) + nvl(DJM_TAX,0) + nvl(DBW_TAX,0)) AS DGG_SUM
                  ,nvl(AGG_TAX,0) AGG_TAX
                  ,nvl(AJM_TAX,0) AJM_TAX
                  ,nvl(CONT_TAX,0) CONT_TAX                  
                  ,(nvl(AGG_TAX,0) + nvl(AJM_TAX,0) + nvl(CONT_TAX,0)) AS AGG_SUM
                  ,nvl(DRE_INTX,0) DRE_INTX
                  ,nvl(DRE_CTTX,0) DRE_CTTX
                  ,nvl(DRE_DFTX,0) DRE_DFTX                  
                  ,(nvl(DRE_INTX,0) + nvl(DRE_CTTX,0) + nvl(DRE_DFTX,0)) AS RESULT
                  ,nvl(REA_TAX,0) REA_TAX
                  ,nvl(REB_TAX,0) REB_TAX
                  ,nvl(REC_TAX,0) REC_TAX                  
                  ,(nvl(REA_TAX,0) + nvl(REB_TAX,0) + nvl(REC_TAX,0)) AS RED_TAX
                  ,(nvl(REA_TAX,0) - nvl(DRE_INTX,0))  AS CEA_TAX  
                  ,(nvl(REB_TAX,0) - nvl(DRE_CTTX,0))  AS CEB_TAX 
                  ,(nvl(REC_TAX,0) - nvl(DRE_DFTX,0))  AS CEC_TAX                                                  
                  ,((nvl(REA_TAX,0) + nvl(REB_TAX,0) + nvl(REC_TAX,0)) - (nvl(DRE_INTX,0) + nvl(DRE_CTTX,0) + nvl(DRE_DFTX,0))) AS CED_TAX                             
              FROM ASNHR.T_AC_RETACC_142
             WHERE PIS_YY  = ?
               AND ENO_NO  = ?
               AND GBN_TAG = '8'
            ]]>
        </query>
    </sql>
    
    <!-- 연말정산결과조회 -->
    <sql name="YACA050_SHR_15">
        <description>연말정산결과조회</description>
        <query>
            <![CDATA[
            SELECT nvl(TAX_INCOME,0) + nvl(YAB_INCOME,0) AS TAX_INCOME
                  ,nvl(MGR_AMT,0) MGR_AMT
                  ,nvl(MNI_AMT,0) MNI_AMT
                  ,nvl(BADD_AMT,0) BADD_AMT
                  ,nvl(SPSB_AMT,0) SPSB_AMT
                  ,nvl(GDED_AMT,0) GDED_AMT
                  ,nvl(GOL_AMT70,0) GOL_AMT70
                  ,nvl(TBL_DED,0) TBL_DED
                  ,nvl(WDD_AMT,0) WDD_AMT
                  ,nvl(OTX_DED,0) OTX_DED
                  ,nvl(NPEN_DED,0) NPEN_DED
                  ,0 ETC_DED
                  ,nvl(HINS_DED,0) + nvl(OLD_DED,0) + nvl(HINU_DED,0) HIN_DED                                    
                  ,nvl(LOAN_DED,0) + nvl(PLOAN_DED,0) LOAN_DED                 
                  ,nvl(LONG_DED,0) LONG_DED
                  ,nvl(DON_FWD,0)  DON_FWD                                    
                  ,nvl(VEN_DED,0) VEN_DED                
                  ,nvl(INDED_TOT,0)  INDED_TOT                 
                  ,nvl(PER_DED,0) PER_DED                
                  ,nvl(SAVE_DED,0) SAVE_DED
                  ,nvl(CARD_DED,0) CARD_DED                 
                  ,nvl(SAJU_DED,0) SAJU_DED                 
                  ,nvl(LSS_DED,0) LSS_DED
                  ,nvl(INDED_EXC,0) INDED_EXC
                  ,nvl(TTAX_STD,0) TTAX_STD
                  ,nvl(TAX_AMT,0) TAX_AMT                  
                  ,nvl(HGR_DED,0) HGR_DED                 
                  ,nvl(AGE_AMT,0) AGE_AMT    
                  ,nvl(AGE_RCH,0) AGE_RCH      
                  ,nvl(AGE_INP,0) AGE_INP                                               
                  ,nvl(ANN_DED,0) ANN_DED      
                  ,nvl(DCIRP_DED,0) DCIRP_DED                  
                  ,nvl(MIN_DED,0) MIN_DED
                  ,nvl(MMA_DED,0) MMA_DED
                  ,nvl(EDU_DED,0) EDU_DED 
                  ,nvl(GOV_DED,0) GOV_DED
                  ,nvl(GOV2_DED,0) GOV2_DED
                  ,nvl(LC1_DED,0) LC1_DED
                  ,nvl(LC23_DED,0) LC23_DED                            
                  ,nvl(CPC_DED,0) CPC_DED
                  ,nvl(NSE_TOT,0) AS NSE_TOT 
                  ,nvl(STA_TOT,0) STA_TOT
                  ,nvl(MRENT_DED,0) MRENT_DED
                  ,nvl(TDED_TOT,0) TDED_TOT
                  ,nvl(DGG_TAX,0) DGG_TAX
                  ,nvl(DJM_TAX,0) DJM_TAX
                  ,nvl(DBW_TAX,0) DBW_TAX                  
                  ,(nvl(DGG_TAX,0) + nvl(DJM_TAX,0) + nvl(DBW_TAX,0)) AS DGG_SUM
                  ,nvl(AGG_TAX,0) AGG_TAX
                  ,nvl(AJM_TAX,0) AJM_TAX
                  ,nvl(CONT_TAX,0) CONT_TAX                  
                  ,(nvl(AGG_TAX,0) + nvl(AJM_TAX,0) + nvl(CONT_TAX,0)) AS AGG_SUM
                  ,nvl(DRE_INTX,0) DRE_INTX
                  ,nvl(DRE_CTTX,0) DRE_CTTX
                  ,nvl(DRE_DFTX,0) DRE_DFTX                  
                  ,(nvl(DRE_INTX,0) + nvl(DRE_CTTX,0) + nvl(DRE_DFTX,0)) AS RESULT
                  /*
                  ,nvl(REA_TAX,0) REA_TAX
                  ,nvl(REB_TAX,0) REB_TAX
                  ,nvl(REC_TAX,0) REC_TAX                  
                  ,(nvl(REA_TAX,0) + nvl(REB_TAX,0) + nvl(REC_TAX,0)) AS RED_TAX
                  ,(nvl(REA_TAX,0) - nvl(DRE_INTX,0))  AS CEA_TAX  
                  ,(nvl(REB_TAX,0) - nvl(DRE_CTTX,0))  AS CEB_TAX 
                  ,(nvl(REC_TAX,0) - nvl(DRE_DFTX,0))  AS CEC_TAX                                                  
                  ,((nvl(REA_TAX,0) + nvl(REB_TAX,0) + nvl(REC_TAX,0)) - (nvl(DRE_INTX,0) + nvl(DRE_CTTX,0) + nvl(DRE_DFTX,0))) AS CED_TAX
                  */                             
              FROM ASNHR.T_AC_RETACC_15
             WHERE PIS_YY  = ?
               AND ENO_NO  = ?
               AND GBN_TAG IN ('8','9')
            ]]>
        </query>
    </sql>



     <!-- 연말정산결과조회 출력 1,2page-->
    <sql name="YACA050_PRT_142">
        <description>연말정산결과조회 출력 1,2page</description>
        <query>
            <![CDATA[
       		SELECT 
			   PERSON.ENO_NM,
			   MAIN.*, SUB01.SDATE, SUB01.EDATE, 
			   COM.COMP_NM,COM.PRESIDENT_NM,COM.TAX_NO,
				 SUBSTR(COM.CORP_NO,1,6)||'-'||SUBSTR(COM.CORP_NO,7,13) AS CORP_NO,
			   (COM.ADDRESS_HD||' '||COM.ADDRESS_DT) AS ADDRESS, COM.TEL_NO, MAIN.TAX_INCOME+MAIN.YAB_INCOME AS SUM,
			   (MAIN.PAYD_AMTS+MAIN.JAA_AMT1+MAIN.JAA_AMT2+MAIN.JAA_AMT3) AS SUM_PAY_AMTS,
			   (MAIN.JAC_AMT1+MAIN.JAC_AMT2+MAIN.JAC_AMT3) AS SUM_PAY_AMTB,
			   (MAIN.JAI_AMT1+MAIN.JAI_AMT2+MAIN.JAI_AMT3) AS SUM_JAI_AMT,
			   (MAIN.HINU_AMT+MAIN.JAH_AMT1+MAIN.JAH_AMT2+MAIN.JAH_AMT3) AS SUM_HINU,
			   (MAIN.HINS_AMT+MAIN.JAP_AMT1+MAIN.JAP_AMT2+MAIN.JAP_AMT3) AS SUM_HINS,
			   (CASE WHEN SUBSTR(MAIN.CET_NO,8,1)='1' OR SUBSTR(MAIN.CET_NO,8,1)='2' OR SUBSTR(MAIN.CET_NO,8,1)='3' OR SUBSTR(MAIN.CET_NO,8,1)='4'
			    	          THEN RPAD('내국인①/외국인9',40) ELSE RPAD('내국인1/외국인⑨',40)  END ) AS TYPE,
			    GREATEST('2014'||'/01/01',TO_CHAR(MAIN.HIR_YMD,'YYYY/MM/DD')) AS STR,
			    LEAST('2014'||'/12/31',NVL(TO_CHAR(MAIN.RET_YMD,'YYYY/MM/DD'),'2099/12/31')) AS END,
			    COM.TAX_OFFICE,
			    (CASE WHEN MAIN.HOL_YN = 'Y' THEN  RPAD('세대주①,세대원2',30) ELSE RPAD('세대주1,세대원②',40) END ) AS HOL_YN_1 
		    FROM
		    (
		      SELECT 
		        A.CHI_CNT,A.PIS_YY,
		        A.ENO_NO, A.PIS_MM,A.OCC_CD,
		        A.GBN_TAG,A.MDPT_CD,
		        A.MJOB_CD,A.MHOB_CD,A.SOU_CNT,
		        A.DFM_CNT,A.TRB_CNT,
		        A.GOL_CNT,A.WCT_CNT,
		        A.MHS_TAG,A.LIN_AMT,A.LMA_AMT,
		
		        A.LHO_AMT,A.LHP_AMT,A.LHR_AMT,
		
		        A.CLS_TAG,A.DOMW_DD,A.OUTW_DD,
		        A.TOTW_DD,A.DOMT_AMTS,A.OUTT_AMTS,
		        A.SALT_AMTS,A.SALT_AMTT,
		        A.PAYD_AMTS,A.PAYO_AMTS,
		        A.TAX_INCOME,A.YAB_INCOME,A.FREE_INCOME,
		        A.ITXD_AMT,A.STAX_DED,
		        A.INCM_TAX,A.CITI_TAX,
		        A.HINU_AMT + A.OLD_AMT HINU_AMT,
		        A.NPEN_AMT,A.HINS_AMT,A.MGR_AMT,A.MNI_AMT,
		        A.BADD_AMT,A.SPSB_AMT,A.GDED_AMT,A.GOL_AMT,
		        A.TBL_DED,A.WDD_AMT,
		        A.PER_TOT,A.MIN_DED,A.MMA_DED,A.EDU_DED,
		        A.CPC_DED,A.NSE_TOT,A.PER_DED,
		        A.INDED_TOT,A.DON_FWD,
		        A.TTAX_STD,A.TAX_AMT,
		        A.HGR_DED,A.OTX_DED,A.TAX_DED,A.TDED_TOT,
		        
		        A.DGG_TAX,A.DJM_TAX,A.DBW_TAX,
		        A.AGG_TAX,A.AJM_TAX,A.CONT_TAX,
		        A.DRE_INTX,A.DRE_CTTX,A.DRE_DFTX,
		        
		        A.CARD_DED,A.CARD_AMT,A.SAJU_DED,A.LSS_DED,
		        A.LIN_DED-A.HINU_AMT-A.HINS_AMT AS LIN_DED,
		        A.VEN_AMT,
		        A.VEN_DED,
		
		        A.LIH_AMT,
		        A.GRA_AMT,A.ANN_AMT,
		        A.LIH_DED,
		        A.NPEN_DED,
		        A.ANN_DED,
		        A.HAN_AMT,
		        A.AGE_AMT,
		        CASE WHEN A.NSE_TOT > 0 THEN 0
		                ELSE LEAST(A.MNI_AMT-(A.PER_TOT+A.NPEN_DED+A.MIN_DED+A.MMA_DED+A.EDU_DED+A.LOAN_DED+A.LONG_DED+A.CPC_DED), 1000000) END STA_TOT,
		        A.VEN2_AMT,A.HED_AMT,A.MHEA_AMT,A.OHEA_AMT,
		        A.LEN_AMT2,A.LEN_AMT3,A.LEN_AMT4,A.LEN_AMT5,
		        A.EDU_TAG1,A.EDU_AMT1,
		        A.EDU_TAG2,A.EDU_AMT2,
		        A.EDU_TAG3,A.EDU_AMT3,
		        A.EDU_TAG4,A.EDU_AMT4,
		        A.EDU_TAG5,A.EDU_AMT5,A.FUN_CNT,
		        A.GOL_CNT70,A.GOL_AMT70,
		        A.CHI_DED,A.HIG_DED,A.UNI_DED,A.SEA_FREE,
		        A.CASH_AMT,
		        
		        A.GOV_DED,A.GOV2_DED,
		        A.LC1_DED,A.LC23_DED,
		                
		        A.IPT_MAN,A.IPT_YMD,A.UPT_MAN,A.UPT_YMD,A.TAX_DPT,
		        
		        B.JAO_NO AS JAO_NO1, B.JAS_NM AS JAS_NM1, NVL(B.JAA_AMT,0) AS JAA_AMT1 ,
		        NVL(B.JAB_AMT,0) AS JAB_AMT1,NVL(B.JAC_AMT,0) AS JAC_AMT1,NVL(B.JAD_AMT,0) AS JAD_AMT1,
		        NVL(B.JAE_AMT,0) AS JAE_AMT1,NVL(B.JAF_AMT,0) AS JAF_AMT1, NVL(B.JAG_AMT,0) AS JAG_AMT1,
		        NVL(B.JAH_AMT,0) AS JAH_AMT1,NVL(B.JAJ_AMT,0) AS JAJ_AMT1, NVL(B.JAK_AMT,0) AS JAK_AMT1,
		        NVL(B.JAL_AMT,0) AS JAL_AMT1,NVL(B.JAN_AMT,0) AS JAN_AMT1,NVL(B.JAM_AMT,0) AS JAM_AMT1,
		        NVL(B.JAP_AMT,0) AS JAP_AMT1, NVL(B.JAQ_AMT,0) AS JAQ_AMT1,NVL(B.SEQ_NO,0) AS SEQ_NO1,NVL(B.JAI_AMT,0) AS JAI_AMT1,
		        
		        C.JAO_NO AS JAO_NO2, C.JAS_NM AS JAS_NM2, NVL(C.JAA_AMT,0) AS JAA_AMT2 ,NVL(C.JAB_AMT,0) AS JAB_AMT2,
		        NVL(C.JAC_AMT,0) AS JAC_AMT2,NVL(C.JAD_AMT,0) AS JAD_AMT2,
		        NVL(C.JAE_AMT,0) AS JAE_AMT2,NVL(C.JAF_AMT,0) AS JAF_AMT2, NVL(C.JAG_AMT,0) AS JAG_AMT2,
		        NVL(C.JAH_AMT,0) AS JAH_AMT2,NVL(C.JAJ_AMT,0) AS JAJ_AMT2, NVL(C.JAK_AMT,0) AS JAK_AMT2,
		        NVL(C.JAL_AMT,0) AS JAL_AMT2,NVL(C.JAN_AMT,0) AS JAN_AMT2,NVL(C.JAM_AMT,0) AS JAM_AMT2,
		        NVL(C.JAP_AMT,0) AS JAP_AMT2, NVL(C.JAQ_AMT,0) AS JAQ_AMT2,NVL(C.SEQ_NO,0) AS SEQ_NO2,NVL(C.JAI_AMT,0) AS JAI_AMT2,
		        
		        D.JAO_NO AS JAO_NO3, D.JAS_NM AS JAS_NM3, NVL(D.JAA_AMT,0) AS JAA_AMT3, NVL(D.JAB_AMT,0) AS JAB_AMT3,
		        NVL(D.JAC_AMT,0) AS JAC_AMT3,NVL(D.JAD_AMT,0) AS JAD_AMT3,
		        NVL(D.JAE_AMT,0) AS JAE_AMT3,NVL(D.JAF_AMT,0) AS JAF_AMT3, NVL(D.JAG_AMT,0) AS JAG_AMT3,
		        NVL(D.JAH_AMT,0) AS JAH_AMT3,NVL(D.JAJ_AMT,0) AS JAJ_AMT3, NVL(D.JAK_AMT,0) AS JAK_AMT3,
		        NVL(D.JAL_AMT,0) AS JAL_AMT3,NVL(D.JAN_AMT,0) AS JAN_AMT3,NVL(D.JAM_AMT,0) AS JAM_AMT3,
		        NVL(D.JAP_AMT,0) AS JAP_AMT3, NVL(D.JAQ_AMT,0) AS JAQ_AMT3,NVL(D.SEQ_NO,0) AS SEQ_NO3,NVL(D.JAI_AMT,0) AS JAI_AMT3,
		  	  	A.ONE_AMT,  
		        CASE WHEN A.LH4_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG4_DED,
		        CASE WHEN A.LH5_AMT > 0 AND A.ENO_NO != '2050037' THEN A.LONG_DED 
		        		 WHEN A.LH5_AMT > 0 AND A.ENO_NO = '2050037' THEN 1150760 ELSE 0 END LONG5_DED,
		        CASE WHEN A.LH6_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG6_DED,
		        CASE WHEN A.LH7_AMT > 0 AND A.ENO_NO != '2050037' THEN A.LONG_DED 
		        		 WHEN A.LH7_AMT > 0 AND A.ENO_NO = '2050037' THEN 1248553 ELSE 0 END LONG7_DED,        
		        CASE WHEN A.LH8_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG8_DED,     			
		  		  A.SAVE_DED,
				    A.SAVE1_DED, 
				    A.SAVE2_DED, 
				    A.SAVE3_DED,  
				    A.LOAN_DED,
				    A.PLOAN_DED,
				    A.MRENT_DED, 
				    A.LONG_DED,
		        (F.ADR_CT  || ' ' || F.ADDRESS ) AS ADDRESS_HOME,
		        F.CET_NO,SUBSTR(F.CET_NO,1,7) ||'  '||SUBSTR(F.CET_NO,8,14) AS CET_NO2,
		        F.HIR_YMD,F.RET_YMD,
		        A.HOL_YN,
		        RPAD('( 소득자 보관용 )',40) AS HTITLE ,   TO_CHAR(SYSDATE,'YYYYMMDD') AS CURDT,
		        NVL(A.TAX_INCOME,0)+ NVL(B.JAA_AMT,0)+NVL(C.JAA_AMT,0)+ NVL(D.JAA_AMT,0) AS SUM_JAA_AMT,
		        NVL(B.JAC_AMT,0)+NVL(C.JAC_AMT,0)+ NVL(D.JAC_AMT,0) AS SUM_JAC_AMT,
		        NVL(A.FREE_INCOME,0)+ NVL(B.JAG_AMT,0)+NVL(C.JAG_AMT,0)+ NVL(D.JAG_AMT,0) AS SUM_JAG_AMT,
		        NVL(A.REA_TAX,0) AS REA_TAX,NVL(A.REB_TAX,0) AS REB_TAX,NVL(A.REC_TAX,0) AS REC_TAX 
		        FROM ASNHR.T_AC_RETACC_142 A
		        LEFT OUTER JOIN ASNHR.T_AC_DUTYPLACE B ON B.ENO_NO = A.ENO_NO AND B.PIS_YY = A.PIS_YY AND B.SEQ_NO='1'
		        LEFT OUTER JOIN ASNHR.T_AC_DUTYPLACE C ON C.ENO_NO = A.ENO_NO AND C.PIS_YY = A.PIS_YY AND C.SEQ_NO='2'
		        LEFT OUTER JOIN ASNHR.T_AC_DUTYPLACE D ON D.ENO_NO = A.ENO_NO AND D.PIS_YY = A.PIS_YY AND D.SEQ_NO='3'
		        LEFT OUTER JOIN ASNHR.T_CM_PERSON F ON A.ENO_NO = F.ENO_NO
		       WHERE  A.PIS_YY = ?
		         AND NVL(A.ENO_NO,' ')  LIKE  '%'||?||'%'    --2140021  3140018  2140029
		    ) MAIN
		    INNER JOIN ASNHR.T_CM_PERSON PERSON ON MAIN.ENO_NO = PERSON.ENO_NO
		    LEFT OUTER JOIN (SELECT '2014'||'/01/01' AS SDATE , TO_CHAR(RET_YMD,'YYYY/MM/DD') AS EDATE, ENO_NO FROM ASNHR.T_CM_PERSON WHERE GUBUN = '01' ) SUB01 ON MAIN.ENO_NO = SUB01.ENO_NO
		    LEFT OUTER JOIN ASNHR.T_CM_COMPANY COM ON COM.GUBUN = '01'
		    ORDER BY ASNHR.SF_GET_DPTSEQ('01','A4',PERSON.DPT_CD), ASNHR.SF_GET_COMMSEQ('01','A2',PERSON.JOB_CD), PERSON.HOB_CD DESC
            ]]>
        </query>
    </sql>
    
     <!-- 연말정산결과조회 출력 1,2page-->
    <sql name="YACA050_PRT_15">
        <description>연말정산결과조회 출력 1,2page</description>
        <query>
            <![CDATA[
       		SELECT 
			   PERSON.ENO_NM,
			   MAIN.*, SUB01.SDATE, SUB01.EDATE, 
			   COM.COMP_NM,COM.PRESIDENT_NM,COM.TAX_NO,
				 SUBSTR(COM.CORP_NO,1,6)||'-'||SUBSTR(COM.CORP_NO,7,13) AS CORP_NO,
			   (COM.ADDRESS_HD||' '||COM.ADDRESS_DT) AS ADDRESS, COM.TEL_NO, MAIN.TAX_INCOME+MAIN.YAB_INCOME AS SUM,
			   (MAIN.PAYD_AMTS+MAIN.JAA_AMT1+MAIN.JAA_AMT2+MAIN.JAA_AMT3) AS SUM_PAY_AMTS,
			   (MAIN.JAC_AMT1+MAIN.JAC_AMT2+MAIN.JAC_AMT3) AS SUM_PAY_AMTB,
			   (MAIN.JAI_AMT1+MAIN.JAI_AMT2+MAIN.JAI_AMT3) AS SUM_JAI_AMT,
			   (MAIN.HINU_AMT+MAIN.JAH_AMT1+MAIN.JAH_AMT2+MAIN.JAH_AMT3) AS SUM_HINU,
			   (MAIN.HINS_AMT+MAIN.JAP_AMT1+MAIN.JAP_AMT2+MAIN.JAP_AMT3) AS SUM_HINS,
			   (CASE WHEN SUBSTR(MAIN.CET_NO,8,1)='1' OR SUBSTR(MAIN.CET_NO,8,1)='2' OR SUBSTR(MAIN.CET_NO,8,1)='3' OR SUBSTR(MAIN.CET_NO,8,1)='4'
			    	          THEN RPAD('내국인①/외국인9',40) ELSE RPAD('내국인1/외국인⑨',40)  END ) AS TYPE,
			    GREATEST('2015'||'/01/01',TO_CHAR(MAIN.HIR_YMD,'YYYY/MM/DD')) AS STR,
			    LEAST('2015'||'/12/31',NVL(TO_CHAR(MAIN.RET_YMD,'YYYY/MM/DD'),'2099/12/31')) AS END,
			    COM.TAX_OFFICE,
			    (CASE WHEN MAIN.HOL_YN = 'Y' THEN  RPAD('세대주①,세대원2',30) ELSE RPAD('세대주1,세대원②',40) END ) AS HOL_YN_1 
		    FROM
		    (
		      SELECT 
		        A.CHI_CNT,A.PIS_YY,
		        A.ENO_NO, A.PIS_MM,A.OCC_CD,
		        A.GBN_TAG,A.MDPT_CD,
		        A.MJOB_CD,A.MHOB_CD,A.SOU_CNT,
		        A.DFM_CNT,A.TRB_CNT,
		        A.GOL_CNT,A.WCT_CNT,
		        A.MHS_TAG,A.LIN_AMT,A.LMA_AMT,
		
		        A.LHO_AMT,A.LHP_AMT,A.LHR_AMT,
		
		        A.CLS_TAG,A.DOMW_DD,A.OUTW_DD,
		        A.TOTW_DD,A.DOMT_AMTS,A.OUTT_AMTS,
		        A.SALT_AMTS,A.SALT_AMTT,
		        A.PAYD_AMTS,A.PAYO_AMTS,
		        A.TAX_INCOME,A.YAB_INCOME,A.FREE_INCOME,
		        A.ITXD_AMT,A.STAX_DED,
		        A.INCM_TAX,A.CITI_TAX,
		        A.HINU_AMT + A.OLD_AMT HINU_AMT,
		        A.NPEN_AMT,A.HINS_AMT,A.MGR_AMT,A.MNI_AMT,
		        A.BADD_AMT,A.SPSB_AMT,A.GDED_AMT,A.GOL_AMT,
		        A.TBL_DED,A.WDD_AMT,
		        A.PER_TOT,A.MIN_DED,A.MMA_DED,A.EDU_DED,
		        A.CPC_DED,A.NSE_TOT,A.PER_DED,
		        A.INDED_TOT,A.DON_FWD,
		        A.TTAX_STD,A.TAX_AMT,
		        A.HGR_DED,A.OTX_DED,A.TAX_DED,A.TDED_TOT,
		        
		        A.DGG_TAX,A.DJM_TAX,A.DBW_TAX,
		        A.AGG_TAX,A.AJM_TAX,A.CONT_TAX,
		        A.DRE_INTX,A.DRE_CTTX,A.DRE_DFTX,
		        
		        A.CARD_DED,A.CARD_AMT,A.SAJU_DED,A.LSS_DED,
		        A.LIN_DED-A.HINU_AMT-A.HINS_AMT AS LIN_DED,
		        A.VEN_AMT,
		        A.VEN_DED,
		
		        A.LIH_AMT,
		        A.GRA_AMT,A.ANN_AMT,
		        A.LIH_DED,
		        A.NPEN_DED,
		        A.ANN_DED,
		        A.DCIRP_DED,    
		        A.HAN_AMT,
		        A.AGE_AMT,
		        CASE WHEN A.NSE_TOT > 0 THEN 0
		                ELSE LEAST(A.MNI_AMT-(A.PER_TOT+A.NPEN_DED+A.MIN_DED+A.MMA_DED+A.EDU_DED+A.LOAN_DED+A.LONG_DED+A.CPC_DED), 1000000) END STA_TOT,
		        A.VEN2_AMT,A.HED_AMT,A.MHEA_AMT,A.OHEA_AMT,
		        A.LEN_AMT2,A.LEN_AMT3,A.LEN_AMT4,A.LEN_AMT5,
		        A.EDU_TAG1,A.EDU_AMT1,
		        A.EDU_TAG2,A.EDU_AMT2,
		        A.EDU_TAG3,A.EDU_AMT3,
		        A.EDU_TAG4,A.EDU_AMT4,
		        A.EDU_TAG5,A.EDU_AMT5,A.FUN_CNT,
		        A.GOL_CNT70,A.GOL_AMT70,
		        A.CHI_DED,A.HIG_DED,A.UNI_DED,A.SEA_FREE,
		        A.CASH_AMT,
		        
		        A.GOV_DED,A.GOV2_DED,
		        A.LC1_DED,A.LC23_DED,
		                
		        A.IPT_MAN,A.IPT_YMD,A.UPT_MAN,A.UPT_YMD,A.TAX_DPT,
		        
		        B.JAO_NO AS JAO_NO1, B.JAS_NM AS JAS_NM1, NVL(B.JAA_AMT,0) AS JAA_AMT1 ,
		        NVL(B.JAB_AMT,0) AS JAB_AMT1,NVL(B.JAC_AMT,0) AS JAC_AMT1,NVL(B.JAD_AMT,0) AS JAD_AMT1,
		        NVL(B.JAE_AMT,0) AS JAE_AMT1,NVL(B.JAF_AMT,0) AS JAF_AMT1, NVL(B.JAG_AMT,0) AS JAG_AMT1,
		        NVL(B.JAH_AMT,0) AS JAH_AMT1,NVL(B.JAJ_AMT,0) AS JAJ_AMT1, NVL(B.JAK_AMT,0) AS JAK_AMT1,
		        NVL(B.JAL_AMT,0) AS JAL_AMT1,NVL(B.JAN_AMT,0) AS JAN_AMT1,NVL(B.JAM_AMT,0) AS JAM_AMT1,
		        NVL(B.JAP_AMT,0) AS JAP_AMT1, NVL(B.JAQ_AMT,0) AS JAQ_AMT1,NVL(B.SEQ_NO,0) AS SEQ_NO1,NVL(B.JAI_AMT,0) AS JAI_AMT1,
		        
		        C.JAO_NO AS JAO_NO2, C.JAS_NM AS JAS_NM2, NVL(C.JAA_AMT,0) AS JAA_AMT2 ,NVL(C.JAB_AMT,0) AS JAB_AMT2,
		        NVL(C.JAC_AMT,0) AS JAC_AMT2,NVL(C.JAD_AMT,0) AS JAD_AMT2,
		        NVL(C.JAE_AMT,0) AS JAE_AMT2,NVL(C.JAF_AMT,0) AS JAF_AMT2, NVL(C.JAG_AMT,0) AS JAG_AMT2,
		        NVL(C.JAH_AMT,0) AS JAH_AMT2,NVL(C.JAJ_AMT,0) AS JAJ_AMT2, NVL(C.JAK_AMT,0) AS JAK_AMT2,
		        NVL(C.JAL_AMT,0) AS JAL_AMT2,NVL(C.JAN_AMT,0) AS JAN_AMT2,NVL(C.JAM_AMT,0) AS JAM_AMT2,
		        NVL(C.JAP_AMT,0) AS JAP_AMT2, NVL(C.JAQ_AMT,0) AS JAQ_AMT2,NVL(C.SEQ_NO,0) AS SEQ_NO2,NVL(C.JAI_AMT,0) AS JAI_AMT2,
		        
		        D.JAO_NO AS JAO_NO3, D.JAS_NM AS JAS_NM3, NVL(D.JAA_AMT,0) AS JAA_AMT3, NVL(D.JAB_AMT,0) AS JAB_AMT3,
		        NVL(D.JAC_AMT,0) AS JAC_AMT3,NVL(D.JAD_AMT,0) AS JAD_AMT3,
		        NVL(D.JAE_AMT,0) AS JAE_AMT3,NVL(D.JAF_AMT,0) AS JAF_AMT3, NVL(D.JAG_AMT,0) AS JAG_AMT3,
		        NVL(D.JAH_AMT,0) AS JAH_AMT3,NVL(D.JAJ_AMT,0) AS JAJ_AMT3, NVL(D.JAK_AMT,0) AS JAK_AMT3,
		        NVL(D.JAL_AMT,0) AS JAL_AMT3,NVL(D.JAN_AMT,0) AS JAN_AMT3,NVL(D.JAM_AMT,0) AS JAM_AMT3,
		        NVL(D.JAP_AMT,0) AS JAP_AMT3, NVL(D.JAQ_AMT,0) AS JAQ_AMT3,NVL(D.SEQ_NO,0) AS SEQ_NO3,NVL(D.JAI_AMT,0) AS JAI_AMT3,
		  	  	A.ONE_AMT,  
		        CASE WHEN A.LH4_AMT > 0 AND  A.ENO_NO = '2050037' THEN 943820 
		             WHEN A.LH4_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG4_DED,
		        CASE WHEN A.LH5_AMT > 0 AND  A.ENO_NO = '1990042' THEN 10000000 
		        	 WHEN A.LH5_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG5_DED,
		        CASE WHEN A.LH6_AMT > 0 AND  A.ENO_NO = '2050017' THEN 3151210 
		             WHEN A.LH6_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG6_DED,
		        CASE WHEN A.LH7_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG7_DED,
		        CASE WHEN A.LH8_AMT > 0 AND A.ENO_NO = '2050037' THEN 2868989   
		             WHEN A.LH8_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG8_DED,
		        CASE WHEN A.LH9_AMT > 0  AND A.ENO_NO ='1990042' THEN 702320 
		             WHEN A.LH9_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG9_DED,   
		        CASE WHEN A.LH10_AMT > 0 AND  A.ENO_NO = '2050017' THEN 886493   
		             WHEN A.LH10_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG10_DED,
		        CASE WHEN A.LH11_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG11_DED,   
		        CASE WHEN A.LH12_AMT > 0 THEN A.LONG_DED ELSE 0 END LONG12_DED,   
		        A.ETC_TOT, A.INDED_EXC,		
		  		    A.SAVE_DED,
				    A.SAVE1_DED, 
				    A.SAVE2_DED, 
				    A.SAVE3_DED,  
				    A.LOAN_DED,
				    A.PLOAN_DED,
				    A.MRENT_DED, 
				    A.LONG_DED,
		        (F.ADR_CT  || ' ' || F.ADDRESS ) AS ADDRESS_HOME,
		        F.CET_NO,SUBSTR(F.CET_NO,1,7) ||'  '||SUBSTR(F.CET_NO,8,14) AS CET_NO2,
		        F.HIR_YMD,F.RET_YMD,
		        A.HOL_YN,
		        RPAD('( 소득자 보관용 )',40) AS HTITLE ,   TO_CHAR(SYSDATE,'YYYYMMDD') AS CURDT,
		        NVL(A.TAX_INCOME,0)+ NVL(B.JAA_AMT,0)+NVL(C.JAA_AMT,0)+ NVL(D.JAA_AMT,0) AS SUM_JAA_AMT,
		        NVL(B.JAC_AMT,0)+NVL(C.JAC_AMT,0)+ NVL(D.JAC_AMT,0) AS SUM_JAC_AMT,
		        NVL(A.SEA_FREE,0)+ NVL(B.JAG_AMT,0)+NVL(C.JAG_AMT,0)+ NVL(D.JAG_AMT,0) AS SUM_JAG_AMT
		        --NVL(A.REA_TAX,0) AS REA_TAX,NVL(A.REB_TAX,0) AS REB_TAX,NVL(A.REC_TAX,0) AS REC_TAX 
		        FROM ASNHR.T_AC_RETACC_15 A
		        LEFT OUTER JOIN ASNHR.T_AC_DUTYPLACE B ON B.ENO_NO = A.ENO_NO AND B.PIS_YY = A.PIS_YY AND B.SEQ_NO='1'
		        LEFT OUTER JOIN ASNHR.T_AC_DUTYPLACE C ON C.ENO_NO = A.ENO_NO AND C.PIS_YY = A.PIS_YY AND C.SEQ_NO='2'
		        LEFT OUTER JOIN ASNHR.T_AC_DUTYPLACE D ON D.ENO_NO = A.ENO_NO AND D.PIS_YY = A.PIS_YY AND D.SEQ_NO='3'
		        LEFT OUTER JOIN ASNHR.T_CM_PERSON F ON A.ENO_NO = F.ENO_NO
		       WHERE  A.PIS_YY = ?
		         AND NVL(A.ENO_NO,' ')  LIKE  '%'||?||'%'    --2140021  3140018  2140029
		    ) MAIN
		    INNER JOIN ASNHR.T_CM_PERSON PERSON ON MAIN.ENO_NO = PERSON.ENO_NO
		    LEFT OUTER JOIN (SELECT '2015'||'/01/01' AS SDATE , TO_CHAR(RET_YMD,'YYYY/MM/DD') AS EDATE, ENO_NO FROM ASNHR.T_CM_PERSON WHERE GUBUN = '01' ) SUB01 ON MAIN.ENO_NO = SUB01.ENO_NO
		    LEFT OUTER JOIN ASNHR.T_CM_COMPANY COM ON COM.GUBUN = '01'
		    ORDER BY ASNHR.SF_GET_DPTSEQ('01','A4',PERSON.DPT_CD), ASNHR.SF_GET_COMMSEQ('01','A2',PERSON.JOB_CD), PERSON.HOB_CD DESC
            ]]>
        </query>
    </sql>
    
     <!-- 연말정산결과조회 출력 3page-->
    <sql name="YACA050_PRT_142_3">
        <description> 연말정산결과조회 출력 3page</description>
        <query>
            <![CDATA[
       		SELECT 
			       REL_CD,
						 (CASE WHEN SUBSTR(cet_no,7,1)='1' OR SUBSTR(cet_no,7,1)='2' OR SUBSTR(cet_no,7,1)='3' OR SUBSTR(cet_no,7,1)='4' THEN '1' ELSE '9' END ) AS TYPE,
						 NAM_KOR AS FAM_NM,
						 CET_NO,
			       BAS_MAN,
			       GOL_70,
			       CASE WHEN INV_MAN = 0 THEN '' ELSE INV_MAN END TRB_MAN,
			       WCT_MAN,
			       ONE_MAN,  
				   INP_MAN,
				   RCH_MAN,
			       (CASE WHEN REL_CD = 0 THEN (SELECT SUM(NVL(B.JAH_AMT,0) + NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0) + NVL(B.JAP_AMT,0) + NVL(A.HINS_AMT,0)) 
			                                     FROM ASNHR.T_AC_RETACC_14 A, 
			                                         (SELECT ENO_NO, SUM(JAH_AMT) JAH_AMT, SUM(JAP_AMT) JAP_AMT FROM ASNHR.T_AC_DUTYPLACE WHERE PIS_YY = ? GROUP BY ENO_NO ) B 
			                                    WHERE A.ENO_NO = B.ENO_NO(+) AND A.PIS_YY =? AND A.ENO_NO = ?) ELSE 0 END)  AS HIN_SUM,                     
			       NVL(LIN_AMT_NTS, '0') AS LIN_AMT_NTS, 
			       NVL(LIN_AMT, '0') AS LIN_AMT,
			       NVL(LIH_AMT_NTS, '0') AS LIH_AMT_NTS, 
                   NVL(LIH_AMT, '0') AS LIH_AMT,
			       NVL(MED_AMT_NTS, '0')  AS MED_AMT_NTS,
			       NVL(MED_AMT, '0')  AS MED_AMT,                     
			       NVL(EDU_AMT_NTS, '0')  AS EDU_AMT_NTS,
			       NVL(EDU_AMT, '0')  AS EDU_AMT,                     
			       NVL(CARD_AMT_NTS,'0') AS CARD_AMT_NTS,
			       NVL(CARD_AMT,'0') AS CARD_AMT,                     
			       NVL(DIR_CARD_AMT_NTS,'0') AS DIR_CARD_AMT_NTS,
			       NVL(DIR_CARD_AMT,'0') AS DIR_CARD_AMT,                     
			       NVL(CASH_AMT_NTS,'0') AS CASH_AMT_NTS,
			       NVL(CASH_AMT,'0') AS CASH_AMT,                     
			       NVL(MARKET_AMT_NTS,'0')  AS  MARKET_AMT_NTS,            
			       NVL(MARKET_AMT,'0')  AS  MARKET_AMT,                           
			       NVL(PUBLIC_AMT_NTS, '0') AS PUBLIC_AMT_NTS,
			       NVL(PUBLIC_AMT, '0') AS PUBLIC_AMT,                     
			       NVL(GOV_AMT_NTS, '0')+NVL(LC1_AMT_NTS, '0')+NVL(LC2_AMT_NTS, '0')+NVL(LC3_AMT_NTS, '0') AS GIBU_AMT_NTS,
			       NVL(GOV_AMT, '0')+NVL(LC1_AMT, '0')+NVL(LC2_AMT, '0')+NVL(LC3_AMT, '0')  AS GIBU_AMT,
			       ( SELECT NVL(CHI_CNT,'0') FROM ASNHR.T_AC_RETACC_142 WHERE PIS_YY=? AND ENO_NO = ?) AS CHI_CNT
			  FROM ASNHR.T_AC_FAMILY_142 A
			 WHERE PIS_YY = ?
			   AND ENO_NO = ?
			 ORDER BY REL_CD, CET_NO, NAM_KOR
       	
            ]]>
        </query>
    </sql>
    
     <!-- 연말정산결과조회 출력 3page-->
    <sql name="YACA050_PRT_15_3">
        <description> 연말정산결과조회 출력 3page</description>
        <query>
            <![CDATA[
       		SELECT 
			       REL_CD,
						 (CASE WHEN SUBSTR(cet_no,7,1)='1' OR SUBSTR(cet_no,7,1)='2' OR SUBSTR(cet_no,7,1)='3' OR SUBSTR(cet_no,7,1)='4' THEN '1' ELSE '9' END ) AS TYPE,
						 NAM_KOR AS FAM_NM,
						 CET_NO,
			       BAS_MAN,
			       GOL_70,
			       CASE WHEN INV_MAN = 0 THEN '' ELSE INV_MAN END TRB_MAN,
			       WCT_MAN,
			       ONE_MAN,  
				   INP_MAN,
				   RCH_MAN,
			       (CASE WHEN REL_CD = 0 THEN (SELECT SUM(NVL(B.JAH_AMT,0) + NVL(A.HINU_AMT,0) + NVL(A.OLD_AMT,0) + NVL(B.JAP_AMT,0) + NVL(A.HINS_AMT,0)) 
			                                     FROM ASNHR.T_AC_RETACC_14 A, 
			                                         (SELECT ENO_NO, SUM(JAH_AMT) JAH_AMT, SUM(JAP_AMT) JAP_AMT FROM ASNHR.T_AC_DUTYPLACE WHERE PIS_YY = ? GROUP BY ENO_NO ) B 
			                                    WHERE A.ENO_NO = B.ENO_NO(+) AND A.PIS_YY =? AND A.ENO_NO = ?) ELSE 0 END)  AS HIN_SUM,                     
			       NVL(LIN_AMT_NTS, '0') AS LIN_AMT_NTS, 
			       NVL(LIN_AMT, '0') AS LIN_AMT,
			       NVL(LIH_AMT_NTS, '0') AS LIH_AMT_NTS, 
                   NVL(LIH_AMT, '0') AS LIH_AMT,
			       NVL(MED_AMT_NTS, '0')  AS MED_AMT_NTS,
			       NVL(MED_AMT, '0')  AS MED_AMT,                     
			       NVL(EDU_AMT_NTS, '0')  AS EDU_AMT_NTS,
			       NVL(EDU_AMT, '0')  AS EDU_AMT,                     
			       NVL(CARD_AMT_NTS,'0') AS CARD_AMT_NTS,
			       NVL(CARD_AMT,'0') AS CARD_AMT,                     
			       NVL(DIR_CARD_AMT_NTS,'0') AS DIR_CARD_AMT_NTS,
			       NVL(DIR_CARD_AMT,'0') AS DIR_CARD_AMT,                     
			       NVL(CASH_AMT_NTS,'0') AS CASH_AMT_NTS,
			       NVL(CASH_AMT,'0') AS CASH_AMT,                     
			       NVL(MARKET_AMT_NTS,'0')  AS  MARKET_AMT_NTS,            
			       NVL(MARKET_AMT,'0')  AS  MARKET_AMT,                           
			       NVL(PUBLIC_AMT_NTS, '0') AS PUBLIC_AMT_NTS,
			       NVL(PUBLIC_AMT, '0') AS PUBLIC_AMT,                     
			       NVL(GOV_AMT_NTS, '0')+NVL(LC1_AMT_NTS, '0')+NVL(LC2_AMT_NTS, '0')+NVL(LC3_AMT_NTS, '0') AS GIBU_AMT_NTS,
			       NVL(GOV_AMT, '0')+NVL(LC1_AMT, '0')+NVL(LC2_AMT, '0')+NVL(LC3_AMT, '0')  AS GIBU_AMT,
			       ( SELECT NVL(CHI_CNT,'0') FROM ASNHR.T_AC_RETACC_142 WHERE PIS_YY=? AND ENO_NO = ?) AS CHI_CNT
			  FROM ASNHR.T_AC_FAMILY_15 A
			 WHERE PIS_YY = ?
			   AND ENO_NO = ?
			 ORDER BY REL_CD, CET_NO, NAM_KOR
       	
            ]]>
        </query>
    </sql>
    
    
    
    <!-- 연말정산결과조회 출력 4page HEAD-->
    <sql name="YACA050_PRT_142_4">
        <description>연말정산결과조회 출력 4page HEAD</description>
        <query>
            <![CDATA[
       		  SELECT ENO_NM, CET_NO,  (ADR_CT  || ' ' || ADDRESS)  AS ADDRESS_HOME, PHN_NO
       		    FROM ASNHR.T_CM_PERSON 
       		   WHERE  ENO_NO = ?
            ]]>
        </query>
    </sql>
    
    <!-- 연말정산결과조회 출력 4page 퇴직연금-->
    <sql name="YACA050_PRT_142_4_1">
        <description>연말정산결과조회 출력 4page 퇴직연금</description>
        <query>
            <![CDATA[
       		   SELECT ENO_NO, PEN_GUBUN_NM , ABA_NM , ACC_NO , AMOUNT , DED_AMT
			     FROM ASNHR.T_AC_PENSION_14
		        WHERE PIS_YY = ?
  			      AND ENO_NO = ?
  			      AND PEN_TYPE_CD = '1'
  			    ORDER BY PEN_GUBUN_CD, SEQ_NO
            ]]>
        </query>
    </sql>
    
    
     <!-- 연말정산결과조회 출력 4page 연금저축-->
    <sql name="YACA050_PRT_142_4_2">
        <description>연말정산결과조회 출력 4page 연금저축</description>
        <query>
            <![CDATA[
       		   SELECT ENO_NO, PEN_GUBUN_NM , ABA_NM , ACC_NO , AMOUNT , DED_AMT
			     FROM ASNHR.T_AC_PENSION_14
		        WHERE PIS_YY = ?
  			      AND ENO_NO = ?
  			      AND PEN_TYPE_CD = '2'
  			    ORDER BY PEN_GUBUN_CD, SEQ_NO
            ]]>
        </query>
    </sql>
    
     <!-- 연말정산결과조회 출력 4page 주택마련-->
    <sql name="YACA050_PRT_142_4_3">
        <description>연말정산결과조회 출력 4page 주택마련</description>
        <query>
            <![CDATA[
       		   SELECT ENO_NO, PEN_GUBUN_NM , ABA_NM , ACC_NO , AMOUNT , DED_AMT
			     FROM ASNHR.T_AC_PENSION_14
		        WHERE PIS_YY = ?
  			      AND ENO_NO = ?
  			      AND PEN_TYPE_CD = '3'
  			    ORDER BY PEN_GUBUN_CD, SEQ_NO
            ]]>
        </query>
    </sql>
    
    
     <!-- 연말정산결과조회 출력 4page 장기집합-->
    <sql name="YACA050_PRT_142_4_4">
        <description>연말정산결과조회 출력 4page 장기집합</description>
        <query>
            <![CDATA[
       		   SELECT ENO_NO, PEN_GUBUN_NM , ABA_NM , ACC_NO , AMOUNT , DED_AMT
			     FROM ASNHR.T_AC_PENSION_14
		        WHERE PIS_YY = ?
  			      AND ENO_NO = ?
  			      AND PEN_TYPE_CD = '4'
  			    ORDER BY PEN_GUBUN_CD, SEQ_NO
            ]]>
        </query>
    </sql>
    
    <!-- 연말정산결과조회 출력 4page HEAD-->
    <sql name="YACA050_PRT_15_4">
        <description>연말정산결과조회 출력 4page HEAD</description>
        <query>
            <![CDATA[
       		  SELECT ENO_NM, CET_NO,  (ADR_CT  || ' ' || ADDRESS)  AS ADDRESS_HOME, PHN_NO
       		    FROM ASNHR.T_CM_PERSON 
       		   WHERE  ENO_NO = ?
            ]]>
        </query>
    </sql>
    
    <!-- 연말정산결과조회 출력 4page 퇴직연금-->
    <sql name="YACA050_PRT_15_4_1">
        <description>연말정산결과조회 출력 4page 퇴직연금</description>
        <query>
            <![CDATA[
       		   SELECT ENO_NO, PEN_GUBUN_NM , ABA_NM , ACC_NO , AMOUNT , DED_AMT
			     FROM ASNHR.T_AC_PENSION_15
		        WHERE PIS_YY = ?
  			      AND ENO_NO = ?
  			      AND PEN_TYPE_CD = '1'
  			    ORDER BY PEN_GUBUN_CD, SEQ_NO
            ]]>
        </query>
    </sql>
    
    
     <!-- 연말정산결과조회 출력 4page 연금저축-->
    <sql name="YACA050_PRT_15_4_2">
        <description>연말정산결과조회 출력 4page 연금저축</description>
        <query>
            <![CDATA[
       		   SELECT ENO_NO, PEN_GUBUN_NM , ABA_NM , ACC_NO , AMOUNT , DED_AMT
			     FROM ASNHR.T_AC_PENSION_15
		        WHERE PIS_YY = ?
  			      AND ENO_NO = ?
  			      AND PEN_TYPE_CD = '2'
  			    ORDER BY PEN_GUBUN_CD, SEQ_NO
            ]]>
        </query>
    </sql>
    
     <!-- 연말정산결과조회 출력 4page 주택마련-->
    <sql name="YACA050_PRT_15_4_3">
        <description>연말정산결과조회 출력 4page 주택마련</description>
        <query>
            <![CDATA[
       		   SELECT ENO_NO, PEN_GUBUN_NM , ABA_NM , ACC_NO , AMOUNT , DED_AMT
			     FROM ASNHR.T_AC_PENSION_15
		        WHERE PIS_YY = ?
  			      AND ENO_NO = ?
  			      AND PEN_TYPE_CD = '3'
  			    ORDER BY PEN_GUBUN_CD, SEQ_NO
            ]]>
        </query>
    </sql>
    
    
     <!-- 연말정산결과조회 출력 4page 장기집합-->
    <sql name="YACA050_PRT_15_4_4">
        <description>연말정산결과조회 출력 4page 장기집합</description>
        <query>
            <![CDATA[
       		   SELECT ENO_NO, PEN_GUBUN_NM , ABA_NM , ACC_NO , AMOUNT , DED_AMT
			     FROM ASNHR.T_AC_PENSION_15
		        WHERE PIS_YY = ?
  			      AND ENO_NO = ?
  			      AND PEN_TYPE_CD = '4'
  			    ORDER BY PEN_GUBUN_CD, SEQ_NO
            ]]>
        </query>
    </sql>
<!--
***********************************************************************
* @UseCase     : YACA060
* @description : 연금저축공제내역입력
***********************************************************************
* 2010/12/20     박동규        최초작성.
***********************************************************************
-->
    <!-- 연금저축공제내역 조회 -->
    <sql name="YACA060_SHR">
        <description>연금저축공제내역 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY, ENO_NO, PEN_TYPE_CD,PEN_TYPE_NM,
            	   PEN_GUBUN_CD, PEN_GUBUN_NM, SEQ_NO, ABA_CD, ABA_NM,
                   ACC_NO,
                   YEAR_SEQ,
                   AMOUNT,
                   NTS_YN
            FROM   ASNHR.T_AC_PENSION
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ORDER BY PEN_TYPE_CD, PEN_TYPE_NM, NTS_YN, YEAR_SEQ ASC
            ]]>
        </query>
    </sql>


    <!-- 연금저축공제내역 조회 -->
    <sql name="YACA060_SHR_14">
        <description>연금저축공제내역 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY, ENO_NO, PEN_TYPE_CD,PEN_TYPE_NM,
            	   PEN_GUBUN_CD, PEN_GUBUN_NM, SEQ_NO, ABA_CD, ABA_NM,
                   ACC_NO,AMOUNT,NTS_YN
            FROM   ASNHR.T_AC_PENSION_14
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ORDER BY PEN_TYPE_CD, PEN_TYPE_NM, NTS_YN, SEQ_NO  ASC
            ]]>
        </query>
    </sql>
    
    <!-- 연금저축공제내역 조회 -->
    <sql name="YACA060_SHR_15">
        <description>연금저축공제내역 조회</description>
        <query>
            <![CDATA[
            SELECT PIS_YY, ENO_NO, PEN_TYPE_CD,PEN_TYPE_NM,
            	   PEN_GUBUN_CD, PEN_GUBUN_NM, SEQ_NO, ABA_CD, ABA_NM,
                   ACC_NO,AMOUNT,NTS_YN, IN_GB
            FROM   ASNHR.T_AC_PENSION_15
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ORDER BY PEN_TYPE_CD, PEN_TYPE_NM, NTS_YN, SEQ_NO  ASC
            ]]>
        </query>
    </sql>

    <!-- 연금저축공제내역 저장. -->
    <sql name="YACA060_INS">
        <description>연금저축공제내역 저장</description>
        <query>
            <![CDATA[
            INSERT INTO ASNHR.T_AC_PENSION
            ( PIS_YY, ENO_NO, ROW_NUM, PEN_TYPE_CD, PEN_TYPE_NM,
              PEN_GUBUN_CD, PEN_GUBUN_NM, SEQ_NO,
              ABA_CD, ABA_NM, ACC_NO, YEAR_SEQ, AMOUNT, NTS_YN,
              IPT_MAN, IPT_YMD, UPT_MAN, UPT_YMD )
            VALUES
            ( ?     , ?     , NVL((SELECT MAX(TO_NUMBER(ROW_NUM)) + 1 FROM ASNHR.T_AC_PENSION WHERE PIS_YY =? AND ENO_NO = ?),0),    ?      , ?   ,
              ?     , ?     , NVL((SELECT MAX(TO_NUMBER(SEQ_NO)) + 1 FROM ASNHR.T_AC_PENSION WHERE PIS_YY =? AND ENO_NO = ? AND PEN_TYPE_CD = ? AND PEN_GUBUN_CD = ? ),0),
              ?     , ?     , ?     , ?      , ?   ,?   ,
              ?     , SYSDATE, ?   , SYSDATE )
            ]]>
        </query>
    </sql>
    
    <!-- 연금저축공제내역 저장. -->
    <sql name="YACA060_INS_14">
        <description>연금저축공제내역 저장</description>
        <query>
            <![CDATA[
            INSERT INTO ASNHR.T_AC_PENSION_14
            ( PIS_YY, ENO_NO, ROW_NUM, PEN_TYPE_CD, PEN_TYPE_NM,
              PEN_GUBUN_CD, PEN_GUBUN_NM, SEQ_NO,
              ABA_CD, ABA_NM, ACC_NO, AMOUNT, NTS_YN,
              IPT_MAN, IPT_YMD, UPT_MAN, UPT_YMD )
            VALUES
            ( ?     , ?     , NVL((SELECT MAX(TO_NUMBER(ROW_NUM)) + 1 FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY =? AND ENO_NO = ?),0),    ?      , ?   ,
              ?     , ?     , NVL((SELECT MAX(TO_NUMBER(SEQ_NO)) + 1 FROM ASNHR.T_AC_PENSION_14 WHERE PIS_YY =? AND ENO_NO = ? AND PEN_TYPE_CD = ? AND PEN_GUBUN_CD = ? ),0),
              ?     , ?     , ?  ,  ?  ,   ?   ,
              ?     , SYSDATE, ?   , SYSDATE )
            ]]>
        </query>
    </sql>    
    
    <!-- 연금저축공제내역 저장. -->
    <sql name="YACA060_INS_15">
        <description>연금저축공제내역 저장</description>
        <query>
            <![CDATA[
            INSERT INTO ASNHR.T_AC_PENSION_15
            ( PIS_YY, ENO_NO, ROW_NUM, PEN_TYPE_CD, PEN_TYPE_NM,
              PEN_GUBUN_CD, PEN_GUBUN_NM, SEQ_NO,
              ABA_CD, ABA_NM, ACC_NO, AMOUNT, NTS_YN, IN_GB, 
              IPT_MAN, IPT_YMD, UPT_MAN, UPT_YMD )
            VALUES
            ( ?     , ?     , NVL((SELECT MAX(TO_NUMBER(ROW_NUM)) + 1 FROM ASNHR.T_AC_PENSION_15 WHERE PIS_YY =? AND ENO_NO = ?),0),    ?      , ?   ,
              ?     , ?     , NVL((SELECT MAX(TO_NUMBER(SEQ_NO)) + 1 FROM ASNHR.T_AC_PENSION_15 WHERE PIS_YY =? AND ENO_NO = ? AND PEN_TYPE_CD = ? AND PEN_GUBUN_CD = ? ),0),
              ?     , ?     , ?  ,  ?  ,   ?   , ?,
              ?     , SYSDATE, ?   , SYSDATE )
            ]]>
        </query>
    </sql>    

    <!-- 연금저축공제내역 삭제 -->
    <sql name="YACA060_DEL">
        <description>연금저축공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_PENSION
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    PEN_TYPE_CD = ?
            AND    PEN_GUBUN_CD = ?
            AND    ABA_CD = ?
            AND    ACC_NO = ?            
            AND    SEQ_NO = ?
            ]]>
        </query>
    </sql>

    <!-- 연금저축공제내역 삭제 -->
    <sql name="YACA060_DEL_01">
        <description>연금저축공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_PENSION
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>    
    

    <!-- 연금저축공제내역 삭제 -->
    <sql name="YACA060_DEL_14">
        <description>연금저축공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_PENSION_14
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    PEN_TYPE_CD = ?
            AND    PEN_GUBUN_CD = ?
            AND    ABA_CD = ?
            AND    ACC_NO = ?         
            AND    SEQ_NO = ?               
            ]]>
        </query>
    </sql>
    
      <!-- 연금저축공제내역 삭제 -->
    <sql name="YACA060_DEL_15">
        <description>연금저축공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_PENSION_15
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            AND    PEN_TYPE_CD = ?
            AND    PEN_GUBUN_CD = ?
            AND    ABA_CD = ?
            AND    ACC_NO = ?         
            AND    SEQ_NO = ?               
            ]]>
        </query>
    </sql>

    <!-- 연금저축공제내역 삭제 -->
    <sql name="YACA060_DEL2_14">
        <description>연금저축공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_PENSION_14
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>      
    
    <!-- 연금저축공제내역 삭제 -->
    <sql name="YACA060_DEL2_15">
        <description>연금저축공제내역 삭제</description>
        <query>
            <![CDATA[
            DELETE ASNHR.T_AC_PENSION_15
            WHERE  PIS_YY = ?
            AND    ENO_NO = ?
            ]]>
        </query>
    </sql>      
    
    
    <!-- 연금저축공제내역 적용 -->
    <sql name="YACA060_UPT_FAM">
        <description>연금저축공제내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_FAMILY A SET (LHO_AMT_NTS, LHP_AMT_NTS, LHQ_AMT_NTS, LHR_AMT_NTS, LHO_AMT, LHP_AMT, LHQ_AMT, LHR_AMT) =
			(SELECT
			      (SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '31' AND NTS_YN = '1') LHO_AMT_NTS,
			      (SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '32' AND NTS_YN = '1') LHP_AMT_NTS,
			      (SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '33' AND NTS_YN = '1') LHQ_AMT_NTS,
			      (SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '34' AND NTS_YN = '1') LHR_AMT_NTS,
			      (SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '31' AND NTS_YN = '2') LHO_AMT,
			      (SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '32' AND NTS_YN = '2') LHP_AMT,
			      (SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '33' AND NTS_YN = '2') LHQ_AMT,
			      (SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '34' AND NTS_YN = '2') LHR_AMT
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
			  AND A.REL_CD = '0'
            ]]>
        </query>
    </sql>




    <!-- 연금저축공제내역 적용 -->
    <sql name="YACA060_UPT_ACC">
        <description>연금저축공제내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC A SET (LF1_AMT, ANN_AMT, LHO_AMT, LHP_AMT, LHQ_AMT, LHR_AMT, STOCK_AMT1, STOCK_AMT2, STOCK_AMT3) =
			(SELECT
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '21'),0) LF1_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '22'),0) ANN_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '31'),0) LHO_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '32'),0) LHP_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '33'),0) LHQ_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '34'),0) LHR_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '41' AND YEAR_SEQ = '01'),0) STOCK_AMT1,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '41' AND YEAR_SEQ = '02'),0) STOCK_AMT2,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '41' AND YEAR_SEQ = '03'),0) STOCK_AMT3
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
			  AND A.GBN_TAG = '8'
            ]]>
        </query>
    </sql>
    
    
    <!-- 연금저축공제내역 적용 -->
    <sql name="YACA060_UPT_ACC_14">
        <description>연금저축공제내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_14 A SET (PER_AMT, ANN_AMT, LHO_AMT, LHP_AMT,  LHR_AMT,  LSS_AMT) =
			(SELECT
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '21'),0) PER_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '22'),0) ANN_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '31'),0) LHO_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '32'),0) LHP_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '34'),0) LHR_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_14
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '51'),0) LSS_AMT			      
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
			  AND A.GBN_TAG = '8'
            ]]>
        </query>
    </sql>    
    
    
     <!-- 연금저축공제내역 적용 -->
    <sql name="YACA060_UPT_ACC_15">
        <description>연금저축공제내역 반영</description>
        <query>
            <![CDATA[
            UPDATE ASNHR.T_AC_RETACC_15 A SET (DCIRP_AMT, PER_AMT, ANN_AMT, LHO_AMT, LHP_AMT,  LHR_AMT,  LSS_AMT) =
			(SELECT
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD IN('11','12')),0) PER_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '21'),0) PER_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '22'),0) ANN_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '31'),0) LHO_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '32'),0) LHP_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '34'),0) LHR_AMT,
			      NVL((SELECT SUM(NVL(AMOUNT,0))
			      FROM ASNHR.T_AC_PENSION_15
			      WHERE PIS_YY = A.PIS_YY AND ENO_NO = A.ENO_NO AND PEN_GUBUN_CD = '51'),0) LSS_AMT			      
			FROM DUAL)
			WHERE A.PIS_YY = ?
			  AND A.ENO_NO = ?
			  AND A.GBN_TAG = '8'
            ]]>
        </query>
    </sql>    
    
    
    
    
<!--
***********************************************************************
* @UseCase     : YACA070
* @description : 연말정산 개인별상세내역조회
***********************************************************************
* 2015/01/27     이동훈       최초작성
***********************************************************************
-->  
    <!-- 근로소득정산현황 검색 -->
    <sql name="YACA070_SHR">
        <description>개인별상세내역조회</description>
        <query>
            <![CDATA[
          
             SELECT ASNHR.SF_GET_DPTNAME('01', 'A4', PERSON.DPT_CD) AS  DPT_NM
                   ,ACC.ENO_NO
                   ,PERSON.ENO_NM
                   ,PERSON.CET_NO                  
                   ,PERSON.RET_YMD AS RET_YN
                   ,SUBSTR(PERSON.RET_YMD,1,4)||SUBSTR(PERSON.RET_YMD,5,2)||SUBSTR(PERSON.RET_YMD,7,2) AS RET_YMD                      
                   ,ASNHR.SF_GET_COMMNAME('01', 'A2', PERSON.JOB_CD) AS JOB_NM

                   ,NVL(ACC.TAX_INCOME, 0)+NVL(ACC.YAB_INCOME, 0) AS TAX_INCOME
                   ,NVL(ACC.MGR_AMT, 0)     AS MGR_AMT
                   ,NVL(ACC.MNI_AMT, 0)     AS MNI_AMT
                   ,NVL(ACC.BADD_AMT, 0)    AS BADD_AMT
                   ,NVL(ACC.SPSB_AMT, 0)    AS SPSB_AMT

                   ,NVL(ACC.GDED_AMT, 0)    AS GDED_AMT

                   ,NVL(ACC.GOL_AMT, 0)     AS GOL_AMT

                   ,NVL(ACC.TBL_DED, 0)     AS TBL_DED
                   ,NVL(ACC.WDD_AMT, 0)     AS WDD_AMT
                   ,NVL(ACC.OTX_DED, 0)     AS OTX_DED
                   ,NVL(ACC.NPEN_DED, 0)     AS NPEN_DED                   
                   ,NVL(ACC.HINS_DED, 0) + NVL(ACC.HINU_DED, 0) AS HIN_DED

                   ,NVL(ACC.LOAN_DED, 0)     AS LOAN_DED
                   ,NVL(ACC.LONG_DED, 0)     AS LONG_DED
                   ,NVL(ACC.DON_FWD, 0)     AS DON_FWD                   
                   ,NVL(ACC.VEN_DED, 0)     AS VEN_DED
                   ,NVL(ACC.INDED_TOT, 0)     AS INDED_TOT

                   ,NVL(ACC.PER_DED, 0)     AS PER_DED
                   ,NVL(ACC.SAVE_DED, 0)     AS SAVE_DED
                   ,NVL(ACC.CARD_DED, 0)     AS CARD_DED
                   ,NVL(ACC.SAJU_DED, 0)     AS SAJU_DED
                   ,NVL(ACC.LSS_DED, 0)     AS LSS_DED
                   ,NVL(ACC.INDED_EXC, 0)   AS INDED_EXC
                   ,NVL(ACC.TTAX_STD, 0)     AS TTAX_STD
                   ,NVL(ACC.TAX_AMT, 0)     AS TAX_AMT
                   

                   ,NVL(ACC.HGR_DED, 0)     AS HGR_DED
                   ,NVL(ACC.AGE_AMT, 0)     AS AGE_AMT
                   ,NVL(ACC.ANN_DED, 0)    AS ANN_DED
                   ,NVL(ACC.MIN_DED, 0)    AS MIN_DED
                   ,NVL(ACC.MMA_DED, 0)    AS MMA_DED
                   ,NVL(ACC.EDU_DED, 0)     AS EDU_DED
                   ,0     AS GOV1_DED
                   ,0     AS GOV2_DED
                   ,0     AS LC1_DED
                   ,0     AS LC23_DED
                   ,NVL(ACC.CPC_DED, 0)     AS CPC_DED
                   ,NVL(ACC.NSE_TOT, 0)     AS NSE_TOT
                   ,NVL(ACC.STA_TOT, 0)     AS STA_TOT
                   ,NVL(ACC.MRENT_DED, 0)   AS MRENT_DED
                   ,NVL(ACC.TDED_TOT, 0)   AS TDED_TOT

                   ,NVL(ACC.DGG_TAX, 0)    AS DGG_TAX
                   ,NVL(ACC.DJM_TAX, 0)    AS DJM_TAX
                   ,NVL(ACC.DBW_TAX, 0)    AS DBW_TAX
                   
                   ,NVL(ACC.AGG_TAX, 0)    AS AGG_TAX
                   ,NVL(ACC.AJM_TAX, 0)    AS AJM_TAX
                   ,NVL(ACC.CONT_TAX, 0)    AS CONT_TAX

                   ,NVL(ACC.DRE_INTX, 0)    AS DRE_INTX
                   ,NVL(ACC.DRE_CTTX, 0)    AS DRE_CTTX
                   ,NVL(ACC.DRE_DFTX, 0)    AS DRE_DFTX
               FROM ASNHR.T_AC_RETACC_14 ACC
                   ,T_CM_PERSON PERSON

              WHERE ACC.PIS_YY      = ?
                AND ACC.PIS_MM      = ?
                AND ACC.ENO_NO   LIKE ?||'%'
                [1]             
                AND PERSON.ENO_NO   = ACC.ENO_NO
           ORDER BY PERSON.JOB_CD, ACC.ENO_NO
            ]]>
        </query>
    </sql>
    
    <!-- 근로소득정산현황 검색 -->
    <sql name="YACA070_SHR_142">
        <description>개인별상세내역조회</description>
        <query>
            <![CDATA[
          
             SELECT ASNHR.SF_GET_DPTNAME('01', 'A4', PERSON.DPT_CD) AS  DPT_NM
                   ,ACC.ENO_NO
                   ,PERSON.ENO_NM
                   ,PERSON.CET_NO                  
                   ,PERSON.RET_YMD AS RET_YN
                   ,SUBSTR(PERSON.RET_YMD,1,4)||SUBSTR(PERSON.RET_YMD,5,2)||SUBSTR(PERSON.RET_YMD,7,2) AS RET_YMD                      
                   ,ASNHR.SF_GET_COMMNAME('01', 'A2', PERSON.JOB_CD) AS JOB_NM

                   ,NVL(ACC.TAX_INCOME, 0)+NVL(ACC.YAB_INCOME, 0) AS TAX_INCOME
                   ,NVL(ACC.MGR_AMT, 0)     AS MGR_AMT
                   ,NVL(ACC.MNI_AMT, 0)     AS MNI_AMT
                   ,NVL(ACC.BADD_AMT, 0)    AS BADD_AMT
                   ,NVL(ACC.SPSB_AMT, 0)    AS SPSB_AMT

                   ,NVL(ACC.GDED_AMT, 0)    AS GDED_AMT

                   ,NVL(ACC.GOL_AMT, 0)     AS GOL_AMT

                   ,NVL(ACC.TBL_DED, 0)     AS TBL_DED
                   ,NVL(ACC.WDD_AMT, 0)     AS WDD_AMT
                   ,NVL(ACC.OTX_DED, 0)     AS OTX_DED
                   ,NVL(ACC.NPEN_DED, 0)     AS NPEN_DED                   
                   ,NVL(ACC.HINS_DED, 0) + NVL(ACC.HINU_DED, 0) AS HIN_DED

                   ,NVL(ACC.LOAN_DED, 0)     AS LOAN_DED
                   ,NVL(ACC.LONG_DED, 0)     AS LONG_DED
                   ,NVL(ACC.DON_FWD, 0)     AS DON_FWD                   
                   ,NVL(ACC.VEN_DED, 0)     AS VEN_DED
                   ,NVL(ACC.INDED_TOT, 0)     AS INDED_TOT

                   ,NVL(ACC.PER_DED, 0)     AS PER_DED
                   ,NVL(ACC.SAVE_DED, 0)     AS SAVE_DED
                   ,NVL(ACC.CARD_DED, 0)     AS CARD_DED
                   ,NVL(ACC.SAJU_DED, 0)     AS SAJU_DED
                   ,NVL(ACC.LSS_DED, 0)     AS LSS_DED
                   ,NVL(ACC.INDED_EXC, 0)   AS INDED_EXC
                   ,NVL(ACC.TTAX_STD, 0)     AS TTAX_STD
                   ,NVL(ACC.TAX_AMT, 0)     AS TAX_AMT
                   

                   ,NVL(ACC.HGR_DED, 0)     AS HGR_DED
                   ,NVL(ACC.AGE_AMT, 0)     AS AGE_AMT
                   ,NVL(ACC.AGE_RCH, 0)     AS AGE_RCH
                   ,NVL(ACC.AGE_INP, 0)     AS AGE_INP                                      
                   ,NVL(ACC.ANN_DED, 0)    AS ANN_DED
                   ,NVL(ACC.MIN_DED, 0)    AS MIN_DED
                   ,NVL(ACC.MMA_DED, 0)    AS MMA_DED
                   ,NVL(ACC.EDU_DED, 0)     AS EDU_DED
                   ,0     AS GOV1_DED
                   ,0     AS GOV2_DED
                   ,0     AS LC1_DED
                   ,0     AS LC23_DED
                   ,NVL(ACC.CPC_DED, 0)     AS CPC_DED
                   ,NVL(ACC.NSE_TOT, 0)     AS NSE_TOT
                   ,NVL(ACC.STA_TOT, 0)     AS STA_TOT
                   ,NVL(ACC.MRENT_DED, 0)   AS MRENT_DED
                   ,NVL(ACC.TDED_TOT, 0)   AS TDED_TOT

                   ,NVL(ACC.DGG_TAX, 0)    AS DGG_TAX
                   ,NVL(ACC.DJM_TAX, 0)    AS DJM_TAX
                   ,NVL(ACC.DBW_TAX, 0)    AS DBW_TAX
                   
                   ,NVL(ACC.AGG_TAX, 0)    AS AGG_TAX
                   ,NVL(ACC.AJM_TAX, 0)    AS AJM_TAX
                   ,NVL(ACC.CONT_TAX, 0)    AS CONT_TAX

                   ,NVL(ACC.DRE_INTX, 0)    AS DRE_INTX
                   ,NVL(ACC.DRE_CTTX, 0)    AS DRE_CTTX
                   ,NVL(ACC.DRE_DFTX, 0)    AS DRE_DFTX
                   
                   ,nvl(ACC.REA_TAX,0) REA_TAX
                   ,nvl(ACC.REB_TAX,0) REB_TAX
                   ,nvl(ACC.REC_TAX,0) REC_TAX                  
                   ,(nvl(ACC.REA_TAX,0) + nvl(ACC.REB_TAX,0) + nvl(ACC.REC_TAX,0)) AS RED_TAX
                   ,(nvl(ACC.REA_TAX,0) - nvl(ACC.DRE_INTX,0))  AS CEA_TAX  
                   ,(nvl(ACC.REB_TAX,0) - nvl(ACC.DRE_CTTX,0))  AS CEB_TAX 
                   ,(nvl(ACC.REC_TAX,0) - nvl(ACC.DRE_DFTX,0))  AS CEC_TAX                                                  
                   ,((nvl(ACC.REA_TAX,0) + nvl(ACC.REB_TAX,0) + nvl(ACC.REC_TAX,0)) - (nvl(ACC.DRE_INTX,0) + nvl(ACC.DRE_CTTX,0) + nvl(ACC.DRE_DFTX,0))) AS CED_TAX                             
                   
               FROM ASNHR.T_AC_RETACC_142 ACC
                   ,ASNHR.T_CM_PERSON PERSON

              WHERE ACC.PIS_YY      = ?
                AND ACC.PIS_MM      = ?
                AND ACC.ENO_NO   LIKE ?||'%'
                [1]             
                AND PERSON.ENO_NO   = ACC.ENO_NO
                AND ACC.ENO_NO IN (
										'1990033','1990040','1990041','1990044','1990089','1990104','1990105',
										'2000023','2010005','2010012','2020005','2020008','2020009','2020011','2020013','2020016','2020025','2020030',
										'2030002','2030005','2030007','2030009',
										'2040001','2040006','2040012','2040013','2040020','2040023','2040024','2040025','2040038','2040042',
										'2040046','2040066','2040067','2040068','2040070','2040071','2040076','2040078','2040080','2040081',
										'2050004','2050009','2050010','2050012','2050013','2050014','2050015','2050017','2050019','2050022','2050023','2050026',
										'2050029','2050030','2050032','2050033','2050036','2050039','2050042','2050046','2050050','2050053','2050056','2050060','2050063',
										'2060004','2060005','2060007','2060009','2060017','2060024','2060026','2060027',
										'2070007','2070016','2070018','2070019','2070021','2070026','2070027','2070030','2070039','2070043',
										'2080003','2080007','2080009','2080012','2080018','2080019','2080021','2080025','2080028','2080031','2080033','2080046',
										'2090002','2090011','2100002','2100003','2100004','2100007','2100016',
										'2110003','2110005','2110007','2110013','2110014','2110016','2110017',
										'2120003','2120007','2120008','2120026','2120029','2120030','2120032','2120033',
										'2130003','2130004','2130005','2130006','2130008','2130010','2130012','2130013','2130015','2130019','2130020','2130021','2130025',
										'2130026','2130027','2130028','2130030','2130033','2130035','2130037','2130039','2130041','2130043','2130045',
										'2140001','2140003','2140004','2140007','2140008','2140009','2140010','2140011','2140012','2140013','2140014','2140015',
										'2140018','2140019','2140021','2140022','2140023','2140025','2140027','2140028','2140032','2140033','2140034',
										'3110012','3120014','3120023','3130008','3130009','3130013','3140010','3140017','3140026'       
                )
           ORDER BY PERSON.JOB_CD, ACC.ENO_NO
            ]]>
        </query>
    </sql>    
    
<!--
***********************************************************************
* @UseCase     : YACA080
* @description : 연말정산 개인별조회
***********************************************************************
* 2015/01/27     이동훈       최초작성
***********************************************************************
-->    
    <!-- 연말정산 개인별조회 -->
    <sql name="YACA080_SHR">
        <description>연말정산 개인별조회</description>
        <query>
            <![CDATA[
			SELECT A.ENO_NO, B.ENO_NM,B.CET_NO,
					B.HEAD_CD,  	
					B.DPT_CD,  
					B.TEAM_CD,  
                    DECODE(SF_GET_DPTNAME('01', 'A4', DPT_CD), DPT_CD, DECODE(SF_GET_DPTNAME('01', 'A6', TEAM_CD), TEAM_CD, 
                    ASNHR.SF_GET_DPTNAME('01', 'B2', HEAD_CD), ASNHR.SF_GET_DPTNAME('01', 'A6', DPT_CD)) , ASNHR.SF_GET_DPTNAME('01', 'A4', DPT_CD))  AS DPT_NM,					
				    DECODE(SF_GET_DPTNAME('01', 'A6', B.TEAM_CD), B.TEAM_CD, 
					SF_GET_DPTNAME('01', 'A4', B.DPT_CD), ASNHR.SF_GET_DPTNAME('01', 'A6', B.TEAM_CD)) AS TEAM_NM,
                    B.JOB_CD,  ASNHR.SF_GET_COMMNAME('01', 'A2', B.JOB_CD) AS JOB_NM,
                    (A.MGR_AMT+A.MNI_AMT+A.FREE_INCOME) AS SALT_AMTT,
                    A.FREE_INCOME, 
                    (A.MGR_AMT+A.MNI_AMT) AS TAX_INCOME,
                    A.MGR_AMT, 
                    A.MNI_AMT, 
                    GREATEST(A.MNI_AMT - A.INDED_TOT, 0) AS MNI_TOT,
                    A.TAX_AMT,
                    A.TDED_TOT,
                    A.DGG_TAX,A.DJM_TAX, A.DGG_TAX+A.DJM_TAX AS DGG_DJM,
                    A.AGG_TAX,A.AJM_TAX, A.AGG_TAX+A.AJM_TAX AS AGG_AJM,
                    A.DRE_INTX,A.DRE_CTTX,
                    (A.DRE_INTX + A.DRE_CTTX) AS RET_SUM                  
			FROM   ASNHR.T_AC_RETACC_14 A, ASNHR.T_CM_PERSON B
			WHERE A.PIS_YY = '2014'
			 AND A.ENO_NO = B.ENO_NO
		     AND NVL(A.MDPT_CD,' ') LIKE '%'||?||'%'
		     AND NVL(A.ENO_NO,' ') LIKE '%'||?||'%'		     
			ORDER BY B.HEAD_CD, B.DPT_CD DESC, B.TEAM_CD, B.JOB_CD, B.ENO_NO
            ]]>
        </query>
    </sql>    
    
    
      <!-- 연말정산 개인별조회 -->
    <sql name="YACA080_SHR_15">
        <description>연말정산 개인별조회</description>
        <query>
            <![CDATA[
			SELECT A.ENO_NO, B.ENO_NM,B.CET_NO, 
					B.HEAD_CD,  	
					B.DPT_CD,  
					B.TEAM_CD,  
                    B.RET_YMD AS RET_YN,
                    SUBSTR(B.RET_YMD,1,4)||SUBSTR(B.RET_YMD,5,2)||SUBSTR(B.RET_YMD,7,2) AS RET_YMD,  					
                    DECODE(SF_GET_DPTNAME('01', 'A4', DPT_CD), DPT_CD, DECODE(SF_GET_DPTNAME('01', 'A6', TEAM_CD), TEAM_CD, 
                    ASNHR.SF_GET_DPTNAME('01', 'B2', HEAD_CD), ASNHR.SF_GET_DPTNAME('01', 'A6', DPT_CD)) , ASNHR.SF_GET_DPTNAME('01', 'A4', DPT_CD))  AS DPT_NM,					
				    DECODE(SF_GET_DPTNAME('01', 'A6', B.TEAM_CD), B.TEAM_CD, 
					SF_GET_DPTNAME('01', 'A4', B.DPT_CD), ASNHR.SF_GET_DPTNAME('01', 'A6', B.TEAM_CD)) AS TEAM_NM,
                    B.JOB_CD,  ASNHR.SF_GET_COMMNAME('01', 'A2', B.JOB_CD) AS JOB_NM,
                    (A.MGR_AMT+A.MNI_AMT+A.FREE_INCOME) AS SALT_AMTT,
                    A.FREE_INCOME, 
                    (A.MGR_AMT+A.MNI_AMT) AS TAX_INCOME,
                    A.MGR_AMT, 
                    A.MNI_AMT, 
                    GREATEST(A.MNI_AMT - A.INDED_TOT, 0) AS MNI_TOT,
                    A.TAX_AMT,
                    A.TDED_TOT,
                    A.DGG_TAX,A.DJM_TAX, A.DGG_TAX+A.DJM_TAX AS DGG_DJM,
                    A.AGG_TAX,A.AJM_TAX, A.AGG_TAX+A.AJM_TAX AS AGG_AJM,
                    A.DRE_INTX,A.DRE_CTTX,
                    (A.DRE_INTX + A.DRE_CTTX) AS RET_SUM, 
                    CASE WHEN A.INS_TAG ='Y' THEN '분납신청      ' ELSE '       '  END AS INS_TAG_NM                         
			FROM   ASNHR.T_AC_RETACC_15 A, ASNHR.T_CM_PERSON B
			WHERE A.PIS_YY = '2015'
			 AND A.ENO_NO = B.ENO_NO
		     AND NVL(A.MDPT_CD,' ') LIKE '%'||?||'%'
		     AND NVL(A.ENO_NO,' ') LIKE '%'||?||'%'		     
			ORDER BY B.HEAD_CD, B.DPT_CD DESC, B.TEAM_CD, B.JOB_CD, B.ENO_NO
            ]]>
        </query>
    </sql>    
    
<!--
***********************************************************************
* @UseCase     : YACA090
* @description : 연말정산계산처리(미사용부분 프로시저 처리로 변경)
***********************************************************************
* 2015/01/27     이동훈       최초작성
***********************************************************************
-->
    <!-- 작업 현황 검색 -->
    <sql name="YACA090_SHR_LOG">
        <description>작업 현황 검색</description>
        <query>
            <![CDATA[
             SELECT PIS_YY
                  , PIS_MM
                  , PRO_STS
                  , DECODE(PRO_STS ,'1' ,'작업시작'
                                   ,'2' ,'대상자선정'
                                   ,'3' ,'정산계산'
                                   ,'4' ,'작업완료'
                                   ,'5' ,'대상자선정 초기화'
                                   ,'6' ,'정산계산 초기화')    AS PRO_STS_MSG
                  , NVL(PRO_CNT, 0)                     AS PRO_CNT
                  , NVL(ERR_CNT, 0)                     AS ERR_CNT
               FROM ASNHR.T_CP_WORKLOG
              WHERE 
              		PIS_YY  = ? AND PIS_MM  = ? AND SAL_GBN = '8'
           ORDER BY PIS_YY DESC, PIS_MM DESC
            ]]>
        </query>
    </sql>
    
    
    <!--
***********************************************************************
* @UseCase     : YACA099
* @description : 연말정산 신용카드 업로드 
***********************************************************************
* 2016/01/07     정영식       최초작성
***********************************************************************
-->    
    <!-- 연말정산 개인별조회 -->
    <sql name="YACA099_SHR_FAM">
        <description>연말정산 신용카드 임시테이블</description>
        <query>
            <![CDATA[
			SELECT PIS_YY,ENO_NO,NAM_KOR,CET_NO,SEQ_NO, 
			       CARD_AMT_NTS,    DIR_CARD_AMT_NTS, CASH_AMT_NTS,  MARKET_AMT_NTS,    PUBLIC_AMT_NTS,	
			       CARD_2015_FH_AMT,CARD_2015_SH_AMT, CARD_2015_AMT, CARD_2015_FH_OVER,	CARD_2015_SH_OVER,	
			       CARD_2013_AMT,	CARD_2014_AMT,    CARD_2013_OVER,CARD_2014_OVER,	
			       IPT_MAN,	IPT_YMD,	UPT_MAN,	UPT_YMD, FILE_SEQ,
			       FORM_CD, GB_CD, 
			       TOT_AMT, MARKET_TOT_AMT, TMONEY_TOT_AMT,
			       CF_TOT_AMT, CF_MARKET_TOT_AMT, CF_TMONEY_TOT_AMT,
			       CS_TOT_AMT, CS_MARKET_TOT_AMT, CS_TMONEY_TOT_AMT,
			       PR_TOT_AMT, PR_MARKET_TOT_AMT, PR_TMONEY_TOT_AMT,
			       FT_TOT_AMT, FT_MARKET_TOT_AMT, FT_TMONEY_TOT_AMT,
			       LOCK_YN
			FROM   ASNHR.T_AC_FAMILY_TEMP_15
		   WHERE PIS_YY =?
			 AND ENO_NO=?
		   ORDER BY SEQ_NO 
            ]]>
        </query>
    </sql>   
    
    
    
     <!-- 신규내역 등록 -->
    <sql name="YACA099_INS_FAM">
        <description>연말정산 신용카드 임시테이블 등록</description>
        <query>
            <![CDATA[
                INSERT INTO ASNHR.T_AC_FAMILY_TEMP_15
                       (SEQ_NO
                       ,PIS_YY
                       ,ENO_NO
                       ,NAM_KOR
                       ,CET_NO
                       ,CARD_AMT_NTS
                       ,DIR_CARD_AMT_NTS
                       ,CASH_AMT_NTS
                       ,MARKET_AMT_NTS                       
                       ,PUBLIC_AMT_NTS                       
                       ,CARD_2015_FH_AMT   
                       ,CARD_2015_SH_AMT   
                       ,CARD_2015_AMT    
                       ,CARD_2015_FH_OVER    
                       ,CARD_2015_SH_OVER   
                       ,CARD_2013_AMT
                       ,CARD_2014_AMT
                       ,CARD_2013_OVER
                       ,CARD_2014_OVER                                               
                       ,FILE_SEQ                                
						,FORM_CD
						,GB_CD
						,TOT_AMT
						,MARKET_TOT_AMT
						,TMONEY_TOT_AMT
						,CS_TOT_AMT
						,CS_MARKET_TOT_AMT
						,CS_TMONEY_TOT_AMT
						,PR_TOT_AMT
						,PR_MARKET_TOT_AMT
						,PR_TMONEY_TOT_AMT
						,FT_TOT_AMT
						,FT_MARKET_TOT_AMT
						,FT_TMONEY_TOT_AMT
						,CF_TOT_AMT
						,CF_MARKET_TOT_AMT
						,CF_TMONEY_TOT_AMT                     
                       ,IPT_MAN
                       ,IPT_YMD
                       ,UPT_MAN
                       ,UPT_YMD)
                VALUES ((SELECT NVL(MAX(SEQ_NO),0) + 1
                           FROM ASNHR.T_AC_FAMILY_TEMP_15
                          WHERE PIS_YY = ?
                            AND ENO_NO = ?)
                       ,?,?,?,?
                       ,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?
                       ,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?
                       ,?,SYSDATE,?,SYSDATE)
            ]]>
        </query>
    </sql> 
    
    <sql name="YACA099_INS_FAM_TEST">
        <description>연말정산 신용카드 임시테이블 등록</description>
        <query>
            <![CDATA[
                INSERT INTO ASNHR.T_AC_FAMILY_TEMP_15
                       (
                        PIS_YY
                       ,ENO_NO
                       ,NAM_KOR
                       ,CET_NO
                       ,CARD_AMT_NTS
                       ,IPT_MAN
                       ,IPT_YMD
                       ,UPT_MAN
                       ,UPT_YMD
                       )
                VALUES (
                       ?,?,?,?,?
                       ,?,SYSDATE,?,SYSDATE)
            ]]>
        </query>
    </sql> 
    
    
    <sql name="YACA099_INS_FAM_TEST2">
        <description>연말정산 신용카드 임시테이블 등록</description>
        <query>
            <![CDATA[
                INSERT INTO TEST
                       (
                        AA
                       ,BB
                       
                       )
                VALUES (
                       ?,?)
            ]]>
        </query>
    </sql> 
    
    
    <!-- 연말정산 개인별조회 -->
    <sql name="YACA099_FAM_UPT_SHR">
        <description>전자문서 파일 연말정산에 반영조회</description>
        <query>
            <![CDATA[
			SELECT PIS_YY, ENO_NO, CET_NO 
			       ,SUM(CASE WHEN FORM_CD ='신용카드'   THEN TOT_AMT ELSE 0 END ) CARD_AMT_NTS      --신용카드
			       ,SUM(CASE WHEN FORM_CD ='직불카드'   THEN TOT_AMT ELSE 0 END ) DIR_CARD_AMT_NTS  --직불카드
			       ,SUM(CASE WHEN FORM_CD ='현금영수증' THEN TOT_AMT ELSE 0 END ) CASH_AMT_NTS       --현금영수증
			       ,SUM( MARKET_TOT_AMT ) MARKET_AMT_NTS                                          --전통시장
			       ,SUM( TMONEY_TOT_AMT ) PUBLIC_AMT_NTS                                          --대중교통 
			       ,SUM(CASE WHEN GB_CD ='1' THEN CF_TOT_AMT+ CF_MARKET_TOT_AMT+CF_TMONEY_TOT_AMT ELSE 0 END )+ SUM(CASE WHEN GB_CD ='1' THEN CS_TOT_AMT+ CS_MARKET_TOT_AMT+CS_TMONEY_TOT_AMT ELSE 0 END ) CARD_2015_AMT
			       ,SUM(CASE WHEN GB_CD ='1' THEN CF_TOT_AMT+ CF_MARKET_TOT_AMT+CF_TMONEY_TOT_AMT ELSE 0 END ) CARD_2015_FH_AMT  --본인 15 상반기 신용카드등
			       ,SUM(CASE WHEN GB_CD ='1' THEN CS_TOT_AMT+ CS_MARKET_TOT_AMT+CS_TMONEY_TOT_AMT ELSE 0 END ) CARD_2015_SH_AMT  --본인 15 하반기 신용카드등
			       ,SUM(CASE WHEN GB_CD ='1' THEN CF_TOT_AMT+ CF_MARKET_TOT_AMT+CF_TMONEY_TOT_AMT ELSE 0 END )- SUM(CASE WHEN GB_CD ='1' AND FORM_CD ='신용카드' THEN CF_TOT_AMT ELSE 0 END ) CARD_2015_FH_OVER --본인 15 상반기 추가공제율
			       ,SUM(CASE WHEN GB_CD ='1' THEN CS_TOT_AMT+ CS_MARKET_TOT_AMT+CS_TMONEY_TOT_AMT ELSE 0 END )- SUM(CASE WHEN GB_CD ='1' AND FORM_CD ='신용카드' THEN CS_TOT_AMT ELSE 0 END ) CARD_2015_SH_OVER --본인 15 하반기 추가공제율
			       ,SUM(CASE WHEN GB_CD ='1' THEN PR_TOT_AMT+ PR_MARKET_TOT_AMT+PR_TMONEY_TOT_AMT ELSE 0 END ) CARD_2014_AMT  --본인 14 신용카드등
			       ,SUM(CASE WHEN GB_CD ='1' THEN FT_TOT_AMT+ FT_MARKET_TOT_AMT+FT_TMONEY_TOT_AMT ELSE 0 END ) CARD_2013_AMT  --본인 13 신용카드등
			       ,SUM(CASE WHEN GB_CD ='1' THEN PR_TOT_AMT+ PR_MARKET_TOT_AMT+PR_TMONEY_TOT_AMT ELSE 0 END )- SUM(CASE WHEN GB_CD ='1' AND FORM_CD ='신용카드' THEN PR_TOT_AMT ELSE 0 END ) CARD_2014_OVER --본인 14 추가공제율
			       ,SUM(CASE WHEN GB_CD ='1' THEN FT_TOT_AMT+ FT_MARKET_TOT_AMT+FT_TMONEY_TOT_AMT ELSE 0 END )- SUM(CASE WHEN GB_CD ='1' AND FORM_CD ='신용카드' THEN FT_TOT_AMT ELSE 0 END ) CARD_2013_OVER --본인 13 추가공제율
			       ,MAX(LOCK_YN) LOCK_YN
			  FROM ASNHR.T_AC_FAMILY_TEMP_15
			 WHERE PIS_YY =?
			   AND ENO_NO =?
			 GROUP BY PIS_YY, ENO_NO, CET_NO
            ]]>
        </query>
    </sql>    
    
    
    <!-- 연말정산 개인별조회 -->
    <sql name="YACA099_RETACC_CARD_UPT">
        <description>전자문서 파일 연말정산에 반영조회</description>
        <query>
            <![CDATA[
			UPDATE ASNHR.T_AC_RETACC_15 A SET 
		       (  A.CARD_AMT
		         ,A.DIR_CARD_AMT
		         ,A.CASH_AMT
		         ,A.MARKET_AMT
		         ,A.PUBLIC_AMT
		         ,A.CARD_2015_AMT
		         ,A.CARD_2015_FH_AMT
		         ,A.CARD_2015_SH_AMT
		         ,A.CARD_2015_FH_OVER
		         ,A.CARD_2015_SH_OVER
		         ,A.CARD_2014_AMT
		         ,A.CARD_2013_AMT
		         ,A.CARD_2014_OVER
		         ,A.CARD_2013_OVER
		        ) = 
		      (SELECT 
		             --2015년도 금액 
		              SUM(CASE WHEN B.FORM_CD ='신용카드'   THEN B.TOT_AMT ELSE 0 END ) CARD_AMT_NTS     --신용카드
		             ,SUM(CASE WHEN B.FORM_CD ='직불카드'   THEN B.TOT_AMT ELSE 0 END ) DIR_CARD_AMT_NTS --직불카드
		             ,SUM(CASE WHEN B.FORM_CD ='현금영수증' THEN B.TOT_AMT ELSE 0 END ) CASH_AMT_NTS      --현금영수증
		             ,SUM( B.MARKET_TOT_AMT ) MARKET_AMT_NTS                                           --전통시장
		             ,SUM( B.TMONEY_TOT_AMT ) PUBLIC_AMT_NTS                                           --대중교통 
		             ,SUM(CASE WHEN GB_CD ='1' THEN CF_TOT_AMT+ CF_MARKET_TOT_AMT+CF_TMONEY_TOT_AMT ELSE 0 END )+SUM(CASE WHEN GB_CD ='1' THEN CS_TOT_AMT+ CS_MARKET_TOT_AMT+CS_TMONEY_TOT_AMT ELSE 0 END ) 
		             ,SUM(CASE WHEN GB_CD ='1' THEN CF_TOT_AMT+ CF_MARKET_TOT_AMT+CF_TMONEY_TOT_AMT ELSE 0 END ) CARD_2015_FH_AMT  --본인 15 상반기 신용카드등
		             ,SUM(CASE WHEN GB_CD ='1' THEN CS_TOT_AMT+ CS_MARKET_TOT_AMT+CS_TMONEY_TOT_AMT ELSE 0 END ) CARD_2015_SH_AMT  --본인 15 하반기 신용카드등
		             ,SUM(CASE WHEN GB_CD ='1' THEN CF_TOT_AMT+ CF_MARKET_TOT_AMT+CF_TMONEY_TOT_AMT ELSE 0 END )- SUM(CASE WHEN GB_CD ='1' AND FORM_CD ='신용카드' THEN CF_TOT_AMT ELSE 0 END ) CARD_2015_FH_OVER --본인 15 상반기 추가공제율
		             ,SUM(CASE WHEN GB_CD ='1' THEN CS_TOT_AMT+ CS_MARKET_TOT_AMT+CS_TMONEY_TOT_AMT ELSE 0 END )- SUM(CASE WHEN GB_CD ='1' AND FORM_CD ='신용카드' THEN CS_TOT_AMT ELSE 0 END ) CARD_2015_SH_OVER --본인 15 하반기 추가공제율
		             ,SUM(CASE WHEN GB_CD ='1' THEN PR_TOT_AMT+ PR_MARKET_TOT_AMT+PR_TMONEY_TOT_AMT ELSE 0 END ) CARD_2014_AMT  --본인 14 신용카드등
		             ,SUM(CASE WHEN GB_CD ='1' THEN FT_TOT_AMT+ FT_MARKET_TOT_AMT+FT_TMONEY_TOT_AMT ELSE 0 END ) CARD_2013_AMT  --본인 13 신용카드등
		             ,SUM(CASE WHEN GB_CD ='1' THEN PR_TOT_AMT+ PR_MARKET_TOT_AMT+PR_TMONEY_TOT_AMT ELSE 0 END )- SUM(CASE WHEN GB_CD ='1' AND FORM_CD ='신용카드' THEN PR_TOT_AMT ELSE 0 END ) CARD_2014_OVER --본인 14 추가공제율
		             ,SUM(CASE WHEN GB_CD ='1' THEN FT_TOT_AMT+ FT_MARKET_TOT_AMT+FT_TMONEY_TOT_AMT ELSE 0 END )- SUM(CASE WHEN GB_CD ='1' AND FORM_CD ='신용카드' THEN FT_TOT_AMT ELSE 0 END ) CARD_2013_OVER --본인 13 추가공제율
		             
		        FROM ASNHR.T_AC_FAMILY_TEMP_15 B
		       WHERE A.PIS_YY = B.PIS_YY
		         AND A.ENO_NO = B.ENO_NO
		         AND B.PIS_YY =?
		         AND B.ENO_NO =?	         
		       GROUP BY  B.PIS_YY, B.ENO_NO       
		      )
		    WHERE A.PIS_YY =?
              AND A.ENO_NO =?	
            ]]>
        </query>
    </sql>    
    
    
    <!-- 연말정산 개인별조회 -->
    <sql name="YACA099_FAMILY_TEMP_LOCK_UPT">
        <description>전자문서 파일 연말정산에 반영조회</description>
        <query>
            <![CDATA[
			UPDATE ASNHR.T_AC_FAMILY_TEMP_15 SET 
		           LOCK_YN ='Y'
		     WHERE PIS_YY =?
		       AND ENO_NO =?	        
            ]]>
        </query>
    </sql>    
    
    
   
   
   <!-- 연말정산 개인별조회 -->
    <sql name="YACA099_FAMILY_CARD_UPT">
        <description>전자문서 파일 연말정산에 반영조회</description>
        <query>
            <![CDATA[
			UPDATE ASNHR.T_AC_FAMILY_15 A SET 
			      A.CARD_AMT_NTS = ?
		         ,A.DIR_CARD_AMT_NTS = ?
		         ,A.CASH_AMT_NTS = ?
		         ,A.MARKET_AMT_NTS = ?
		         ,A.PUBLIC_AMT_NTS = ?
		         ,A.CARD_2015_AMT = ?
		         ,A.CARD_2015_FH_AMT = ?
		         ,A.CARD_2015_SH_AMT = ?
		         ,A.CARD_2015_FH_OVER = ?
		         ,A.CARD_2015_SH_OVER = ?
		         ,A.CARD_2013_AMT = ?
		         ,A.CARD_2014_AMT = ?
		         ,A.CARD_2013_OVER = ?
		         ,A.CARD_2014_OVER = ?
			 WHERE PIS_YY =?
			   AND ENO_NO =?
			   AND CET_NO =?
            ]]>
        </query>
    </sql>    
    
    <!-- 첨부파일 삭제시 TEMP 데이터삭제-->
    <sql name="YACA099_DEL_FAM_TEMP">
        <description>전자문서 파일 연말정산에 반영조회</description>
        <query>
            <![CDATA[
			DELETE FROM ASNHR.T_AC_FAMILY_TEMP_15
			 WHERE PIS_YY=?
			   AND ENO_NO =?
			   AND FILE_SEQ =?
			 
            ]]>
        </query>
    </sql>    
    

</sqls>
